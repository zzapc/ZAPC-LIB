<?xml version="1.0" encoding="utf-8"?>
<PROG NAME="ZCTRLJOBS_PARAM" VARCL="X" SUBC="1" RSTAT="K" RMAND="011" RLOAD="S" FIXPT="X" UCCHECK="X">
 <textPool>
  <language SPRAS="S">
   <textElement ID="R" ENTRY="Parametrizaciones control jobs" LENGTH="30 "/>
   <textElement ID="S" KEY="S_CASO" ENTRY="D       ." LENGTH="9 "/>
   <textElement ID="S" KEY="S_JOB" ENTRY="D       ." LENGTH="9 "/>
   <textElement ID="S" KEY="S_REPORT" ENTRY="D       ." LENGTH="9 "/>
   <textElement ID="S" KEY="S_TEXTO" ENTRY="D       ." LENGTH="9 "/>
   <textElement ID="S" KEY="S_TIPOC" ENTRY="D       ." LENGTH="9 "/>
  </language>
 </textPool>
 <dynpros>
  <dynpro PROG="ZCTRLJOBS_PARAM" DNUM="0100" FNUM="0100" BZMX="32 " BZBR="120 " MILI="192 " MICO="37 " MALI="0 " MACO="0 " NOLI="33 " NOCO="122 " VALP="0 " CUAN="G" SPRA="S" DTEXT="Control jobs">
   <dynprofield FNAM="MARCO" DIDX="000B" FLG1="00" FLG2="00" FLG3="08" FILL="R" FMB1="30" FMB2="00" LENG="78" LINE="01" COLN="02" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="102" AGLT="00" ADEZ="00" STXT="Datos job"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-TIPOCONTROL" DIDX="0000" FLG1="30" FLG2="00" FLG3="01" FMB1="30" FMB2="00" LENG="0F" LINE="02" COLN="03" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="2" AGLT="00" ADEZ="00" STXT="Tipo de control" RES1="X                                                                                                                                                                                                                                                       X"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-TIPOCONTROL" DIDX="0017" FLG1="A0" FLG2="00" FLG3="81" FMB1="00" FMB2="08" LENG="01" LINE="02" COLN="14" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="C" AGLT="02" ADEZ="00" STXT="_" RES1="XDL                                    00"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-CASOAVISO" DIDX="0000" FLG1="30" FLG2="00" FLG3="01" FMB1="30" FMB2="00" LENG="0A" LINE="02" COLN="38" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="1" AGLT="00" ADEZ="00" STXT="Caso aviso" RES1="X                                                                                                                                                                                                                                                       X"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-CASOAVISO" DIDX="0020" FLG1="A0" FLG2="00" FLG3="81" FMB1="00" FMB2="08" LENG="01" LINE="02" COLN="44" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="C" AGLT="02" ADEZ="00" STXT="_" RES1="XDL                                    00"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-JOBNAME" DIDX="0000" FLG1="30" FLG2="00" FLG3="00" FMB1="30" FMB2="00" LENG="0F" LINE="03" COLN="03" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="2" AGLT="00" ADEZ="00" STXT="Job" RES1="                                                                                                                                                                                                                                                        X"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-JOBNAME" DIDX="0000" FLG1="A0" FLG2="00" FLG3="80" FMB1="00" FMB2="00" LENG="20" LINE="03" COLN="14" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="C" AGLT="40" ADEZ="00" STXT="________________________________" RES1="                                       00"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-REPORT" DIDX="0000" FLG1="30" FLG2="00" FLG3="00" FMB1="30" FMB2="00" LENG="0A" LINE="03" COLN="38" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="3" AGLT="00" ADEZ="00" STXT="Report" RES1="                                                                                                                                                                                                                                                        X"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-REPORT" DIDX="0000" FLG1="A0" FLG2="00" FLG3="80" FMB1="00" FMB2="00" LENG="28" LINE="03" COLN="44" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="C" AGLT="50" ADEZ="00" STXT="________________________________________" RES1="                                       00"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-TEXTOBREVE" DIDX="0000" FLG1="30" FLG2="02" FLG3="00" FMB1="30" FMB2="00" LENG="0B" LINE="04" COLN="03" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="0" AGLT="00" ADEZ="00" STXT="Descripción" RES1="                                                                                                                                                                                                                                                        X"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-TEXTOBREVE" DIDX="0000" FLG1="A0" FLG2="02" FLG3="80" FMB1="00" FMB2="00" LENG="50" LINE="04" COLN="14" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="C" AGLT="A0" ADEZ="00" STXT="________________________________________________________________________________" RES1="                                       00"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-MSGID" DIDX="0000" FLG1="30" FLG2="00" FLG3="00" FMB1="30" FMB2="00" LENG="0F" LINE="05" COLN="03" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="2" AGLT="00" ADEZ="00" STXT="ID mensajes"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-MSGID" DIDX="0000" FLG1="A0" FLG2="00" FLG3="80" FMB1="00" FMB2="00" LENG="14" LINE="05" COLN="14" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="C" AGLT="28" ADEZ="00" STXT="____________________" RES1="                                       00"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-MSGNO" DIDX="0000" FLG1="30" FLG2="00" FLG3="00" FMB1="30" FMB2="00" LENG="0A" LINE="05" COLN="2A" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="1" AGLT="00" ADEZ="00" STXT="Mensaje"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-MSGNO" DIDX="0000" FLG1="A0" FLG2="00" FLG3="80" FMB1="00" FMB2="00" LENG="03" LINE="05" COLN="38" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="C" AGLT="06" ADEZ="00" STXT="___" RES1="                                       00"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-MSGV1" DIDX="0000" FLG1="30" FLG2="00" FLG3="00" FMB1="30" FMB2="00" LENG="14" LINE="05" COLN="40" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="3" AGLT="00" ADEZ="00" STXT="Variable de mensaje"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-MSGV1" DIDX="000F" FLG1="A1" FLG2="00" FLG3="80" FMB1="00" FMB2="00" LENG="32" LINE="05" COLN="55" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="C" AGLT="64" ADEZ="00" STXT="__________________________________________________" RES1="                                       00"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-DISTINTO" DIDX="0000" FLG1="A0" FLG2="00" FLG3="81" FILL="C" FMB1="00" FMB2="08" LENG="01" LINE="05" COLN="66" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="103" ITYP="C" AGLT="02" ADEZ="00" STXT="_" RES1="X                                      00"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-DISTINTO" DIDX="0000" FLG1="30" FLG2="00" FLG3="01" FILL="C" FMB1="30" FMB2="00" LENG="0F" LINE="05" COLN="68" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="103" ITYP="2" AGLT="00" ADEZ="00" STXT="Distinto"/>
   <dynprofield FNAM="TNO" DIDX="0000" FLG1="00" FLG2="00" FLG3="00" FMB1="30" FMB2="00" LENG="09" LINE="06" COLN="03" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="0" AGLT="00" ADEZ="00" STXT="No enviar"/>
   <dynprofield FNAM="L_LISTADO-NO_ENVIAR" DIDX="0064" FLG1="81" FLG2="00" FLG3="80" FMB1="00" FMB2="00" LENG="FF" LINE="06" COLN="14" LANF="00" LBLK="00" LREP="00" TYPE="STRG" ITYP="g" AGLT="08" ADEZ="00" STXT="____________________________________________________________________________________________________________________________________"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-EJEC_REPORT" DIDX="0000" FLG1="30" FLG2="00" FLG3="00" FMB1="30" FMB2="00" LENG="0F" LINE="07" COLN="03" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="0" AGLT="00" ADEZ="00" STXT="Ejecutar report" RES1="                                                                                                                                                                                                                                                        X"/>
   <dynprofield FNAM="ZCTRLJOBS_PARAM-EJEC_REPORT" DIDX="0000" FLG1="A0" FLG2="00" FLG3="80" FMB1="00" FMB2="00" LENG="28" LINE="07" COLN="14" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="C" AGLT="50" ADEZ="00" STXT="________________________________________" RES1="                                       00"/>
   <dynprofield FNAM="TUSUARIOS" DIDX="0000" FLG1="00" FLG2="00" FLG3="00" FMB1="30" FMB2="00" LENG="08" LINE="08" COLN="03" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="0" AGLT="00" ADEZ="00" STXT="Usuarios"/>
   <dynprofield FNAM="L_LISTADO-USUARIOS" DIDX="0064" FLG1="81" FLG2="00" FLG3="80" FMB1="00" FMB2="00" LENG="FF" LINE="08" COLN="14" LANF="00" LBLK="00" LREP="00" TYPE="STRG" ITYP="g" AGLT="08" ADEZ="00" STXT="____________________________________________________________________________________________________________________________________"/>
   <dynprofield FNAM="TNO_USUARIOS" DIDX="0000" FLG1="00" FLG2="00" FLG3="00" FMB1="30" FMB2="00" LENG="0B" LINE="09" COLN="03" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="0" AGLT="00" ADEZ="00" STXT="No usuarios"/>
   <dynprofield FNAM="L_LISTADO-NO_USUARIOS" DIDX="0064" FLG1="81" FLG2="00" FLG3="80" FMB1="00" FMB2="00" LENG="FF" LINE="09" COLN="14" LANF="00" LBLK="00" LREP="00" TYPE="STRG" ITYP="g" AGLT="08" ADEZ="00" STXT="____________________________________________________________________________________________________________________________________"/>
   <dynprofield FNAM="MCREADO" DIDX="0000" FLG1="00" FLG2="00" FLG3="00" FMB1="30" FMB2="00" LENG="0E" LINE="0A" COLN="03" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" ITYP="0" AGLT="00" ADEZ="00" STXT="Creado/Mod.por" RES1="                                                                                                                                                                                                                                                        X"/>
   <dynprofield FNAM="L_LISTADO-CREADO_POR" DIDX="0064" FLG1="81" FLG2="00" FLG3="80" FMB1="00" FMB2="00" LENG="FF" LINE="0A" COLN="14" LANF="00" LBLK="00" LREP="00" TYPE="STRG" ITYP="g" AGLT="08" ADEZ="00" STXT="____________________________________________________________________________________________________________________________________"/>
   <dynprofield FNAM="MR" DIDX="0009" FLG1="00" FLG2="00" FLG3="00" FILL="R" FMB1="30" FMB2="00" LENG="78" LINE="0C" COLN="02" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="104" AGLT="00" ADEZ="00" STXT="Responsables"/>
   <dynprofield FNAM="TCU" DIDX="0006" FLG1="F8" FLG2="F8" FLG3="00" FILL="T" FMB1="00" FMB2="00" LENG="74" LINE="0D" COLN="04" LTYP="E" LANF="65" LBLK="01" LREP="01" AGLT="05" ADEZ="0F"/>
   <dynprofield FNAM="ZEBC20-USUARIO" DIDX="000C" FLG1="00" FLG2="00" FLG3="08" FMB1="30" FMB2="80" LENG="07" LINE="01" COLN="01" LTYP="T" LANF="65" LBLK="01" LREP="01" TYPE="CHAR" AGLT="00" ADEZ="00" STXT="Usuario"/>
   <dynprofield FNAM="ZEBC20-NOMBRE" DIDX="0028" FLG1="00" FLG2="00" FLG3="08" FMB1="30" FMB2="80" LENG="06" LINE="01" COLN="02" LTYP="T" LANF="65" LBLK="01" LREP="01" TYPE="CHAR" AGLT="00" ADEZ="00" STXT="Nombre"/>
   <dynprofield FNAM="ZEBC20-EMAIL" DIDX="0050" FLG1="00" FLG2="00" FLG3="08" FMB1="30" FMB2="80" LENG="05" LINE="01" COLN="03" LTYP="T" LANF="65" LBLK="01" LREP="01" TYPE="CHAR" AGLT="00" ADEZ="00" STXT="Email"/>
   <dynprofield FNAM="ZEBC20-MARCA" DIDX="0001" FLG1="80" FLG2="00" FLG3="88" FILL="C" FMB1="00" FMB2="20" LENG="01" LINE="01" COLN="00" LTYP="T" LANF="65" LBLK="01" LREP="01" TYPE="CHAR" AUTH="105" AGLT="00" ADEZ="00"/>
   <dynprofield FNAM="ZEBC20-USUARIO" DIDX="000C" FLG1="80" FLG2="00" FLG3="88" FMB1="00" FMB2="00" LENG="0C" LINE="01" COLN="01" LTYP="T" LANF="65" LBLK="01" LREP="01" TYPE="CHAR" AGLT="00" ADEZ="00"/>
   <dynprofield FNAM="ZEBC20-NOMBRE" DIDX="0028" FLG1="80" FLG2="00" FLG3="88" FMB1="31" FMB2="00" LENG="28" LINE="01" COLN="02" LTYP="T" LANF="65" LBLK="01" LREP="01" TYPE="CHAR" AGLT="00" ADEZ="00" STXT="________________________________________"/>
   <dynprofield FNAM="ZEBC20-EMAIL" DIDX="0050" FLG1="80" FLG2="00" FLG3="88" FMB1="00" FMB2="00" LENG="50" LINE="01" COLN="03" LTYP="T" LANF="65" LBLK="01" LREP="01" TYPE="CHAR" AGLT="00" ADEZ="00" STXT="________________________________________________________________________________"/>
   <dynprofield FNAM="TCU_INSERT" DIDX="0003" FLG1="00" FLG2="00" FLG3="08" FILL="P" FMB1="30" FMB2="00" LENG="1B" LINE="13" COLN="04" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="106" GRP1="MOD" AGLT="00" ADEZ="00" STXT="@17@" RES1="                                                                                                                                                                        TCU_INSR"/>
   <dynprofield FNAM="TCU_DELETE" DIDX="0003" FLG1="00" FLG2="00" FLG3="08" FILL="P" FMB1="30" FMB2="00" LENG="04" LINE="13" COLN="08" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="107" GRP1="MOD" AGLT="00" ADEZ="00" STXT="@18@" RES1="                                                                                                                                                                        TCU_DELE"/>
   <dynprofield FNAM="TCU_TOP" DIDX="0003" FLG1="00" FLG2="00" FLG3="08" FILL="P" FMB1="30" FMB2="00" LENG="04" LINE="13" COLN="0E" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="108" GRP1="PAG" AGLT="00" ADEZ="00" STXT="@2Y@" RES1="                                                                                                                                                                        TCU_P--"/>
   <dynprofield FNAM="TCU_PREVIOUS" DIDX="0003" FLG1="00" FLG2="00" FLG3="08" FILL="P" FMB1="30" FMB2="00" LENG="04" LINE="13" COLN="12" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="109" GRP1="PAG" AGLT="00" ADEZ="00" STXT="@2Z@" RES1="                                                                                                                                                                        TCU_P-"/>
   <dynprofield FNAM="TCU_NEXT" DIDX="0003" FLG1="00" FLG2="00" FLG3="08" FILL="P" FMB1="30" FMB2="00" LENG="04" LINE="13" COLN="16" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="110" GRP1="PAG" AGLT="00" ADEZ="00" STXT="@30@" RES1="                                                                                                                                                                        TCU_P+"/>
   <dynprofield FNAM="TCU_BOTTOM" DIDX="0003" FLG1="00" FLG2="00" FLG3="08" FILL="P" FMB1="30" FMB2="00" LENG="04" LINE="13" COLN="1A" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="111" GRP1="PAG" AGLT="00" ADEZ="00" STXT="@31@" RES1="                                                                                                                                                                        TCU_P++"/>
   <dynprofield FNAM="TCU_MARK" DIDX="0003" FLG1="00" FLG2="00" FLG3="08" FILL="P" FMB1="30" FMB2="00" LENG="04" LINE="13" COLN="20" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="112" GRP1="MAR" AGLT="00" ADEZ="00" STXT="@4B@" RES1="                                                                                                                                                                        TCU_MARK"/>
   <dynprofield FNAM="TCU_DEMARK" DIDX="0003" FLG1="00" FLG2="00" FLG3="08" FILL="P" FMB1="30" FMB2="00" LENG="04" LINE="13" COLN="24" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="113" GRP1="MAR" AGLT="00" ADEZ="00" STXT="@4D@" RES1="                                                                                                                                                                        TCU_DMRK"/>
   <dynprofield FNAM="MT" DIDX="000C" FLG1="00" FLG2="00" FLG3="00" FILL="R" FMB1="30" FMB2="00" LENG="78" LINE="15" COLN="02" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AUTH="114" AGLT="00" ADEZ="00" STXT="Documentación"/>
   <dynprofield FNAM="CDOC" DIDX="000A" FLG1="00" FLG2="00" FLG3="00" FILL="U" FMB1="30" FMB2="00" LENG="75" LINE="16" COLN="03" LANF="00" LBLK="00" LREP="00" AUTH="115" AGLT="01" ADEZ="01"/>
   <dynprofield DIDX="0000" FLG1="80" FLG2="10" FLG3="08" FMB1="00" FMB2="00" LENG="14" LINE="FF" COLN="01" LTYP="O" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AGLT="00" ADEZ="00" STXT="____________________"/>
   <dynproflowsource>PROCESS BEFORE OUTPUT.

  MODULE STATUS_0100.

*&amp;SPWIZARD: PBO FLOW LOGIC FOR TABLECONTROL &apos;TCU&apos;
  MODULE TCU_CHANGE_TC_ATTR.
*&amp;SPWIZARD: MODULE TCU_CHANGE_COL_ATTR.
  LOOP AT   I_ZEBC20
       INTO ZEBC20
       WITH CONTROL TCU
       CURSOR TCU-CURRENT_LINE.
    MODULE TCU_GET_LINES.
*&amp;SPWIZARD:   MODULE TCU_CHANGE_FIELD_ATTR
  ENDLOOP.

PROCESS AFTER INPUT.

  chain.
    field: zctrljobs_param-tipocontrol,
           zctrljobs_param-jobname,
           zctrljobs_param-casoaviso.
       module validar_campos_obligatorios.
  endchain.

*&amp;SPWIZARD: PAI FLOW LOGIC FOR TABLECONTROL &apos;TCU&apos;
  LOOP AT I_ZEBC20.
    CHAIN.
      FIELD ZEBC20-USUARIO.
      FIELD ZEBC20-NOMBRE.
      FIELD ZEBC20-EMAIL.
      MODULE TCU_MODIFY ON CHAIN-REQUEST.
    endchain.
    FIELD ZEBC20-MARCA
      MODULE TCU_MARK ON REQUEST.
  ENDLOOP.
  MODULE TCU_USER_COMMAND.
*&amp;SPWIZARD: MODULE TCU_CHANGE_TC_ATTR.
*&amp;SPWIZARD: MODULE TCU_CHANGE_COL_ATTR.

 MODULE USER_COMMAND_0100.</dynproflowsource>
  </dynpro>
 </dynpros>
 <pfstatus>
  <pfstatus_sta CODE="STANDARD" MODAL="D" ACTCODE="000001" PFKCODE="000001" BUTCODE="0001" INT_NOTE="Standard für allgemeine Listausgabe"/>
  <pfstatus_sta CODE="STATUS" MODAL="D" ACTCODE="000002" PFKCODE="000002" BUTCODE="0001" INT_NOTE="Status"/>
  <pfstatus_fun CODE="%ML" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Juego de datos" PATH="A"/>
  <pfstatus_fun CODE="%PC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_EXPORT" ICON_ID="@49@" FUN_TEXT="Fichero local..." PATH="F"/>
  <pfstatus_fun CODE="%SC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SEARCH" ICON_ID="@13@" FUN_TEXT="Buscar" PATH="U"/>
  <pfstatus_fun CODE="%SC+" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SEARCH_NEXT" ICON_ID="@4E@" FUN_TEXT="Continuar búsqueda"/>
  <pfstatus_fun CODE="%SL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_MAIL" ICON_ID="@1S@" FUN_TEXT="Destinatario de mail" PATH="M"/>
  <pfstatus_fun CODE="&amp;ABC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_ABC" ICON_ID="@DL@" FUN_TEXT="Análisis ABC" PATH="A"/>
  <pfstatus_fun CODE="&amp;ALL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SELECT_ALL" ICON_ID="@4B@" FUN_TEXT="Marcar todo" PATH="T"/>
  <pfstatus_fun CODE="&amp;AQW" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_WORD_PROCESSING" ICON_ID="@DK@" FUN_TEXT="Tratamiento de textos..." PATH="T"/>
  <pfstatus_fun CODE="&amp;AUF" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Especificar desglose..." PATH="E"/>
  <pfstatus_fun CODE="&amp;AVE" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Grabar..." PATH="G"/>
  <pfstatus_fun CODE="&amp;AVE" TEXTNO="002" TEXT_TYPE="S" TEXT_NAME="ICON_ALV_VARIANT_SAVE" ICON_ID="@DN@" FUN_TEXT="Grabar disposición..."/>
  <pfstatus_fun CODE="&amp;AVR" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Valor medio" PATH="M"/>
  <pfstatus_fun CODE="&amp;CDF" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Anular fijación" PATH="I"/>
  <pfstatus_fun CODE="&amp;CFI" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Fijar hasta columna" PATH="F"/>
  <pfstatus_fun CODE="&amp;CRB" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TOTAL_LEFT" ICON_ID="@0B@" FUN_TEXT="Primera columna"/>
  <pfstatus_fun CODE="&amp;CRDESIG" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Crystal Reports Designer" PATH="C"/>
  <pfstatus_fun CODE="&amp;CRE" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TOTAL_RIGHT" ICON_ID="@0C@" FUN_TEXT="Última columna"/>
  <pfstatus_fun CODE="&amp;CRL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLUMN_LEFT" ICON_ID="@0D@" FUN_TEXT="Columna izquierda"/>
  <pfstatus_fun CODE="&amp;CRR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLUMN_RIGHT" ICON_ID="@0E@" FUN_TEXT="Columna derecha"/>
  <pfstatus_fun CODE="&amp;CRTEMPL" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Fichero reports crystal" PATH="C"/>
  <pfstatus_fun CODE="&amp;DAU" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Separador automático" PATH="T"/>
  <pfstatus_fun CODE="&amp;DOF" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Separador siempre off" PATH="E"/>
  <pfstatus_fun CODE="&amp;DON" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Separador siempre on" PATH="R"/>
  <pfstatus_fun CODE="&amp;EB9" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TABLE_SETTINGS" ICON_ID="@36@" FUN_TEXT="Llamar informe..." PATH="L"/>
  <pfstatus_fun CODE="&amp;ELP" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SYSTEM_HELP" ICON_ID="@35@" FUN_TEXT="Ayuda"/>
  <pfstatus_fun CODE="&amp;ERW" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Gestionar la disposición" PATH="T"/>
  <pfstatus_fun CODE="&amp;ETA" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SELECT_DETAIL" ICON_ID="@16@" FUN_TEXT="Detalles"/>
  <pfstatus_fun CODE="&amp;F03" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Back" PATH="K"/>
  <pfstatus_fun CODE="&amp;F12" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_CANCEL" ICON_ID="@0W@" FUN_TEXT="Cancelar" PATH="N"/>
  <pfstatus_fun CODE="&amp;F15" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Finalizar" PATH="F"/>
  <pfstatus_fun CODE="&amp;IC1" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SELECT_DETAIL" ICON_ID="@16@" FUN_TEXT="Seleccionar"/>
  <pfstatus_fun CODE="&amp;ILD" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Borrar filtros" PATH="L"/>
  <pfstatus_fun CODE="&amp;ILT" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_FILTER" ICON_ID="@4G@" FUN_TEXT="Fijar filtros" PATH="F"/>
  <pfstatus_fun CODE="&amp;KOM" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLLAPSE" ICON_ID="@3T@" FUN_TEXT="Seleccionar..." PATH="A"/>
  <pfstatus_fun CODE="&amp;LFO" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Status listas..." PATH="L"/>
  <pfstatus_fun CODE="&amp;LFO" TEXTNO="002" TEXT_TYPE="S" TEXT_NAME="ICON_INFORMATION" ICON_ID="@0S@" FUN_TEXT="Status listas..."/>
  <pfstatus_fun CODE="&amp;LIS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Lista básica" PATH="I"/>
  <pfstatus_fun CODE="&amp;MAX" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Máximo" PATH="Á"/>
  <pfstatus_fun CODE="&amp;MIN" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Mínimo" PATH="I"/>
  <pfstatus_fun CODE="&amp;NFO" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_INFORMATION" ICON_ID="@0S@" FUN_TEXT="Selecciones..." ICON_TEXT="Selecciones" PATH="E"/>
  <pfstatus_fun CODE="&amp;NTE" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Refrescar"/>
  <pfstatus_fun CODE="&amp;OAD" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Seleccionar..." PATH="E"/>
  <pfstatus_fun CODE="&amp;OAD" TEXTNO="002" TEXT_TYPE="S" TEXT_NAME="ICON_ALV_VARIANT_CHOOSE" ICON_ID="@DM@" FUN_TEXT="Seleccionar disposición..."/>
  <pfstatus_fun CODE="&amp;ODN" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SORT_DOWN" ICON_ID="@3F@" FUN_TEXT="Clasificación descendente" PATH="C"/>
  <pfstatus_fun CODE="&amp;OL0" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_ALV_VARIANTS" ICON_ID="@LZ@" FUN_TEXT="Modificar disposición..."/>
  <pfstatus_fun CODE="&amp;OLX" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_VARIANTS" ICON_ID="@0R@" FUN_TEXT="Modificar..." PATH="M"/>
  <pfstatus_fun CODE="&amp;OMP" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLLAPSE" ICON_ID="@3T@" FUN_TEXT="Comprimir"/>
  <pfstatus_fun CODE="&amp;OPT" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Ancho óptimo" PATH="P"/>
  <pfstatus_fun CODE="&amp;OUP" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SORT_UP" ICON_ID="@3E@" FUN_TEXT="Clasificación ascendente" PATH="I"/>
  <pfstatus_fun CODE="&amp;RNT" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_PRINT" ICON_ID="@0X@" FUN_TEXT="Imprimir" PATH="I"/>
  <pfstatus_fun CODE="&amp;RNT_PREV" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_LAYOUT_CONTROL" ICON_ID="@3G@" FUN_TEXT="Presentación preliminar" PATH="R"/>
  <pfstatus_fun CODE="&amp;SAL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_DESELECT_ALL" ICON_ID="@4D@" FUN_TEXT="Desmarcar todo" PATH="D"/>
  <pfstatus_fun CODE="&amp;SUM" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_INTERMEDIATE_SUM" ICON_ID="@5V@" FUN_TEXT="Subtotales..." PATH="S"/>
  <pfstatus_fun CODE="&amp;UMC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SUM" ICON_ID="@3Z@" FUN_TEXT="Total" PATH="T"/>
  <pfstatus_fun CODE="&amp;XINT" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Archivo ampliado de query SAP" PATH="E"/>
  <pfstatus_fun CODE="&amp;XPA" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_EXPAND" ICON_ID="@3S@" FUN_TEXT="Desplegar"/>
  <pfstatus_fun CODE="&amp;XXL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_XXL" ICON_ID="@DJ@" FUN_TEXT="Hoja cálculo coste..." PATH="A"/>
  <pfstatus_fun CODE="BACK" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Back"/>
  <pfstatus_fun CODE="BORRAR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_DELETE" ICON_ID="@11@" FUN_TEXT="Borrar" ICON_TEXT="Borrar" INFO_TEXT="Borrar"/>
  <pfstatus_fun CODE="GRABAR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SYSTEM_SAVE" ICON_ID="@2L@" FUN_TEXT="Grabar"/>
  <pfstatus_fun CODE="MODIFICAR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_CHANGE" ICON_ID="@0Z@" FUN_TEXT="Modificar" ICON_TEXT="Modificar" INFO_TEXT="Modificar"/>
  <pfstatus_fun CODE="NUEVO" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_CREATE" ICON_ID="@0Y@" FUN_TEXT="Nuevo" ICON_TEXT="Nuevo" INFO_TEXT="Nueva entrada"/>
  <pfstatus_fun CODE="P+" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Página siguiente"/>
  <pfstatus_fun CODE="P++" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Última página"/>
  <pfstatus_fun CODE="P-" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Página anterior"/>
  <pfstatus_fun CODE="P--" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Primera página"/>
  <pfstatus_fun CODE="PICK" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SELECT_DETAIL" ICON_ID="@16@" FUN_TEXT="Seleccionar" PATH="S"/>
  <pfstatus_men CODE="000001" NO="01" REF_TYPE="F" REF_CODE="&amp;RNT" REF_NO="001"/>
  <pfstatus_men CODE="000001" NO="02" REF_TYPE="M" REF_CODE="000002"/>
  <pfstatus_men CODE="000001" NO="03" REF_TYPE="M" REF_CODE="000003"/>
  <pfstatus_men CODE="000001" NO="04" REF_TYPE="S"/>
  <pfstatus_men CODE="000001" NO="05" REF_TYPE="F" REF_CODE="&amp;F15" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="01" REF_TYPE="F" REF_CODE="&amp;AQW" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="02" REF_TYPE="F" REF_CODE="&amp;XXL" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="03" REF_TYPE="F" REF_CODE="%PC" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="04" REF_TYPE="F" REF_CODE="&amp;XINT" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="05" REF_TYPE="F" REF_CODE="&amp;CRTEMPL" REF_NO="001"/>
  <pfstatus_men CODE="000003" NO="01" REF_TYPE="F" REF_CODE="%SL" REF_NO="001"/>
  <pfstatus_men CODE="000003" NO="02" REF_TYPE="F" REF_CODE="%ML" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="01" REF_TYPE="F" REF_CODE="&amp;ALL" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="02" REF_TYPE="F" REF_CODE="&amp;SAL" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="03" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="04" REF_TYPE="F" REF_CODE="&amp;ILT" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="05" REF_TYPE="F" REF_CODE="&amp;ILD" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="06" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="07" REF_TYPE="F" REF_CODE="&amp;OUP" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="08" REF_TYPE="F" REF_CODE="&amp;ODN" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="09" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="10" REF_TYPE="M" REF_CODE="000005"/>
  <pfstatus_men CODE="000004" NO="11" REF_TYPE="F" REF_CODE="&amp;SUM" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="12" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="13" REF_TYPE="F" REF_CODE="%SC" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="14" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="15" REF_TYPE="F" REF_CODE="&amp;F12" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="01" REF_TYPE="F" REF_CODE="&amp;UMC" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="02" REF_TYPE="F" REF_CODE="&amp;AVR" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="03" REF_TYPE="F" REF_CODE="&amp;MIN" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="04" REF_TYPE="F" REF_CODE="&amp;MAX" REF_NO="001"/>
  <pfstatus_men CODE="000006" NO="01" REF_TYPE="F" REF_CODE="&amp;ABC" REF_NO="001"/>
  <pfstatus_men CODE="000006" NO="02" REF_TYPE="S"/>
  <pfstatus_men CODE="000006" NO="03" REF_TYPE="F" REF_CODE="&amp;CRDESIG" REF_NO="001"/>
  <pfstatus_men CODE="000006" NO="04" REF_TYPE="S"/>
  <pfstatus_men CODE="000006" NO="05" REF_TYPE="F" REF_CODE="&amp;F03" REF_NO="001"/>
  <pfstatus_men CODE="000007" NO="01" REF_TYPE="F" REF_CODE="&amp;LIS" REF_NO="001"/>
  <pfstatus_men CODE="000007" NO="02" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="03" REF_TYPE="M" REF_CODE="000008"/>
  <pfstatus_men CODE="000007" NO="04" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="05" REF_TYPE="M" REF_CODE="000009"/>
  <pfstatus_men CODE="000007" NO="06" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="07" REF_TYPE="M" REF_CODE="000010"/>
  <pfstatus_men CODE="000007" NO="08" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="09" REF_TYPE="F" REF_CODE="&amp;NFO" REF_NO="001"/>
  <pfstatus_men CODE="000007" NO="10" REF_TYPE="F" REF_CODE="&amp;LFO" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="01" REF_TYPE="F" REF_CODE="&amp;OLX" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="02" REF_TYPE="F" REF_CODE="&amp;OAD" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="03" REF_TYPE="S"/>
  <pfstatus_men CODE="000008" NO="04" REF_TYPE="F" REF_CODE="&amp;AVE" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="05" REF_TYPE="S"/>
  <pfstatus_men CODE="000008" NO="06" REF_TYPE="F" REF_CODE="&amp;ERW" REF_NO="001"/>
  <pfstatus_men CODE="000009" NO="01" REF_TYPE="F" REF_CODE="&amp;KOM" REF_NO="001"/>
  <pfstatus_men CODE="000009" NO="02" REF_TYPE="F" REF_CODE="&amp;AUF" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="01" REF_TYPE="F" REF_CODE="&amp;OPT" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="02" REF_TYPE="S"/>
  <pfstatus_men CODE="000010" NO="03" REF_TYPE="F" REF_CODE="&amp;CFI" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="04" REF_TYPE="F" REF_CODE="&amp;CDF" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="05" REF_TYPE="S"/>
  <pfstatus_men CODE="000010" NO="06" REF_TYPE="F" REF_CODE="&amp;DAU" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="07" REF_TYPE="F" REF_CODE="&amp;DON" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="08" REF_TYPE="F" REF_CODE="&amp;DOF" REF_NO="001"/>
  <pfstatus_mtx CODE="000001" TEXT_TYPE="S" TEXT="Lista" PATH="L" INT_NOTE="STANDARD Liste"/>
  <pfstatus_mtx CODE="000002" TEXT_TYPE="S" TEXT="Exportar" PATH="E" INT_NOTE="STANDARD Sichern"/>
  <pfstatus_mtx CODE="000003" TEXT_TYPE="S" TEXT="Enviar a" PATH="N"/>
  <pfstatus_mtx CODE="000004" TEXT_TYPE="S" TEXT="Tratar" PATH="T" INT_NOTE="STANDARD"/>
  <pfstatus_mtx CODE="000005" TEXT_TYPE="S" TEXT="Calcular" PATH="A"/>
  <pfstatus_mtx CODE="000006" TEXT_TYPE="S" TEXT="Pasar a" PATH="P" INT_NOTE="STANDARD"/>
  <pfstatus_mtx CODE="000007" TEXT_TYPE="S" TEXT="Opciones" PATH="O" INT_NOTE="STANDARD"/>
  <pfstatus_mtx CODE="000008" TEXT_TYPE="S" TEXT="Disposición" PATH="D" INT_NOTE="Sub STANDARD"/>
  <pfstatus_mtx CODE="000009" TEXT_TYPE="S" TEXT="Niveles de totalización" PATH="S" INT_NOTE="Sub STANDARD"/>
  <pfstatus_mtx CODE="000010" TEXT_TYPE="S" TEXT="Columnas" PATH="C"/>
  <pfstatus_act CODE="000001" NO="01" MENUCODE="000001"/>
  <pfstatus_act CODE="000001" NO="02" MENUCODE="000004"/>
  <pfstatus_act CODE="000001" NO="03" MENUCODE="000006"/>
  <pfstatus_act CODE="000001" NO="04" MENUCODE="000007"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="01" PFNO="20"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="02" PFNO="36"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="03" PFNO="16"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="04" PFNO="39"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="05" PFNO="37"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="06" PFNO="S"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="07" PFNO="05"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="08" PFNO="06"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="09" PFNO="S"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="10" PFNO="28"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="11" PFNO="40"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="12" PFNO="29"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="13" PFNO="S"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="14" PFNO="30"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="15" PFNO="42"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="16" PFNO="35"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="17" PFNO="47"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="18" PFNO="S"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="19" PFNO="43"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="20" PFNO="44"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="21" PFNO="45"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="22" PFNO="31"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="23" PFNO="25"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="24" PFNO="S"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="25" PFNO="32"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="26" PFNO="33"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="27" PFNO="34"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="28" PFNO="S"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="29" PFNO="41"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="30" PFNO="07"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="31" PFNO="S"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="32" PFNO="18"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="33" PFNO="26"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="34" PFNO="27"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="35" PFNO="19"/>
  <pfstatus_pfk CODE="000001" PFNO="01" FUNCODE="&amp;ELP" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="02" FUNCODE="&amp;IC1" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="03" FUNCODE="&amp;F03" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="05" FUNCODE="&amp;ALL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="06" FUNCODE="&amp;SAL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="07" FUNCODE="&amp;NFO" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="08" FUNCODE="&amp;NTE" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="11" FUNCODE="GRABAR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="12" FUNCODE="&amp;F12" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="15" FUNCODE="&amp;F15" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="16" FUNCODE="BORRAR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="18" FUNCODE="&amp;CRB" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="19" FUNCODE="&amp;CRE" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="20" FUNCODE="NUEVO" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="21" FUNCODE="P--" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="22" FUNCODE="P-" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="23" FUNCODE="P+" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="24" FUNCODE="P++" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="25" FUNCODE="&amp;ABC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="26" FUNCODE="&amp;CRL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="27" FUNCODE="&amp;CRR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="28" FUNCODE="&amp;OUP" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="29" FUNCODE="&amp;ILT" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="30" FUNCODE="&amp;UMC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="31" FUNCODE="%SL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="32" FUNCODE="&amp;OL0" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="33" FUNCODE="&amp;OAD" FUNNO="002"/>
  <pfstatus_pfk CODE="000001" PFNO="34" FUNCODE="&amp;AVE" FUNNO="002"/>
  <pfstatus_pfk CODE="000001" PFNO="35" FUNCODE="&amp;XPA" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="36" FUNCODE="MODIFICAR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="37" FUNCODE="&amp;EB9" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="39" FUNCODE="&amp;ETA" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="40" FUNCODE="&amp;ODN" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="41" FUNCODE="&amp;LFO" FUNNO="002"/>
  <pfstatus_pfk CODE="000001" PFNO="42" FUNCODE="&amp;SUM" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="43" FUNCODE="&amp;XXL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="44" FUNCODE="&amp;AQW" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="45" FUNCODE="%PC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="46" FUNCODE="&amp;RNT_PREV" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="47" FUNCODE="&amp;OMP" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="71" FUNCODE="%SC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="80" FUNCODE="P--" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="81" FUNCODE="P-" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="82" FUNCODE="P+" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="83" FUNCODE="P++" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="84" FUNCODE="%SC+" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="86" FUNCODE="&amp;RNT" FUNNO="001"/>
  <pfstatus_pfk CODE="000002" PFNO="02" FUNCODE="PICK" FUNNO="001"/>
  <pfstatus_pfk CODE="000002" PFNO="03" FUNCODE="BACK" FUNNO="001"/>
  <pfstatus_pfk CODE="000002" PFNO="11" FUNCODE="GRABAR" FUNNO="001"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%CH"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%ML"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%PC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%SC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%SC+"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%SL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ABC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ALL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AQW"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AUF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AVE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AVR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;BS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;BS+"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;BS-"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CDF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CFI"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRB"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;DAU"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;DOF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;DON"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;EB3"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;EB9"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ELP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ERW"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ETA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;F03"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;F12"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;F15"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;IC1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ILD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ILT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;KOM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;LFO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;LIS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;MAX"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;MIN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;NFO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;NTE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OAD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ODN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OL0"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OLX"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OMP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OPT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OUP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;RNT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;SAL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;SUM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;UMC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;XPA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;XXL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BAC1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BACK"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB2"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB3"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB9"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEBN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BORRAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COL0"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COLX"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DETA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DRUK"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DSAL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ENTE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="EXIT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="EXPA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="FILD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="FILT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="GLIS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="GRABAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="HELP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="INFO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="KOMP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="MODIFICAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="NUEVO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P+"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P++"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P-"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P--"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PF09"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PF13"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PIC1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PICK"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PRI"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PRIN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PRNT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="RW"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SALL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SAUF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SAVE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRB"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SKOM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SODN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SOUP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SUMC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ZSUM"/>
  <pfstatus_set STATUS="STATUS" FUNCTION="BACK"/>
  <pfstatus_set STATUS="STATUS" FUNCTION="GRABAR"/>
  <pfstatus_set STATUS="STATUS" FUNCTION="PICK"/>
  <pfstatus_doc OBJ_TYPE="A" OBJ_CODE="000001" MODAL="D" INT_NOTE="Standardoberfläche              STANDARD"/>
  <pfstatus_doc OBJ_TYPE="P" OBJ_CODE="000001" MODAL="D" NORM="X" INT_NOTE="Standard maximale Interaktion"/>
  <pfstatus_doc OBJ_TYPE="B" OBJ_CODE="000001" SUB_CODE="0001" MODAL="D" INT_NOTE="Standard maximale Interaktion"/>
  <pfstatus_doc OBJ_TYPE="A" OBJ_CODE="000002" MODAL="D" INT_NOTE="Status"/>
  <pfstatus_doc OBJ_TYPE="P" OBJ_CODE="000002" MODAL="D" INT_NOTE="Status"/>
  <pfstatus_doc OBJ_TYPE="B" OBJ_CODE="000002" SUB_CODE="0001" MODAL="D" INT_NOTE="Status"/>
  <pfstatus_tit CODE="001" TEXT="Editar control job"/>
 </pfstatus>
 <source>************************************************************************
* APLICACION  : BC                                                     *
* TIPO        : Listado
* TITULO      : Parametrización control de jobs
* DESCRIPCION :
*                                                                      *
* AUTOR: Andrés Picazo                          FECHA: 30/07/2007      *
* MODIFICACIONES                                                       *
* -------------                                                        *
* FECHA        NOMBRE            TAREA              ORDEN              *
* -------------------------------------------------------------------- *
* dd.mm.yyyy   username          APPXXX             PO1K90XXXXX        *
************************************************************************
REPORT zctrljobs_param
      NO STANDARD PAGE HEADING
      LINE-COUNT 90
      LINE-SIZE 120.

*------INCLUDES--------------------------------------------------------*

*------TABLAS/ESTRUCTURAS----------------------------------------------*
TABLES : zctrljobs_doc,
         zctrljobs_resp,
         zebc20,
         user_addr,
         zctrljobs_param.

*------TABLAS INTERNAS-------------------------------------------------*
TYPES: BEGIN OF t_listado,
*        check,
         tipocontrol   LIKE zctrljobs_param-tipocontrol,
         jobname       LIKE zctrljobs_param-jobname,
         report        LIKE zctrljobs_param-report,
         textobreve    LIKE zctrljobs_param-textobreve,
         casoaviso     LIKE zctrljobs_param-casoaviso,
         msgid         LIKE zctrljobs_param-msgid,
         msgno         LIKE zctrljobs_param-msgno,
         msgv1         LIKE zctrljobs_param-msgv1,
         distinto      LIKE zctrljobs_param-distinto,
         no_enviar     TYPE zstring,
         solo_usuarios TYPE zstring,
         no_usuarios   TYPE zstring,
         creado_por    TYPE zstring,
         ejec_report   LIKE zctrljobs_param-ejec_report,
       END OF t_listado.
DATA: i_listado TYPE TABLE OF t_listado,
      l_listado TYPE t_listado.

FIELD-SYMBOLS &lt;listado&gt; TYPE t_listado.


DATA: i_zctrljobs_doc       LIKE zctrljobs_doc OCCURS 0 WITH HEADER LINE,
      i_zctrljobs_resp      LIKE zctrljobs_resp OCCURS 0 WITH HEADER LINE,
      i_zebc20              LIKE zebc20 OCCURS 0 WITH HEADER LINE,
      o_texto               TYPE REF TO zcl_ap_control_texto,
      v_hreditor_visualizar,
      i_hreditor_texto      TYPE TABLE OF text72,
      l_text72              TYPE zctrljobs_doc-comentarios.

*----------------------------------------------------------------------*
*       CLASS lcl_alv DEFINITION
*----------------------------------------------------------------------*
*
*----------------------------------------------------------------------*
CLASS lcl_alv DEFINITION INHERITING FROM zcl_ap_alv. &quot;_check.
  PUBLIC SECTION.
    METHODS: handle_double_click REDEFINITION.
    METHODS: handle_user_command REDEFINITION.
ENDCLASS. &quot;lcl_alv DEFINITION


*------VARIABLES-------------------------------------------------------*
DATA: v_inicio,
      o_alv TYPE REF TO lcl_alv.

*&amp;SPWIZARD: DECLARATION OF TABLECONTROL &apos;TCU&apos; ITSELF
CONTROLS: tcu TYPE TABLEVIEW USING SCREEN 0100.

*&amp;SPWIZARD: LINES OF TABLECONTROL &apos;TCU&apos;
DATA:     g_tcu_lines  LIKE sy-loopc.

DATA:     ok_code LIKE sy-ucomm.


*------PARAMETER/SELECT-OPTIONS EN PANTALLA----------------------------*
SELECTION-SCREEN BEGIN OF BLOCK blk_par WITH FRAME TITLE TEXT-001.

SELECT-OPTIONS: s_tipoc  FOR zctrljobs_param-tipocontrol,
                s_job    FOR zctrljobs_param-jobname,
                s_report FOR zctrljobs_param-report,
                s_texto  FOR zctrljobs_param-textobreve,
                s_caso   FOR zctrljobs_param-casoaviso.
SELECTION-SCREEN END OF BLOCK blk_par.

*----------------------------------------------------------------------*
*       CLASS lcl_alv IMPLEMENTATION
*----------------------------------------------------------------------*
*
*----------------------------------------------------------------------*
CLASS lcl_alv IMPLEMENTATION.
  METHOD handle_double_click.
    READ TABLE i_listado INDEX row INTO l_listado.
    IF sy-subrc = 0.
      CLEAR zctrljobs_param.
      SELECT SINGLE * FROM  zctrljobs_param
        INTO zctrljobs_param
             WHERE  tipocontrol  = l_listado-tipocontrol
             AND    jobname      = l_listado-jobname
             AND    report       = l_listado-report.

      v_inicio = &apos;X&apos;.
      v_hreditor_visualizar = &apos;X&apos;.
      CALL SCREEN 100.
    ENDIF.
  ENDMETHOD. &quot;handle_double_click
  METHOD handle_user_command.
    DATA: l_row TYPE i.

    CASE e_salv_function.
      WHEN &apos;EXCEL&apos;.
        exportar_excel( ).
      WHEN &apos;NUEVO&apos;.
        CLEAR zctrljobs_param.

        v_inicio = &apos;X&apos;.
        CLEAR v_hreditor_visualizar.
        CALL SCREEN 100.
        PERFORM seleccionar_datos.
        refresh( ).

      WHEN &apos;MODIFICAR&apos;.
        l_row = get_fila_activa( ).
        READ TABLE i_listado INTO l_listado INDEX l_row.
        IF sy-subrc = 0.
          CLEAR zctrljobs_param.
          MOVE-CORRESPONDING l_listado TO zctrljobs_param.
          v_inicio = &apos;X&apos;.
          CLEAR v_hreditor_visualizar.
          CALL SCREEN 100.
          PERFORM seleccionar_datos.
          refresh( ).
        ENDIF.


      WHEN &apos;BORRAR&apos;.
        l_row = get_fila_activa( ).
        READ TABLE i_listado INTO l_listado INDEX l_row.
        IF sy-subrc = 0.
          DELETE FROM zctrljobs_param
           WHERE tipocontrol = l_listado-tipocontrol
             AND jobname     = l_listado-jobname
             AND report      = l_listado-report.

          PERFORM seleccionar_datos.
          refresh( ).
        ENDIF.
      WHEN OTHERS.
    ENDCASE.
  ENDMETHOD. &quot;handle_USER_COMMAND
ENDCLASS. &quot;lcl_alv IMPLEMENTATION

AT SELECTION-SCREEN.

************************************************************************
*
*                  LOGICA DEL PROGRAMA
*
************************************************************************

*----------------------------------------------------------------------*
* INITIALIZATION
*----------------------------------------------------------------------*
INITIALIZATION.

*----------------------------------------------------------------------
* START-OF-SELECTION.
*----------------------------------------------------------------------*
START-OF-SELECTION.


  PERFORM seleccionar_datos.

  PERFORM listado.

*----------------------------------------------------------------------
* AT USER-COMMAND.
*----------------------------------------------------------------------*
AT USER-COMMAND.

*----------------------------------------------------------------------
* TOP-OF-PAGE.
*----------------------------------------------------------------------*
TOP-OF-PAGE.

************************************************************************
*
*                  FORMS ADICIONALES
*
************************************************************************


*&amp;---------------------------------------------------------------------*
*&amp;      Form  SELECCIONAR_DATOS
*&amp;---------------------------------------------------------------------*
FORM seleccionar_datos.

  REFRESH i_listado.
  SELECT * FROM zctrljobs_param               &quot;#EC CI_ALL_FIELDS_NEEDED
    INTO CORRESPONDING FIELDS OF TABLE i_listado
   WHERE tipocontrol IN s_tipoc
     AND jobname     IN s_job
     AND report      IN s_report
     AND textobreve  IN s_texto
     AND casoaviso   IN s_caso.

  LOOP AT i_listado ASSIGNING FIELD-SYMBOL(&lt;listado&gt;).
    SELECT  tipo, string FROM  zctrljobs_paramt
      INTO TABLE @DATA(i_t)
     WHERE tipocontrol  = @&lt;listado&gt;-tipocontrol
       AND jobname      = @&lt;listado&gt;-jobname
       AND report       = @&lt;listado&gt;-report.
    LOOP AT i_t ASSIGNING FIELD-SYMBOL(&lt;t&gt;).
      ASSIGN COMPONENT &lt;t&gt;-tipo OF STRUCTURE &lt;listado&gt; TO FIELD-SYMBOL(&lt;fs&gt;).
      IF sy-subrc = 0.
        &lt;fs&gt; = &lt;t&gt;-string.
      ENDIF.
    ENDLOOP.
  ENDLOOP.

ENDFORM.                    &quot; SELECCIONAR_DATOS

*&amp;---------------------------------------------------------------------*
*&amp;      Form  listado_alv
*&amp;---------------------------------------------------------------------*
FORM listado.

  CREATE OBJECT o_alv
    EXPORTING
      status = &apos;STANDARD&apos;.

  o_alv-&gt;set_field_text( &apos;NO_ENVIAR,SOLO_USUARIOS,NO_USUARIOS,CREADO_POR&apos; ).
  o_alv-&gt;show( ).

ENDFORM.                    &quot; listado


******************** DYNPRO ********************************************

*&amp;---------------------------------------------------------------------*
*&amp;      Module  STATUS_0100  OUTPUT
*&amp;---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE status_0100 OUTPUT.
  SET PF-STATUS &apos;STATUS&apos;.
  SET TITLEBAR &apos;001&apos;.

  IF v_inicio = &apos;X&apos;.
    IF NOT zctrljobs_param IS INITIAL.
      SELECT comentarios FROM zctrljobs_doc
        INTO CORRESPONDING FIELDS OF TABLE i_zctrljobs_doc
       WHERE tipocontrol = zctrljobs_param-tipocontrol
         AND jobname     = zctrljobs_param-jobname
         AND report      = zctrljobs_param-report.
      CLEAR i_hreditor_texto.
      LOOP AT i_zctrljobs_doc.
        APPEND i_zctrljobs_doc-comentarios TO i_hreditor_texto.
      ENDLOOP.

      REFRESH i_zebc20.
      SELECT * FROM zctrljobs_resp
        INTO CORRESPONDING FIELDS OF TABLE i_zebc20
       WHERE tipocontrol = zctrljobs_param-tipocontrol
         AND jobname     = zctrljobs_param-jobname
         AND report      = zctrljobs_param-report.
    ELSE.
      REFRESH: i_zctrljobs_doc, i_zebc20, i_hreditor_texto.
    ENDIF.

    IF o_texto IS INITIAL.
      CREATE OBJECT o_texto
        EXPORTING
          controlname = &apos;CDOC&apos;.

    ENDIF.
    o_texto-&gt;set_editor( lines = i_hreditor_texto[]
                         display_mode = v_hreditor_visualizar ).
  ENDIF.

  IF i_zebc20[] IS INITIAL.
    DO 10 TIMES.
      CLEAR i_zebc20.
      APPEND i_zebc20.
    ENDDO.
  ENDIF.

  LOOP AT i_zebc20.
    IF  NOT i_zebc20-usuario IS INITIAL.
      CLEAR user_addr.
      SELECT SINGLE name_first name_last FROM  user_addr
        INTO CORRESPONDING FIELDS OF user_addr
             WHERE  bname  = i_zebc20-usuario.
      CONCATENATE user_addr-name_first user_addr-name_last
            INTO i_zebc20-nombre SEPARATED BY space.
    ELSE.
      CLEAR i_zebc20-nombre.
    ENDIF.
    MODIFY i_zebc20.
  ENDLOOP.

  DESCRIBE TABLE i_zebc20 LINES tcu-lines.

  CLEAR v_inicio.

  LOOP AT SCREEN.
    IF v_hreditor_visualizar = &apos;X&apos;.
      IF screen-name(6) = &apos;ZCTRLJOBS_PARAM&apos;.
        screen-input = 0.
        IF screen-name(10) = &apos;ZCTRLJOBS_PARAM-MSG&apos; OR
           screen-name = &apos;ZCTRLJOBS_PARAM-DISTINTO&apos;.
          IF zctrljobs_param-casoaviso = &apos;D&apos;.
            screen-invisible = 0.
          ELSE.
            screen-invisible = 1.
          ENDIF.
        ENDIF.
      ENDIF.
    ELSE.
      IF screen-name(10) = &apos;ZCTRLJOBS_PARAM-MSG&apos; OR
         screen-name = &apos;ZCTRLJOBS_PARAM-DISTINTO&apos;.
        IF zctrljobs_param-casoaviso = &apos;D&apos;.
          screen-invisible = 0.
          screen-input = 1.
        ELSE.
          screen-invisible = 1.
          screen-input = 0.
        ENDIF.
      ELSEIF screen-name(6) = &apos;ZCTRLJOBS_PARAM&apos;.
        screen-input = 1.
      ENDIF.
    ENDIF.
    MODIFY SCREEN.
  ENDLOOP.

ENDMODULE.                 &quot; STATUS_0100  OUTPUT


*&amp;---------------------------------------------------------------------*
*&amp;      Module  USER_COMMAND_0100  INPUT
*&amp;---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE user_command_0100 INPUT.
  DATA zctrljobs_paramt TYPE zctrljobs_paramt.
  CASE sy-ucomm.
    WHEN &apos;GRABAR&apos;.
      MODIFY zctrljobs_param FROM zctrljobs_param.
      MOVE-CORRESPONDING zctrljobs_param TO zctrljobs_paramt.
      zctrljobs_paramt-tipo = &apos;NO_ENVIAR&apos;.
      IF NOT l_listado-no_enviar IS INITIAL.
        zctrljobs_paramt-string = l_listado-no_enviar.
        MODIFY zctrljobs_paramt FROM zctrljobs_paramt.
      ELSE.
        DELETE zctrljobs_paramt FROM zctrljobs_paramt.
      ENDIF.
      zctrljobs_paramt-tipo = &apos;SOLO_USUARIOS&apos;.
      IF NOT l_listado-solo_usuarios IS INITIAL.
        zctrljobs_paramt-string = l_listado-solo_usuarios.
        MODIFY zctrljobs_paramt FROM zctrljobs_paramt.
      ELSE.
        DELETE zctrljobs_paramt FROM zctrljobs_paramt.
      ENDIF.
      zctrljobs_paramt-tipo = &apos;NO_USUARIOS&apos;.
      IF NOT l_listado-no_usuarios IS INITIAL.
        zctrljobs_paramt-string = l_listado-no_usuarios.
        MODIFY zctrljobs_paramt FROM zctrljobs_paramt.
      ELSE.
        DELETE zctrljobs_paramt FROM zctrljobs_paramt.
      ENDIF.
      zctrljobs_paramt-tipo = &apos;CREADO_POR&apos;.
      IF NOT l_listado-creado_por IS INITIAL.
        zctrljobs_paramt-string = l_listado-creado_por.
        MODIFY zctrljobs_paramt FROM zctrljobs_paramt.
      ELSE.
        DELETE zctrljobs_paramt FROM zctrljobs_paramt.
      ENDIF.

      o_texto-&gt;get_editor( EXPORTING col_width = 120 IMPORTING lines = i_hreditor_texto[] ).
      DELETE FROM zctrljobs_doc
       WHERE tipocontrol = zctrljobs_param-tipocontrol
         AND jobname     = zctrljobs_param-jobname
         AND report      = zctrljobs_param-report.

      DELETE ADJACENT DUPLICATES FROM i_hreditor_texto.
      LOOP AT i_hreditor_texto INTO l_text72.
        CLEAR zctrljobs_doc.
        MOVE-CORRESPONDING zctrljobs_param TO zctrljobs_doc.
        zctrljobs_doc-linea = sy-tabix.
        zctrljobs_doc-comentarios = l_text72.
        MODIFY zctrljobs_doc.
      ENDLOOP.


      DELETE FROM zctrljobs_resp
       WHERE tipocontrol = zctrljobs_param-tipocontrol
         AND jobname     = zctrljobs_param-jobname
         AND report      = zctrljobs_param-report.

      LOOP AT i_zebc20 WHERE NOT usuario IS INITIAL
                          OR NOT email IS INITIAL.
        CLEAR zctrljobs_resp.
        MOVE-CORRESPONDING i_zebc20 TO zctrljobs_resp.
        MOVE-CORRESPONDING zctrljobs_param TO zctrljobs_resp.
        INSERT zctrljobs_resp.
      ENDLOOP.

      MESSAGE s398(00) WITH &apos;Se han grabado los datos&apos;.
    WHEN &apos;PICK&apos;.
      DATA: l_campo       TYPE string,
            l_texto(4098),
            l_mod.
      GET CURSOR FIELD l_campo.
      CASE l_campo.
        WHEN &apos;L_LISTADO-NO_ENVIAR&apos;.
          CLEAR l_mod.
          l_texto = l_listado-no_enviar.
*          l_string = zcl_ap_string=&gt;editor_popup_string( string = l_string titulo = &apos;No enviar si...&apos; ).
          CALL FUNCTION &apos;Z_POPUP_EDIT_TEXT&apos;
            EXPORTING
              titulo     = &apos;No enviar si...&apos;
              texto      = &apos;&apos;
              ini_x      = 1
*             INI_Y      = 3
              fin_x      = 202
*             FIN_Y      = 24
              max_cols   = 200
*             DISPLAY_MODE       = &apos;&apos;
            IMPORTING
              modificado = l_mod
*             CANCELADO  =
            CHANGING
              string     = l_texto.
          IF l_mod = &apos;X&apos;.
            l_listado-no_enviar = l_texto.
          ENDIF.

        WHEN &apos;L_LISTADO-NO_USUARIOS&apos;.
          CLEAR l_mod.
          l_texto = l_listado-no_usuarios.
          CALL FUNCTION &apos;Z_POPUP_EDIT_TEXT&apos;
            EXPORTING
              titulo     = &apos;No enviar a usuarios...&apos;
              texto      = &apos;&apos;
              ini_x      = 1
*             INI_Y      = 3
              fin_x      = 202
*             FIN_Y      = 24
              max_cols   = 200
*             DISPLAY_MODE       = &apos;&apos;
            IMPORTING
              modificado = l_mod
*             CANCELADO  =
            CHANGING
              string     = l_texto.
          IF l_mod = &apos;X&apos;.
            l_listado-no_usuarios = l_texto.
          ENDIF.

      ENDCASE.
    WHEN &apos;BACK&apos;.
      LEAVE TO SCREEN 0.
      o_texto-&gt;destroy( ).
      CLEAR o_texto.
  ENDCASE.

ENDMODULE.                 &quot; USER_COMMAND_0100  INPUT

*&amp;---------------------------------------------------------------------*
*&amp;      Module  validar_campos_obligatorios  INPUT
*&amp;---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE validar_campos_obligatorios INPUT.

  CHECK sy-ucomm = &apos;GRABAR&apos;.
  IF zctrljobs_param-tipocontrol IS INITIAL OR
     zctrljobs_param-jobname IS INITIAL OR
     zctrljobs_param-casoaviso IS INITIAL.
    MESSAGE e398(00) WITH &apos;Informe campos obligatorios&apos;.
  ENDIF.

ENDMODULE.                 &quot; validar_campos_obligatorios  INPUT





************************** GENERADO TC ****************************

*&amp;SPWIZARD: OUTPUT MODULE FOR TC &apos;TCU&apos;. DO NOT CHANGE THIS LINE!
*&amp;SPWIZARD: UPDATE LINES FOR EQUIVALENT SCROLLBAR
MODULE tcu_change_tc_attr OUTPUT.
  DESCRIBE TABLE i_zebc20 LINES tcu-lines.
ENDMODULE.                    &quot;TCU_CHANGE_TC_ATTR OUTPUT

*&amp;SPWIZARD: OUTPUT MODULE FOR TC &apos;TCU&apos;. DO NOT CHANGE THIS LINE!
*&amp;SPWIZARD: GET LINES OF TABLECONTROL
MODULE tcu_get_lines OUTPUT.
  g_tcu_lines = sy-loopc.

  LOOP AT SCREEN.
    IF v_hreditor_visualizar = &apos;X&apos;.
      IF screen-name = &apos;ZEBC20-USUARIO&apos; OR
         screen-name = &apos;ZEBC20-EMAIL&apos;.
        screen-input = 0.
      ENDIF.
    ELSE.
      IF screen-name = &apos;ZEBC20-USUARIO&apos; OR
         screen-name = &apos;ZEBC20-EMAIL&apos;.
        screen-input = 1.
      ENDIF.
    ENDIF.
    MODIFY SCREEN.
  ENDLOOP.

ENDMODULE.                    &quot;TCU_GET_LINES OUTPUT

*&amp;SPWIZARD: INPUT MODULE FOR TC &apos;TCU&apos;. DO NOT CHANGE THIS LINE!
*&amp;SPWIZARD: MODIFY TABLE
MODULE tcu_modify INPUT.
  MODIFY i_zebc20
    FROM zebc20
    INDEX tcu-current_line.
ENDMODULE.                    &quot;TCU_MODIFY INPUT

*&amp;SPWIZARD: INPUT MODUL FOR TC &apos;TCU&apos;. DO NOT CHANGE THIS LINE!
*&amp;SPWIZARD: MARK TABLE
MODULE tcu_mark INPUT.
  DATA: g_tcu_wa2 LIKE LINE OF i_zebc20.
  IF tcu-line_sel_mode = 1
  AND zebc20-marca = &apos;X&apos;.
    LOOP AT i_zebc20 INTO g_tcu_wa2
      WHERE marca = &apos;X&apos;.
      g_tcu_wa2-marca = &apos;&apos;.
      MODIFY i_zebc20
        FROM g_tcu_wa2
        TRANSPORTING marca.
    ENDLOOP.
  ENDIF.
  MODIFY i_zebc20
    FROM zebc20
    INDEX tcu-current_line
    TRANSPORTING marca.
ENDMODULE.                    &quot;TCU_MARK INPUT

*&amp;SPWIZARD: INPUT MODULE FOR TC &apos;TCU&apos;. DO NOT CHANGE THIS LINE!
*&amp;SPWIZARD: PROCESS USER COMMAND
MODULE tcu_user_command INPUT.
  ok_code = sy-ucomm.
  PERFORM user_ok_tc USING    &apos;TCU&apos;
                              &apos;I_ZEBC20&apos;
                              &apos;MARCA&apos;
                     CHANGING ok_code.
  sy-ucomm = ok_code.
ENDMODULE.                    &quot;TCU_USER_COMMAND INPUT

*----------------------------------------------------------------------*
*   INCLUDE TABLECONTROL_FORMS                                         *
*----------------------------------------------------------------------*

*&amp;---------------------------------------------------------------------*
*&amp;      Form  USER_OK_TC                                               *
*&amp;---------------------------------------------------------------------*
FORM user_ok_tc USING    p_tc_name TYPE dynfnam
                         p_table_name
                         p_mark_name
                CHANGING p_ok      LIKE sy-ucomm.

*&amp;SPWIZARD: BEGIN OF LOCAL DATA----------------------------------------*
  DATA: l_ok     TYPE sy-ucomm,
        l_offset TYPE i.
*&amp;SPWIZARD: END OF LOCAL DATA------------------------------------------*

*&amp;SPWIZARD: Table control specific operations                          *
*&amp;SPWIZARD: evaluate TC name and operations                            *
  SEARCH p_ok FOR p_tc_name.
  IF sy-subrc &lt;&gt; 0.
    EXIT.
  ENDIF.
  l_offset = strlen( p_tc_name ) + 1.
  l_ok = p_ok+l_offset.
*&amp;SPWIZARD: execute general and TC specific operations                 *
  CASE l_ok.
    WHEN &apos;INSR&apos;.                      &quot;insert row
      PERFORM fcode_insert_row USING    p_tc_name
                                        p_table_name.
      CLEAR p_ok.

    WHEN &apos;DELE&apos;.                      &quot;delete row
      PERFORM fcode_delete_row USING    p_tc_name
                                        p_table_name
                                        p_mark_name.
      CLEAR p_ok.

    WHEN &apos;P--&apos; OR                     &quot;top of list
         &apos;P-&apos;  OR                     &quot;previous page
         &apos;P+&apos;  OR                     &quot;next page
         &apos;P++&apos;.                       &quot;bottom of list
      PERFORM compute_scrolling_in_tc USING p_tc_name
                                            l_ok.
      CLEAR p_ok.
*     WHEN &apos;L--&apos;.                       &quot;total left
*       PERFORM FCODE_TOTAL_LEFT USING P_TC_NAME.
*
*     WHEN &apos;L-&apos;.                        &quot;column left
*       PERFORM FCODE_COLUMN_LEFT USING P_TC_NAME.
*
*     WHEN &apos;R+&apos;.                        &quot;column right
*       PERFORM FCODE_COLUMN_RIGHT USING P_TC_NAME.
*
*     WHEN &apos;R++&apos;.                       &quot;total right
*       PERFORM FCODE_TOTAL_RIGHT USING P_TC_NAME.
*
    WHEN &apos;MARK&apos;.                      &quot;mark all filled lines
      PERFORM fcode_tc_mark_lines USING p_tc_name
                                        p_table_name
                                        p_mark_name   .
      CLEAR p_ok.

    WHEN &apos;DMRK&apos;.                      &quot;demark all filled lines
      PERFORM fcode_tc_demark_lines USING p_tc_name
                                          p_table_name
                                          p_mark_name .
      CLEAR p_ok.

*     WHEN &apos;SASCEND&apos;   OR
*          &apos;SDESCEND&apos;.                  &quot;sort column
*       PERFORM FCODE_SORT_TC USING P_TC_NAME
*                                   l_ok.

  ENDCASE.

ENDFORM.                              &quot; USER_OK_TC

*&amp;---------------------------------------------------------------------*
*&amp;      Form  FCODE_INSERT_ROW                                         *
*&amp;---------------------------------------------------------------------*
FORM fcode_insert_row
              USING    p_tc_name           TYPE dynfnam
                       p_table_name             .

*&amp;SPWIZARD: BEGIN OF LOCAL DATA----------------------------------------*
  DATA l_lines_name       LIKE feld-name.
  DATA l_selline          LIKE sy-stepl.
  DATA l_lastline         TYPE i.
  DATA l_line             TYPE i.
  DATA l_table_name       LIKE feld-name.
  FIELD-SYMBOLS &lt;tc&gt;                 TYPE cxtab_control.
  FIELD-SYMBOLS &lt;table&gt;              TYPE STANDARD TABLE.
  FIELD-SYMBOLS &lt;lines&gt;              TYPE i.
*&amp;SPWIZARD: END OF LOCAL DATA------------------------------------------*

  ASSIGN (p_tc_name) TO &lt;tc&gt;.

*&amp;SPWIZARD: get the table, which belongs to the tc                     *
  CONCATENATE p_table_name &apos;[]&apos; INTO l_table_name. &quot;table body
  ASSIGN (l_table_name) TO &lt;table&gt;.                &quot;not headerline

*&amp;SPWIZARD: get looplines of TableControl                              *
  CONCATENATE &apos;G_&apos; p_tc_name &apos;_LINES&apos; INTO l_lines_name.
  ASSIGN (l_lines_name) TO &lt;lines&gt;.

*&amp;SPWIZARD: get current line                                           *
  GET CURSOR LINE l_selline.
  IF sy-subrc &lt;&gt; 0.                   &quot; append line to table
    l_selline = &lt;tc&gt;-lines + 1.
*&amp;SPWIZARD: set top line                                               *
    IF l_selline &gt; &lt;lines&gt;.
      &lt;tc&gt;-top_line = l_selline - &lt;lines&gt; + 1 .
    ELSE.
      &lt;tc&gt;-top_line = 1.
    ENDIF.
  ELSE.                               &quot; insert line into table
    l_selline = &lt;tc&gt;-top_line + l_selline - 1.
    l_lastline = &lt;tc&gt;-top_line + &lt;lines&gt; - 1.
  ENDIF.
*&amp;SPWIZARD: set new cursor line                                        *
  l_line = l_selline - &lt;tc&gt;-top_line + 1.

*&amp;SPWIZARD: insert initial line                                        *
  INSERT INITIAL LINE INTO &lt;table&gt; INDEX l_selline.
  &lt;tc&gt;-lines = &lt;tc&gt;-lines + 1.
*&amp;SPWIZARD: set cursor                                                 *
  SET CURSOR LINE l_line.

ENDFORM.                              &quot; FCODE_INSERT_ROW

*&amp;---------------------------------------------------------------------*
*&amp;      Form  FCODE_DELETE_ROW                                         *
*&amp;---------------------------------------------------------------------*
FORM fcode_delete_row
              USING    p_tc_name           TYPE dynfnam
                       p_table_name
                       p_mark_name   .

*&amp;SPWIZARD: BEGIN OF LOCAL DATA----------------------------------------*
  DATA l_table_name       LIKE feld-name.

  FIELD-SYMBOLS &lt;tc&gt;         TYPE cxtab_control.
  FIELD-SYMBOLS &lt;table&gt;      TYPE STANDARD TABLE.
  FIELD-SYMBOLS &lt;wa&gt;.
  FIELD-SYMBOLS &lt;mark_field&gt;.
*&amp;SPWIZARD: END OF LOCAL DATA------------------------------------------*

  ASSIGN (p_tc_name) TO &lt;tc&gt;.

*&amp;SPWIZARD: get the table, which belongs to the tc                     *
  CONCATENATE p_table_name &apos;[]&apos; INTO l_table_name. &quot;table body
  ASSIGN (l_table_name) TO &lt;table&gt;.                &quot;not headerline

*&amp;SPWIZARD: delete marked lines                                        *
  DESCRIBE TABLE &lt;table&gt; LINES &lt;tc&gt;-lines.

  LOOP AT &lt;table&gt; ASSIGNING &lt;wa&gt;.

*&amp;SPWIZARD: access to the component &apos;FLAG&apos; of the table header         *
    ASSIGN COMPONENT p_mark_name OF STRUCTURE &lt;wa&gt; TO &lt;mark_field&gt;.

    IF &lt;mark_field&gt; = &apos;X&apos;.
      DELETE &lt;table&gt; INDEX syst-tabix.
      IF sy-subrc = 0.
        &lt;tc&gt;-lines = &lt;tc&gt;-lines - 1.
      ENDIF.
    ENDIF.
  ENDLOOP.

ENDFORM.                              &quot; FCODE_DELETE_ROW

*&amp;---------------------------------------------------------------------*
*&amp;      Form  COMPUTE_SCROLLING_IN_TC
*&amp;---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      --&gt;P_TC_NAME  name of tablecontrol
*      --&gt;P_OK       ok code
*----------------------------------------------------------------------*
FORM compute_scrolling_in_tc USING    p_tc_name
                                      p_ok.
*&amp;SPWIZARD: BEGIN OF LOCAL DATA----------------------------------------*
  DATA l_tc_new_top_line     TYPE i.
  DATA l_tc_name             LIKE feld-name.
  DATA l_tc_lines_name       LIKE feld-name.
  DATA l_tc_field_name       LIKE feld-name.

  FIELD-SYMBOLS &lt;tc&gt;         TYPE cxtab_control.
  FIELD-SYMBOLS &lt;lines&gt;      TYPE i.
*&amp;SPWIZARD: END OF LOCAL DATA------------------------------------------*

  ASSIGN (p_tc_name) TO &lt;tc&gt;.
*&amp;SPWIZARD: get looplines of TableControl                              *
  CONCATENATE &apos;G_&apos; p_tc_name &apos;_LINES&apos; INTO l_tc_lines_name.
  ASSIGN (l_tc_lines_name) TO &lt;lines&gt;.


*&amp;SPWIZARD: is no line filled?                                         *
  IF &lt;tc&gt;-lines = 0.
*&amp;SPWIZARD: yes, ...                                                   *
    l_tc_new_top_line = 1.
  ELSE.
*&amp;SPWIZARD: no, ...                                                    *
    CALL FUNCTION &apos;SCROLLING_IN_TABLE&apos;
      EXPORTING
        entry_act      = &lt;tc&gt;-top_line
        entry_from     = 1
        entry_to       = &lt;tc&gt;-lines
        last_page_full = &apos;X&apos;
        loops          = &lt;lines&gt;
        ok_code        = p_ok
        overlapping    = &apos;X&apos;
      IMPORTING
        entry_new      = l_tc_new_top_line
      EXCEPTIONS
*       NO_ENTRY_OR_PAGE_ACT  = 01
*       NO_ENTRY_TO    = 02
*       NO_OK_CODE_OR_PAGE_GO = 03
        OTHERS         = 0.
  ENDIF.

*&amp;SPWIZARD: get actual tc and column                                   *
  GET CURSOR FIELD l_tc_field_name
             AREA  l_tc_name.

  IF syst-subrc = 0.
    IF l_tc_name = p_tc_name.
*&amp;SPWIZARD: et actual column                                           *
      SET CURSOR FIELD l_tc_field_name LINE 1.
    ENDIF.
  ENDIF.

*&amp;SPWIZARD: set the new top line                                       *
  &lt;tc&gt;-top_line = l_tc_new_top_line.


ENDFORM.                              &quot; COMPUTE_SCROLLING_IN_TC

*&amp;---------------------------------------------------------------------*
*&amp;      Form  FCODE_TC_MARK_LINES
*&amp;---------------------------------------------------------------------*
*       marks all TableControl lines
*----------------------------------------------------------------------*
*      --&gt;P_TC_NAME  name of tablecontrol
*----------------------------------------------------------------------*
FORM fcode_tc_mark_lines USING p_tc_name
                               p_table_name
                               p_mark_name.
*&amp;SPWIZARD: EGIN OF LOCAL DATA-----------------------------------------*
  DATA l_table_name       LIKE feld-name.

  FIELD-SYMBOLS &lt;tc&gt;         TYPE cxtab_control.
  FIELD-SYMBOLS &lt;table&gt;      TYPE STANDARD TABLE.
  FIELD-SYMBOLS &lt;wa&gt;.
  FIELD-SYMBOLS &lt;mark_field&gt;.
*&amp;SPWIZARD: END OF LOCAL DATA------------------------------------------*

  ASSIGN (p_tc_name) TO &lt;tc&gt;.

*&amp;SPWIZARD: get the table, which belongs to the tc                     *
  CONCATENATE p_table_name &apos;[]&apos; INTO l_table_name. &quot;table body
  ASSIGN (l_table_name) TO &lt;table&gt;.                &quot;not headerline

*&amp;SPWIZARD: mark all filled lines                                      *
  LOOP AT &lt;table&gt; ASSIGNING &lt;wa&gt;.

*&amp;SPWIZARD: access to the component &apos;FLAG&apos; of the table header         *
    ASSIGN COMPONENT p_mark_name OF STRUCTURE &lt;wa&gt; TO &lt;mark_field&gt;.

    &lt;mark_field&gt; = &apos;X&apos;.
  ENDLOOP.
ENDFORM.                                          &quot;fcode_tc_mark_lines

*&amp;---------------------------------------------------------------------*
*&amp;      Form  FCODE_TC_DEMARK_LINES
*&amp;---------------------------------------------------------------------*
*       demarks all TableControl lines
*----------------------------------------------------------------------*
*      --&gt;P_TC_NAME  name of tablecontrol
*----------------------------------------------------------------------*
FORM fcode_tc_demark_lines USING p_tc_name
                                 p_table_name
                                 p_mark_name .
*&amp;SPWIZARD: BEGIN OF LOCAL DATA----------------------------------------*
  DATA l_table_name       LIKE feld-name.

  FIELD-SYMBOLS &lt;tc&gt;         TYPE cxtab_control.
  FIELD-SYMBOLS &lt;table&gt;      TYPE STANDARD TABLE.
  FIELD-SYMBOLS &lt;wa&gt;.
  FIELD-SYMBOLS &lt;mark_field&gt;.
*&amp;SPWIZARD: END OF LOCAL DATA------------------------------------------*

  ASSIGN (p_tc_name) TO &lt;tc&gt;.

*&amp;SPWIZARD: get the table, which belongs to the tc                     *
  CONCATENATE p_table_name &apos;[]&apos; INTO l_table_name. &quot;table body
  ASSIGN (l_table_name) TO &lt;table&gt;.                &quot;not headerline

*&amp;SPWIZARD: demark all filled lines                                    *
  LOOP AT &lt;table&gt; ASSIGNING &lt;wa&gt;.

*&amp;SPWIZARD: access to the component &apos;FLAG&apos; of the table header         *
    ASSIGN COMPONENT p_mark_name OF STRUCTURE &lt;wa&gt; TO &lt;mark_field&gt;.

    &lt;mark_field&gt; = space.
  ENDLOOP.
ENDFORM.                                          &quot;fcode_tc_mark_lines</source>
</PROG>
