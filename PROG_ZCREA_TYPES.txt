REPORT zcrea_types.

START-OF-SELECTION.
  TYPES t_linea(1000).
  DATA: i_tabla TYPE TABLE OF t_linea,
        l_linea TYPE t_linea,
        long    TYPE i.

  DATA: BEGIN OF itab OCCURS 0,
          inicio(10),
          fin(10),
          long(10),
          estado(1),
          tipo(10),
          descripcion(40),
          valor(40),
        END OF itab.


  CALL METHOD cl_gui_frontend_services=>clipboard_import
    IMPORTING
      data                 = i_tabla
*     length               =
    EXCEPTIONS
      cntl_error           = 1
      error_no_gui         = 2
      not_supported_by_gui = 3
      OTHERS               = 4.

  LOOP AT i_tabla INTO l_linea.

    CALL FUNCTION 'SCP_REPLACE_STRANGE_CHARS'
      EXPORTING
        intext            = l_linea
        replacement       = 64
      IMPORTING
        outtext           = l_linea
      EXCEPTIONS
        invalid_codepage  = 1
        codepage_mismatch = 2
        internal_error    = 3
        cannot_convert    = 4
        fields_not_type_c = 5
        OTHERS            = 6.

    SPLIT l_linea AT '@' INTO itab-inicio itab-fin itab-long itab-estado itab-tipo itab-descripcion itab-valor.
    APPEND itab.
  ENDLOOP.

  DATA string TYPE string.
  LOOP AT itab WHERE descripcion NE ''.
    l_linea = itab-descripcion.
    long = strlen( itab-descripcion ).
    REPLACE ALL OCCURRENCES OF ` ` IN l_linea(long) WITH '_'.
    REPLACE ALL OCCURRENCES OF '(' IN l_linea(long) WITH ``.
    REPLACE ALL OCCURRENCES OF ')' IN l_linea(long) WITH ``.
    REPLACE ALL OCCURRENCES OF '.' IN l_linea(long) WITH ``.
    CONCATENATE l_linea '(' itab-long ')' INTO string.
    CONDENSE string NO-GAPS.
    IF itab-tipo = 'Alfa'.
      CONCATENATE string 'type c, "' INTO string SEPARATED BY space.
    ELSEIF itab-tipo = 'Num'.
      CONCATENATE string 'type n, "' INTO string SEPARATED BY space.
    ENDIF.

    IF NOT itab-valor IS INITIAL.
      replace all OCCURRENCES OF '@' in itab-valor with ``.
      CONCATENATE string 'Valor=' itab-valor INTO string SEPARATED BY space.
    ENDIF.

    IF itab-estado = 'O'.
      CONCATENATE string 'Opcional' INTO string SEPARATED BY space.
    ENDIF.

    WRITE / string.
  ENDLOOP.
