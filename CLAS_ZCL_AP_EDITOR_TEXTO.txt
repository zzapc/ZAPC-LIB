class ZCL_AP_EDITOR_TEXTO definition
  public
  create public .

public section.

  methods CONSTRUCTOR
    importing
      !I_TEXTO type RMXTTY_OTPT_TRSI_LTX_LINES optional
      !COLUMNAS type I default 72
      !REPID type SY-REPID default SY-REPID
      !DISPLAY_MODE type C default '' .
  type-pools ABAP .
  methods SET_EDITOR
    importing
      !CONTROL type SCRFNAME
      !DYNNR type DYNNR default SY-DYNNR
      !REFRESCAR type ABAP_BOOL default ''
      !P_DISPLAY_MODE type C optional
      !SHOW_TOOL type ABAP_BOOL default ''
    preferred parameter CONTROL .
  methods SET_TEXTO
    importing
      !I_TEXTO type RMXTTY_OTPT_TRSI_LTX_LINES optional
      !STRING type STRING optional
      !FORZAR_ENTER type ABAP_BOOL default '' .
  methods GET_TEXTO
    returning
      value(I_TEXTO) type RMXTTY_OTPT_TRSI_LTX_LINES .
  methods FREE_EDITOR .
  methods GET_STRING
    returning
      value(STRING) type STRING .
protected section.
private section.

  data I_TEXTO type RMXTTY_OTPT_TRSI_LTX_LINES .
  data LINEA type RMXTS_OTPT_TRSI_LTX_LINES .
  data COLUMNAS type I .
  data CONTROLNAME type SCRFNAME .
  data REPID type SY-REPID value SY-REPID .
  data DISPLAY_MODE type C .
  type-pools ABAP .
  data EDITOR_CREADO type ABAP_BOOL .
endclass. "ZCL_AP_EDITOR_TEXTO definition
class ZCL_AP_EDITOR_TEXTO implementation.
method CONSTRUCTOR.

  me->i_texto = i_texto.
  me->columnas = columnas.
  me->repid = repid.
  me->display_mode = display_mode.

  clear EDITOR_CREADO.

endmethod.
method FREE_EDITOR.

  CALL FUNCTION 'RH_EDITOR_DESTROY'
    EXPORTING
      controlname = controlname.

endmethod.
method GET_STRING.

  i_texto = get_texto( ).
  string = zcl_ap_string=>tabla2string( i_texto ).

endmethod.
method GET_TEXTO.

  CALL FUNCTION 'RH_EDITOR_GET'
    EXPORTING
      controlname    = controlname
    TABLES
      lines          = i_texto
    EXCEPTIONS
      internal_error = 1
      OTHERS         = 2.

endmethod.
method SET_EDITOR.

  IF p_display_mode IS SUPPLIED.
    display_mode = p_display_mode.
  ENDIF.
  IF editor_creado IS INITIAL OR refrescar = 'X' OR
     p_display_mode IS SUPPLIED.
    editor_creado = 'X'.
    me->controlname = control.
    CALL FUNCTION 'RH_EDITOR_SET'
      EXPORTING
        repid          = repid
        dynnr          = dynnr
        controlname    = control
        max_cols       = columnas
        show_tool      = show_tool
        show_status    = ' '
        display_mode   = display_mode
      TABLES
        lines          = i_texto
      EXCEPTIONS
        create_error   = 1
        internal_error = 2
        OTHERS         = 3.
  ENDIF.
endmethod.
METHOD set_texto.

  CLEAR me->i_texto.
  IF NOT i_texto IS INITIAL.
    me->i_texto = i_texto.
  ELSEIF NOT string IS INITIAL.
    zcl_ap_string=>string2tabla( EXPORTING string   = string
                                           longitud = columnas
                                           forzar_enter = forzar_enter
                                 CHANGING  tabla    = me->i_texto ).
  ENDIF.

ENDMETHOD.