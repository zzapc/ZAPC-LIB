<?xml version="1.0" encoding="utf-8"?>
<PROG NAME="ZAP_DEV_INFO" VARCL="X" SUBC="1" APPL="M" RMAND="200" RLOAD="S" FIXPT="X" UCCHECK="X">
 <textPool>
  <language SPRAS="S">
   <textElement ID="R" ENTRY="Gestión de desarrollos" LENGTH="22 "/>
   <textElement ID="S" KEY="P_BADIS" ENTRY="        BADIs" LENGTH="13 "/>
   <textElement ID="S" KEY="P_BSP" ENTRY="        BSPs" LENGTH="12 "/>
   <textElement ID="S" KEY="P_BTE" ENTRY="        BTEs" LENGTH="12 "/>
   <textElement ID="S" KEY="P_CLASES" ENTRY="        Clases" LENGTH="14 "/>
   <textElement ID="S" KEY="P_DIRLIB" ENTRY="        Directorio librería" LENGTH="27 "/>
   <textElement ID="S" KEY="P_ENHAN" ENTRY="        Enhancements" LENGTH="20 "/>
   <textElement ID="S" KEY="P_FORMUL" ENTRY="        Formularios" LENGTH="19 "/>
   <textElement ID="S" KEY="P_FTP" ENTRY="        FTP" LENGTH="11 "/>
   <textElement ID="S" KEY="P_FUNCIO" ENTRY="        Funciones" LENGTH="17 "/>
   <textElement ID="S" KEY="P_LIB" ENTRY="        Modo librería" LENGTH="21 "/>
   <textElement ID="S" KEY="P_LIBT" ENTRY="        Transacción librería" LENGTH="28 "/>
   <textElement ID="S" KEY="P_MIME" ENTRY="        MIME" LENGTH="12 "/>
   <textElement ID="S" KEY="P_MODIFE" ENTRY="        Modificaciones al estándar" LENGTH="34 "/>
   <textElement ID="S" KEY="P_NUMLIN" ENTRY="        Mostrar nº de líneas" LENGTH="28 "/>
   <textElement ID="S" KEY="P_ORIGEN" ENTRY="        Origen" LENGTH="14 "/>
   <textElement ID="S" KEY="P_OUTLO" ENTRY="        Enviar por Outlook" LENGTH="26 "/>
   <textElement ID="S" KEY="P_PDF" ENTRY="        PDF Forms" LENGTH="17 "/>
   <textElement ID="S" KEY="P_PROYEC" ENTRY="        Proyectos de modificación" LENGTH="33 "/>
   <textElement ID="S" KEY="P_REPORT" ENTRY="        Reports" LENGTH="15 "/>
   <textElement ID="S" KEY="P_RUTINA" ENTRY="        Rutinas VOFM" LENGTH="20 "/>
   <textElement ID="S" KEY="P_SOLOM" ENTRY="        Sólo modificaciones lib." LENGTH="32 "/>
   <textElement ID="S" KEY="P_TABLAS" ENTRY="        Tablas" LENGTH="14 "/>
   <textElement ID="S" KEY="P_USEREX" ENTRY="        Userexits ventas" LENGTH="24 "/>
   <textElement ID="S" KEY="P_UTILI" ENTRY="        Mostrar utilización" LENGTH="27 "/>
   <textElement ID="S" KEY="P_VIVAS" ENTRY="        Tareas vivas" LENGTH="20 "/>
   <textElement ID="S" KEY="P_WEBD" ENTRY="        Web Dynpros" LENGTH="19 "/>
   <textElement ID="S" KEY="P_WF" ENTRY="        Workflows" LENGTH="17 "/>
   <textElement ID="S" KEY="P_XSLT" ENTRY="        XSLT" LENGTH="12 "/>
   <textElement ID="S" KEY="P_ZIP" ENTRY="        Comprimir con ZIP" LENGTH="25 "/>
   <textElement ID="S" KEY="S_ASIGN" ENTRY="D       ." LENGTH="18 "/>
   <textElement ID="S" KEY="S_CDAT" ENTRY="D       ." LENGTH="22 "/>
   <textElement ID="S" KEY="S_CNAM" ENTRY="D       ." LENGTH="18 "/>
   <textElement ID="S" KEY="S_DEVCLA" ENTRY="D       ." LENGTH="15 "/>
   <textElement ID="S" KEY="S_ESTADO" ENTRY="D       ." LENGTH="26 "/>
   <textElement ID="S" KEY="S_GRUPO" ENTRY="D       ." LENGTH="13 "/>
   <textElement ID="S" KEY="S_PRIOR" ENTRY="D       ." LENGTH="17 "/>
   <textElement ID="S" KEY="S_PROGR" ENTRY="D       ." LENGTH="15 "/>
   <textElement ID="S" KEY="S_REPORT" ENTRY="D       ." LENGTH="16 "/>
   <textElement ID="S" KEY="S_SUBC" ENTRY="D       ." LENGTH="24 "/>
   <textElement ID="S" KEY="S_TCODE" ENTRY="D       ." LENGTH="26 "/>
   <textElement ID="S" KEY="S_UDAT" ENTRY="D       ." LENGTH="26 "/>
   <textElement ID="S" KEY="S_UNAM" ENTRY="D       ." LENGTH="22 "/>
  </language>
 </textPool>
 <dynpros>
  <dynpro PROG="ZAP_DEV_INFO" DNUM="0100" FNUM="0100" BZMX="0 " BZBR="0 " MILI="192 " MICO="37 " MALI="0 " MACO="0 " NOLI="200 " NOCO="255 " VALP="0 " CUAN="G" SPRA="E" DTEXT="Pantalla">
   <dynprofield FNAM="GRID" DIDX="00C8" FLG1="00" FLG2="30" FLG3="00" FILL="U" FMB1="30" FMB2="00" LENG="FF" LINE="01" COLN="02" LANF="00" LBLK="00" LREP="00" AUTH="101" AGLT="01" ADEZ="01"/>
   <dynprofield DIDX="0000" FLG1="80" FLG2="10" FLG3="00" FMB1="00" FMB2="00" LENG="14" LINE="FF" COLN="01" LTYP="O" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AGLT="00" ADEZ="00" STXT="____________________"/>
   <dynproflowsource>PROCESS BEFORE OUTPUT.
 MODULE STATUS_0100.
*
PROCESS AFTER INPUT.
  MODULE USER_COMMAND_0100.</dynproflowsource>
  </dynpro>
 </dynpros>
 <pfstatus>
  <pfstatus_sta CODE="STANDARD" MODAL="D" ACTCODE="000001" PFKCODE="000001" BUTCODE="0001" INT_NOTE="Standard für allgemeine Listausgabe"/>
  <pfstatus_fun CODE="%ML" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Juego de datos" PATH="A"/>
  <pfstatus_fun CODE="%PC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_EXPORT" ICON_ID="@49@" FUN_TEXT="Fichero local..." PATH="F"/>
  <pfstatus_fun CODE="%SC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SEARCH" ICON_ID="@13@" FUN_TEXT="Buscar" PATH="U"/>
  <pfstatus_fun CODE="%SC+" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SEARCH_NEXT" ICON_ID="@4E@" FUN_TEXT="Continuar búsqueda"/>
  <pfstatus_fun CODE="%SL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_MAIL" ICON_ID="@1S@" FUN_TEXT="Destinatario de mail" PATH="M"/>
  <pfstatus_fun CODE="&amp;ABC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_ABC" ICON_ID="@DL@" FUN_TEXT="Análisis ABC" PATH="A"/>
  <pfstatus_fun CODE="&amp;ALL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SELECT_ALL" ICON_ID="@4B@" FUN_TEXT="Marcar todo" PATH="T"/>
  <pfstatus_fun CODE="&amp;AQW" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_WORD_PROCESSING" ICON_ID="@DK@" FUN_TEXT="Tratamiento de textos..." PATH="T"/>
  <pfstatus_fun CODE="&amp;AUF" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Especificar desglose..." PATH="E"/>
  <pfstatus_fun CODE="&amp;AVE" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Grabar..." PATH="G"/>
  <pfstatus_fun CODE="&amp;AVE" TEXTNO="002" TEXT_TYPE="S" TEXT_NAME="ICON_ALV_VARIANT_SAVE" ICON_ID="@DN@" FUN_TEXT="Grabar disposición..."/>
  <pfstatus_fun CODE="&amp;AVR" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Valor medio" PATH="M"/>
  <pfstatus_fun CODE="&amp;CDF" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Anular fijación" PATH="I"/>
  <pfstatus_fun CODE="&amp;CFI" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Fijar hasta columna" PATH="F"/>
  <pfstatus_fun CODE="&amp;CRB" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TOTAL_LEFT" ICON_ID="@0B@" FUN_TEXT="Primera columna"/>
  <pfstatus_fun CODE="&amp;CRDESIG" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Crystal Reports Designer" PATH="C"/>
  <pfstatus_fun CODE="&amp;CRE" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TOTAL_RIGHT" ICON_ID="@0C@" FUN_TEXT="Última columna"/>
  <pfstatus_fun CODE="&amp;CRL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLUMN_LEFT" ICON_ID="@0D@" FUN_TEXT="Columna izquierda"/>
  <pfstatus_fun CODE="&amp;CRR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLUMN_RIGHT" ICON_ID="@0E@" FUN_TEXT="Columna derecha"/>
  <pfstatus_fun CODE="&amp;CRTEMPL" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Fichero reports crystal" PATH="C"/>
  <pfstatus_fun CODE="&amp;DAU" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Separador automático" PATH="T"/>
  <pfstatus_fun CODE="&amp;DOF" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Separador siempre off" PATH="E"/>
  <pfstatus_fun CODE="&amp;DON" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Separador siempre on" PATH="R"/>
  <pfstatus_fun CODE="&amp;EB9" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TABLE_SETTINGS" ICON_ID="@36@" FUN_TEXT="Llamar informe..." PATH="L"/>
  <pfstatus_fun CODE="&amp;ELP" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SYSTEM_HELP" ICON_ID="@35@" FUN_TEXT="Ayuda"/>
  <pfstatus_fun CODE="&amp;ERW" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Gestionar la disposición" PATH="T"/>
  <pfstatus_fun CODE="&amp;ETA" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SELECT_DETAIL" ICON_ID="@16@" FUN_TEXT="Detalles"/>
  <pfstatus_fun CODE="&amp;F03" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Back" PATH="K"/>
  <pfstatus_fun CODE="&amp;F12" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_CANCEL" ICON_ID="@0W@" FUN_TEXT="Cancelar" PATH="N"/>
  <pfstatus_fun CODE="&amp;F15" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Finalizar" PATH="F"/>
  <pfstatus_fun CODE="&amp;IC1" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SELECT_DETAIL" ICON_ID="@16@" FUN_TEXT="Seleccionar"/>
  <pfstatus_fun CODE="&amp;ILD" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Borrar filtros" PATH="L"/>
  <pfstatus_fun CODE="&amp;ILT" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_FILTER" ICON_ID="@4G@" FUN_TEXT="Fijar filtros" PATH="F"/>
  <pfstatus_fun CODE="&amp;KOM" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLLAPSE" ICON_ID="@3T@" FUN_TEXT="Seleccionar..." PATH="A"/>
  <pfstatus_fun CODE="&amp;LFO" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Status listas..." PATH="L"/>
  <pfstatus_fun CODE="&amp;LFO" TEXTNO="002" TEXT_TYPE="S" TEXT_NAME="ICON_INFORMATION" ICON_ID="@0S@" FUN_TEXT="Status listas..."/>
  <pfstatus_fun CODE="&amp;LIS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Lista básica" PATH="I"/>
  <pfstatus_fun CODE="&amp;MAX" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Máximo" PATH="Á"/>
  <pfstatus_fun CODE="&amp;MIN" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Mínimo" PATH="I"/>
  <pfstatus_fun CODE="&amp;NFO" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_INFORMATION" ICON_ID="@0S@" FUN_TEXT="Selecciones..." ICON_TEXT="Selecciones" PATH="E"/>
  <pfstatus_fun CODE="&amp;NTE" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Refrescar"/>
  <pfstatus_fun CODE="&amp;OAD" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Seleccionar..." PATH="E"/>
  <pfstatus_fun CODE="&amp;OAD" TEXTNO="002" TEXT_TYPE="S" TEXT_NAME="ICON_ALV_VARIANT_CHOOSE" ICON_ID="@DM@" FUN_TEXT="Seleccionar disposición..."/>
  <pfstatus_fun CODE="&amp;ODN" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SORT_DOWN" ICON_ID="@3F@" FUN_TEXT="Clasificación descendente" PATH="C"/>
  <pfstatus_fun CODE="&amp;OL0" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_ALV_VARIANTS" ICON_ID="@LZ@" FUN_TEXT="Modificar disposición..."/>
  <pfstatus_fun CODE="&amp;OLX" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_VARIANTS" ICON_ID="@0R@" FUN_TEXT="Modificar..." PATH="M"/>
  <pfstatus_fun CODE="&amp;OMP" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLLAPSE" ICON_ID="@3T@" FUN_TEXT="Comprimir"/>
  <pfstatus_fun CODE="&amp;OPT" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Ancho óptimo" PATH="P"/>
  <pfstatus_fun CODE="&amp;OUP" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SORT_UP" ICON_ID="@3E@" FUN_TEXT="Clasificación ascendente" PATH="I"/>
  <pfstatus_fun CODE="&amp;RNT" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_PRINT" ICON_ID="@0X@" FUN_TEXT="Imprimir" PATH="I"/>
  <pfstatus_fun CODE="&amp;RNT_PREV" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_LAYOUT_CONTROL" ICON_ID="@3G@" FUN_TEXT="Presentación preliminar" PATH="R"/>
  <pfstatus_fun CODE="&amp;SAL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_DESELECT_ALL" ICON_ID="@4D@" FUN_TEXT="Desmarcar todo" PATH="D"/>
  <pfstatus_fun CODE="&amp;SUM" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_INTERMEDIATE_SUM" ICON_ID="@5V@" FUN_TEXT="Subtotales..." PATH="S"/>
  <pfstatus_fun CODE="&amp;UMC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SUM" ICON_ID="@3Z@" FUN_TEXT="Total" PATH="T"/>
  <pfstatus_fun CODE="&amp;XINT" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Archivo ampliado de query SAP" PATH="E"/>
  <pfstatus_fun CODE="&amp;XPA" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_EXPAND" ICON_ID="@3S@" FUN_TEXT="Desplegar"/>
  <pfstatus_fun CODE="&amp;XXL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_XXL" ICON_ID="@DJ@" FUN_TEXT="Hoja cálculo coste..." PATH="A"/>
  <pfstatus_fun CODE="BACK" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Back"/>
  <pfstatus_fun CODE="BORRAR" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Borrar objeto" PATH="B"/>
  <pfstatus_fun CODE="BOR_DUMPS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Borra dumps" PATH="O"/>
  <pfstatus_fun CODE="CAMBIACLAS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Cambia clase desarr." PATH="C"/>
  <pfstatus_fun CODE="CAMBIOCLAS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Cambia clase desarr." PATH="C"/>
  <pfstatus_fun CODE="COMPARAR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_RENAME" ICON_ID="@4F@" FUN_TEXT="Comparar" ICON_TEXT="Comparar" INFO_TEXT="Comparar objetos"/>
  <pfstatus_fun CODE="COPIAPROD" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Copia tablas prod." PATH="P"/>
  <pfstatus_fun CODE="CORREO" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_ADDRESS" ICON_ID="@0T@" FUN_TEXT="Correo" ICON_TEXT="Enviar mail" INFO_TEXT="Enviar código por correo"/>
  <pfstatus_fun CODE="DESCARGAR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_EXPORT" ICON_ID="@49@" FUN_TEXT="Descargar" ICON_TEXT="Descargar" INFO_TEXT="Descargar desarrollos"/>
  <pfstatus_fun CODE="ENTER" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Enter"/>
  <pfstatus_fun CODE="EXCEL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_XLS" ICON_ID="@J2@" FUN_TEXT="Excel"/>
  <pfstatus_fun CODE="EXEC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_EXECUTE_OBJECT" ICON_ID="@15@" FUN_TEXT="EXEC" ICON_TEXT="Borrar pedidos" INFO_TEXT="Marcar pedidos para borrado"/>
  <pfstatus_fun CODE="GRABAR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SYSTEM_SAVE" ICON_ID="@2L@" FUN_TEXT="Grabar"/>
  <pfstatus_fun CODE="LIN_72" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Control lin.&gt;72"/>
  <pfstatus_fun CODE="MACHACAR" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="SAP -&gt; Fichero" PATH="S"/>
  <pfstatus_fun CODE="NUEVAL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TE_ADVANCE_PAYMENT" ICON_ID="@93@" FUN_TEXT="Nueva línea" ICON_TEXT="Nueva línea" INFO_TEXT="Nueva línea"/>
  <pfstatus_fun CODE="P+" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Página siguiente"/>
  <pfstatus_fun CODE="P++" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Última página"/>
  <pfstatus_fun CODE="P-" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Página anterior"/>
  <pfstatus_fun CODE="P--" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Primera página"/>
  <pfstatus_fun CODE="REPO" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Actualizar repos." PATH="T"/>
  <pfstatus_fun CODE="SAPUI5" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="BSP SAPUI5"/>
  <pfstatus_fun CODE="SUBIR_LIB" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Fichero -&gt; SAP" PATH="A"/>
  <pfstatus_fun CODE="TADIR" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Corregir TADIR" PATH="R"/>
  <pfstatus_fun CODE="TCODE" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Transacción"/>
  <pfstatus_fun CODE="UPDATE" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Verif.Actualizac." PATH="V"/>
  <pfstatus_fun CODE="VERSIONES" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Grabar copia versión" PATH="G"/>
  <pfstatus_fun CODE="WORD" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_WORD_PROCESSING" ICON_ID="@DK@" FUN_TEXT="Documentacion" ICON_TEXT="Documentación" INFO_TEXT="Documentación"/>
  <pfstatus_fun CODE="ZTASKS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Exportar a ZTASKS" PATH="E"/>
  <pfstatus_men CODE="000001" NO="01" REF_TYPE="F" REF_CODE="&amp;RNT" REF_NO="001"/>
  <pfstatus_men CODE="000001" NO="02" REF_TYPE="M" REF_CODE="000002"/>
  <pfstatus_men CODE="000001" NO="03" REF_TYPE="M" REF_CODE="000003"/>
  <pfstatus_men CODE="000001" NO="04" REF_TYPE="S"/>
  <pfstatus_men CODE="000001" NO="05" REF_TYPE="F" REF_CODE="&amp;F15" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="01" REF_TYPE="F" REF_CODE="&amp;AQW" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="02" REF_TYPE="F" REF_CODE="&amp;XXL" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="03" REF_TYPE="F" REF_CODE="%PC" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="04" REF_TYPE="F" REF_CODE="&amp;XINT" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="05" REF_TYPE="F" REF_CODE="&amp;CRTEMPL" REF_NO="001"/>
  <pfstatus_men CODE="000003" NO="01" REF_TYPE="F" REF_CODE="%SL" REF_NO="001"/>
  <pfstatus_men CODE="000003" NO="02" REF_TYPE="F" REF_CODE="%ML" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="01" REF_TYPE="F" REF_CODE="&amp;ALL" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="02" REF_TYPE="F" REF_CODE="&amp;SAL" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="03" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="04" REF_TYPE="F" REF_CODE="&amp;ILT" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="05" REF_TYPE="F" REF_CODE="&amp;ILD" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="06" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="07" REF_TYPE="F" REF_CODE="&amp;OUP" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="08" REF_TYPE="F" REF_CODE="&amp;ODN" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="09" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="10" REF_TYPE="M" REF_CODE="000005"/>
  <pfstatus_men CODE="000004" NO="11" REF_TYPE="F" REF_CODE="&amp;SUM" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="12" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="13" REF_TYPE="F" REF_CODE="%SC" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="14" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="15" REF_TYPE="F" REF_CODE="&amp;F12" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="01" REF_TYPE="F" REF_CODE="&amp;UMC" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="02" REF_TYPE="F" REF_CODE="&amp;AVR" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="03" REF_TYPE="F" REF_CODE="&amp;MIN" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="04" REF_TYPE="F" REF_CODE="&amp;MAX" REF_NO="001"/>
  <pfstatus_men CODE="000006" NO="01" REF_TYPE="F" REF_CODE="&amp;ABC" REF_NO="001"/>
  <pfstatus_men CODE="000006" NO="02" REF_TYPE="S"/>
  <pfstatus_men CODE="000006" NO="03" REF_TYPE="F" REF_CODE="&amp;CRDESIG" REF_NO="001"/>
  <pfstatus_men CODE="000006" NO="04" REF_TYPE="S"/>
  <pfstatus_men CODE="000006" NO="05" REF_TYPE="F" REF_CODE="&amp;F03" REF_NO="001"/>
  <pfstatus_men CODE="000007" NO="01" REF_TYPE="F" REF_CODE="&amp;LIS" REF_NO="001"/>
  <pfstatus_men CODE="000007" NO="02" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="03" REF_TYPE="M" REF_CODE="000008"/>
  <pfstatus_men CODE="000007" NO="04" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="05" REF_TYPE="M" REF_CODE="000009"/>
  <pfstatus_men CODE="000007" NO="06" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="07" REF_TYPE="M" REF_CODE="000010"/>
  <pfstatus_men CODE="000007" NO="08" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="09" REF_TYPE="F" REF_CODE="&amp;NFO" REF_NO="001"/>
  <pfstatus_men CODE="000007" NO="10" REF_TYPE="F" REF_CODE="&amp;LFO" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="01" REF_TYPE="F" REF_CODE="&amp;OLX" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="02" REF_TYPE="F" REF_CODE="&amp;OAD" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="03" REF_TYPE="S"/>
  <pfstatus_men CODE="000008" NO="04" REF_TYPE="F" REF_CODE="&amp;AVE" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="05" REF_TYPE="S"/>
  <pfstatus_men CODE="000008" NO="06" REF_TYPE="F" REF_CODE="&amp;ERW" REF_NO="001"/>
  <pfstatus_men CODE="000009" NO="01" REF_TYPE="F" REF_CODE="&amp;KOM" REF_NO="001"/>
  <pfstatus_men CODE="000009" NO="02" REF_TYPE="F" REF_CODE="&amp;AUF" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="01" REF_TYPE="F" REF_CODE="&amp;OPT" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="02" REF_TYPE="S"/>
  <pfstatus_men CODE="000010" NO="03" REF_TYPE="F" REF_CODE="&amp;CFI" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="04" REF_TYPE="F" REF_CODE="&amp;CDF" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="05" REF_TYPE="S"/>
  <pfstatus_men CODE="000010" NO="06" REF_TYPE="F" REF_CODE="&amp;DAU" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="07" REF_TYPE="F" REF_CODE="&amp;DON" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="08" REF_TYPE="F" REF_CODE="&amp;DOF" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="01" REF_TYPE="F" REF_CODE="BORRAR" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="02" REF_TYPE="F" REF_CODE="CAMBIOCLAS" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="03" REF_TYPE="F" REF_CODE="BOR_DUMPS" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="04" REF_TYPE="F" REF_CODE="COPIAPROD" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="05" REF_TYPE="F" REF_CODE="SUBIR_LIB" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="06" REF_TYPE="F" REF_CODE="MACHACAR" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="07" REF_TYPE="F" REF_CODE="REPO" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="08" REF_TYPE="F" REF_CODE="VERSIONES" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="09" REF_TYPE="F" REF_CODE="UPDATE" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="10" REF_TYPE="F" REF_CODE="TADIR" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="11" REF_TYPE="F" REF_CODE="ZTASKS" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="12" REF_TYPE="F" REF_CODE="TCODE" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="13" REF_TYPE="F" REF_CODE="LIN_72" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="14" REF_TYPE="F" REF_CODE="SAPUI5" REF_NO="001"/>
  <pfstatus_mtx CODE="000001" TEXT_TYPE="S" TEXT="Lista" PATH="L" INT_NOTE="STANDARD Liste"/>
  <pfstatus_mtx CODE="000002" TEXT_TYPE="S" TEXT="Exportar" PATH="E" INT_NOTE="STANDARD Sichern"/>
  <pfstatus_mtx CODE="000003" TEXT_TYPE="S" TEXT="Enviar a" PATH="N"/>
  <pfstatus_mtx CODE="000004" TEXT_TYPE="S" TEXT="Tratar" PATH="T" INT_NOTE="STANDARD"/>
  <pfstatus_mtx CODE="000005" TEXT_TYPE="S" TEXT="Calcular" PATH="A"/>
  <pfstatus_mtx CODE="000006" TEXT_TYPE="S" TEXT="Pasar a" PATH="P" INT_NOTE="STANDARD"/>
  <pfstatus_mtx CODE="000007" TEXT_TYPE="S" TEXT="Opciones" PATH="O" INT_NOTE="STANDARD"/>
  <pfstatus_mtx CODE="000008" TEXT_TYPE="S" TEXT="Disposición" PATH="D" INT_NOTE="Sub STANDARD"/>
  <pfstatus_mtx CODE="000009" TEXT_TYPE="S" TEXT="Niveles de totalización" PATH="S" INT_NOTE="Sub STANDARD"/>
  <pfstatus_mtx CODE="000010" TEXT_TYPE="S" TEXT="Columnas" PATH="C"/>
  <pfstatus_mtx CODE="000011" TEXT_TYPE="S" TEXT="Utilidades" PATH="U"/>
  <pfstatus_act CODE="000001" NO="01" MENUCODE="000011"/>
  <pfstatus_act CODE="000001" NO="02" MENUCODE="000001"/>
  <pfstatus_act CODE="000001" NO="03" MENUCODE="000004"/>
  <pfstatus_act CODE="000001" NO="04" MENUCODE="000006"/>
  <pfstatus_act CODE="000001" NO="05" MENUCODE="000007"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="01" PFNO="16"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="02" PFNO="36"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="03" PFNO="17"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="04" PFNO="94"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="05" PFNO="20"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="06" PFNO="14"/>
  <pfstatus_pfk CODE="000001" PFNO="00" FUNCODE="ENTER" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="02" FUNCODE="&amp;IC1" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="03" FUNCODE="BACK" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="05" FUNCODE="&amp;ALL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="06" FUNCODE="&amp;SAL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="07" FUNCODE="&amp;NFO" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="08" FUNCODE="&amp;NTE" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="09" FUNCODE="EXEC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="11" FUNCODE="GRABAR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="14" FUNCODE="EXCEL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="16" FUNCODE="DESCARGAR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="17" FUNCODE="COMPARAR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="18" FUNCODE="&amp;CRB" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="19" FUNCODE="&amp;CRE" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="20" FUNCODE="NUEVAL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="21" FUNCODE="P--" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="22" FUNCODE="P-" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="23" FUNCODE="P+" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="24" FUNCODE="P++" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="25" FUNCODE="&amp;ABC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="26" FUNCODE="&amp;CRL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="27" FUNCODE="&amp;CRR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="28" FUNCODE="&amp;OUP" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="29" FUNCODE="&amp;ILT" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="30" FUNCODE="&amp;UMC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="31" FUNCODE="%SL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="32" FUNCODE="&amp;OL0" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="33" FUNCODE="&amp;OAD" FUNNO="002"/>
  <pfstatus_pfk CODE="000001" PFNO="34" FUNCODE="&amp;AVE" FUNNO="002"/>
  <pfstatus_pfk CODE="000001" PFNO="35" FUNCODE="&amp;XPA" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="36" FUNCODE="CORREO" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="37" FUNCODE="&amp;EB9" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="39" FUNCODE="&amp;ETA" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="40" FUNCODE="&amp;ODN" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="41" FUNCODE="&amp;LFO" FUNNO="002"/>
  <pfstatus_pfk CODE="000001" PFNO="42" FUNCODE="&amp;SUM" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="43" FUNCODE="&amp;XXL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="44" FUNCODE="&amp;AQW" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="45" FUNCODE="%PC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="46" FUNCODE="&amp;RNT_PREV" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="47" FUNCODE="&amp;OMP" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="94" FUNCODE="WORD" FUNNO="001"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%CH"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%ML"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%PC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%SC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%SC+"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%SL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ABC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ALL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AQW"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AUF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AVE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AVR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;BS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;BS+"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;BS-"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CDF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CFI"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRB"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;DAU"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;DOF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;DON"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;EB3"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;EB9"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ELP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ERW"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ETA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;F03"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;F12"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;F15"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;IC1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ILD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ILT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;KOM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;LFO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;LIS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;MAX"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;MIN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;NFO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;NTE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OAD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ODN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OL0"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OLX"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OMP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OPT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OUP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;RNT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;SAL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;SUM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;UMC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;XPA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;XXL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BAC1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BACK"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB2"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB3"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB9"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEBN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BORRAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BOR_DUMPS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="CAMBIACLAS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="CAMBIOCLAS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COL0"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COLX"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COMPARAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COPIAPROD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="CORREO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DESCARGAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DETA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DRUK"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DSAL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ENTE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ENTER"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="EXCEL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="EXEC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="EXIT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="EXPA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="FILD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="FILT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="GLIS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="GRABAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="HELP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="INFO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="KOMP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="LIN_72"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="MACHACAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="NUEVAL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P+"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P++"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P-"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P--"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PF09"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PF13"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PIC1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PICK"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PRI"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PRIN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PRNT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="REPO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="RW"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SALL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SAPUI5"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SAUF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SAVE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRB"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SKOM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SODN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SOUP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SUBIR_LIB"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SUMC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="TADIR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="TCODE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="UPDATE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="VERSIONES"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="WORD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ZSUM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ZTASKS"/>
  <pfstatus_doc OBJ_TYPE="A" OBJ_CODE="000001" MODAL="D" INT_NOTE="Standardoberfläche              STANDARD"/>
  <pfstatus_doc OBJ_TYPE="P" OBJ_CODE="000001" MODAL="D" NORM="X" INT_NOTE="Standard maximale Interaktion"/>
  <pfstatus_doc OBJ_TYPE="B" OBJ_CODE="000001" SUB_CODE="0001" MODAL="D" INT_NOTE="Standard maximale Interaktion"/>
  <pfstatus_tit CODE="100" TEXT="Desarrollo"/>
 </pfstatus>
 <source>************************************************************************
* APLICACION  : BC                                                    *
* TIPO        : Listado
* TITULO      : Listado seguimiento desarrollos
* DESCRIPCION :
* VERSION     : 0.70
*                                                                      *
*AUTOR: Andres Picazo                           FECHA: 28/02/2007      *
* MODIFICACIONES                                                       *
* -------------                                                        *
* FECHA        NOMBRE                               ORDEN              *
* -------------------------------------------------------------------- *
* dd.mm.yyyy   username                                                *
************************************************************************
REPORT zbcut011
      NO STANDARD PAGE HEADING
      LINE-COUNT 065
      LINE-SIZE 100.

* Trampo status
* inlclude LSMPIF03 linea 62 form check_adm tables
*if sy-uname = zcl_c=&gt;usuario_ap. exit. endif.

*------INCLUDES--------------------------------------------------------*

CONSTANTS: c_version TYPE p VALUE 20170919.

*------TABLAS/ESTRUCTURAS----------------------------------------------*
TABLES:
*  zestadisticas,
  seoclass,
  cross,
  trdir,
  tadir,
  ddtypes,
  tfdir,
  v_fdirt,
  stxh,
  zbc003,
  zbc003t,
  stxfadm,
  modtext,
  modact,
  modsap,
  tstcp,
  ttxfp,
  dd02l,
  smimloio,
  e071,
  rseuinc,
  dd40l,
  dd04l,
  dd01l,
  dd02t,
  o2xsltdesc,
  hrs1000,
  sscrfields,
  tstc.

DATA: i_listado         TYPE TABLE OF zest_zbc003 WITH HEADER LINE,
      i_list_orig       TYPE TABLE OF zest_zbc003 WITH HEADER LINE,
      i_list            TYPE TABLE OF zest_zbc003 WITH HEADER LINE,
      l_listado         TYPE zest_zbc003,
      enhincinx         TYPE enhincinx,
      fpcontext         TYPE fpcontext,
      fpinterface       TYPE fpinterface,
      v_ruta_comparador TYPE string.

DATA: i_source(255) OCCURS 0 WITH HEADER LINE.

DATA: BEGIN OF i_cambios OCCURS 0,
        name    TYPE trdir-name,
        vrsflag TYPE vxabapt255-vrsflag,
        number  TYPE vxabapt255-number,
        line    TYPE vxabapt255-line,
      END OF i_cambios,
      i_camb    TYPE TABLE OF vxabapt255,
      l_camb    TYPE vxabapt255,
      l_cambios LIKE i_cambios,
      i_grupof  TYPE TABLE OF string WITH HEADER LINE.

*------VARIABLES-------------------------------------------------------*
DATA: sgpi  TYPE REF TO zcl_ap_sgpi,
      o_alv TYPE REF TO zcl_ap_alv_grid,
      o_enh TYPE REF TO cl_enh_editor_navigator.

DATA: BEGIN OF i_ztasks OCCURS 0,
        cliente(3),
        objeto(30),
        descripcion_obj(80),
        texto               TYPE string,
      END OF i_ztasks.


DATA: v_directorio         TYPE string.
DATA: v_ans,
      v_emailaddr(130),
      v_no_se_adjunta_slnk,
      i_ficheros_ftp       TYPE TABLE OF string WITH HEADER LINE.

DATA o_bi      TYPE REF TO zcl_ap_batch_input.
DATA l_mensaje TYPE bapireturn1-message.                    &quot;#EC *

DATA o_prog TYPE REF TO zcl_ap_dev.

DEFINE addrango_eq.
  CLEAR &amp;1.
  &amp;1-option = &apos;EQ&apos;.
  &amp;1-sign = &apos;I&apos;.
  &amp;1-low = &amp;2.
  APPEND &amp;1.
END-OF-DEFINITION.


DEFINE addrango_neq.
  CLEAR &amp;1.
  &amp;1-option = &apos;EQ&apos;.
  &amp;1-sign = &apos;E&apos;.
  &amp;1-low = &amp;2.
  APPEND &amp;1.
END-OF-DEFINITION.

*----------------------------------------------------------------------*
* CLASS lcl_event_grid_100 DEFINITION
*----------------------------------------------------------------------*
*
*----------------------------------------------------------------------*
CLASS lcl_event_grid DEFINITION INHERITING FROM zcl_ap_alv_grid_eventos.
  PUBLIC SECTION.
    METHODS: double_click REDEFINITION,
      toolbar      REDEFINITION,
      user_command REDEFINITION.
ENDCLASS. &quot;lcl_event_grid_100 DEFINITION

DATA: o_event        TYPE REF TO lcl_event_grid,
      v_fechas_vivas TYPE d,
      i_ficheros     TYPE TABLE OF file_info WITH HEADER LINE.

*------PARAMETER/SELECT-OPTIONS EN PANTALLA----------------------------*
SELECTION-SCREEN BEGIN OF BLOCK blk_par WITH FRAME TITLE TEXT-001.

SELECT-OPTIONS: s_tcode  FOR tstc-tcode,
                s_report FOR trdir-name,
                s_subc   FOR trdir-subc,
                s_devcla FOR tadir-devclass,
                s_estado FOR zbc003-estado,
                s_grupo  FOR zbc003-grupo,
                s_cdat   FOR trdir-cdat,
                s_udat   FOR trdir-udat,
                s_cnam   FOR trdir-cnam,
                s_unam   FOR trdir-unam,
                s_asign  FOR zbc003-asignado_a,
                s_progr  FOR zbc003-probado_por,
                s_prior  FOR zbc003-prioridad.

SELECTION-SCREEN SKIP.

PARAMETERS: p_report AS CHECKBOX DEFAULT &apos;X&apos;,
            p_funcio AS CHECKBOX DEFAULT &apos; &apos;,
            p_clases AS CHECKBOX DEFAULT &apos; &apos;,
            p_formul AS CHECKBOX DEFAULT &apos; &apos;,
            p_proyec AS CHECKBOX DEFAULT &apos; &apos;,
            p_badis  AS CHECKBOX DEFAULT &apos; &apos;,
            p_userex AS CHECKBOX DEFAULT &apos; &apos;,
            p_modife AS CHECKBOX DEFAULT &apos; &apos;,
            p_rutina AS CHECKBOX DEFAULT &apos; &apos;,
            p_tablas AS CHECKBOX DEFAULT &apos; &apos;,
            p_enhan  AS CHECKBOX DEFAULT &apos; &apos;,
            p_bte    AS CHECKBOX DEFAULT &apos; &apos;,
            p_bsp    AS CHECKBOX DEFAULT &apos; &apos;,
            p_mime   AS CHECKBOX DEFAULT &apos; &apos;,
            p_webd   AS CHECKBOX DEFAULT &apos;&apos;,
            p_pdf    AS CHECKBOX DEFAULT &apos;&apos;,
            p_xslt   AS CHECKBOX DEFAULT &apos;&apos;,
            p_wf     AS CHECKBOX DEFAULT &apos;&apos;.

SELECTION-SCREEN END OF BLOCK blk_par.

SELECTION-SCREEN BEGIN OF BLOCK blk_par3 WITH FRAME TITLE TEXT-003.
PARAMETERS: p_lib    AS CHECKBOX,
            p_solom  AS CHECKBOX,
            p_utili  AS CHECKBOX,
            p_numlin AS CHECKBOX,
            p_zip    AS CHECKBOX,
            p_outlo  AS CHECKBOX,
            p_ftp    AS CHECKBOX,
            p_origen DEFAULT &apos;L&apos;,
            p_dirlib TYPE string,
            p_vivas  AS CHECKBOX,
            p_libt   AS CHECKBOX.
SELECTION-SCREEN END OF BLOCK blk_par3.


************************************************************************
*
*                  LOGICA DEL PROGRAMA
*
************************************************************************


*----------------------------------------------------------------------*
* INITIALIZATION
*----------------------------------------------------------------------*
INITIALIZATION.

  CREATE OBJECT o_prog
    EXPORTING
      get_nombre_pc = &apos;X&apos;.

  o_prog-&gt;initialization( EXPORTING nombre_pc = o_prog-&gt;nombre_pc CHANGING sscrfields = sscrfields ).

*  addrango_eq: s_subc &apos;1&apos;,
*               s_subc &apos;M&apos;,
*               s_subc &apos;S&apos;.


  addrango_neq: s_estado &apos;B&apos;,
                s_estado &apos;N&apos;,
                s_estado &apos;O&apos;.

  IF sy-uname = zcl_c=&gt;usuario_ap.
    SET PARAMETER ID &apos;SAPLINK_AUTHOR&apos; FIELD &apos;APICAZO&apos;.
  ENDIF.


AT SELECTION-SCREEN.

*----------------------------------------------------------------------
* START-OF-SELECTION.
*----------------------------------------------------------------------*
START-OF-SELECTION.

  IF p_vivas = &apos;X&apos;.
    p_report = &apos;X&apos;.
    p_funcio = &apos;X&apos;.
    p_clases = &apos;X&apos;.
    p_formul = &apos;X&apos;.
*    p_proyec = &apos;X&apos;.
*    p_badis  = &apos;X&apos;.
    p_tablas = &apos;X&apos;.
    p_pdf    = &apos;X&apos;.
*    p_xslt   = &apos;X&apos;.
    v_fechas_vivas = zcl_ap_temp=&gt;get_st_valor1( clave = sy-tcode subclave = sy-uname ).
    IF v_fechas_vivas IS INITIAL.
      v_fechas_vivas = sy-datum - 365.
    ENDIF.
  ELSEIF p_libt = &apos;X&apos;.
    p_lib = &apos;X&apos;.
    p_solom = &apos;X&apos;.
    p_report = &apos;X&apos;.
    p_funcio = &apos;X&apos;.
    p_clases = &apos;X&apos;.
    p_tablas = &apos;X&apos;.
*    v_fechas_vivas = sy-datum - 60.
*    CLEAR s_udat.
*    s_udat-option = &apos;GT&apos;.
*    s_udat-sign = &apos;I&apos;.
*    s_udat-low = v_fechas_vivas.
*    APPEND s_udat.
  ENDIF.

  IF p_lib = &apos;X&apos;.
    v_ruta_comparador = zcl_ap_ficheros=&gt;buscar_ruta_fichero( fichero = &apos;WinMergeU.exe&apos;
                                                              rutas = &apos;C:\Program Files (x86)\WinMerge\,C:\Users\andres\OneDrive\tools\WinMerge\,C:\OneDrive\tools\WinMerge\,D:\OneDrive\tools\WinMerge&apos; ).

  ENDIF.

  IF NOT p_dirlib IS INITIAL.
    v_directorio = p_dirlib.
  ELSE.
    v_directorio = zcl_ap_ficheros=&gt;buscar_ruta_fichero( rutas = &apos;\\vmware-host\Shared Folders\Google Drive\LIB,Z:\Google Drive\LIB,C:\Users\Andres\Google Drive\LIB,D:\Google Drive\LIB&apos; ).
  ENDIF.

  IF p_lib IS INITIAL.
    DATA: v_aux1 TYPE string, v_aux2 TYPE string.
    SPLIT zcl_c=&gt;ruta_descarga_slnk AT &apos;\CODIGO\Reports slnk\&apos; INTO v_aux1 v_aux2.
    CONCATENATE &apos;\CODIGO\Reports slnk\&apos; v_aux2 INTO v_aux1.
    REPLACE &apos;\LIB&apos; IN v_directorio WITH v_aux1.
  ENDIF.
  IF p_solom = &apos;X&apos;.
    i_ficheros[] = zcl_ap_ficheros=&gt;lista_ficheros( v_directorio ).
  ENDIF.

  CREATE OBJECT sgpi.
  CREATE OBJECT o_bi.

  PERFORM seleccionar_datos.

  CALL SCREEN 0100.



************************************************************************
*
*                  FORMS ADICIONALES
*
************************************************************************


*&amp;---------------------------------------------------------------------*

*&amp;      Form  SELECCIONAR_DATOS
*&amp;---------------------------------------------------------------------*
*       Selecciona las devoluciones
*----------------------------------------------------------------------*

FORM seleccionar_datos.
  DATA: i_trdir LIKE trdir OCCURS 1000 WITH HEADER LINE,
        BEGIN OF i_tstc  OCCURS 300,
          pgmna LIKE tstc-pgmna,
          tcode LIKE tstc-tcode,
        END   OF i_tstc,
        BEGIN OF i_estad OCCURS 1000,
          report(40),  &quot;LIKE zestadisticas-report,
          fecha      TYPE d, &quot;LIKE zestadisticas-fecha,

          account    TYPE sy-uname, &quot;LIKE zestadisticas-account,
          total      TYPE i,
        END OF i_estad,
        l_aux(60),
        i_est     LIKE i_estad OCCURS 100000 WITH HEADER LINE,
        l_fin,
        l_tcode   TYPE sy-tcode.

  DATA: r_obj TYPE TABLE OF rstt_s_range_string WITH HEADER LINE.

  CLEAR r_obj.
  r_obj-option = &apos;CP&apos;.
  r_obj-sign   = &apos;I&apos;.
  r_obj-low    = &apos;Z*&apos;.
  APPEND r_obj.
  r_obj-low    = &apos;Y*&apos;.
  APPEND r_obj.
  IF sy-uname = zcl_c=&gt;usuario_ap.
    r_obj-low    = &apos;/SOTHIS/*&apos;.
    APPEND r_obj.
    r_obj-low    = &apos;/SEI/*&apos;.
    APPEND r_obj.
    r_obj-low    = &apos;/MOVI/*&apos;.
    APPEND r_obj.
    r_obj-low    = &apos;/COCKPIT/*&apos;.
    APPEND r_obj.
  ENDIF.


  IF p_vivas IS INITIAL.
    DATA l_tabla TYPE tabname VALUE &apos;ZESTADISTICAS&apos;.
    SELECT SINGLE tabname FROM dd02l
      INTO l_tabla
     WHERE tabname = l_tabla.
    IF sy-subrc = 0.
      SELECT * FROM (l_tabla)
        INTO CORRESPONDING FIELDS OF TABLE i_est
       WHERE report IN s_report
         AND ( report IN r_obj
          OR   report LIKE &apos;SAPMZ%&apos; ).
      SORT i_est.
      LOOP AT i_est.
        AT NEW report.
          CLEAR i_estad.
          CLEAR l_fin.
        ENDAT.
        ADD 1 TO i_estad-total.
        AT END OF report.
          l_fin = &apos;X&apos;.
        ENDAT.
        IF l_fin = &apos;X&apos;.
          i_estad-report  = i_est-report.
          i_estad-fecha   = i_est-fecha.
          i_estad-account = i_est-account.
          APPEND i_estad.
          CLEAR l_fin.
        ENDIF.
      ENDLOOP.
      REFRESH i_est.
      SORT i_estad.
    ENDIF.
  ENDIF.



  RANGES: r_name FOR trdir-name,
          r_name_apc FOR trdir-name.
  DATA i_zbc003 LIKE zbc003 OCCURS 0 WITH HEADER LINE.

  addrango_eq r_name_apc &apos;&amp;&amp;&amp;&amp;&amp;&apos;.
  IF NOT s_grupo[] IS INITIAL OR
     NOT s_asign[] IS INITIAL OR
     NOT s_progr[] IS INITIAL OR
     NOT s_prior[] IS INITIAL OR
     NOT p_lib IS INITIAL.
    SELECT * FROM zbc003
      INTO TABLE i_zbc003
     WHERE ( grupo IN s_grupo OR
             grupo2 IN s_grupo OR
             grupo3 IN s_grupo )
       AND asignado_a IN s_asign
       AND procesado_por IN s_progr
         AND name IN s_report
      AND prioridad IN s_prior.
    IF sy-subrc NE 0.
      addrango_eq r_name &apos;&amp;&amp;&amp;&amp;&amp;&apos;.
    ELSE.
      IF p_lib = &apos;X&apos;.
        DELETE i_zbc003 WHERE libreria = &apos;&apos;.
      ENDIF.
      LOOP AT i_zbc003.
        addrango_eq r_name i_zbc003-name.
      ENDLOOP.
    ENDIF.
  ELSEIF p_vivas = &apos;X&apos;.
    SELECT * FROM zbc003
      INTO TABLE i_zbc003
     WHERE name IN s_report
       AND ( asignado_a = sy-uname
          OR procesado_por = sy-uname
          OR prioridad NE 0 ).
    IF sy-subrc = 0.
      IF p_lib = &apos;X&apos;.
        DELETE i_zbc003 WHERE libreria = &apos;&apos;.
      ENDIF.
      LOOP AT i_zbc003.
        addrango_eq r_name_apc i_zbc003-name.
      ENDLOOP.
    ENDIF.
  ENDIF.

  IF p_report = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando programas&apos; ).
* Buscamos programas

    IF p_vivas IS INITIAL.
      SELECT * FROM  trdir
        INTO TABLE i_trdir
       WHERE ( name  IN r_obj
            OR name  LIKE &apos;SAPMZ%&apos;
            OR name  LIKE &apos;MZ%&apos;
            OR name  LIKE &apos;LZ%F01&apos; )
          AND NOT name LIKE &apos;%=====%&apos;
          AND name IN s_report
          AND name IN r_name
      AND ( subc = &apos;1&apos; OR subc = &apos;M&apos; OR subc = &apos;I&apos; OR subc = &apos;S&apos; )
      AND subc IN s_subc
      AND ( cnam IN s_cnam
        AND unam IN s_unam
        AND cdat IN s_cdat
        AND udat IN s_udat ).
    ELSE.
      SELECT * FROM  trdir
        INTO TABLE i_trdir
       WHERE
        name IN r_name_apc
         OR (
            ( name  IN r_obj
           OR name  LIKE &apos;SAPMZ%&apos;
           OR name  LIKE &apos;MZ%&apos;
           OR name  LIKE &apos;LZ%F01&apos; )
         AND NOT name LIKE &apos;%=====%&apos;
         AND name IN s_report
         AND name IN r_name
      AND ( subc = &apos;1&apos; OR subc = &apos;M&apos; OR subc = &apos;I&apos; OR subc = &apos;S&apos; )
      AND subc IN s_subc
      AND ( cnam = sy-uname OR unam = sy-uname )
      AND ( cdat &gt;= v_fechas_vivas OR udat &gt;= v_fechas_vivas )
        ).

      LOOP AT i_zbc003 WHERE prioridad = &apos;88888&apos;.
        DELETE i_trdir WHERE name = i_zbc003-name.
      ENDLOOP.

      SELECT * FROM tstc
        INTO CORRESPONDING FIELDS OF TABLE i_tstc
        FOR ALL ENTRIES IN i_trdir
       WHERE pgmna = i_trdir-name.
    ENDIF.
    SORT i_tstc.
    sgpi-&gt;get_filas_tabla( i_trdir[] ).
    LOOP AT i_trdir.
      SELECT SINGLE devclass FROM  tadir
        INTO i_listado-devclass
       WHERE pgmid = &apos;R3TR&apos;
         AND object = &apos;PROG&apos;
         AND obj_name   = i_trdir-name
         AND delflag = &apos;&apos;.
      IF sy-subrc = 0.
        sgpi-&gt;porcentaje( texto = &apos;Procesando&apos; cantidad = sy-tabix ).
        CLEAR i_listado.
        MOVE-CORRESPONDING i_trdir TO i_listado.
        i_listado-object = &apos;PROG&apos;.
        READ TABLE i_tstc WITH KEY pgmna = i_trdir-name
                          BINARY SEARCH.
        IF sy-subrc = 0.
          i_listado-tcode = i_tstc-tcode.
        ELSE.
          i_listado-tcode = &apos;SE38&apos;.
        ENDIF.

        IF i_listado-tcode IN s_tcode.
          APPEND i_listado.
        ENDIF.
      ENDIF.
    ENDLOOP.

    zcl_ap_sgpi=&gt;text( &apos;Seleccionando transacciones sin report Z&apos; ).
    LOOP AT i_tstc WHERE ( tcode(1) = &apos;Z&apos;
                        OR tcode(1) = &apos;Y&apos; )
                     AND   tcode IN s_tcode.
      READ TABLE i_listado WITH KEY tcode = i_tstc-tcode.
      IF sy-subrc NE 0.
        CLEAR i_listado.
        i_listado-tcode = i_tstc-tcode.
        i_listado-name  = i_tstc-pgmna.
        IF i_listado-name IS INITIAL.
          SELECT SINGLE * FROM tstcp
           WHERE tcode = i_tstc-tcode.
          IF sy-subrc = 0.
            i_listado-subc = &apos;1&apos;.
            IF tstcp-param+2(12) = &apos;START_REPORT&apos;.
              DATA: l_aux1(80), l_aux2(80).
              SPLIT tstcp-param AT &apos;D_SREPOVARI-REPORT=&apos;
                     INTO l_aux1 l_aux2.
              SPLIT l_aux2 AT &apos;;&apos; INTO i_listado-name l_aux1.
            ELSEIF tstcp-param+2(4) = &apos;ZBC4&apos;.
              SPLIT tstcp-param AT &apos;P_TABLA=&apos;
                     INTO l_aux1 l_aux2.
              SPLIT l_aux2 AT &apos;;&apos; INTO i_listado-aux l_aux1.
            ELSEIF tstcp-param+2(6) = &apos;ZBCTAB&apos;.
              SPLIT tstcp-param AT &apos;TABLA=&apos;
                     INTO l_aux1 l_aux2.
              SPLIT l_aux2 AT &apos;;&apos; INTO i_listado-aux l_aux1.
            ELSE.
              i_listado-name = tstcp-param+2.
            ENDIF.
          ENDIF.
        ENDIF.

        IF i_listado-name IN r_name.
          READ TABLE i_trdir WITH KEY name = i_listado-name
                             BINARY SEARCH.
          IF sy-subrc = 0.
            MOVE-CORRESPONDING i_trdir TO i_listado.
          ELSE.
            SELECT SINGLE * FROM  trdir
             WHERE name  = i_listado-name
               AND name IN s_report.
            IF sy-subrc = 0.
              MOVE-CORRESPONDING trdir TO i_listado.
            ENDIF.
          ENDIF.

          IF i_listado-name(4) = &apos;AQQQ&apos;.
            i_listado-subc = &apos;Q&apos;.
          ENDIF.
          IF i_listado-subc IN s_subc.
            APPEND i_listado.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDLOOP.

    zcl_ap_sgpi=&gt;text( &apos;Seleccionando programas&apos; ).
    LOOP AT i_listado.
      IF NOT i_listado-tcode IS INITIAL.

        IF i_listado-name IS INITIAL.
          SELECT SINGLE * FROM tstcp
           WHERE tcode = i_listado-tcode.
          SEARCH tstcp FOR &apos;EXTDREPORT=KE&apos;.
          IF sy-subrc = 0.
            DELETE i_listado.
            CONTINUE.
          ENDIF.
        ENDIF.

        SELECT SINGLE ttext FROM tstct
      INTO i_listado-ttext
     WHERE sprsl = sy-langu
       AND tcode = i_listado-tcode.
      ENDIF.
      SELECT SINGLE text FROM trdirt
        INTO i_listado-text
       WHERE sprsl = sy-langu
         AND name  = i_listado-name.
      SELECT SINGLE devclass FROM  tadir
        INTO i_listado-devclass
       WHERE pgmid  = &apos;R3TR&apos;
         AND object = &apos;PROG&apos;
         AND obj_name  = i_listado-name.
      IF i_listado-devclass IN s_devcla.
        IF NOT i_listado-name IS INITIAL.
          READ TABLE i_estad WITH KEY report = i_listado-name
                             BINARY SEARCH.
          IF sy-subrc = 0.
            i_listado-total  = i_estad-total.
            i_listado-fult   = i_estad-fecha.
            i_listado-uuname = i_estad-account.
          ENDIF.
        ENDIF.

        IF p_numlin = &apos;X&apos;.
          IF NOT i_listado-name IS INITIAL.
            READ REPORT i_listado-name INTO i_source.
            DESCRIBE TABLE i_source LINES i_listado-numlin.
          ENDIF.
        ENDIF.

        MODIFY i_listado.
      ELSE.
        DELETE i_listado.
      ENDIF.
    ENDLOOP.
  ENDIF.

  IF p_utili = &apos;X&apos;.
    LOOP AT i_listado WHERE subc = &apos;1&apos;.
      SELECT * FROM cross
       WHERE type = &apos;R&apos;
         AND name = i_listado-name.
        IF i_listado-aux IS INITIAL.
          i_listado-aux = cross-include.
        ELSE.
          CONCATENATE i_listado-aux &apos;,&apos; cross-include
                 INTO i_listado-aux SEPARATED BY space.
        ENDIF.
        IF i_listado-total = 0.
          READ TABLE i_estad WITH KEY report = cross-include
                             BINARY SEARCH.
          IF sy-subrc = 0.
            i_listado-total = i_estad-total.
          ENDIF.
        ENDIF.

      ENDSELECT.
      MODIFY i_listado.
    ENDLOOP.

    LOOP AT i_listado WHERE subc = &apos;I&apos;.
      SELECT * FROM rseuinc
       WHERE include = i_listado-name.
        IF i_listado-aux IS INITIAL.
          i_listado-aux = rseuinc-master.
        ELSE.
          CONCATENATE i_listado-aux &apos;,&apos; rseuinc-master
                 INTO i_listado-aux SEPARATED BY space.
        ENDIF.
        IF i_listado-total = 0.
          READ TABLE i_estad WITH KEY report = rseuinc-master
                            BINARY SEARCH.
          IF sy-subrc = 0.
            i_listado-total = i_estad-total.
          ENDIF.
        ENDIF.
        IF i_listado-tcode IS INITIAL.
          READ TABLE i_tstc WITH KEY pgmna = rseuinc-master
                            BINARY SEARCH.
          IF sy-subrc = 0.
            i_listado-tcode = i_tstc-tcode.
            SELECT SINGLE ttext FROM tstct
          INTO i_listado-ttext
         WHERE sprsl = sy-langu
           AND tcode = i_listado-tcode.
          ENDIF.
        ENDIF.
      ENDSELECT.
      MODIFY i_listado.
    ENDLOOP.
  ENDIF.

  IF p_funcio = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando programas&apos; ).
    SELECT * FROM v_fdirt
     WHERE area IN r_obj
       AND funcname IN s_report
       AND funcname NOT LIKE &apos;TABLE%&apos;
       AND funcname NOT LIKE &apos;VIEW%&apos;
       AND active = &apos;X&apos;
       AND spras  = sy-langu.
      IF v_fdirt-funcname IN r_name.
        SELECT SINGLE * FROM tadir
         WHERE pgmid = &apos;R3TR&apos;
           AND object = &apos;FUGR&apos;
          AND obj_name = v_fdirt-area
          AND devclass IN s_devcla.
        IF sy-subrc = 0.
          CLEAR i_listado.
          i_listado-object   = &apos;FUGR&apos;.  &quot;APC03112010
          i_listado-devclass = tadir-devclass.
          PERFORM get_funcion USING v_fdirt-funcname.
          IF p_utili = &apos;X&apos;.
            SELECT * FROM cross
             WHERE type = &apos;F&apos;
               AND name = i_listado-name.
              IF i_listado-aux IS INITIAL.
                i_listado-aux = cross-include.
              ELSE.
                CONCATENATE i_listado-aux &apos;,&apos; cross-include
                       INTO i_listado-aux SEPARATED BY space.
              ENDIF.
              IF i_listado-total = 0.
                READ TABLE i_estad WITH KEY report = cross-include
                                   BINARY SEARCH.
                IF sy-subrc = 0.
                  i_listado-total = i_estad-total.
                ENDIF.
              ENDIF.

            ENDSELECT.
          ENDIF.

          APPEND i_listado.
        ENDIF.
      ENDIF.
    ENDSELECT.
  ENDIF.



  IF p_clases = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando clases&apos; ).
    DATA i_tadir TYPE TABLE OF tadir WITH HEADER LINE.

    IF i_zbc003[] IS INITIAL.
      SELECT * FROM  tadir
        INTO TABLE i_tadir
       WHERE pgmid = &apos;R3TR&apos;
         AND object = &apos;CLAS&apos;
         AND obj_name  IN r_obj
         AND obj_name IN s_report
         AND devclass IN s_devcla
         AND delflag = &apos;&apos;.
    ELSE.
      SELECT * FROM  tadir
        INTO TABLE i_tadir
         FOR ALL ENTRIES IN i_zbc003
       WHERE pgmid = &apos;R3TR&apos;
         AND object = &apos;CLAS&apos;
         AND obj_name  = i_zbc003-name
         AND devclass IN s_devcla
         AND delflag = &apos;&apos;.
    ENDIF.
    LOOP AT i_tadir INTO tadir.
      SELECT SINGLE * FROM seoclass
       WHERE clsname = tadir-obj_name.
      IF sy-subrc = 0.
        CLEAR i_listado.
        i_listado-name     = tadir-obj_name.
        i_listado-object   = tadir-object.
        i_listado-subc     = &apos;C&apos;.
        i_listado-tcode    = &apos;SE24&apos;.
        i_listado-text     = stxh-tdtitle.
        i_listado-devclass = tadir-devclass.

        SELECT SINGLE descript author createdon
                      changedby changedon
          FROM vseoclass
          INTO (i_listado-text, i_listado-cnam, i_listado-cdat,
                i_listado-unam, i_listado-udat)
         WHERE clsname = tadir-obj_name
           AND langu = sy-langu.

        CONCATENATE tadir-obj_name &apos;%&apos; INTO l_aux.
        SELECT MAX( udat ) FROM progdir
          INTO i_listado-udat
         WHERE name LIKE l_aux.

        SELECT SINGLE unam FROM progdir
          INTO i_listado-unam
         WHERE name LIKE l_aux
           AND state = &apos;A&apos;
           AND udat = i_listado-udat.

        APPEND i_listado.
      ENDIF.
    ENDLOOP.
  ENDIF.

  IF p_enhan = &apos;X&apos;.                                                              &quot;NOLIB
    CREATE OBJECT o_enh.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando enhancement&apos; ).                            &quot;NOLIB
    SELECT * FROM  tadir                                                         &quot;NOLIB
     WHERE object IN (&apos;ENHO&apos;, &apos;ENHS&apos;)
       AND obj_name IN r_obj                                                   &quot;NOLIB
       AND obj_name IN s_report.                                                 &quot;NOLIB
      &quot;NOLIB
      CLEAR i_listado.                                                           &quot;NOLIB
      i_listado-name   = tadir-obj_name.  &quot;NOLIB
      i_listado-object = tadir-object.
      i_listado-subc   = &apos;A&apos;.  &quot;NOLIB

      CLEAR enhincinx.
      SELECT SINGLE * FROM enhincinx
        INTO enhincinx
       WHERE enhname = i_listado-name.
      IF NOT enhincinx-enhinclude IS INITIAL.
        SELECT SINGLE cnam cdat unam udat vern FROM trdir
          INTO CORRESPONDING FIELDS OF i_listado
         WHERE name = enhincinx-enhinclude.
      ENDIF.

      SELECT SINGLE obj_name FROM enhobj                                &quot;NOLIB
        INTO (i_listado-tcode )                                &quot;NOLIB
       WHERE enhname = tadir-obj_name.                                           &quot;NOLIB
      i_listado-devclass = tadir-devclass.                                       &quot;NOLIB
      APPEND i_listado.                                                          &quot;NOLIB
    ENDSELECT.                                                                   &quot;NOLIB
    LOOP AT i_listado WHERE subc = &apos;A&apos;.
      DATA: ev_include TYPE programm,
            ev_line    TYPE string.
      i_listado-subc = &apos;+&apos;.

      DATA i_enhincinx TYPE TABLE OF enhincinx WITH HEADER LINE.

      SELECT * FROM enhincinx
        INTO TABLE i_enhincinx
       WHERE enhname = i_listado-name.

      LOOP AT i_enhincinx.
        i_listado-text = i_enhincinx-full_name.

        o_enh-&gt;get_line_position( EXPORTING iv_full_name = i_enhincinx-full_name
                                            iv_prog      = i_enhincinx-programname
                                            iv_enhname   = i_enhincinx-enhname
                                  IMPORTING ev_include   = ev_include
                                            ev_line      = ev_line ).
        i_listado-tcode  = ev_include.
        i_listado-object = &apos;PROG&apos;.

        APPEND i_listado.
      ENDLOOP.
    ENDLOOP.
  ENDIF.                                                                         &quot;NOLIB

  IF p_formul = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando programas&apos; ).
    SELECT * FROM stxh
   WHERE tdobject = &apos;FORM&apos;
     AND tdform IN s_report
*     AND tdform IN r_name
     AND tdform IN r_obj
     AND tdid = &apos;DEF&apos;
     AND tdspras = &apos;S&apos;.
      IF stxh-tdform IN r_name.
        CLEAR i_listado.
        i_listado-name   = stxh-tdform.
        i_listado-subc   = &apos;S&apos;.
        i_listado-tcode  = &apos;SE71&apos;.
        i_listado-text   = stxh-tdtitle.
        i_listado-cdat   = stxh-tdfdate.
        i_listado-cnam   = stxh-tdfuser.
        i_listado-udat   = stxh-tdldate.
        i_listado-unam   = stxh-tdluser.
        i_listado-object = &apos;FORM&apos;.  &quot;APC03112010

        SELECT SINGLE devclass FROM  tadir
          INTO i_listado-devclass
         WHERE pgmid = &apos;R3TR&apos;
           AND object = &apos;FORM&apos;
           AND obj_name   = i_listado-name.

        IF p_utili = &apos;X&apos;.
          SELECT * FROM ttxfp
           WHERE tdform = i_listado-name.
            IF i_listado-ttext IS INITIAL.
              i_listado-ttext = ttxfp-print_name.
            ELSE.
              CONCATENATE i_listado-ttext &apos;,&apos; ttxfp-print_name
                     INTO i_listado-ttext.
            ENDIF.
          ENDSELECT.
        ENDIF.
        APPEND i_listado.
      ENDIF.
    ENDSELECT.

    SELECT * FROM  stxfadm
           WHERE  formname    IN s_report
           AND formname IN r_obj
           AND    masterlang  = sy-langu
           AND    devclass    IN s_devcla.
      IF stxfadm-formname IN r_name.
        CLEAR i_listado.
        i_listado-name   = stxfadm-formname.
        i_listado-subc   = &apos;S&apos;.
        i_listado-object = &apos;SSFO&apos;.  &quot;APC03112010
        i_listado-tcode  = &apos;SMARTFORMS&apos;.
        i_listado-cdat   = stxfadm-firstdate.
        i_listado-cnam   = stxfadm-firstuser.
        i_listado-udat   = stxfadm-lastdate.
        i_listado-unam   = stxfadm-lastuser.

        SELECT SINGLE pgnam kschl FROM tnapr
          INTO (i_listado-tcode, i_listado-ttext)
         WHERE nacha = &apos;1&apos;
           AND sform = stxfadm-formname.

        SELECT SINGLE caption FROM  stxfadmt
          INTO i_listado-text
               WHERE  langu     = sy-langu
               AND    formname  = stxfadm-formname.
        APPEND i_listado.
      ENDIF.
    ENDSELECT.

  ENDIF.

  IF p_proyec = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando proyectos de ampliación&apos; ).
    REFRESH i_list.
    SELECT * FROM modtext
     WHERE name IN s_report.
      IF modtext-name IN r_name.
        CLEAR i_list.
        i_list-name = modtext-name.
        i_list-subc = &apos;A&apos;.
        i_list-text = modtext-modtext.
        APPEND i_list.
      ENDIF.
    ENDSELECT.

    DATA l_ok.
    LOOP AT i_list.
      CLEAR l_ok.
      SELECT * FROM modact
       WHERE name = i_list-name.
        i_listado-devclass = modact-devclass.
        SELECT * FROM modsap
         WHERE name = modact-member
           AND typ  = &apos;E&apos;.
          i_listado       = i_list.
          i_listado-tcode = modsap-member.
          SELECT SINGLE modtext FROM  modsapt
            INTO i_listado-aux
                 WHERE  sprsl  = sy-langu
                 AND    name   = modsap-name.
          SELECT SINGLE * FROM tfdir
           WHERE funcname = modsap-member.
          CONCATENATE tfdir-pname+3 &apos;U&apos; tfdir-include INTO
          i_listado-ttext.

          i_listado-ttext(1) = &apos;Z&apos;.
          SELECT SINGLE * FROM trdir
           WHERE name = i_listado-ttext.
          IF sy-subrc = 0.

            IF i_listado-ttext(2) = &apos;ZX&apos;.
              SELECT SINGLE cnam unam cdat udat FROM  trdir
                INTO (i_listado-cnam, i_listado-unam,
                      i_listado-cdat, i_listado-udat)
               WHERE name  = i_listado-ttext.
              i_listado-object = &apos;PROG&apos;.
            ENDIF.

            IF i_listado-devclass IS INITIAL.
              SELECT SINGLE devclass FROM  tadir
                INTO i_listado-devclass
               WHERE pgmid = &apos;R3TR&apos;
                 AND object = &apos;PROG&apos;
                 AND obj_name   = i_listado-ttext.
            ENDIF.

            APPEND i_listado.
            l_ok = &apos;X&apos;.
          ENDIF.
        ENDSELECT.
      ENDSELECT.
      IF l_ok IS INITIAL.
        APPEND i_list TO i_listado.
      ENDIF.
    ENDLOOP.

  ENDIF.

  IF p_badis = &apos;X&apos;.
    SELECT * FROM tadir
     WHERE pgmid = &apos;R3TR&apos;
       AND object = &apos;SXCI&apos;
       AND obj_name IN s_report
       AND obj_name IN r_name
       AND obj_name IN r_obj
       AND devclass IN s_devcla
       AND delflag = &apos;&apos;.
      CLEAR i_listado.
      i_listado-name  = tadir-obj_name.
      i_listado-subc  = &apos;B&apos;.
      i_listado-tcode = &apos;SE19&apos;.

      SELECT SINGLE text FROM  sxc_attrt
        INTO i_listado-text
       WHERE imp_name  = tadir-obj_name
         AND sprsl      = sy-langu.

      SELECT SINGLE imp_class FROM sxc_class
        INTO i_listado-ttext
       WHERE imp_name = tadir-obj_name.

      SELECT SINGLE descript author createdon
                    changedby changedon
        FROM vseoclass
        INTO (i_listado-aux, i_listado-cnam, i_listado-cdat,
              i_listado-unam, i_listado-udat)
       WHERE clsname = i_listado-ttext.

      IF i_listado-ttext(1) = &apos;Z&apos;.
        CONCATENATE i_listado-ttext &apos;%&apos; INTO l_aux.
        SELECT MAX( udat ) FROM progdir
          INTO i_listado-udat
         WHERE name LIKE l_aux.

        SELECT SINGLE unam FROM progdir
          INTO i_listado-unam
         WHERE name LIKE l_aux
           AND state = &apos;A&apos;
           AND udat = i_listado-udat.
      ENDIF.

      i_listado-object = &apos;CLAS&apos;.

      APPEND i_listado.
    ENDSELECT.
  ENDIF.

  IF p_userex = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando Userexits&apos; ).
    SELECT * FROM  trdir
      INTO TABLE i_trdir
     WHERE ( ( name  LIKE &apos;MV%Z%&apos; )
         OR  ( name  LIKE &apos;RV%Z%&apos; )
         OR  ( name  LIKE &apos;LV%Z%&apos; )
         OR  ( name  LIKE &apos;RPC%Z%&apos; )
         OR  ( name  LIKE &apos;VV05HF%&apos; ) )
        AND name IN s_report
        AND name IN r_name
        AND subc = &apos;I&apos;
        AND unam NE &apos;SAP&apos;.
    LOOP AT i_trdir WHERE name IN r_name.
      CLEAR i_listado.
      MOVE-CORRESPONDING i_trdir TO i_listado.
      i_listado-object = &apos;PROG&apos;.
      SELECT SINGLE text FROM trdirt
        INTO i_listado-text
       WHERE sprsl = sy-langu
         AND name  = i_listado-name.
      SELECT SINGLE devclass FROM  tadir
        INTO i_listado-devclass
       WHERE pgmid  = &apos;R3TR&apos;
         AND object = &apos;PROG&apos;
         AND obj_name  = i_listado-name.
      APPEND i_listado.
    ENDLOOP.
  ENDIF.

  IF p_rutina = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando Rutinas&apos; ).
    SELECT * FROM  trdir
      INTO TABLE i_trdir
     WHERE  name  LIKE &apos;RV%&apos;
        AND name  NOT LIKE &apos;RV%NN&apos;
        AND name  NOT LIKE &apos;RV%CC&apos;
        AND name  NOT LIKE &apos;RV%Z%&apos;
        AND name IN s_report
        AND subc = &apos;I&apos;
        AND unam NE &apos;SAP&apos;.
    LOOP AT i_trdir WHERE name IN r_name.
      CLEAR i_listado.
      MOVE-CORRESPONDING i_trdir TO i_listado.
      i_listado-object = &apos;PROG&apos;.  &quot;APC03112010
      i_listado-tcode  = &apos;VOFM&apos;.  &quot;APC03112010
      SELECT SINGLE text FROM trdirt
        INTO i_listado-text
       WHERE sprsl = sy-langu
         AND name  = i_listado-name.
      SELECT SINGLE devclass FROM  tadir
        INTO i_listado-devclass
       WHERE pgmid  = &apos;R3TR&apos;
         AND object = &apos;PROG&apos;
         AND obj_name  = i_listado-name.
      APPEND i_listado.
    ENDLOOP.
  ENDIF.

  IF p_tablas = &apos;X&apos;.
    DATA: l_tabname LIKE d010tab-tabname,
          i_progs   LIKE d010tab OCCURS 0 WITH HEADER LINE,
          i_dd02l   TYPE TABLE OF dd02l WITH HEADER LINE.

    zcl_ap_sgpi=&gt;text( &apos;Seleccionando tablas&apos; ).

    IF p_vivas IS INITIAL.
      SELECT * FROM  dd02l
        INTO TABLE i_dd02l
       WHERE  tabname  IN r_obj
         AND tabname IN s_report
         AND as4user IN s_cnam
         AND as4user IN s_unam
         AND as4date IN s_cdat
         AND as4date IN s_udat.
    ELSE.
      SELECT * FROM  dd02l
        INTO TABLE i_dd02l
        WHERE tabname IN r_name_apc
           OR ( tabname IN r_obj
           AND tabname IN s_report
        AND ( as4user = sy-uname )
        AND ( as4date &gt;= v_fechas_vivas )
          ).
    ENDIF.
    LOOP AT i_dd02l INTO dd02l.
      IF dd02l-tabname IN r_name.
        CLEAR i_listado.
        i_listado-name = dd02l-tabname.
        SELECT SINGLE ddtext FROM  dd02t
          INTO i_listado-text
               WHERE  tabname     = i_listado-name
               AND    ddlanguage  = sy-langu.


        SELECT SINGLE devclass object FROM tadir
          INTO (i_listado-devclass, i_listado-object)
         WHERE pgmid = &apos;R3TR&apos;
           AND object IN (&apos;TABL&apos;, &apos;VIEW&apos;)
           AND obj_name = dd02l-tabname
           AND delflag = &apos;&apos;.
        IF i_listado-devclass IN s_devcla.
          CASE dd02l-tabclass.
            WHEN &apos;INTTAB&apos;.
              i_listado-subc = &apos;E&apos;.
            WHEN &apos;VIEW&apos;.
              i_listado-subc = &apos;V&apos;.
            WHEN &apos;APPEND&apos;.
              i_listado-subc = &apos;A&apos;.
            WHEN OTHERS.
              i_listado-subc = &apos;T&apos;.
              IF p_numlin = &apos;X&apos;.
                SELECT COUNT( * ) FROM (i_listado-name)
                  INTO i_listado-numlin.
              ENDIF.
          ENDCASE.

          i_listado-cdat = dd02l-as4date.
          i_listado-cnam = dd02l-as4user.

          i_listado-tcode = &apos;SE11&apos;.

          IF p_utili = &apos;X&apos;.
            l_tabname = i_listado-name.
            CALL FUNCTION &apos;RS_TABLE_IN_PROGRAMS&apos;
              EXPORTING
                tabname  = l_tabname
              TABLES
                proglist = i_progs.
            LOOP AT i_progs.
              IF i_listado-aux IS INITIAL.
                i_listado-aux = i_progs-master.
              ELSE.
                CONCATENATE i_listado-aux &apos;,&apos; i_progs-master
                       INTO i_listado-aux SEPARATED BY space.
              ENDIF.

              IF i_listado-total = 0.
                READ TABLE i_estad WITH KEY report = i_progs-master
                                   BINARY SEARCH.
                IF sy-subrc = 0.
                  i_listado-total = i_estad-total.
                ENDIF.
              ENDIF.

            ENDLOOP.
          ENDIF.

          APPEND i_listado.
        ENDIF.
      ENDIF.
    ENDLOOP.


    IF p_vivas IS INITIAL AND p_libt IS INITIAL.
      zcl_ap_sgpi=&gt;text( &apos;Seleccionando tipos&apos; ).
      SELECT * FROM  ddtypes
       WHERE  typename  IN r_obj
          AND typename IN s_report.
        IF ddtypes-typename IN r_name.

          SELECT SINGLE * FROM  dd40l
           WHERE typename = ddtypes-typename
          AND as4user IN s_cnam
          AND as4user IN s_unam
          AND as4date IN s_cdat
          AND as4date IN s_udat.
          IF sy-subrc = 0.
            CLEAR i_listado.
            i_listado-name = ddtypes-typename.
            SELECT SINGLE devclass object FROM tadir
               INTO (i_listado-devclass, i_listado-object)
              WHERE pgmid = &apos;R3TR&apos;
                AND object LIKE &apos;T%&apos;
                AND obj_name = ddtypes-typename.
            IF i_listado-devclass IN s_devcla.

              i_listado-cdat  = dd40l-as4date.
              i_listado-cnam  = dd40l-as4user.
              i_listado-tcode = &apos;SE11&apos;.
              i_listado-subc  = &apos;D&apos;.

              SELECT SINGLE ddtext FROM  dd40t
                INTO i_listado-text
              WHERE  typename    = i_listado-name
              AND    ddlanguage  = sy-langu.

              APPEND i_listado.
            ENDIF.
          ENDIF.
        ENDIF.
      ENDSELECT.

      zcl_ap_sgpi=&gt;text( &apos;Seleccionando elementos de datos&apos; ).

      SELECT  * FROM  dd04l
       WHERE rollname IN s_report
         AND rollname IN r_name
         AND rollname IN r_obj
      AND as4user IN s_cnam
      AND as4user IN s_unam
      AND as4date IN s_cdat
      AND as4date IN s_udat.
        IF sy-subrc = 0.
          CLEAR i_listado.
          i_listado-name = dd04l-rollname.
          SELECT SINGLE devclass object FROM tadir
             INTO (i_listado-devclass, i_listado-object)
            WHERE pgmid = &apos;R3TR&apos;
              AND object = &apos;DTEL&apos;
              AND obj_name = i_listado-name.
          IF i_listado-devclass IN s_devcla.

            i_listado-cdat  = dd04l-as4date.
            i_listado-cnam  = dd04l-as4user.
            i_listado-tcode = &apos;SE11&apos;.
            i_listado-subc  = &apos;D&apos;.

            SELECT SINGLE ddtext FROM  dd04t
              INTO i_listado-text
            WHERE  rollname    = i_listado-name
            AND    ddlanguage  = sy-langu.

            APPEND i_listado.
          ENDIF.
        ENDIF.
      ENDSELECT.

      zcl_ap_sgpi=&gt;text( &apos;Seleccionando dominios&apos; ).
      SELECT * FROM  dd01l
       WHERE domname IN s_report
        AND domname IN r_obj
        AND domname IN r_name
      AND as4user IN s_cnam
      AND as4user IN s_unam
      AND as4date IN s_cdat
      AND as4date IN s_udat.
        IF sy-subrc = 0.
          CLEAR i_listado.
          i_listado-name = dd01l-domname.
          SELECT SINGLE devclass object FROM tadir
             INTO (i_listado-devclass, i_listado-object)
            WHERE pgmid = &apos;R3TR&apos;
              AND object = &apos;DOMA&apos;
              AND obj_name = i_listado-name.
          IF i_listado-devclass IN s_devcla.

            i_listado-cdat  = dd01l-as4date.
            i_listado-cnam  = dd01l-as4user.
            i_listado-tcode = &apos;SE11&apos;.
            i_listado-subc  = &apos;D&apos;.

            SELECT SINGLE ddtext FROM  dd01t
              INTO i_listado-text
            WHERE  domname    = i_listado-name
            AND    ddlanguage  = sy-langu.

            APPEND i_listado.
          ENDIF.
        ENDIF.
      ENDSELECT.
    ENDIF.
  ENDIF.
  IF p_modife = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando modificaciones al estandar&apos; ).
    SELECT * FROM zbc003
      WHERE name  IN s_report
        AND tcode IN s_tcode
        AND name IN r_name
        AND estado = &apos;M&apos;.
      CLEAR i_listado.
      MOVE-CORRESPONDING zbc003 TO i_listado.

      IF NOT i_listado-tcode IS INITIAL.
        SELECT SINGLE ttext FROM tstct
      INTO i_listado-ttext
     WHERE sprsl = sy-langu
       AND tcode = i_listado-tcode.
      ENDIF.
      SELECT SINGLE text FROM trdirt
        INTO i_listado-text
       WHERE sprsl = sy-langu
         AND name  = i_listado-name.
      SELECT SINGLE devclass object FROM  tadir
        INTO (i_listado-devclass, i_listado-object)
       WHERE pgmid  = &apos;R3TR&apos;
         AND object = &apos;PROG&apos;
         AND obj_name  = i_listado-name.
      IF sy-subrc NE 0.
        SELECT SINGLE devclass object FROM  tadir
        INTO (i_listado-devclass, i_listado-object)
         WHERE pgmid  = &apos;R3TR&apos;
           AND obj_name  = i_listado-name.
      ENDIF.
      IF i_listado-object IS INITIAL.                          &quot;APC03112010
        SELECT SINGLE * FROM trdir                             &quot;APC03112010
         WHERE name = i_listado-name.                          &quot;APC03112010
        IF sy-subrc = 0.                                       &quot;APC03112010
          i_listado-object = &apos;PROG&apos;.                           &quot;APC03112010
        ENDIF.                                                 &quot;APC03112010
      ENDIF.                                                   &quot;APC03112010

      SELECT SINGLE cnam unam cdat udat FROM  trdir
        INTO (i_listado-cnam, i_listado-unam,
              i_listado-cdat, i_listado-udat)
       WHERE name  = i_listado-name.

      PERFORM icono_status USING i_listado-estado
                        CHANGING i_listado-icono.

      IF i_listado-estado = &apos;B&apos;.
        zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc = &apos;ROJO&apos;
                                    CHANGING tabla_color = i_listado-color ).
      ELSEIF i_listado-estado = &apos;O&apos;.
        zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc = &apos;NARANJA&apos;
                                    CHANGING tabla_color = i_listado-color ).
      ELSEIF i_listado-estado = &apos;M&apos;.
        zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc = &apos;AMARILLO&apos;
                                    CHANGING tabla_color = i_listado-color ).
      ENDIF.

      i_listado-tipo = &apos;X&apos;.

      APPEND i_listado.
    ENDSELECT.
  ENDIF.


  IF p_bte = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando BTEs&apos; ).
    DATA i_tbe TYPE TABLE OF tbe32 WITH HEADER LINE.

    SELECT * FROM tbe31
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct  IN s_report
        AND funct IN r_obj.
    SELECT * FROM tbe32
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct  IN s_report
        AND funct IN r_obj.

    SELECT * FROM tbe34
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct  IN s_report
        AND funct  IN r_obj.

    SELECT * FROM tps31
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct  IN s_report
        AND funct  IN r_obj.
    SELECT * FROM tps32
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct  IN s_report
        AND funct  IN r_obj.

    SELECT * FROM tps34
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct  IN s_report
        AND funct  IN r_obj.

    LOOP AT i_tbe WHERE funct IN r_name.
      CLEAR i_listado.
      SELECT SINGLE * FROM v_fdirt
       WHERE area IN r_obj
         AND funcname = i_tbe-funct
         AND active = &apos;X&apos;
         AND spras  = sy-langu.
      IF sy-subrc = 0.
        PERFORM get_funcion USING v_fdirt-funcname.
        i_listado-tcode = &apos;FIBF&apos;.
        i_listado-subc  = &apos;9&apos;.
        APPEND i_listado.
      ENDIF.
    ENDLOOP.
  ENDIF.

  IF p_bsp = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando BSPs&apos; ).
    DATA i_bsp TYPE TABLE OF o2appl WITH HEADER LINE.

    SELECT * FROM o2appl
      INTO TABLE i_bsp
      WHERE applname  IN s_report
        AND applname IN r_obj
        AND applname IN r_name
    AND author IN s_cnam
    AND changedby IN s_unam
    AND createdon IN s_cdat
    AND changedon IN s_udat.

    LOOP AT i_bsp.
      i_listado-tcode  = &apos;BSP&apos;.
      i_listado-subc   = &apos;B&apos;.
      i_listado-object = &apos;WAPA&apos;.
      i_listado-name   = i_bsp-applname.
      i_listado-cdat   = i_bsp-createdon.
      i_listado-cnam   = i_bsp-author.
      i_listado-udat   = i_bsp-changedon.
      i_listado-unam   = i_bsp-changedby.
      i_listado-ttext  = i_bsp-applclas.

      APPEND i_listado.
    ENDLOOP.
  ENDIF.

  IF p_webd = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando Webdynpros&apos; ).
    DATA i_webd TYPE TABLE OF wdy_application WITH HEADER LINE.

    SELECT * FROM wdy_application
      INTO TABLE i_webd
      WHERE application_name  IN s_report
        AND application_name IN r_obj
    AND author IN s_cnam
    AND changedby IN s_unam
    AND createdon IN s_cdat
    AND changedon IN s_udat.

    LOOP AT i_webd.
      CLEAR i_listado.
      i_listado-tcode  = &apos;WEBDYNPRO&apos;.
      i_listado-subc   = &apos;W&apos;.
      i_listado-object = &apos;WDYA&apos;.
      i_listado-name   = i_webd-application_name.
      i_listado-cdat   = i_webd-createdon.
      i_listado-cnam   = i_webd-author.
      i_listado-udat   = i_webd-changedon.
      i_listado-unam   = i_webd-changedby.

      APPEND i_listado.
    ENDLOOP.

    SELECT * FROM tadir
     WHERE pgmid = &apos;R3TR&apos;
       AND object LIKE &apos;WD%&apos;
      AND obj_name IN s_report
      AND obj_name IN r_obj
      AND devclass IN s_devcla
      AND delflag = &apos;&apos;.
      READ TABLE i_listado TRANSPORTING NO FIELDS WITH KEY subc = &apos;W&apos;
                                                           object = tadir-object
                                                           name = tadir-obj_name.
      IF sy-subrc NE 0.
        CLEAR i_listado.
        MOVE-CORRESPONDING tadir TO i_listado.
        i_listado-tcode    = &apos;WEBDYNPRO&apos;.
        i_listado-subc     = &apos;W&apos;.
        i_listado-name     = tadir-obj_name.
        i_listado-devclass = tadir-devclass.
        APPEND i_listado.
      ENDIF.
    ENDSELECT.

  ENDIF.

  IF p_mime = &apos;X&apos;.
    SELECT * FROM smimloio
     WHERE crea_user NE &apos;SAP&apos;
       AND crea_time &gt; &apos;20100101000000&apos;
       AND prop09 IN s_report.

      CLEAR i_listado.
      i_listado-tcode  = &apos;MIME&apos;.
      i_listado-subc   = &apos;M&apos;.
      i_listado-object = &apos;SMIM&apos;.
      i_listado-ttext  = smimloio-lo_class.
      i_listado-name   = smimloio-prop09.
      i_listado-text   = smimloio-loio_id.
      i_listado-cnam   = smimloio-crea_user.
      i_listado-cdat   = smimloio-crea_time(8).
      IF smimloio-chng_time IS INITIAL.
        i_listado-unam = i_listado-cnam.
        i_listado-udat = i_listado-cdat.
      ELSE.
        i_listado-unam = smimloio-chng_user.
        i_listado-udat = smimloio-chng_time.
      ENDIF.

      IF i_listado-cnam IN s_cnam
        AND i_listado-unam IN s_unam
        AND i_listado-cdat IN s_cdat
        AND i_listado-udat IN s_udat.
        IF smimloio-prop02 = &apos;M_FOLDER&apos; AND NOT smimloio-prop08 IS INITIAL.
          SELECT SINGLE prop09 FROM smimloio
            INTO i_listado-tcode
           WHERE loio_id  = smimloio-prop08
             AND lo_class = smimloio-prop02.
        ENDIF.
        APPEND i_listado.
      ENDIF.
    ENDSELECT.
  ENDIF.

  IF p_pdf = &apos;X&apos;.
    SELECT * FROM tadir
     WHERE pgmid = &apos;R3TR&apos;
       AND object = &apos;SFPF&apos;
       AND obj_name IN s_report
       AND obj_name IN r_name
       AND obj_name IN r_obj
       AND devclass IN s_devcla
       AND delflag = &apos;&apos;.
      CLEAR i_listado.
      i_listado-name     = tadir-obj_name.
      i_listado-subc     = &apos;P&apos;.
      i_listado-tcode    = &apos;SFP&apos;.
      i_listado-object   = &apos;SFPF&apos;.
      i_listado-devclass = tadir-devclass.

      SELECT SINGLE * FROM fpcontext
        INTO fpcontext
       WHERE name = tadir-obj_name.

        i_listado-cdat = fpcontext-firstdate.
        i_listado-cnam = fpcontext-firstuser.
        i_listado-udat = fpcontext-lastdate.
        i_listado-unam = fpcontext-lastuser.

        SELECT SINGLE text FROM  fpcontextt
          INTO i_listado-text
               WHERE  name      = fpcontext-name
               AND    state     = fpcontext-state
               AND    language  = sy-langu.

          APPEND i_listado.
        ENDSELECT.

        SELECT * FROM tadir
         WHERE pgmid = &apos;R3TR&apos;
           AND object = &apos;SFPI&apos;
           AND obj_name IN s_report
           AND obj_name IN r_name
           AND obj_name IN r_obj
           AND devclass IN s_devcla
           AND delflag = &apos;&apos;.
          CLEAR i_listado.
          i_listado-name     = tadir-obj_name.
          i_listado-subc     = &apos;P&apos;.
          i_listado-tcode    = &apos;SFP&apos;.
          i_listado-object   = &apos;SFPI&apos;.
          i_listado-devclass = tadir-devclass.

          SELECT SINGLE * FROM fpinterface
            INTO fpinterface
           WHERE name = tadir-obj_name.

            i_listado-cdat = fpinterface-firstdate.
            i_listado-cnam = fpinterface-firstuser.
            i_listado-udat = fpinterface-lastdate.
            i_listado-unam = fpinterface-lastuser.

            SELECT SINGLE text FROM  fpinterfacet
              INTO i_listado-text
                   WHERE  name      = fpinterface-name
                   AND    state     = fpinterface-state
                   AND    language  = sy-langu.

              APPEND i_listado.
            ENDSELECT.
          ENDIF.



          IF p_xslt = &apos;X&apos;.
            SELECT * FROM tadir
             WHERE pgmid = &apos;R3TR&apos;
               AND object = &apos;XSLT&apos;
               AND obj_name IN s_report
               AND obj_name IN r_name
               AND obj_name IN r_obj
               AND devclass IN s_devcla
               AND delflag = &apos;&apos;.
              SELECT SINGLE * FROM o2xsltdesc
               WHERE xsltdesc = tadir-obj_name.
              IF sy-subrc = 0.

                CLEAR i_listado.
                i_listado-name   = tadir-obj_name.
                i_listado-subc   = &apos;X&apos;.
                i_listado-tcode  = &apos;XSLT_TOOL&apos;.
                i_listado-object = &apos;XSLT&apos;.
                i_listado-cnam   = o2xsltdesc-author.
                i_listado-cdat   = o2xsltdesc-createdon.
                i_listado-unam   = o2xsltdesc-changedby.
                i_listado-udat   = o2xsltdesc-changedon.

                APPEND i_listado.
              ENDIF.
            ENDSELECT.
          ENDIF.


          IF p_wf = &apos;X&apos;.
            SELECT * FROM hrs1000
             WHERE otype IN (&apos;AC&apos;, &apos;TS&apos;, &apos;WS&apos;)
               AND uname NE &apos;SAP&apos;
               AND mc_short IN s_report
               AND mc_short IN r_name
               AND mc_short IN r_obj.
              CLEAR i_listado.
              i_listado-name = hrs1000-mc_short.
              i_listado-subc = &apos;W&apos;.
              CONCATENATE hrs1000-otype hrs1000-objid INTO i_listado-tcode.
              i_listado-object = hrs1000-otype.
              i_listado-text   = hrs1000-stext.
              IF hrs1000-otype = &apos;WS&apos;.
                SELECT SINGLE created_by created_on changed_by changed_on FROM swdsheader
                  INTO (i_listado-cnam, i_listado-cdat, i_listado-unam, i_listado-udat)
                WHERE wfd_id = i_listado-tcode.
              ELSE.
                i_listado-cnam = i_listado-unam = hrs1000-uname.
                i_listado-cdat = i_listado-udat = hrs1000-aedtm.
              ENDIF.
              APPEND i_listado.
            ENDSELECT.
          ENDIF.


          zcl_ap_sgpi=&gt;text( &apos;Analizando información&apos; ).

          LOOP AT i_listado WHERE devclass = &apos;&apos;.
            SELECT SINGLE devclass FROM  tadir
              INTO i_listado-devclass
             WHERE object = i_listado-object
               AND obj_name  = i_listado-name.
            MODIFY i_listado.
          ENDLOOP.

          DELETE i_listado WHERE NOT devclass IN s_devcla.

          LOOP AT i_listado.
            SELECT SINGLE * FROM zbc003
             WHERE name  = i_listado-name
               AND tcode = i_listado-tcode.
            IF sy-subrc = 0.
              MOVE-CORRESPONDING zbc003 TO i_listado.
            ENDIF.

            PERFORM icono_status USING i_listado-estado
                              CHANGING i_listado-icono.


            IF i_listado-total &gt; 0.
              zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc = &apos;VERDE&apos;
                                          CHANGING tabla_color = i_listado-color ).
            ELSEIF i_listado-estado = &apos;B&apos;.
              zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc = &apos;ROJO&apos;
                                          CHANGING tabla_color = i_listado-color ).
            ELSEIF i_listado-estado = &apos;O&apos;.
              zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc = &apos;NARANJA&apos;
                                          CHANGING tabla_color = i_listado-color ).
            ELSEIF i_listado-estado = &apos;M&apos;.
              zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc = &apos;AMARILLO&apos;
                                          CHANGING tabla_color = i_listado-color ).
            ENDIF.

            SELECT SINGLE tcode FROM zdocumentos
              INTO l_tcode
             WHERE tcode = i_listado-name.
            IF sy-subrc NE 0 AND i_listado-grupo NE &apos;&apos;.
              SELECT SINGLE tcode FROM zdocumentos
                INTO l_tcode
               WHERE tcode = i_listado-grupo.
            ENDIF.
            IF sy-subrc = 0.
              i_listado-doc = &apos;@DK@&apos;.
            ENDIF.

            SELECT SINGLE comentarios FROM zbc003t
              INTO i_listado-comentarios
             WHERE name  = i_listado-name
               AND tcode = i_listado-tcode.
            MODIFY i_listado.
          ENDLOOP.

          LOOP AT i_listado WHERE udat IS INITIAL
                              AND NOT cdat IS INITIAL.
            i_listado-udat = i_listado-cdat.
            i_listado-unam = i_listado-cnam.
            MODIFY i_listado.
          ENDLOOP.

          DELETE i_listado WHERE NOT estado IN s_estado.
          DELETE i_listado WHERE NOT asignado_a IN s_asign.
          DELETE i_listado WHERE NOT procesado_por IN s_progr.

          DELETE i_listado WHERE NOT cnam IN s_cnam OR
                                 NOT cdat IN s_cdat OR
                                 NOT unam IN s_unam OR
                                 NOT udat IN s_udat.

          IF p_vivas = &apos;X&apos;.
            DELETE i_listado WHERE NOT ( ( cnam = sy-uname OR unam = sy-uname ) ).

            DELETE i_listado WHERE NOT  ( cdat &gt;= v_fechas_vivas OR udat &gt;= v_fechas_vivas ).
          ENDIF.

          IF p_lib = &apos;X&apos;.
            DELETE i_listado WHERE libreria = &apos;&apos;.
          ENDIF.

          IF p_solom = &apos;X&apos;.
            DATA: l_nombre TYPE string,
                  l_fecha  TYPE d.
            LOOP AT i_listado.
              REPLACE ALL OCCURRENCES OF &apos;/&apos; IN i_listado-name WITH &apos;_&apos;.
              CONCATENATE i_listado-object i_listado-name INTO l_nombre SEPARATED BY &apos;_&apos;.

              IF p_lib IS INITIAL.
                l_fecha = i_listado-udat.
              ELSE.
* Quiero asegurarme de que se verifica si se ha modificado en el plazo de un mes
                l_fecha = i_listado-udat + 30.
                CONCATENATE l_nombre &apos;.TXT&apos; INTO l_nombre.
              ENDIF.
              IF l_fecha &lt; sy-datum.
                LOOP AT i_ficheros WHERE filename CS l_nombre
                                     AND writedate &gt; l_fecha.
                  EXIT.
                ENDLOOP.
                IF sy-subrc = 0.
* Sólo si el fichero no se ha modificado en el últimos
                  ADD 30 TO i_ficheros-writedate.
                  IF i_ficheros-writedate &lt; sy-datum.
                    DELETE i_listado.
                  ENDIF.
                ENDIF.
              ENDIF.
            ENDLOOP.
          ENDIF.


          IF p_lib = &apos;X&apos;.
            zcl_ap_sgpi=&gt;text( &apos;Comparando ficheros&apos; ).
            PERFORM comparar_ficheros.
          ENDIF.

          i_list_orig[] = i_listado[].

ENDFORM.                    &quot; SELECCIONAR_DATOS

*&amp;---------------------------------------------------------------------*
*&amp;      Form  icono_status
*&amp;---------------------------------------------------------------------*
FORM icono_status USING    pe_estado
                CHANGING   ps_icono.

  CASE pe_estado.
    WHEN &apos;B&apos;.  &quot;Borrar
      ps_icono = &apos;@11@&apos;.
    WHEN &apos;C&apos;.  &quot;Critico
      ps_icono = &apos;@8R@&apos;.
    WHEN &apos;O&apos;.  &quot;Obsoleto
      ps_icono = &apos;@K0@&apos;.
    WHEN &apos;?&apos;.  &quot;Duda
      ps_icono = &apos;@8Q@&apos;.
    WHEN &apos;M&apos;.
      ps_icono = &apos;@1D@&apos;.
    WHEN &apos;A&apos;.
      ps_icono = &apos;@0V@&apos;.
    WHEN &apos;N&apos;.
      ps_icono = &apos;@1M@&apos;.
    WHEN &apos;Q&apos;.
      ps_icono = &apos;@3W@&apos;.
    WHEN &apos;R&apos;.
      ps_icono = &apos;@6T@&apos;.
  ENDCASE.

ENDFORM.                    &quot; icono_status

*&amp;---------------------------------------------------------------------*
*&amp;      Form  editar_nota
*&amp;---------------------------------------------------------------------*
FORM editar_nota USING pe_name pe_tcode.
  DATA: l_titulo(80),
        i_zbc003t    LIKE zbc003t OCCURS 0 WITH HEADER LINE,
        i_lineas     LIKE zbc003t-comentarios OCCURS 0 WITH HEADER LINE.

  SELECT * FROM zbc003t
    INTO TABLE i_zbc003t
   WHERE name  = pe_name
     AND tcode = pe_tcode.

  LOOP AT i_zbc003t.
    i_lineas = i_zbc003t-comentarios.
    APPEND i_lineas.
  ENDLOOP.

  CONCATENATE &apos;Notas report&apos; pe_name pe_tcode
              INTO l_titulo SEPARATED BY space.
  CALL FUNCTION &apos;TERM_CONTROL_EDIT&apos;
    EXPORTING
      titel          = l_titulo
      langu          = sy-langu
    TABLES
      textlines      = i_lineas
    EXCEPTIONS
      user_cancelled = 1
      OTHERS         = 2.
  IF sy-subrc = 0.
    DELETE FROM zbc003t
     WHERE name  = pe_name
       AND tcode = pe_tcode.
    LOOP AT i_lineas.
      CLEAR zbc003t.
      zbc003t-name        = pe_name.
      zbc003t-tcode       = pe_tcode.
      zbc003t-linea       = sy-tabix.
      zbc003t-comentarios = i_lineas.
      MODIFY zbc003t.
    ENDLOOP.
  ENDIF.
*  endif.

ENDFORM.                    &quot; editar_nota
*&amp;---------------------------------------------------------------------*
*&amp;      Form  descargar_slnk
*&amp;---------------------------------------------------------------------*
FORM descargar_slnk USING pe_mail.
  DATA: xml      TYPE string,
        _objname TYPE string.

  DATA  errorflag    TYPE flag.
  DATA  deffilename  TYPE string.
  DATA  deffilename2 TYPE string.
  DATA  deffilename3 TYPE string.
  DATA  izip         TYPE REF TO cl_abap_zip.
  DATA  zip_file     TYPE xstring.
  DATA: l_string     TYPE string,
        l_xstring    TYPE xstring,
        v_dif(50),
        l_nombre(80),
        l_smartf     TYPE tdsfname,
        l_no.

  CHECK i_listado-object NE &apos;&apos;.                       &quot;APC03112010

  CLEAR v_dif.
  IF sy-ucomm = &apos;COMPARAR&apos;.
    CONCATENATE &apos;___DIF_&apos; zcl_c=&gt;empresa INTO v_dif.
  ELSEIF pe_mail = &apos;B&apos;.
    IF sy-ucomm = &apos;MACHACAR&apos;.
      CONCATENATE &apos;__DESCARGA_&apos; zcl_c=&gt;empresa &apos;_&apos; sy-datum &apos;_&apos; sy-uzeit INTO v_dif.
    ELSE.
      CONCATENATE &apos;__BACKUP_&apos; zcl_c=&gt;empresa &apos;_&apos; sy-datum &apos;_&apos; sy-uzeit INTO v_dif.
    ENDIF.
  ENDIF.


  CASE i_listado-object.
    WHEN &apos;PROG&apos;.
      IF i_listado-subc = &apos;P&apos;.
        _objname = i_listado-ttext.
        CONCATENATE i_listado-ttext &apos;_&apos; i_listado-text INTO i_listado-text.
      ELSEIF i_listado-subc = &apos;A&apos; OR i_listado-subc = &apos;+&apos;.
        _objname = i_listado-tcode.
      ELSE.
        _objname = i_listado-name.
      ENDIF.
    WHEN &apos;CLAS&apos;.
      IF i_listado-subc = &apos;B&apos;.                          &quot;APC03112010
        _objname = i_listado-ttext.
      ELSE.
        _objname = i_listado-name.
      ENDIF.
    WHEN &apos;TABL&apos; OR &apos;VIEW&apos;.
      _objname = i_listado-name.
    WHEN &apos;TTYP&apos; OR &apos;DOMA&apos; OR &apos;DTEL&apos;.
      _objname = i_listado-name.
    WHEN &apos;FUGR&apos;.
      _objname = i_listado-ttext.
    WHEN &apos;SSFO&apos; OR &apos;FORM&apos;.
      _objname = i_listado-name.
    WHEN &apos;WAPA&apos; OR &apos;WDYA&apos; OR &apos;WDYN&apos; OR &apos;WDCA&apos; OR &apos;WDCC&apos;.
      _objname = i_listado-name.
    WHEN &apos;ENHO&apos; OR &apos;ENHS&apos;.
      _objname = i_listado-name.
    WHEN &apos;SFPF&apos; OR &apos;SFPI&apos;.
      _objname = i_listado-name.
    WHEN &apos;SMIM&apos;.
      _objname = i_listado-text.
    WHEN &apos;SHLP&apos;.
      EXIT.
    WHEN &apos;XSLT&apos;.
      _objname = i_listado-name.
  ENDCASE.


  IF i_listado-object NE &apos;FORM&apos; AND i_listado-object NE &apos;SFPF&apos;.
    CLEAR l_no.
    IF i_listado-object = &apos;FUGR&apos;.
      IF pe_mail IS INITIAL.
        READ TABLE i_grupof WITH KEY table_line = _objname TRANSPORTING NO FIELDS.
        IF sy-subrc = 0.
          l_no = &apos;X&apos;.
        ENDIF.
      ENDIF.
    ENDIF.
    IF l_no IS INITIAL.
      xml = zcl_ap_dev=&gt;get_saplink_xml( object = i_listado-object
                                         nombre = _objname ).
      IF xml IS INITIAL.
        MESSAGE i398(00) WITH &apos;Install plugin for object type:&apos; i_listado-object _objname.
      ENDIF.
    ENDIF.
  ENDIF.

  l_string = i_listado-text.
  CALL METHOD zcl_ap_string=&gt;limpiar_nombre_fichero
    CHANGING
      string = l_string.
  i_listado-text = l_string.

  IF pe_mail = &apos;X&apos; OR p_ftp = &apos;X&apos;.
    IF p_lib = &apos;X&apos;.
      CONCATENATE i_listado-object &apos;_&apos; _objname
                 v_dif
                 &apos;.slnk&apos; INTO deffilename.
    ELSE.
      CONCATENATE i_listado-object &apos;_&apos; _objname &apos;_&apos;
                 i_listado-text
                 v_dif
                 &apos;.slnk&apos; INTO deffilename.
    ENDIF.
    IF p_zip = &apos;X&apos;.
      CREATE OBJECT izip.
      l_xstring = zcl_ap_string=&gt;string2xstring( xml ).
      izip-&gt;add( name = deffilename
                 content = l_xstring ).
    ENDIF.
  ENDIF.

  IF p_lib IS INITIAL AND i_listado-object NE &apos;FUGR&apos;.
    CONCATENATE v_directorio &apos;\&apos;
               i_listado-object &apos;_&apos; _objname &apos;_&apos;
               i_listado-text
               v_dif
               &apos;.slnk&apos; INTO deffilename.
  ELSE.
    CONCATENATE v_directorio &apos;\&apos;
               i_listado-object &apos;_&apos; _objname
               v_dif
               &apos;.slnk&apos; INTO deffilename.
  ENDIF.
  REPLACE &apos;\\&apos; WITH &apos;\&apos; INTO deffilename.
  CLEAR errorflag.

  REPLACE ALL OCCURRENCES OF &apos;/&apos; IN  deffilename WITH &apos;_&apos;.

  IF pe_mail NE &apos;V&apos;.
    IF pe_mail = &apos;B&apos;.
      REPLACE &apos;\LIB&apos; WITH &apos;\LIB_BACKUP&apos; INTO deffilename.
    ENDIF.
    IF i_listado-object = &apos;SFPF&apos;.
      PERFORM descargar_sfp USING deffilename _objname.
    ELSEIF i_listado-object NE &apos;FORM&apos;.
      CLEAR l_no.
      IF i_listado-object = &apos;FUGR&apos;.
        IF pe_mail IS INITIAL.
          READ TABLE i_grupof WITH KEY table_line = _objname TRANSPORTING NO FIELDS.
          IF sy-subrc = 0.
            l_no = &apos;X&apos;.
          ELSE.
            APPEND _objname TO i_grupof.
          ENDIF.
        ENDIF.
      ENDIF.
      IF l_no IS INITIAL.
        PERFORM putonmachine USING deffilename xml.
        IF errorflag IS NOT INITIAL.
          MESSAGE s208(00) WITH TEXT-005.
          EXIT.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDIF.

  DATA:  i_tabla(255) OCCURS 0.
  l_nombre = _objname.

  IF i_listado-object = &apos;SSFO&apos;.
    CONCATENATE l_nombre &apos;&apos; INTO l_smartf.
    CALL FUNCTION &apos;FB_DOWNLOAD_FORM&apos;
      EXPORTING
        i_formname           = l_smartf
        i_formtype           = &apos; &apos;
        i_with_dialog        = &apos;&apos;
*     IMPORTING
*       O_FORMNAME           =
      EXCEPTIONS
        no_name              = 1
        no_form              = 2
        no_access_permission = 3
        illegal_language     = 4
        illegal_formtype     = 5
        OTHERS               = 6.
    IF sy-subrc &lt;&gt; 0.
      MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
              WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    ENDIF.
*
*    DATA o_bi TYPE REF TO zcl_batch_input.
*    DATA l_mensaje TYPE bapireturn1-message.
*    CREATE OBJECT o_bi.
*
*    o_bi-&gt;inicio( ).
*
** SAP Smart Forms: Initial screen
*    o_bi-&gt;dynpro( program = &apos;SAPMSSFO&apos; dynpro = &apos;0100&apos;).
*    o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=XMLDOWN&apos;).
*
** Smart Forms: Determine form name (create, change, ...)
*    o_bi-&gt;dynpro( program = &apos;SAPLSTXB&apos; dynpro = &apos;3000&apos;).
*    o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=ENTER&apos;).
*    l_smartf = l_nombre.
*    o_bi-&gt;campos( campo = &apos;SSFSCREEN-FNAME&apos; valor = l_smartf ). &quot; Smart Forms: Nombre formulario
*
** SAP Smart Forms: Initial screen
*    o_bi-&gt;dynpro( program = &apos;SAPMSSFO&apos; dynpro = &apos;0100&apos;).
*    o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=BACK&apos;).
*    o_bi-&gt;campos( campo = &apos;RB_SF&apos; valor = &apos;X&apos;).
*
*    CONCATENATE v_directorio &apos;\&apos;
*               i_listado-object &apos;_&apos;
*               i_listado-name &apos;_&apos;
*               i_listado-text
*               v_dif
*               &apos;.xml&apos; INTO deffilename2.
*
*    o_bi-&gt;campos( campo = &apos;SSFSCREEN-FNAME&apos; valor = deffilename2 ). &quot; Smart Forms: Nombre formulario
*
*    l_mensaje = o_bi-&gt;llamar_transaccion( tcode = &apos;SMARTFORMS&apos; modo = &apos;A&apos;).
  ELSEIF i_listado-object = &apos;FORM&apos;.
    CONCATENATE v_directorio &apos;\&apos;
               i_listado-object &apos;_&apos;
               i_listado-name
               &apos;.txt&apos; INTO deffilename3.
    SUBMIT rstxscrp  WITH obj_name = _objname
                     WITH dataset  = deffilename3
     EXPORTING LIST TO MEMORY
      AND RETURN.
  ELSEIF i_listado-object = &apos;FUGR&apos;.
    i_tabla = zcl_ap_dev=&gt;get_objeto_como_texto( tipo = i_listado-object
                                                 nombre = i_listado-name ).
  ELSEIF i_listado-object = &apos;SFPF&apos;.
  ELSE.
    i_tabla = zcl_ap_dev=&gt;get_objeto_como_texto( tipo = i_listado-object
                                                 nombre = l_nombre ).
  ENDIF.

  IF NOT i_tabla[] IS INITIAL.

    IF pe_mail = &apos;V&apos;.
      DATA: l_version TYPE string,
            zbc003v   TYPE zbc003v.
      CALL METHOD zcl_ap_string=&gt;tabla2string
        EXPORTING
          tabla  = i_tabla[]
        RECEIVING
          string = l_version.

      CLEAR zbc003v.
      MOVE-CORRESPONDING i_listado TO zbc003v.
      zbc003v-fecha  = sy-datum.
      zbc003v-hora   = sy-uzeit.
      zbc003v-string = l_version.
      MODIFY zbc003v FROM zbc003v.

    ELSE.
      IF p_lib IS INITIAL.
        CONCATENATE v_directorio &apos;\&apos;
                   i_listado-object &apos;_&apos;
                   i_listado-name &apos;_&apos;
                   i_listado-text
                   v_dif
                   &apos;.txt&apos; INTO deffilename2.
      ELSE.
        CONCATENATE v_directorio &apos;\&apos;
                   i_listado-object &apos;_&apos;
                   i_listado-name
                   v_dif
                   &apos;.txt&apos; INTO deffilename2.

        CONCATENATE v_directorio &apos;\&apos;
                   i_listado-object &apos;_&apos;
                   i_listado-name
                   &apos;.txt&apos; INTO deffilename3.
      ENDIF.

      IF pe_mail = &apos;B&apos;.
        REPLACE &apos;\LIB&apos; WITH &apos;\LIB_BACKUP&apos; INTO deffilename2.
        REPLACE &apos;\LIB&apos; WITH &apos;\LIB_BACKUP&apos; INTO deffilename3.
      ENDIF.

      REPLACE ALL OCCURRENCES OF &apos;/&apos; IN  deffilename2 WITH &apos;_&apos;.
      REPLACE ALL OCCURRENCES OF &apos;/&apos; IN  deffilename3 WITH &apos;_&apos;.

      zcl_ap_ficheros=&gt;grabar( EXPORTING fichero = deffilename2
                                         mostrar_error = &apos;I&apos;
                               CHANGING tabla = i_tabla ).


      IF sy-ucomm = &apos;COMPARAR&apos;.
        DATA: l_comando TYPE string.

        CONCATENATE &apos;&quot;&apos; deffilename2 &apos;&quot;&apos; INTO deffilename2.
        CONCATENATE &apos;&quot;&apos; deffilename3 &apos;&quot;&apos; INTO deffilename3.

        CONCATENATE deffilename2 deffilename3
               INTO l_comando SEPARATED BY space.
        CALL FUNCTION &apos;WS_EXECUTE&apos;
          EXPORTING
*           program            = &apos;C:\WINDOWS\UEDIT32.EXE&apos;
            program            = v_ruta_comparador
            commandline        = l_comando
            inform             = &apos; &apos;
          EXCEPTIONS
            frontend_error     = 1
            no_batch           = 2
            prog_not_found     = 3
            illegal_option     = 4
            gui_refuse_execute = 5
            OTHERS             = 6.
      ENDIF.
    ENDIF.
  ENDIF.

  IF pe_mail NE &apos;V&apos;.
    IF pe_mail = &apos;X&apos; OR p_ftp = &apos;X&apos;.
      IF p_zip = &apos;X&apos;.
        CONCATENATE _objname &apos;_&apos;
                   i_listado-text
                   &apos;.txt&apos; INTO deffilename2.
        l_string  = zcl_ap_string=&gt;tabla2string( i_tabla ).
        l_xstring = zcl_ap_string=&gt;string2xstring( l_string ).


        DATA binary_tab TYPE STANDARD TABLE OF x255.
        CALL FUNCTION &apos;SCMS_XSTRING_TO_BINARY&apos;
          EXPORTING
            buffer     = zip_file
          TABLES
            binary_tab = binary_tab.

        CONCATENATE v_directorio &apos;\&apos;
                   _objname &apos;_&apos;
                   i_listado-text
                   v_dif
                   &apos;.zip&apos; INTO deffilename2.

        zcl_ap_ficheros=&gt;grabar( EXPORTING fichero = deffilename2
                                        tipo = &apos;BIN&apos;
                                         mostrar_error = &apos;I&apos;
                              CHANGING tabla = binary_tab ).
      ENDIF.

      DATA i_texto_mail LIKE solisti1 OCCURS 0 WITH HEADER LINE.
      REFRESH i_texto_mail.
      LOOP AT i_tabla INTO i_texto_mail.
        APPEND i_texto_mail.
      ENDLOOP.

      DATA i_ficheros LIKE tnotetem OCCURS 0 WITH HEADER LINE.
      IF v_no_se_adjunta_slnk IS INITIAL.
        IF p_zip IS INITIAL.
          i_ficheros-template = deffilename.
          APPEND i_ficheros.
          APPEND i_ficheros-template TO i_ficheros_ftp.
        ELSE.
          i_ficheros-template = deffilename2.
          APPEND i_ficheros.
          APPEND i_ficheros-template TO i_ficheros_ftp.
        ENDIF.
      ENDIF.

      IF pe_mail = &apos;X&apos;.
        CONCATENATE &apos;(&apos; zcl_c=&gt;empresa &apos;)&apos; i_listado-name &apos;-&apos;
                   i_listado-text INTO deffilename2.

        IF v_ans EQ &apos;J&apos;.
          DELETE i_ficheros WHERE template = &apos;&apos;.
          IF p_outlo IS INITIAL.
            CALL FUNCTION &apos;Z_ENVIO_MAIL&apos;
              EXPORTING
                subject    = deffilename2
                direccion  = v_emailaddr
                urgente    = &apos;X&apos;
                html       = &apos;&apos;
              TABLES
                texto      = i_texto_mail
                t_ficheros = i_ficheros.
          ELSE.
            PERFORM outlook TABLES i_ficheros i_texto_mail
                       USING v_emailaddr deffilename2.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDIF.


ENDFORM.                    &quot; descargar_slnk

*\--------------------------------------------------------------------/


*/------------------------putOnMachine--------------------------------\
FORM putonmachine USING fullpath TYPE string xmlstring TYPE string.

  TRY.
      TRY.
          zcl_ap_ficheros=&gt;grabar_xstring(  EXPORTING fichero = fullpath
                                                           mostrar_error = &apos;I&apos;
                                                           string = xmlstring ).
          CLEAR v_no_se_adjunta_slnk.
        CATCH cx_root.
          v_no_se_adjunta_slnk = &apos;X&apos;.
      ENDTRY.
    CATCH cx_root.
      v_no_se_adjunta_slnk = &apos;X&apos;.
  ENDTRY.

ENDFORM.                    &quot;putonmachine

*&amp;---------------------------------------------------------------------*
*&amp;      Form  outlook
*&amp;---------------------------------------------------------------------*

FORM outlook TABLES email_attachments STRUCTURE tnotetem
                    email_body STRUCTURE  solisti1
              USING email_address subject.
  DATA: g_file(120),
        g_translate(2),
        t_vbs             LIKE STANDARD TABLE OF soli WITH HEADER LINE,
        g_last,
        g_vbs_filename    LIKE rlgrap-filename,
        commandline(1000).

*- Prepare a code to translate a quote into a hex-tab
*- so it can then be translated back to 2 double quotes.
  CONCATENATE &apos;&quot;&apos; cl_abap_char_utilities=&gt;cr_lf+1(1) INTO g_translate.


  APPEND: &apos;Dim myolapp &apos; TO t_vbs,
      &apos;Dim olNamespace &apos; TO t_vbs,
      &apos;Dim myItem &apos; TO t_vbs,
      &apos;Dim myRecipient &apos; TO t_vbs,
      &apos;Dim myAttachments &apos; TO t_vbs,
      &apos; &apos; TO t_vbs,
      &apos;Set myolapp = CreateObject(&quot;Outlook.Application&quot;) &apos; TO t_vbs,
      &apos;Set olNamespace = myolapp.GetNamespace(&quot;MAPI&quot;) &apos; TO t_vbs,
      &apos;Set myItem = myolapp.CreateItem(olMailItem) &apos; TO t_vbs,
      &apos; &apos; TO t_vbs.

*- Destinatarios del mensaje
*  LOOP AT email_address.
*   IF email_address = space. CONTINUE. ENDIF.
  CONCATENATE
    &apos;Set myRecipient = myItem.Recipients.Add(&quot;&apos; email_address &apos;&quot;)&apos;
    INTO t_vbs.
  APPEND t_vbs.
*  ENDLOOP.

*- Asunto del mensaje
  CONCATENATE &apos;myItem.Subject = &quot;&apos; subject &apos;&quot;&apos; INTO t_vbs.
  APPEND t_vbs.

*- Ficheros adjuntos
  APPEND:
    &apos;Set myAttachments = myItem.Attachments&apos; TO t_vbs.

*- Chequeamos la existencia de los ficheros adjuntos
  LOOP AT email_attachments.

    g_file = email_attachments-template.

    CALL FUNCTION &apos;WS_QUERY&apos;
      EXPORTING
        filename       = g_file
        query          = &apos;FE&apos;
      EXCEPTIONS
        inv_query      = 1
        no_batch       = 2
        frontend_error = 3
        OTHERS         = 4.
    IF sy-subrc EQ 0.
      CONCATENATE &apos;myAttachments.Add(&quot;&apos; email_attachments-template &apos;&quot;)&apos;
      INTO t_vbs.
      APPEND t_vbs.
    ELSE.
      MESSAGE i000(38) WITH
        &apos;No se ha podido adjuntar el fichero&apos; email_attachments.
    ENDIF.
  ENDLOOP.

*- Cuerpo del email
  CLEAR: g_last, t_vbs.
  APPEND t_vbs.
  LOOP AT email_body.
    AT FIRST.
      APPEND &apos;myitem.body = _&apos; TO t_vbs.
    ENDAT.
    AT LAST.
      g_last = &apos;X&apos;.
    ENDAT.

*- Double-quotes(&quot;) will cause an error in VBScript
*- Replace with a hex-tab and then replace with
*- 2 double-quotes (&quot;&quot;)
    TRANSLATE email_body USING g_translate.
    WHILE sy-subrc EQ 0.
      REPLACE cl_abap_char_utilities=&gt;cr_lf+1(1)
            WITH &apos;&quot;&quot;&apos; INTO email_body.
    ENDWHILE.

    IF g_last = &apos;X&apos;.
      CONCATENATE &apos;&quot;&apos; email_body &apos;&quot; &amp;vbCrLf &apos;
      INTO t_vbs.
    ELSE.
      CONCATENATE &apos;&quot;&apos; email_body &apos;&quot; &amp;vbCrLf &amp;_&apos;
      INTO t_vbs.
    ENDIF.
    APPEND t_vbs.
  ENDLOOP.

*  APPEND &apos;myItem.Display&apos; TO t_vbs.
  APPEND &apos;myItem.Send&apos; TO t_vbs.

*- Preparamos el nombre de fichero vbscript para descargarlo
*- y ejecutarlo, llamando a la variable de entorno de Windows
*- TEMP
  CLEAR g_vbs_filename.
  CALL FUNCTION &apos;WS_QUERY&apos;
    EXPORTING
      environment    = &apos;TEMP&apos;
      query          = &apos;EN&apos;
    IMPORTING
      return         = g_vbs_filename
    EXCEPTIONS
      inv_query      = 1
      no_batch       = 2
      frontend_error = 3
      OTHERS         = 4.

  CONCATENATE g_vbs_filename &apos;mail.vbs&apos; INTO g_vbs_filename.
  commandline = g_vbs_filename.

  PERFORM sapgui_progress(rstxldmc) USING 10
    &apos;Realizando download de fichero...&apos;.


  DATA: l_string TYPE string.
  l_string = g_vbs_filename.

*- Descargamos el fichero vbscript
  zcl_ap_ficheros=&gt;grabar( EXPORTING fichero = l_string

                        CHANGING tabla = t_vbs[] ).

* Abrimos el Outlook
  PERFORM sapgui_progress(rstxldmc) USING 50
    &apos;Abriendo Outlook... Espere por favor&apos;.

  CALL FUNCTION &apos;WS_EXECUTE&apos;
    EXPORTING
      commandline    = commandline
      program        = &apos;WSCRIPT.EXE&apos;
    EXCEPTIONS
      frontend_error = 1
      no_batch       = 2
      prog_not_found = 3
      illegal_option = 4
      OTHERS         = 5.


  MESSAGE s000(38) WITH &apos;Abriendo Outlook... Espere por favor&apos;.
  WAIT UP TO 5 SECONDS.

ENDFORM.                    &quot;outlook

*&amp;---------------------------------------------------------------------*
*&amp;      Form  copy_ftp
*&amp;---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM copy_ftp.
  DATA: o_ftp TYPE REF TO zcl_ap_ftp.

  CREATE OBJECT o_ftp.

  o_ftp-&gt;connect( user = &apos;sap4abap&apos; password = &apos;B5DC3B26771B&apos; host =
  &apos;sap4.com&apos; ).

  IF NOT o_ftp-&gt;error_conexion IS INITIAL.
    MESSAGE &apos;Error de conexión&apos; TYPE &apos;E&apos;.
  ELSE.
    IF o_ftp-&gt;cd( &apos;lib&apos; ) = &apos;X&apos;.

      IF NOT zcl_c=&gt;empresa IS INITIAL.
        IF o_ftp-&gt;cd( zcl_c=&gt;empresa ) = &apos;&apos;.
          MESSAGE e398(00) WITH &apos;Error al cambiar a dir.FTP&apos;
                                 zcl_c=&gt;empresa.
        ENDIF.
      ENDIF.

      LOOP AT i_ficheros_ftp.
        IF o_ftp-&gt;put( i_ficheros_ftp ) = &apos;&apos;.
          WRITE / o_ftp-&gt;mensaje_error.
        ENDIF.
      ENDLOOP.
    ENDIF.

    o_ftp-&gt;disconnect( ).

  ENDIF.

ENDFORM.                    &quot;copy_ftp
*&amp;---------------------------------------------------------------------*
*&amp;      Form  COMPARAR_FICHEROS
*&amp;---------------------------------------------------------------------*
FORM comparar_ficheros .
  DATA: l_nombrefichero TYPE string.
  DATA: i_tabla(255)  OCCURS 0,
        l_tabla(255),
        i_tabla2(255) OCCURS 0 WITH HEADER LINE,
        i_ficheros    TYPE TABLE OF file_info WITH HEADER LINE,
        l_aux1        TYPE string,
        l_aux2        TYPE string.

  i_ficheros[] = zcl_ap_ficheros=&gt;lista_ficheros( v_directorio ).
  LOOP AT i_ficheros.
    TRANSLATE i_ficheros-filename TO UPPER CASE.         &quot;#EC TRANSLANG
    MODIFY i_ficheros.
  ENDLOOP.

  LOOP AT i_listado.
    CLEAR: i_tabla, i_tabla2.
    REFRESH: i_tabla, i_tabla2.

    CONCATENATE v_directorio &apos;\&apos;
                i_listado-object &apos;_&apos;
               i_listado-name
               &apos;.txt&apos; INTO l_nombrefichero.
    TRANSLATE l_nombrefichero TO UPPER CASE.

    CLEAR i_ficheros.
    READ TABLE i_ficheros WITH KEY filename = l_nombrefichero.
    IF sy-subrc = 0.
      zcl_ap_ficheros=&gt;leer( EXPORTING fichero = l_nombrefichero
                                    mostrar_error = &apos;&apos;
                          CHANGING  tabla = i_tabla[] ).
    ENDIF.

    IF i_tabla IS INITIAL.
      i_listado-icono    = &apos;@LR@&apos;.  &quot;BAJAR
      i_listado-libreria = &apos;N&apos;.
    ELSE.
      zcl_ap_dev=&gt;texto_comparable( CHANGING i_tabla = i_tabla[] ).

      LOOP AT i_tabla INTO l_tabla.
        IF l_tabla CS &apos;type-pools&apos; OR l_tabla CS &apos;TYPE_POOLS&apos;.
          DELETE i_tabla.
        ELSEIF l_tabla CS &apos;&quot;&apos;.
          SPLIT l_tabla AT &apos;&quot;&apos; INTO l_aux1 l_aux2.
          l_tabla = l_aux1.
          MODIFY i_tabla FROM l_tabla.
        ELSEIF l_tabla CS &apos;##NO_TEXT.&apos;.
          REPLACE &apos; ##NO_TEXT.&apos; IN l_tabla WITH &apos;.&apos;.
          MODIFY i_tabla FROM l_tabla.
        ENDIF.
      ENDLOOP.

      DESCRIBE TABLE i_tabla LINES i_listado-nlinlib.
      i_tabla2[] = zcl_ap_dev=&gt;get_objeto_como_texto( tipo = i_listado-object
                                                      nombre = i_listado-name
                                                      modo = &apos;C&apos; ).

      LOOP AT i_tabla2 INTO l_tabla.
        IF l_tabla CS &apos;type-pools&apos; OR l_tabla CS &apos;TYPE_POOLS&apos;.
          DELETE i_tabla2.
        ELSEIF l_tabla CS &apos;&quot;&apos;.
          SPLIT l_tabla AT &apos;&quot;&apos; INTO l_aux1 l_aux2.
          l_tabla = l_aux1.
          MODIFY i_tabla2 FROM l_tabla.
        ELSEIF l_tabla CS &apos;##NO_TEXT.&apos;.
          REPLACE &apos; ##NO_TEXT.&apos; IN l_tabla WITH &apos;.&apos;.
          MODIFY i_tabla2 FROM l_tabla.
        ENDIF.
      ENDLOOP.

      DESCRIBE TABLE i_tabla2 LINES i_listado-nlinact.

      i_listado-icono = &apos;@20@&apos;.
      IF i_listado-nlinlib NE i_listado-nlinact.
        i_listado-icono = &apos;@2B@&apos;.
      ELSE.
        LOOP AT i_tabla INTO l_tabla.
          CLEAR i_tabla2.
          READ TABLE i_tabla2 INDEX sy-tabix.
          CONDENSE l_tabla NO-GAPS.
          TRANSLATE l_tabla TO UPPER CASE.
          CONDENSE i_tabla2 NO-GAPS.
          TRANSLATE i_tabla2 TO UPPER CASE.
          IF l_tabla NE i_tabla2.
            i_listado-icono = &apos;@2B@&apos;.
            EXIT.
          ENDIF.
        ENDLOOP.
      ENDIF.

      IF i_listado-icono = &apos;@2B@&apos;.
        DATA: abaptext_delta LIKE vxabapt255 OCCURS 0 WITH HEADER LINE.

        abaptext_delta[] = zcl_ap_dev=&gt;comparar_reports(
                                             tabla1 = i_tabla2[]
                                             tabla2 = i_tabla[] ).

        LOOP AT abaptext_delta.
          CLEAR i_cambios.
          MOVE-CORRESPONDING abaptext_delta TO i_cambios.
          i_cambios-name = i_listado-name.
          APPEND i_cambios.
        ENDLOOP.

        IF i_listado-nlinact &gt; i_listado-nlinlib AND
           i_listado-udat &gt;= i_ficheros-writedate.
          i_listado-icono = &apos;@LR@&apos;.                      &quot;BAJAR
        ELSEIF i_listado-nlinact &lt; i_listado-nlinlib AND
          i_listado-udat &lt;= i_ficheros-writedate.
          i_listado-icono = &apos;@LS@&apos;.                      &quot;SUBIR
        ENDIF.
      ENDIF.
    ENDIF.

    IF p_solom = &apos;&apos; OR i_listado-icono NE &apos;@20@&apos;.
      MODIFY i_listado.
    ELSE.
      DELETE i_listado.
    ENDIF.

  ENDLOOP.

ENDFORM.                    &quot; COMPARAR_FICHEROS
*&amp;---------------------------------------------------------------------*
*&amp;      Form  SUBIR_LIB
*&amp;---------------------------------------------------------------------*
FORM subir_lib .
  DATA: l_file(300),
        l_tipo(4),
        isslinkee.

  PERFORM get_tipo USING i_listado-subc i_listado-name
                  CHANGING l_tipo.

  CONCATENATE v_directorio &apos;\&apos; l_tipo &apos;_&apos; i_listado-name &apos;.slnk&apos;
         INTO l_file.

  isslinkee = &apos;X&apos;.
  EXPORT isslinkee TO MEMORY ID &apos;ISSLNK&apos;.
  SUBMIT zsaplink
   AND RETURN
*   VIA SELECTION-SCREEN
   WITH filename = l_file
   WITH slpkg    = i_listado-devclass
   WITH overwr   = &apos;X&apos;.

  PERFORM cambiar_clase_desarrollo .

  DATA: l_object   TYPE e071-object,
        l_obj_name TYPE e071-obj_name.

  l_object   = l_tipo.
  l_obj_name = i_listado-name.
  zcl_ap_dev=&gt;activar_objeto( object = l_object
                              obj_name = l_obj_name ).


ENDFORM.                    &quot; SUBIR_LIB
*&amp;---------------------------------------------------------------------*
*&amp;      Form  GET_TIPO
*&amp;---------------------------------------------------------------------*
FORM get_tipo  USING    pe_subc pe_name
               CHANGING ps_tipo.

  CASE pe_subc.
    WHEN &apos;1&apos; OR &apos;I&apos; OR &apos;M&apos;.
      ps_tipo = &apos;PROG&apos;.
    WHEN &apos;C&apos;.
      ps_tipo = &apos;CLAS&apos;.
    WHEN &apos;T&apos; OR &apos;E&apos;.
      SELECT SINGLE * FROM dd02l
       WHERE tabname = pe_name.
      IF sy-subrc = 0.
        ps_tipo = &apos;TABL&apos;.
      ELSE.
        CLEAR ps_tipo.
      ENDIF.
    WHEN &apos;D&apos;.
      ps_tipo = &apos;TTYP&apos;.
    WHEN &apos;F&apos;.
      ps_tipo = &apos;FUGR&apos;.
  ENDCASE.

ENDFORM.                    &quot; GET_TIPO
*&amp;---------------------------------------------------------------------*
*&amp;      Form  CAMBIAR_CLASE_DESARROLLO
*&amp;---------------------------------------------------------------------*
FORM cambiar_clase_desarrollo .

  e071-obj_name = i_listado-name.
  zcl_ap_dev=&gt;popup_cambio_clase_desarrollo( object = i_listado-object
                                             obj_name = e071-obj_name
                                       devclass = i_listado-devclass ).

ENDFORM.                    &quot; CAMBIAR_CLASE_DESARROLLO
*&amp;---------------------------------------------------------------------*
*&amp;      Form  VER_VERSIONES
*&amp;---------------------------------------------------------------------*

CLASS lcl_alv_popup DEFINITION INHERITING FROM zcl_ap_alv.
  PUBLIC SECTION.
    DATA: i_versiones TYPE TABLE OF  zbc003v.

    METHODS: handle_double_click REDEFINITION.
    METHODS: handle_user_command REDEFINITION.
ENDCLASS.                    &quot;lcl_alv DEFINITION

*----------------------------------------------------------------------*
*       CLASS lcl_alv IMPLEMENTATION
*----------------------------------------------------------------------*
*
*----------------------------------------------------------------------*
CLASS lcl_alv_popup IMPLEMENTATION.
  METHOD handle_double_click.
    DATA: l_version TYPE zbc003v.

    READ TABLE i_versiones INTO l_version INDEX row.
    IF sy-subrc = 0.
      zcl_ap_string=&gt;editor_popup_string( l_version-string ).
    ENDIF.

  ENDMETHOD.                                         &quot;handle_double_click
  METHOD handle_user_command.
  ENDMETHOD.                                         &quot;handle_USER_COMMAND

ENDCLASS.                    &quot;lcl_alv IMPLEMENTATION

*&amp;---------------------------------------------------------------------*
*&amp;      Form  ver_versiones
*&amp;---------------------------------------------------------------------*

FORM ver_versiones .
  DATA: o_alv TYPE REF TO lcl_alv_popup.

  CREATE OBJECT o_alv
    EXPORTING
      tabla = &apos;&apos;.

  SELECT * FROM zbc003v
    INTO TABLE o_alv-&gt;i_versiones
   WHERE name = i_listado-name
     AND tcode = i_listado-tcode.

  o_alv-&gt;constructor_tabla( EXPORTING tabla = &apos;I_VERSIONES&apos;
                            CHANGING t_tabla = o_alv-&gt;i_versiones ).

  o_alv-&gt;show( ).

ENDFORM.                    &quot; VER_VERSIONES
*&amp;---------------------------------------------------------------------*
*&amp;      Form  ACTUALIZAR_REPOSITORIO
*&amp;---------------------------------------------------------------------*
FORM actualizar_repositorio .
  DATA: o_repo    TYPE REF TO zcl_ap_repo,
        l_repo    TYPE zap_repo,
        l_fichero TYPE string,
        l_cambio.

  CREATE OBJECT o_repo
    EXPORTING
      origen        = p_origen
      ruta_pc_local = v_directorio.

  o_repo-&gt;conexion( password = &apos;B5DC3B23704A7C&apos; ).

  LOOP AT i_listado WHERE marca = &apos;X&apos;.
    CLEAR l_cambio.
    READ TABLE o_repo-&gt;i_repo INTO l_repo WITH KEY object =
    i_listado-object
                                                   nombre =
                                                   i_listado-name.
    IF sy-subrc NE 0.
      CLEAR l_repo.
      MOVE-CORRESPONDING i_listado TO l_repo.
      l_repo-nombre      = i_listado-name.
      l_repo-descripcion = i_listado-text.
      APPEND l_repo TO o_repo-&gt;i_repo.
      l_cambio = &apos;X&apos;.
    ELSE.
      l_repo-udat = i_listado-udat.
      IF l_repo-udat NE i_listado-udat.
        l_repo-udat = i_listado-udat.
        l_cambio    = &apos;X&apos;.
        MODIFY o_repo-&gt;i_repo FROM l_repo INDEX sy-tabix.
      ENDIF.
    ENDIF.

    IF p_origen = &apos;F&apos;.
      CONCATENATE v_directorio &apos;\&apos;
                 i_listado-name &apos;.txt&apos;
                 INTO l_fichero.
      o_repo-&gt;actualizar_fichero( l_fichero ).

      CONCATENATE v_directorio &apos;\&apos;
                 i_listado-object &apos;_&apos; i_listado-name &apos;.slnk&apos;
                 INTO l_fichero.
      o_repo-&gt;actualizar_fichero( l_fichero ).
    ENDIF.
  ENDLOOP.

  o_repo-&gt;actualiza_indice_repo( ).

  o_repo-&gt;desconexion( ).

ENDFORM.                    &quot; ACTUALIZAR_REPOSITORIO
*&amp;---------------------------------------------------------------------*
*&amp;      Form  get_funcion
*&amp;---------------------------------------------------------------------*
FORM get_funcion  USING    pe_funcion.

  i_listado-subc  = &apos;F&apos;.
  i_listado-name  = pe_funcion.
  i_listado-text  = v_fdirt-stext.
  i_listado-tcode = &apos;SE37&apos;.
  i_listado-ttext = v_fdirt-area.

  SELECT SINGLE * FROM tfdir
   WHERE funcname = v_fdirt-funcname.
  CONCATENATE tfdir-pname+3 &apos;U&apos; tfdir-include INTO trdir-name.

  SELECT SINGLE cdat cnam udat unam FROM trdir
    INTO (i_listado-cdat, i_listado-cnam,
          i_listado-udat, i_listado-unam)
   WHERE name = trdir-name
       AND cnam IN s_cnam
       AND unam IN s_unam
       AND cdat IN s_cdat
       AND udat IN s_udat.
  IF sy-subrc = 0.
    SELECT SINGLE devclass FROM  tadir
      INTO i_listado-devclass
     WHERE pgmid = &apos;R3TR&apos;
       AND object = &apos;PROG&apos;
       AND obj_name   = trdir-name.
    IF sy-subrc = 0.
      IF p_numlin = &apos;X&apos;.
        READ REPORT trdir-name INTO i_source.
        DESCRIBE TABLE i_source LINES i_listado-numlin.
      ENDIF.
    ENDIF.
  ENDIF.
ENDFORM.                    &quot; get_funcion
*&amp;---------------------------------------------------------------------*
*&amp;      Module  USER_COMMAND_0100  INPUT
*&amp;---------------------------------------------------------------------*
MODULE user_command_0100 INPUT.
  DATA: l_ok,
        l_fila TYPE i.

  o_alv-&gt;comprobar_cambios( ).
  o_alv-&gt;get_filas_sel( ).
  l_fila = o_alv-&gt;get_fila_activa( ).

  LOOP AT i_listado.
    READ TABLE o_alv-&gt;i_filas_sel TRANSPORTING NO FIELDS WITH KEY index = sy-tabix.
    IF sy-subrc = 0.
      i_listado-marca = &apos;X&apos;.
    ELSE.
      CLEAR i_listado-marca.
    ENDIF.
    MODIFY i_listado.
  ENDLOOP.

  CASE sy-ucomm.
    WHEN &apos;BACK&apos;.
      LEAVE TO SCREEN 0.
    WHEN &apos;ENTER&apos;.

      LOOP AT i_listado.
        PERFORM icono_status USING i_listado-estado
                          CHANGING i_listado-icono.
        MODIFY i_listado.
      ENDLOOP.
      o_alv-&gt;refrescar_grid( ).
    WHEN &apos;GRABAR&apos;.
      LOOP AT i_listado.
        CLEAR i_list_orig.
        READ TABLE i_list_orig INDEX sy-tabix.
        IF i_listado NE i_list_orig.
          CLEAR zbc003.
          MOVE-CORRESPONDING i_listado TO zbc003.
          MODIFY zbc003.
        ENDIF.
      ENDLOOP.
      i_list_orig[] = i_listado[].
      MESSAGE &apos;Se han grabado los cambios&apos; TYPE &apos;S&apos;.
      LOOP AT i_listado.
        PERFORM icono_status USING i_listado-estado
                          CHANGING i_listado-icono.
        MODIFY i_listado.
      ENDLOOP.
      o_alv-&gt;refrescar_grid( ).
    WHEN &apos;NUEVAL&apos;.
      zcl_ap_popup=&gt;popup_usuario(
                            EXPORTING campo1 = &apos;TRDIR-NAME&apos;
                                campo2 = &apos;TSTC-TCODE&apos;
                                titulo = &apos;Prog.Modificado&apos;
                            IMPORTING return = l_ok
                            CHANGING
                                    valor1 = i_listado-name
                                    valor2 = i_listado-tcode ).
      IF l_ok = &apos;&apos;.
        i_listado-estado = &apos;M&apos;.
        APPEND i_listado.
      ENDIF.
      o_alv-&gt;refrescar_grid( ).

    WHEN &apos;TCODE&apos;.
      CLEAR tstc.
      zcl_ap_popup=&gt;popup_usuario(
                            EXPORTING campo1 = &apos;TSTC-TCODE&apos;
                                titulo = &apos;Ejecutar transacción&apos;
                            IMPORTING return = l_ok
                            CHANGING
                                    valor1 = tstc-tcode ).
      IF l_ok = &apos;&apos;.
        CALL TRANSACTION tstc-tcode.
      ENDIF.


    WHEN &apos;DESCARGAR&apos;.
      IF v_directorio IS INITIAL.
        CALL METHOD cl_gui_frontend_services=&gt;directory_browse
          EXPORTING
            window_title         = &apos;Selecciona un directorio&apos;
            initial_folder       = zcl_c=&gt;ruta_descarga_slnk
          CHANGING
            selected_folder      = v_directorio
          EXCEPTIONS
            cntl_error           = 1
            error_no_gui         = 2
            not_supported_by_gui = 3
            OTHERS               = 4.
      ENDIF.

      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        PERFORM descargar_slnk USING &apos;&apos;.
      ENDLOOP.
      IF sy-subrc = 0.
        IF p_vivas = &apos;X&apos;.
          zcl_ap_temp=&gt;set_st( clave = sy-tcode subclave = sy-uname valor1 = sy-datum ).
        ENDIF.
      ENDIF.
      IF p_ftp = &apos;X&apos;.
        PERFORM copy_ftp.
      ENDIF.

    WHEN &apos;COMPARAR&apos;.
      READ TABLE i_listado INDEX l_fila.
      IF sy-subrc = 0.
        PERFORM descargar_slnk USING &apos;&apos;.
      ENDIF.

    WHEN &apos;NVERSION&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        PERFORM descargar_slnk USING &apos;V&apos;.
      ENDLOOP.

    WHEN &apos;MACHACAR&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        CLEAR l_ok.
        IF i_listado-icono NE &apos;@LR@&apos; AND i_listado-icono NE &apos;@20@&apos;.
          l_ok = zcl_ap_popup=&gt;confirmar( titulo = &apos;Descargar objeto&apos;
              texto  = &apos;¿Está seguro de querer descargar el objeto?&apos;
              texto2 =  i_listado-name ).
          sy-ucomm = &apos;MACHACAR&apos;.
        ELSE.
          l_ok = &apos;X&apos;.
        ENDIF.

        IF l_ok = &apos;X&apos;.
          PERFORM descargar_slnk USING &apos;B&apos;..
          PERFORM descargar_slnk USING &apos;&apos;.
        ENDIF.
      ENDLOOP.

    WHEN &apos;VERSIONES&apos;.
      READ TABLE i_listado INDEX l_fila.
      IF sy-subrc = 0.
        PERFORM ver_versiones.
      ENDIF.

    WHEN &apos;SUBIR_LIB&apos;.
      IF p_lib = &apos;X&apos;.
        LOOP AT i_listado WHERE marca = &apos;X&apos;.
          CLEAR l_ok.
          IF i_listado-icono NE &apos;@LS@&apos;.                      &quot;BAJAR
            l_ok = zcl_ap_popup=&gt;confirmar( titulo = &apos;Subir objeto&apos;
                texto  = &apos;¿Está seguro de querer subir el objeto?&apos;
                texto2 =  i_listado-name ).
            sy-ucomm = &apos;SUBIR_LIB&apos;.
          ELSE.
            l_ok = &apos;X&apos;.
          ENDIF.

          IF l_ok = &apos;X&apos;.
            PERFORM descargar_slnk USING &apos;B&apos;.

            PERFORM subir_lib.
          ENDIF.
        ENDLOOP.
      ENDIF.

    WHEN &apos;WORD&apos;.
      RANGES r_tcode FOR sy-tcode.
      READ TABLE i_listado INDEX l_fila.
      IF sy-subrc = 0.
        IF i_listado-object = &apos;TABL&apos;.
          PERFORM generar_doc_tabla USING i_listado-name.
        ELSE.
          IF NOT i_listado-grupo IS INITIAL.
            addrango_eq: r_tcode i_listado-grupo.
          ENDIF.
          IF NOT i_listado-grupo2 IS INITIAL.
            addrango_eq: r_tcode i_listado-grupo2.
          ENDIF.
          IF NOT i_listado-grupo3 IS INITIAL.
            addrango_eq: r_tcode i_listado-grupo3.
          ENDIF.
          addrango_eq: r_tcode i_listado-name.
          SUBMIT zdocumentos
            AND RETURN
            WITH s_tcode IN r_tcode.
        ENDIF.
      ENDIF.

    WHEN &apos;CORREO&apos;.
      IF v_directorio IS INITIAL.
        CALL METHOD cl_gui_frontend_services=&gt;directory_browse
          EXPORTING
            window_title         = &apos;Selecciona un directorio&apos;
            initial_folder       = zcl_c=&gt;ruta_descarga_slnk
          CHANGING
            selected_folder      = v_directorio
          EXCEPTIONS
            cntl_error           = 1
            error_no_gui         = 2
            not_supported_by_gui = 3
            OTHERS               = 4.
      ENDIF.
      IF v_emailaddr IS INITIAL.
        IF sy-sysid = &apos;NSP&apos;.
          v_emailaddr = &apos;sap4abap@gmail.com&apos;.
          v_ans       = &apos;J&apos;.
        ELSE.
          CALL FUNCTION &apos;CORRESPONDENCE_POPUP_EMAIL&apos;
            EXPORTING
              i_intad  = &apos;sap4abap@gmail.com&apos;
            IMPORTING
              e_answer = v_ans
              e_intad  = v_emailaddr.
        ENDIF.
      ENDIF.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        PERFORM descargar_slnk USING &apos;X&apos;.
      ENDLOOP.
      IF p_ftp = &apos;X&apos;.
        PERFORM copy_ftp.
      ENDIF.

    WHEN &apos;BORRAR&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos;
                          AND ( subc = &apos;1&apos; OR subc = &apos;I&apos; OR subc = &apos;M&apos; ).
        zcl_ap_dev=&gt;borrar_programa( i_listado-name ).
      ENDLOOP.

      DATA: l_objname LIKE  rsedd0-ddobjname,
            l_objtype LIKE  rsedd0-ddobjtype,
            l_corrnum LIKE e070-trkorr.
      LOOP AT i_listado WHERE marca = &apos;X&apos;
                          AND ( subc = &apos;T&apos; OR subc = &apos;E&apos; OR subc = &apos;D&apos; OR subc = &apos;V&apos;  ).
        l_objname = i_listado-name.
        l_objtype = i_listado-object.
        IF i_listado-object = &apos;DTEL&apos;. l_objtype = &apos;E&apos;. ENDIF.
        CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
          EXPORTING
            no_ask               = &apos;X&apos;
            objname              = l_objname
            objtype              = l_objtype
          CHANGING
            corrnum              = l_corrnum
          EXCEPTIONS
            not_executed         = 1
            object_not_found     = 2
            object_not_specified = 3
            permission_failure   = 4
            dialog_needed        = 5
            OTHERS               = 6.
      ENDLOOP.


    WHEN &apos;CAMBIOCLAS&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        PERFORM cambiar_clase_desarrollo.
      ENDLOOP.

    WHEN &apos;COPIAPROD&apos;.
      DATA: l_sistema TYPE char40.

      IF sy-sysid = zcl_c=&gt;entorno_produccion.
        l_sistema = zcl_c=&gt;rfc_desarrollo.
      ELSE.
        l_sistema = zcl_c=&gt;rfc_produccion.
      ENDIF.
      CALL FUNCTION &apos;Z_RFC_GET_TABLA&apos;
        EXPORTING
          tabla      = &apos;ZBC003&apos;
          actualizar = &apos;X&apos;
          sistema    = l_sistema.

      CALL FUNCTION &apos;Z_RFC_GET_TABLA&apos;
        EXPORTING
          tabla      = &apos;ZBC003T&apos;
          actualizar = &apos;X&apos;
          sistema    = l_sistema.

      CALL FUNCTION &apos;Z_RFC_GET_TABLA&apos;
        EXPORTING
          tabla      = &apos;ZBC003V&apos;
          actualizar = &apos;X&apos;
          sistema    = l_sistema.

    WHEN &apos;BOR_DUMPS&apos;.
      DELETE FROM snap
       WHERE datum = sy-datum
         AND uname = sy-uname.
    WHEN &apos;REPO&apos;.
      PERFORM actualizar_repositorio.
    WHEN &apos;UPDATE&apos;.
      IF sy-sysid = zcl_c=&gt;entorno_desarrollo.
        zcl_ap_repo=&gt;check_update( version = c_version mostrar_error = &apos;X&apos; ).
      ENDIF.
    WHEN &apos;EXCEL&apos;.
      o_alv-&gt;comprobar_cambios( ).
      o_alv-&gt;exportar_excel( CHANGING t_tabla = i_listado[] ).

    WHEN &apos;TADIR&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos;
                          AND ( subc = &apos;1&apos; OR subc = &apos;I&apos; OR subc = &apos;M&apos; ).
        UPDATE tadir
           SET srcsystem = sy-sysid
               srcdep    = &apos;&apos;
               WHERE  object    = i_listado-object
               AND    obj_name  = i_listado-name.

      ENDLOOP.
    WHEN &apos;ZTASKS&apos;.
      DATA: l_no,
            i_inc     TYPE TABLE OF wbcrossgt WITH HEADER LINE,
            i_fun     TYPE TABLE OF cross WITH HEADER LINE,
            l_string  TYPE string,
            i_ztasks2 LIKE i_ztasks OCCURS 0 WITH HEADER LINE.

      DEFINE add_text.
        CLEAR i_ztasks2.
        CONCATENATE i_ztasks-texto cl_abap_char_utilities=&gt;cr_lf  &amp;1 &amp;2 &amp;3 INTO i_ztasks-texto SEPARATED BY space.
        i_ztasks2-objeto = &amp;2.
        IF i_ztasks2-objeto(1) = &apos;$&apos;.
          i_ztasks2-objeto = i_ztasks2-objeto+1.
        ENDIF.
        IF &amp;2(1) = &apos;Z&apos;.
          i_ztasks2-cliente = zcl_c=&gt;cliente_tasks.
        ELSE.
          i_ztasks2-cliente = &apos;*&apos;.
        ENDIF.
        CONCATENATE &amp;1 &amp;3 INTO i_ztasks2-descripcion_obj SEPARATED BY space.

        CASE &amp;1.
          WHEN &apos;Tabla&apos;.
            CONCATENATE i_ztasks2-texto cl_abap_char_utilities=&gt;cr_lf  &apos;$TABLAS&apos; INTO i_ztasks2-texto.
          WHEN &apos;Función&apos;.
            CONCATENATE i_ztasks2-texto cl_abap_char_utilities=&gt;cr_lf  &apos;$FUNCIONES&apos; INTO i_ztasks2-texto.
          WHEN &apos;Transacción&apos;.
            CONCATENATE i_ztasks2-texto cl_abap_char_utilities=&gt;cr_lf  &apos;$TRANSACCIONES&apos; INTO i_ztasks2-texto.
        ENDCASE.

        APPEND i_ztasks2.
      END-OF-DEFINITION.

      REFRESH: i_ztasks, i_ztasks2.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        CLEAR i_ztasks.
        i_ztasks-cliente = zcl_c=&gt;cliente_tasks.
        i_ztasks-objeto  = i_listado-name.
        CLEAR l_no.

        CASE i_listado-subc.
          WHEN &apos;1&apos;.
            CONCATENATE &apos;Report&apos; i_listado-text INTO i_ztasks-descripcion_obj SEPARATED BY space.
            IF NOT i_listado-tcode IS INITIAL AND i_listado-tcode NE &apos;SE38&apos;.
              CONCATENATE &apos;Transacción&apos; i_listado-tcode i_listado-ttext cl_abap_char_utilities=&gt;cr_lf INTO i_ztasks-texto SEPARATED BY space.
              add_text &apos;Transacción&apos; i_listado-tcode i_listado-ttext.
            ENDIF.
            SELECT * FROM wbcrossgt
              INTO TABLE i_inc
             WHERE otype = &apos;TY&apos;
               AND include = i_listado-name
               AND direct = &apos;X&apos;.
            DELETE i_inc WHERE name CS &apos;\&apos; OR name CS &apos;:&apos;.
            DELETE ADJACENT DUPLICATES FROM i_inc.
            SELECT * FROM cross
              INTO TABLE i_fun
             WHERE type = &apos;F&apos;
               AND include = i_listado-name.
          WHEN OTHERS.
            l_no = &apos;X&apos;.
        ENDCASE.
        IF l_no IS INITIAL.
          LOOP AT i_inc.
            SELECT SINGLE * FROM  dd02t
                   WHERE  tabname     = i_inc-name
                   AND    ddlanguage  = sy-langu.
            IF sy-subrc = 0.
              IF i_inc-name(1) NE &apos;Z&apos;.
                CONCATENATE &apos;$&apos; i_inc-name INTO i_inc-name.
              ENDIF.
              add_text &apos;Tabla&apos; i_inc-name dd02t-ddtext.
            ENDIF.
          ENDLOOP.
          IF sy-subrc = 0.
            CONCATENATE i_ztasks-texto cl_abap_char_utilities=&gt;cr_lf INTO i_ztasks-texto.
          ENDIF.

          LOOP AT i_fun.
            CLEAR v_fdirt.
            SELECT SINGLE * FROM v_fdirt
             WHERE funcname = i_fun-name
               AND active = &apos;X&apos;
               AND spras  = sy-langu.
            IF sy-subrc NE 0.
              SELECT SINGLE * FROM v_fdirt
               WHERE funcname = i_fun-name
                 AND active = &apos;X&apos;
                 AND spras  = &apos;E&apos;.
              IF sy-subrc NE 0.
                SELECT SINGLE * FROM v_fdirt
                 WHERE funcname = i_fun-name
                   AND active = &apos;X&apos;.
              ENDIF.
            ENDIF.
            IF NOT v_fdirt IS INITIAL.
              IF i_fun-name(1) NE &apos;Z&apos;.
                CONCATENATE &apos;$&apos; i_fun-name INTO i_fun-name.
              ENDIF.
              add_text &apos;Función&apos; i_fun-name v_fdirt-stext.
            ENDIF.
          ENDLOOP.

          APPEND i_ztasks.
        ENDIF.
      ENDLOOP.

      LOOP AT i_ztasks2.
        COLLECT i_ztasks2 INTO i_ztasks.
      ENDLOOP.

      CALL TRANSFORMATION id_indent
           SOURCE obj   = i_ztasks[]
           RESULT XML l_string.

      zcl_ap_ws=&gt;grabar_xml( EXPORTING string = l_string dialogo = &apos;X&apos; fichero = &apos;ZTASKS.XML&apos; codepage = zcl_c=&gt;codepage  ).

    WHEN &apos;SALL&apos;.
      DATA ust04 TYPE ust04.
      ust04-bname = sy-uname.
      ust04-profile = &apos;SAP_ALL&apos;.
      MODIFY ust04 FROM ust04.
      CALL FUNCTION &apos;SAUT_UPD_AUTH_FLDINFO_TMP&apos;
        EXPORTING
          mode   = &apos;R&apos;
        EXCEPTIONS
          OTHERS = 0.

      SUBMIT rsusr406 WITH no_check = &apos;X&apos; AND RETURN.

    WHEN &apos;LIN_72&apos;.
      DATA: BEGIN OF  l_abap_source OCCURS 0,
              l72(72),
              resto(255),
            END OF l_abap_source.

      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        REFRESH l_abap_source.
        READ REPORT i_listado-name INTO l_abap_source.

        LOOP AT l_abap_source WHERE resto NE &apos;&apos;.
          WRITE: / i_listado-name, sy-tabix, l_abap_source-resto.
        ENDLOOP.
      ENDLOOP.
      LEAVE TO LIST-PROCESSING.

    WHEN &apos;SAPUI5&apos;.
      DATA: l_dir TYPE text255, l_rc TYPE i.
      LOOP AT i_listado WHERE marca = &apos;X&apos; AND object = &apos;WAPA&apos; AND ttext CS &apos;UI5&apos;.
        SET PARAMETER ID &apos;ZDIR_UI5&apos; FIELD &apos;&apos;.
        IF NOT v_directorio IS INITIAL.
          l_dir = zcl_ap_ficheros=&gt;concat_ruta( directorio = v_directorio fichero = i_listado-name ).
          CLEAR l_rc.
          IF zcl_ap_ficheros=&gt;existe_dir( l_dir ) = &apos;&apos;.
            l_string = l_dir.
            cl_gui_frontend_services=&gt;directory_create( EXPORTING directory = l_string CHANGING rc = l_rc ).
          ENDIF.
          IF l_rc = 0.
            SET PARAMETER ID &apos;ZDIR_UI5&apos; FIELD l_dir.
          ENDIF.
        ENDIF.
        SUBMIT /ui5/ui5_repository_load
          AND RETURN
          WITH ui5rep = i_listado-name
          WITH upload = &apos;&apos;
          WITH download = &apos;X&apos;.

*  METHOD select_directory.
*  DATA L_DIR TYPE TEXT255.
*    GET PARAMETER ID &apos;ZDIR_UI5&apos; FIELD L_DIR.
*    IF NOT L_DIR IS INITIAL.
*    rv_directory = L_DIR.
*    EXIT.
*    ENDIF.
        SET PARAMETER ID &apos;ZDIR_UI5&apos; FIELD &apos;&apos;.
      ENDLOOP.
  ENDCASE.

ENDMODULE.                   &quot; USER_COMMAND_0100  INPUT
*----------------------------------------------------------------------*
*  MODULE status_0100 OUTPUT
*----------------------------------------------------------------------*
MODULE status_0100 OUTPUT.
  SET PF-STATUS &apos;STANDARD&apos;.
  SET TITLEBAR &apos;100&apos;.

  IF o_alv IS INITIAL.
    CREATE OBJECT o_event.
    CREATE OBJECT o_alv
      EXPORTING
        estructura = &apos;ZEST_ZBC003&apos;
        o_event    = o_event.


    o_alv-&gt;quitar_opciones( cl_gui_alv_grid=&gt;mc_fc_loc_delete_row ).
*    o_alv-&gt;quitar_opciones( cl_gui_alv_grid=&gt;mc_fc_filter  ).
    o_alv-&gt;quitar_botones_insercion( ).

    o_alv-&gt;set_layout( ancho_optimizado = &apos;X&apos;
                       input  = &apos;X&apos;
                       colort = &apos;COLOR&apos;
                       zebra  = &apos;X&apos; ).

    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;MODULO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;ESTADO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;DIFICULTAD&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;PRIORIDAD&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;TIPO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;GRUPO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;GRUPO2&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;GRUPO3&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;PROCESADO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;PROCESADO_POR&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;REVISADO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;PROBADO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;LIBRERIA&apos; ).
    o_alv-&gt;set_field( op = &apos;CHECKBOX&apos; campo = &apos;LIBRERIA&apos; ).

    o_alv-&gt;set_field( op = &apos;NO_OUT&apos; campo = &apos;MARCA&apos; ).

    IF p_vivas = &apos;X&apos;.
      o_alv-&gt;set_orden( campo = &apos;PRIORIDAD,UDAT&apos; down = &apos;X&apos; ).
      o_alv-&gt;set_orden( campo = &apos;SUBC,NAME&apos; down = &apos;X&apos; ).
    ENDIF.

    o_alv-&gt;show( CHANGING tabla = i_listado[] ).
  ENDIF.

ENDMODULE.                                         &quot;status_0100 OUTPUT



*----------------------------------------------------------------------*
* CLASS lcl_event_grid IMPLEMENTATION
*----------------------------------------------------------------------*
*
*----------------------------------------------------------------------*
CLASS lcl_event_grid IMPLEMENTATION.
  METHOD double_click.
    DATA o_bi TYPE REF TO zcl_ap_batch_input.
    CREATE OBJECT o_bi.

    READ TABLE i_listado INTO l_listado INDEX e_row.
    IF sy-subrc = 0.
      CASE e_column.
        WHEN &apos;ICONO&apos;.
          DATA: o_ver TYPE REF TO zcl_ap_alv.
          CLEAR i_camb.
          LOOP AT i_cambios INTO l_cambios WHERE name = l_listado-name.
            CLEAR l_camb.
            MOVE-CORRESPONDING l_cambios TO l_camb.
            APPEND l_camb TO i_camb.
          ENDLOOP.

          CREATE OBJECT o_ver
            EXPORTING
              tabla = &apos;I_CAMB&apos;.

          o_ver-&gt;show_popup( ).

        WHEN &apos;DOC&apos;.
          DATA: r_tcode TYPE RANGE OF sy-tcode,
                l_tcode LIKE LINE OF r_tcode.
          CLEAR l_tcode.
          l_tcode-option = &apos;EQ&apos;.
          l_tcode-sign   = &apos;I&apos;.

          IF NOT l_listado-grupo IS INITIAL.
            l_tcode-low = l_listado-grupo.
            APPEND l_tcode TO r_tcode.
          ENDIF.
          IF NOT l_listado-grupo2 IS INITIAL.
            l_tcode-low = l_listado-grupo2.
            APPEND l_tcode TO r_tcode.
          ENDIF.
          IF NOT l_listado-grupo3 IS INITIAL.
            l_tcode-low = l_listado-grupo3.
            APPEND l_tcode TO r_tcode.
          ENDIF.
          l_tcode-low = l_listado-name.
          APPEND l_tcode TO r_tcode.
          SUBMIT zdocumentos
            AND RETURN
            WITH s_tcode IN r_tcode.
        WHEN &apos;NAME&apos; OR &apos;TEXT&apos;.
          IF l_listado-subc = &apos;1&apos; OR l_listado-subc = &apos;M&apos; OR
             l_listado-subc = &apos;I&apos; OR l_listado-subc = &apos;&apos;.
            SET PARAMETER ID &apos;RID&apos; FIELD l_listado-name.
            CALL TRANSACTION &apos;SE38&apos; AND SKIP FIRST SCREEN.
          ELSEIF l_listado-subc = &apos;F&apos; OR l_listado-subc = &apos;9&apos;.
            SET PARAMETER ID &apos;LIB&apos; FIELD l_listado-name.
            CALL TRANSACTION &apos;SE37&apos; AND SKIP FIRST SCREEN.
          ELSEIF i_listado-subc = &apos;S&apos;.
            IF l_listado-tcode = &apos;SE71&apos;.
              SET PARAMETER ID &apos;TTX&apos; FIELD l_listado-name.
              CALL TRANSACTION &apos;SE71&apos; AND SKIP FIRST SCREEN.
            ELSE.

              o_bi-&gt;inicio( ).

* SAP Smart Forms: Initial screen
              o_bi-&gt;dynpro( program = &apos;SAPMSSFO&apos; dynpro = &apos;0100&apos;).
              o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=DISPLAY&apos;).
              o_bi-&gt;campos( campo = &apos;RB_SF&apos; valor = &apos;X&apos;).
              o_bi-&gt;campos( campo = &apos;SSFSCREEN-FNAME&apos; valor = l_listado-name ).                      &quot; Smart Forms: Nombre formulario

              l_mensaje = o_bi-&gt;llamar_transaccion( tcode = &apos;SMARTFORMS&apos; modo = &apos;E&apos;).
            ENDIF.
          ELSEIF l_listado-subc = &apos;A&apos;.
            o_bi-&gt;inicio( ).

            o_bi-&gt;dynpro( program = &apos;SAPMSMOD&apos; dynpro = &apos;1010&apos;).
            o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;/00&apos;).
            o_bi-&gt;campos( campo = &apos;MOD0-NAME&apos; valor = l_listado-name ).

            l_mensaje = o_bi-&gt;llamar_transaccion( tcode = &apos;CMOD&apos; modo = &apos;E&apos;).
          ELSEIF l_listado-subc = &apos;B&apos;.
            SET PARAMETER ID &apos;IMN&apos; FIELD l_listado-name.
            CALL TRANSACTION &apos;SE19&apos; AND SKIP FIRST SCREEN.
          ELSEIF l_listado-subc = &apos;C&apos;.
            SET PARAMETER ID &apos;CLASS&apos; FIELD l_listado-name.
            CALL TRANSACTION &apos;SE24&apos; AND SKIP FIRST SCREEN.
          ELSEIF l_listado-subc = &apos;P&apos;.
            IF l_listado-object = &apos;SFPF&apos;.
              SET PARAMETER ID &apos;FPWBFORM&apos; FIELD l_listado-name.
            ELSE.
              SET PARAMETER ID &apos;FPWBINTERFACE&apos; FIELD l_listado-name.
            ENDIF.
            CALL TRANSACTION &apos;SFP&apos; AND SKIP FIRST SCREEN.
          ELSEIF l_listado-subc = &apos;A&apos;.
            o_bi-&gt;inicio( ).

            o_bi-&gt;dynpro( program = &apos;SAPLENHANCEMENTS&apos; dynpro = &apos;0100&apos;).
            o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=DISPLAY&apos;).
            o_bi-&gt;campos( campo = &apos;RSEUX-C_XS&apos; valor = &apos;&apos;).                      &quot; DE: Radiobutton &quot;Enhancement Spot&quot;
            o_bi-&gt;campos( campo = &apos;RSEUX-CXH&apos; valor = &apos;X&apos;).                      &quot; DE: Radiobutton &quot;Enhancement&quot;
            o_bi-&gt;campos( campo = &apos;RSEUX-CXH_VALUE&apos; valor = l_listado-name ).                      &quot; ID of an Enhancement

            l_mensaje = o_bi-&gt;llamar_transaccion( tcode = &apos;SE20&apos; modo = &apos;E&apos;).
          ELSEIF l_listado-subc = &apos;T&apos;.
            SET PARAMETER ID &apos;DTB&apos; FIELD l_listado-name.
            CALL TRANSACTION &apos;SE11&apos; AND SKIP FIRST SCREEN.
          ELSEIF l_listado-subc = &apos;E&apos;.
            SET PARAMETER ID &apos;DTYP&apos; FIELD l_listado-name.
            CALL TRANSACTION &apos;SE11&apos; AND SKIP FIRST SCREEN.
          ENDIF.
        WHEN &apos;TCODE&apos; OR &apos;TTEXT&apos;.
          IF i_listado-subc = &apos;T&apos;.
            CALL TRANSACTION &apos;FIBF&apos; AND SKIP FIRST SCREEN.
          ELSEIF i_listado-subc = &apos;A&apos; OR i_listado-subc = &apos;S&apos;.
            IF i_listado-subc = &apos;A&apos; .
              SET PARAMETER ID &apos;RID&apos; FIELD l_listado-ttext.
            ELSE.
              SET PARAMETER ID &apos;RID&apos; FIELD l_listado-tcode.
            ENDIF.
            CALL TRANSACTION &apos;SE38&apos; AND SKIP FIRST SCREEN.
          ELSE.
            SET PARAMETER ID &apos;TCD&apos; FIELD l_listado-tcode.
            CALL TRANSACTION &apos;SE93&apos; AND SKIP FIRST SCREEN.
          ENDIF.
        WHEN OTHERS.
          PERFORM editar_nota USING l_listado-name l_listado-tcode.
      ENDCASE.
    ENDIF.
  ENDMETHOD. &quot;data_changed


  METHOD toolbar.
    DATA: ls_toolbar TYPE stb_button.

    CLEAR ls_toolbar.
    ls_toolbar-function  = &apos;EXCEL&apos;.
    ls_toolbar-icon      = &apos;@J2@&apos;.
    ls_toolbar-quickinfo = &apos;Excel&apos;.
    ls_toolbar-text      = &apos;Excel&apos;.
    APPEND ls_toolbar TO e_object-&gt;mt_toolbar.

  ENDMETHOD.                                         &quot;toolbar

  METHOD user_command.

    CASE e_ucomm .
      WHEN &apos;EXCEL&apos;.
        o_alv-&gt;comprobar_cambios( ).
        o_alv-&gt;exportar_excel( CHANGING t_tabla = i_listado[] ).
    ENDCASE .
  ENDMETHOD.                                         &quot;USER_COMMAND


ENDCLASS. &quot;lcl_event_grid IMPLEMENTATION


FORM descargar_sfp USING pe_path pe_form .

  TYPES: t_raw(1024) TYPE x.

  DATA: l_wb_form       TYPE REF TO   if_fp_wb_form,
        l_form_wb_if    TYPE REF TO   if_fp_wb_form,
        l_form          TYPE REF TO   if_fp_form,
        l_name          TYPE          string,
        l_fullpath      TYPE          string,
        l_xstring       TYPE          xstring,
        l_binary_table  TYPE TABLE OF t_raw,
        l_binary_length TYPE          i,
        l_formname      TYPE          fpname.

  l_formname = pe_form.

  TRY.
      CALL METHOD cl_fp_wb_form=&gt;load
        EXPORTING
          i_name    = l_formname
        RECEIVING
          r_wb_form = l_form_wb_if.
    CATCH cx_fp_api_usage .
      EXIT.
    CATCH cx_fp_api_repository .
      EXIT.
    CATCH cx_fp_api_internal .
      EXIT.
  ENDTRY.

  l_wb_form ?= l_form_wb_if.

  l_form ?= l_wb_form-&gt;get_object( ).

  l_name = l_wb_form-&gt;get_name( ).

  l_fullpath = pe_path.
  REPLACE &apos;.slnk&apos; WITH &apos;.xml&apos; INTO l_fullpath.


  TRY.
      l_xstring = cl_fp_helper=&gt;convert_form_to_xstring( l_form ).
    CATCH cx_fp_api_internal.
      EXIT.
  ENDTRY.

  CALL FUNCTION &apos;SCMS_XSTRING_TO_BINARY&apos;
    EXPORTING
      buffer        = l_xstring
    IMPORTING
      output_length = l_binary_length
    TABLES
      binary_tab    = l_binary_table.

  CALL FUNCTION &apos;GUI_DOWNLOAD&apos;
    EXPORTING
      bin_filesize = l_binary_length
      filename     = l_fullpath
      filetype     = &apos;BIN&apos;
    TABLES
      data_tab     = l_binary_table
    EXCEPTIONS
      OTHERS       = 1.

ENDFORM.

FORM generar_doc_tabla USING pe_tabla.
  DATA: i_lineas(255) OCCURS 0 WITH HEADER LINE,
        i_campos      TYPE TABLE OF dfies WITH HEADER LINE,
        l_rc          TYPE i.

  i_campos[] = zcl_ap_dev=&gt;get_fieldcatalog_tabla( pe_tabla ).

  APPEND &apos;TYPES: BEGIN OF T_TABLA,&apos; TO i_lineas.
  LOOP AT i_campos.
    IF i_campos-scrtext_l IS INITIAL.
      CONCATENATE &apos;     &apos; i_campos-fieldname &apos;    TYPE &apos; i_campos-rollname &apos;,&apos; INTO i_lineas SEPARATED BY space.
    ELSE.
      CONCATENATE &apos;     &apos; i_campos-fieldname &apos;    TYPE &apos; i_campos-rollname &apos;, &quot;&apos; i_campos-scrtext_l INTO i_lineas SEPARATED BY space.
    ENDIF.
    APPEND i_lineas.
  ENDLOOP.
  APPEND &apos;TYPES: END OF T_TABLA,&apos; TO i_lineas.

  cl_gui_frontend_services=&gt;clipboard_export(  IMPORTING data = i_lineas[] CHANGING rc = l_rc ).
  MESSAGE &apos;Se ha exportado tabla a portapapeles&apos; TYPE &apos;S&apos;.

ENDFORM.</source>
</PROG>
