<?xml version="1.0" encoding="utf-8"?>
<CLAS CLSNAME="ZCL_AP_DEV" VERSION="1" LANGU="S" DESCRIPT="Utilidades desarrollo" CATEGORY="00" EXPOSURE="2" STATE="1" RELEASE="0" CLSCCINCL="X" FIXPT="X" UNICODE="X" CLSBCCAT="00" DURATION_TYPE="0 " RISK_LEVEL="0 ">
 <types CLSNAME="ZCL_AP_DEV" CMPNAME="TT_EXC" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="1 " TYPTYPE="4" SRCROW1="6 " SRCCOLUMN1="10 " SRCROW2="6 " SRCCOLUMN2="36 " TYPESRC_LENG="29 " TYPESRC="tt_exc TYPE TABLE OF text20
"/>
 <localImplementation>*&quot;* local class implementation for public class
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes

type-pools abap .</localImplementation>
 <localTypes>*&quot;* use this source file for any type of declarations (class
*&quot;* definitions, interfaces or type declarations) you need for
*&quot;* components in the private section</localTypes>
 <localMacros>*&quot;* use this source file for any macro definitions you need
*&quot;* in the implementation part of the class</localMacros>
 <textPool>
  <language SPRAS="E">
   <textElement ID="I" KEY="EBP" ENTRY="Error deleting program" LENGTH="46 "/>
   <textElement ID="I" KEY="GIN" ENTRY="Generating report" LENGTH="27 "/>
   <textElement ID="I" KEY="SPA" ENTRY="Exit due to another active job" LENGTH="82 "/>
   <textElement ID="I" KEY="SPE" ENTRY="Exit due to report is already in execution" LENGTH="112 "/>
  </language>
  <language SPRAS="F">
   <textElement ID="I" KEY="EBP" ENTRY="Error deleting program" LENGTH="46 "/>
   <textElement ID="I" KEY="GIN" ENTRY="Generating report" LENGTH="27 "/>
   <textElement ID="I" KEY="SPA" ENTRY="Exit due to another active job" LENGTH="82 "/>
   <textElement ID="I" KEY="SPE" ENTRY="Exit due to report is already in execution" LENGTH="112 "/>
  </language>
  <language SPRAS="I">
   <textElement ID="I" KEY="EBP" ENTRY="Error deleting program" LENGTH="46 "/>
   <textElement ID="I" KEY="GIN" ENTRY="Generating report" LENGTH="27 "/>
   <textElement ID="I" KEY="SPA" ENTRY="Exit due to another active job" LENGTH="82 "/>
   <textElement ID="I" KEY="SPE" ENTRY="Exit due to report is already in execution" LENGTH="112 "/>
  </language>
  <language SPRAS="S">
   <textElement ID="I" KEY="EBP" ENTRY="Error borrando programa" LENGTH="46 "/>
   <textElement ID="I" KEY="ECC" ENTRY="Error cambiando clase de desarrollo" LENGTH="70 "/>
   <textElement ID="I" KEY="EEV" ENTRY="Error evaluando variable" LENGTH="48 "/>
   <textElement ID="I" KEY="EFC" ENTRY="@J2@ Ejemplo fichero carga" LENGTH="52 "/>
   <textElement ID="I" KEY="EGS" ENTRY="Error generando SLNK" LENGTH="40 "/>
   <textElement ID="I" KEY="ELI" ENTRY="en linea" LENGTH="18 "/>
   <textElement ID="I" KEY="ERV" ENTRY="Error recuperando variante" LENGTH="52 "/>
   <textElement ID="I" KEY="ESM" ENTRY="Error de sintaxis, mensaje" LENGTH="52 "/>
   <textElement ID="I" KEY="GIN" ENTRY="Generando informe" LENGTH="27 "/>
   <textElement ID="I" KEY="MUS" ENTRY="@J7@ Manual usuario" LENGTH="29 "/>
   <textElement ID="I" KEY="SPA" ENTRY="Saliendo debido a que hay otro job activo" LENGTH="82 "/>
   <textElement ID="I" KEY="SPE" ENTRY="Saliendo debido a que el programa ya se está ejecutando." LENGTH="112 "/>
  </language>
 </textPool>
 <typeUsage CLSNAME="ZCL_AP_DEV" TYPEGROUP="ABAP" VERSION="1" TPUTYPE="0" IMPLICIT="X"/>
 <forwardDeclaration>ABAP</forwardDeclaration>
 <typeClasDef CLSNAME="ZCL_AP_DEV" TYPEGROUP="CL_ABAP_OBJECTDESCR" VERSION="1" TPUTYPE="1" IMPLICIT="X"/>
 <typeClasDef CLSNAME="ZCL_AP_DEV" TYPEGROUP="ZCL_C" VERSION="1" TPUTYPE="1" IMPLICIT="X"/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="ACCION_EJECUTADA" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="29 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="AUX1" VERSION="1" LANGU="S" DESCRIPT="Texto, longitud 80" EXPOSURE="2" STATE="1" EDITORDER="17 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TEXT80" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="AUX2" VERSION="1" LANGU="S" DESCRIPT="Texto, longitud 80" EXPOSURE="2" STATE="1" EDITORDER="18 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TEXT80" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="CONT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="16 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="I" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="CX_ROOT" VERSION="1" LANGU="S" DESCRIPT="Abstract Superclass for All Global Exceptions" EXPOSURE="2" STATE="1" EDITORDER="13 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CX_ROOT" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="C_LIN_SEP" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="1 " ATTDECLTYP="2" ATTVALUE="&apos;==================================================&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="FECHA" VERSION="1" LANGU="S" DESCRIPT="Campo de tipo DATS" EXPOSURE="2" STATE="1" EDITORDER="21 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="DATS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="HANDLE" VERSION="1" LANGU="S" DESCRIPT="ID de gestión para llamada múltiple desde el mismo programa" EXPOSURE="2" STATE="1" EDITORDER="30 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SLIS_HANDL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="INICIO" VERSION="1" LANGU="S" DESCRIPT="Casilla de selección" EXPOSURE="2" STATE="1" EDITORDER="20 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="XFELD" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="I_EXC" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="6 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TT_EXC" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="LINEA" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="28 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="MENSAJE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" EXPOSURE="2" STATE="1" EDITORDER="14 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPI_MSG" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="MODO_CT" VERSION="1" LANGU="S" DESCRIPT="Batch input processing mode" EXPOSURE="2" STATE="1" EDITORDER="26 " ATTDECLTYP="0" ATTVALUE="&apos;N&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BDCMODE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="NOMBRE_PC" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="4 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="NO_BREAK" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="12 " ATTDECLTYP="0" ATTVALUE="&apos;&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="NO_SGPI" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="31 " ATTDECLTYP="0" ATTVALUE="&apos;&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="OBJECT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="19 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="O_CACHE" VERSION="1" LANGU="S" DESCRIPT="Cache" EXPOSURE="2" STATE="1" EDITORDER="25 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="ZCL_AP_CACHE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="O_LOG" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="3 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="ZCL_AP_LOG" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="O_PAR" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="2 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="ZCL_AP_PARAMETROS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="O_SGPI" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="1 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="ZCL_AP_SGPI" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="PROCESO_LOG" VERSION="1" LANGU="S" DESCRIPT="Proceso" EXPOSURE="2" STATE="1" EDITORDER="11 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ZPROCESO_LOG" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_PROG" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Programa de llamada" EXPOSURE="2" STATE="1" EDITORDER="27 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SY-CPROG" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="STRING" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="15 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="TITULO" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="5 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="UCOMM" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Código función que ha lanzado PAI" EXPOSURE="2" STATE="1" EDITORDER="22 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SY-UCOMM" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="UCOMM_GRABAR" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="24 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="UCOMM_TEXT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="23 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="URL_MANUAL" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="7 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="URL_MANUAL_EDT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="8 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="URL_PLANTILLA" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="9 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_DEV" CMPNAME="URL_PLANTILLA_EDT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="10 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="ACTIVAR_OBJETO" VERSION="1" LANGU="S" DESCRIPT="Activa objeto" EXPOSURE="2" STATE="1" EDITORDER="5 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ACTIVAR_OBJETO" SCONAME="OBJECT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="E071-OBJECT"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ACTIVAR_OBJETO" SCONAME="OBJ_NAME" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="E071-OBJ_NAME"/>
  <source>METHOD activar_objeto.
    CALL FUNCTION &apos;RS_WORKING_OBJECT_ACTIVATE&apos;
      EXPORTING
        object                     = object
        obj_name                   = obj_name
*       FORCE_ACTIVATION           = &apos; &apos;
*       ACTIVATE_ONLY_THIS_OBJECT  =
*       OBJECT_SAVED               =
*       DICTIONARY_ONLY            = &apos; &apos;
*       P_WB_MANAGER               =
*       P_CALLER_PROGRAM           =
*       CWB_MODE                   =
*       DISPLAY_SYSID              = &apos; &apos;
* IMPORTING
*       BIND_ERROR_WINDOW          =
* TABLES
*       OBJECTS                    =
      EXCEPTIONS
        object_not_in_working_area = 1
        execution_error            = 2
        cancelled                  = 3
        insert_into_corr_error     = 4
        OTHERS                     = 5.
    IF sy-subrc &lt;&gt; 0.
      MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
              WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="AT_SELECTION" VERSION="1" LANGU="S" DESCRIPT="Eventos AT SELECCION SCREEN" EXPOSURE="2" STATE="1" EDITORDER="20 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="AT_SELECTION" SCONAME="ACTION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="C" PARVALUE="&apos;U&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="AT_SELECTION" SCONAME="ZPARAMETROS_ALV" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="ZCL_C=&gt;ZPARAMETROS_ALV"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="AT_SELECTION" SCONAME="TCODE_DOC" VERSION="1" LANGU="S" DESCRIPT="Código transacción" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZDOCUMENTOS-TCODE" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="AT_SELECTION" SCONAME="BOTON_FC05" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZDOCUMENTOS-CLASIFICACION" PARVALUE="&apos;&apos;"/>
  <source>METHOD at_selection.
    DATA: l_ucomm       TYPE sy-ucomm,
          l_but         TYPE smp_dyntxt,
          l_ruta_ztasks TYPE string.

    l_ucomm = sy-ucomm.

    IF sy-ucomm(1) = &apos;M&apos;.
      PERFORM get_button IN PROGRAM zap_status USING sy-ucomm CHANGING l_but.
      CASE l_but-text.
        WHEN &apos;Log&apos;. l_ucomm = &apos;LOG&apos;.
        WHEN &apos;Parámetro&apos; OR &apos;Parámetros&apos;. l_ucomm = &apos;PARAM&apos;.
      ENDCASE.
    ENDIF.

    IF NOT tcode_doc IS INITIAL.
      DATA(l_tcode_doc) = tcode_doc.
    ELSE.
      l_tcode_doc = sy-cprog.
    ENDIF.

    CASE l_ucomm.
      WHEN &apos;FC02&apos;.
        zcl_ap_documentos=&gt;get_documentos_por_clas( EXPORTING tcode = l_tcode_doc
                                                              clasificacion = &apos;MANUAL&apos;
                                                    IMPORTING i_documentos = DATA(i_documentos)
                                                              eliminados = DATA(l_eliminados) ).
        IF NOT i_documentos IS INITIAL OR l_eliminados &gt; 0.
          zcl_ap_documentos=&gt;popup_list( tcode = l_tcode_doc clasificacion = &apos;MANUAL&apos; ).
        ELSEIF zcl_ap_documentos=&gt;visualizar_documento( nombre = &apos;MANUAL&apos; ) = &apos;&apos;.
          IF NOT url_manual IS INITIAL.
            zcl_ap_gos=&gt;visualizar_fichero_st( url_manual ).
          ENDIF.
        ENDIF.
      WHEN &apos;FC03&apos;.
        zcl_ap_documentos=&gt;get_documentos_por_clas( EXPORTING tcode = l_tcode_doc
                                                              clasificacion = &apos;PLANTILLA&apos;
                                                    IMPORTING i_documentos = i_documentos
                                                              eliminados = l_eliminados ).
        IF NOT i_documentos IS INITIAL OR l_eliminados &gt; 0.
          zcl_ap_documentos=&gt;popup_list( tcode = l_tcode_doc clasificacion = &apos;PLANTILLA&apos; ).
        ELSEIF zcl_ap_documentos=&gt;visualizar_documento( nombre = &apos;PLANTILLA&apos; ) = &apos;&apos;.
          IF NOT url_plantilla IS INITIAL.
            zcl_ap_gos=&gt;visualizar_fichero_st( url_plantilla ).
          ENDIF.
        ENDIF.
      WHEN &apos;FC04&apos;.
        zcl_ap_documentos=&gt;popup_list( tcode = l_tcode_doc clasificacion = &apos;DOC_TEC&apos; ).

      WHEN &apos;FC05&apos;.
        IF NOT boton_fc05 IS INITIAL.
          zcl_ap_documentos=&gt;popup_list( tcode = l_tcode_doc clasificacion = boton_fc05 ).
        ENDIF.
      WHEN &apos;CDOCU&apos;.
        SUBMIT zdocumentos                               &quot;#EC CI_SUBMIT
               AND RETURN
               WITH s_tcode = sy-cprog.
      WHEN &apos;DOC_TEC&apos;.
        IF zcl_ap_documentos=&gt;visualizar_documento( nombre = &apos;Documentacion Tecnica&apos;(dtc) ) = &apos;&apos;.
          CONCATENATE zcl_c=&gt;rutas_tasks sy-cprog INTO l_ruta_ztasks.
          zcl_ap_gos=&gt;visualizar_fichero_st( l_ruta_ztasks ).
        ENDIF.
      WHEN &apos;LOG&apos;.
        IF NOT object IS INITIAL.
          o_log-&gt;ver_logs( object = o_log-&gt;s_log-object subobject = o_log-&gt;s_log-subobject ).
        ELSEIF NOT me-&gt;proceso_log IS INITIAL.
          SUBMIT (zcl_c=&gt;prog_zlog)                      &quot;#EC CI_SUBMIT
                 VIA SELECTION-SCREEN
                 WITH s_proces = proceso_log
                 WITH s_progra = sy-cprog
                 WITH s_fecha  = sy-datum.
        ENDIF.
      WHEN &apos;PARAM&apos;.
        IF NOT o_par IS INITIAL.
          o_par-&gt;mantenimiento( action = action alv = zparametros_alv ).
          o_par-&gt;inicio( ).
          relanzar_report( via_selection_screen = &apos;X&apos; ).
        ENDIF.
      WHEN OTHERS.
        IF l_ucomm(5) = &apos;DOCU_&apos;.
          show_docu( id = CONV #( l_ucomm+5 ) ).
        ELSE.
          zcl_ap_utils=&gt;mantener_tabla( sy-ucomm ).
        ENDIF.
    ENDCASE.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="AT_SELECTION_SCREEN" VERSION="1" LANGU="S" DESCRIPT="Procesa opciones AT SELECTION SCREEN" EXPOSURE="2" STATE="1" EDITORDER="16 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="AT_SELECTION_SCREEN" SCONAME="O_PAR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_PARAMETROS" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="AT_SELECTION_SCREEN" SCONAME="URL_MANUAL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="AT_SELECTION_SCREEN" SCONAME="URL_PLANTILLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="AT_SELECTION_SCREEN" SCONAME="ZPARAMETROS_ALV" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="ZCL_C=&gt;ZPARAMETROS_ALV"/>
  <source>METHOD at_selection_screen.
    DATA l_ruta_ztasks TYPE string.

    CASE sy-ucomm.
      WHEN &apos;FC02&apos;.
        IF zcl_ap_documentos=&gt;visualizar_documento( nombre = &apos;MANUAL&apos; ) = &apos;&apos;.
          IF NOT url_manual IS INITIAL.
            zcl_ap_gos=&gt;visualizar_fichero_st( url_manual ).
          ENDIF.
        ENDIF.
      WHEN &apos;FC03&apos;.
        IF zcl_ap_documentos=&gt;visualizar_documento( nombre = &apos;PLANTILLA&apos; ) = &apos;&apos;.
          IF NOT url_plantilla IS INITIAL.
            zcl_ap_gos=&gt;visualizar_fichero_st( url_plantilla ).
          ENDIF.
        ENDIF.
      WHEN &apos;FC04&apos;.
        zcl_ap_documentos=&gt;popup_list( ).
      WHEN &apos;CDOCU&apos;.
        SUBMIT zdocumentos                               &quot;#EC CI_SUBMIT
               AND RETURN
               WITH s_tcode = sy-cprog.
      WHEN &apos;DOC_TEC&apos;.
        IF zcl_ap_documentos=&gt;visualizar_documento( nombre = &apos;Documentacion Tecnica&apos;(dtc) ) = &apos;&apos;.
          CONCATENATE zcl_c=&gt;rutas_tasks sy-cprog INTO l_ruta_ztasks.
          zcl_ap_gos=&gt;visualizar_fichero_st( l_ruta_ztasks ).
        ENDIF.
      WHEN &apos;PARAM&apos;.
        IF NOT o_par IS INITIAL.
          o_par-&gt;mantenimiento( alv = zparametros_alv ).
        ENDIF.
    ENDCASE.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="BORRAR_PROGRAMA" VERSION="1" LANGU="S" DESCRIPT="Borrar programa" EXPOSURE="2" STATE="1" EDITORDER="7 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="BORRAR_PROGRAMA" SCONAME="PROGRAM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-REPID"/>
  <source>METHOD borrar_programa.
    CALL FUNCTION &apos;RS_DELETE_PROGRAM&apos;
      EXPORTING
        program            = program
      EXCEPTIONS
        enqueue_lock       = 1
        object_not_found   = 2
        permission_failure = 3
        reject_deletion    = 4
        OTHERS             = 5.
    IF sy-subrc &lt;&gt; 0.
      MESSAGE &apos;Error borrando programa&apos;(ebp) TYPE &apos;E&apos;.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="BOTON_GOS_OBJ" VERSION="1" LANGU="S" DESCRIPT="Crea boton GOS" EXPOSURE="2" STATE="1" EDITORDER="19 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="BOTON_GOS_OBJ" SCONAME="OBJETO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SWO_OBJTYP"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="BOTON_GOS_OBJ" SCONAME="CLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD boton_gos_obj.
    DATA: l_obj     TYPE borident,
          l_manager TYPE REF TO cl_gos_manager.

* Set object Key
    l_obj-objtype = objeto.
    l_obj-objkey  = clave.

* GOS toolbar
    CREATE OBJECT l_manager
      EXPORTING
        is_object    = l_obj
        ip_no_commit = &apos;&apos;
      EXCEPTIONS
        OTHERS       = 1.
    IF sy-subrc = 0.
      IF clave IS INITIAL.
        IF NOT l_manager IS INITIAL.
          l_manager-&gt;unpublish( ).
          CLEAR l_manager.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="BREAK_CONDICIONAL" VERSION="1" LANGU="S" DESCRIPT="Break condicional en base a tabla ZAP_BREAK" EXPOSURE="2" STATE="1" EDITORDER="33 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="BREAK_CONDICIONAL" SCONAME="TEXTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="BREAK_CONDICIONAL" SCONAME="CPROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <source>METHOD break_condicional.
    DATA: l_seguir   TYPE c LENGTH 1,
          i_breaks   TYPE TABLE OF zap_break,
          l_variable TYPE string.

    FIELD-SYMBOLS: &lt;break&gt;    TYPE zap_break,
                   &lt;variable&gt; TYPE any.

    DEFINE breakp.
      IF &lt;break&gt;-solo_codigo IS INITIAL.
        IF sy-batch IS INITIAL.
          BREAK-POINT.                                      &quot;&quot;#EC *
        ELSEIF NOT &lt;break&gt;-fondo IS INITIAL.
          zcl_ap_utils=&gt;parar_fondo( ).
        ENDIF.
      ENDIF.

      IF NOT &lt;break&gt;-abap1 IS INITIAL.
        codigo_dinamico( l1 = &lt;break&gt;-abap1
                         l2 = &lt;break&gt;-abap2
                         l3 = &lt;break&gt;-abap3
                         l4 = &lt;break&gt;-abap4
                         l5 = &lt;break&gt;-abap5
                         l6 = &lt;break&gt;-abap6
                         l7 = &lt;break&gt;-abap7
                         l8 = &lt;break&gt;-abap8
                         l9 = &lt;break&gt;-abap9 ).
      ENDIF.
    END-OF-DEFINITION.

    IF sy-uname &lt;&gt; zcl_c=&gt;usuario_ap.
      IF zcl_c=&gt;break_condicional &lt;&gt; &apos;X&apos;.
        RETURN.
      ENDIF.
    ENDIF.

    GET PARAMETER ID &apos;ZBREAKC&apos; FIELD l_seguir ##EXISTS.
    IF l_seguir &lt;&gt; &apos;X&apos;.
      RETURN.
    ENDIF.

    TRY.
        SELECT * FROM zap_break
          INTO TABLE i_breaks
         WHERE cprog    = cprog
           AND uname    = sy-uname
           AND inactivo = &apos;&apos;.
      CATCH cx_root. &quot;#EC *
        RETURN.
    ENDTRY.

    LOOP AT i_breaks ASSIGNING &lt;break&gt;.
      IF texto NS &lt;break&gt;-texto.
        CONTINUE.
      ENDIF.

      IF &lt;break&gt;-variables IS INITIAL.
        breakp.                                             &quot;#EC *
      ELSE.
        TRY.
            CONCATENATE &apos;(&apos; sy-cprog &apos;)&apos; &lt;break&gt;-variables INTO l_variable.
            ASSIGN (l_variable) TO &lt;variable&gt;.
            IF sy-subrc = 0.
              CASE &lt;break&gt;-op.
                WHEN &apos;&apos; OR &apos;EQ&apos; OR &apos;=&apos;.
                  IF &lt;variable&gt; = &lt;break&gt;-valor.
                    breakp.                                 &quot;#EC *
                  ENDIF.
                WHEN &apos;NE&apos; OR &apos;&lt;&gt;&apos;.
                  IF &lt;variable&gt; &lt;&gt; &lt;break&gt;-valor.
                    breakp.                                 &quot;#EC *
                  ENDIF.
                WHEN &apos;GT&apos; OR &apos;&gt;&apos;.
                  IF &lt;variable&gt; &gt; &lt;break&gt;-valor.
                    breakp.                                 &quot;#EC *
                  ENDIF.
                WHEN &apos;GE&apos; OR &apos;&gt;=&apos;.
                  IF &lt;variable&gt; &gt;= &lt;break&gt;-valor.
                    breakp.                                 &quot;#EC *
                  ENDIF.
                WHEN &apos;LT&apos; OR &apos;&lt;&apos;.
                  IF &lt;variable&gt; &lt; &lt;break&gt;-valor.
                    breakp.                                 &quot;#EC *
                  ENDIF.
                WHEN &apos;LE&apos; OR &apos;&lt;=&apos;.
                  IF &lt;variable&gt; &lt;= &lt;break&gt;-valor.
                    breakp.                                 &quot;#EC *
                  ENDIF.
                WHEN &apos;LIKE&apos;.
                  IF &lt;variable&gt; CS &lt;break&gt;-valor.
                    breakp.                                 &quot;#EC *
                  ENDIF.
                WHEN &apos;NOT LIKE&apos;.
                  IF NOT &lt;variable&gt; CS &lt;break&gt;-valor.
                    breakp.                                 &quot;#EC *
                  ENDIF.
              ENDCASE.
            ENDIF.
          CATCH cx_root. &quot;#EC *
            MESSAGE i398(00) WITH &apos;Error evaluando variable&apos;(eev) &lt;break&gt;-variables &apos;&apos; &apos;&apos;.
        ENDTRY.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="BUSCAR_DATOS" VERSION="1" LANGU="S" DESCRIPT="Seleccionar datos" EXPOSURE="2" STATE="1" EDITORDER="26 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD buscar_datos. &quot;#EC EMPTY_PROCEDURE
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="CLASS_OK" VERSION="1" LANGU="S" DESCRIPT="¿Clase tiene errores?" EXPOSURE="2" STATE="1" EDITORDER="55 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CLASS_OK" SCONAME="CLASS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CLASS_OK" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CLASS_OK" SCONAME="OK" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ABAP_BOOL"/>
  <source>METHOD class_ok.
    DATA: source_code TYPE TABLE OF string,
          dir         TYPE trdir,
          &quot; TODO: variable is assigned but never used (ABAP cleaner)
          line        TYPE i,
          &quot; TODO: variable is assigned but never used (ABAP cleaner)
          word        TYPE string.

    CLEAR ok.
    DATA(include_name) = cl_oo_classname_service=&gt;get_cs_name( CONV #( class ) ).
    READ REPORT include_name INTO source_code.
    IF source_code IS INITIAL.
      include_name+30 = &apos;CP&apos;.
      READ REPORT include_name INTO source_code.
    ENDIF.

    SELECT SINGLE * FROM trdir
      INTO dir
     WHERE name = include_name.
    IF sy-subrc &lt;&gt; 0.
      message = |No existe el programa { include_name }|.
    ELSE.
      SYNTAX-CHECK FOR source_code MESSAGE message LINE line WORD word DIRECTORY ENTRY dir.
      ok = xsdbool( sy-subrc = 0 ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="CLEAR_GLOBAL_DATA" VERSION="1" LANGU="S" DESCRIPT="Borra TODAS las variables de un programa" EXPOSURE="2" STATE="1" EDITORDER="35 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CLEAR_GLOBAL_DATA" SCONAME="CPROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <source>METHOD clear_global_data.
* http://abap.ninja/making-programs-forget/

    DATA: lt_globals   TYPE TABLE OF rfieldlist,
          lv_fieldname TYPE string.

    FIELD-SYMBOLS: &lt;global&gt; LIKE LINE OF lt_globals,
                   &lt;table&gt;  TYPE ANY TABLE,
                   &lt;field&gt;  TYPE any.

    &quot;// Get all the global variables&apos; names
    CALL FUNCTION &apos;GET_GLOBAL_SYMBOLS&apos;
      EXPORTING
        program   = cprog
      TABLES
        fieldlist = lt_globals.

    &quot;// Clear them
    LOOP AT lt_globals ASSIGNING &lt;global&gt;                &quot;#EC CI_STDSEQ
         WHERE
                   name(1) NA &apos;&lt;%&apos; &quot;// Don&apos;t touch field-symbols
               AND name    &lt;&gt; &apos;SY&apos;
               AND name    &lt;&gt; &apos;SYST&apos;
               AND flitl   IS INITIAL. &quot;// neither read-only variables
      &quot;// Cross-program field-symbols access, format: &apos;(PROGRAM)VARIABLE&apos;
      CONCATENATE &apos;(&apos; cprog &apos;)&apos; &lt;global&gt;-name INTO lv_fieldname.
      CASE &lt;global&gt;-type.
        WHEN cl_abap_typedescr=&gt;typekind_table. &quot;// Table
          ASSIGN (lv_fieldname) TO &lt;table&gt;.
          IF sy-subrc = 0.
            FREE &lt;table&gt;.
          ENDIF.
        WHEN OTHERS. &quot;// Anything else
          ASSIGN (lv_fieldname) TO &lt;field&gt;.
          IF sy-subrc = 0.
            FREE &lt;field&gt;.
          ENDIF.
      ENDCASE.
    ENDLOOP.

    cl_abap_memory_utilities=&gt;do_garbage_collection( ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" VERSION="1" LANGU="S" DESCRIPT="Ejecuta código dinámico" EXPOSURE="2" STATE="1" EDITORDER="37 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" SCONAME="L1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" SCONAME="L2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" SCONAME="L3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" SCONAME="L4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" SCONAME="L5" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" SCONAME="L6" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" SCONAME="L7" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" SCONAME="L8" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" SCONAME="L9" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CODIGO_DINAMICO" SCONAME="CPROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <source>METHOD codigo_dinamico.
    DATA: i_source             TYPE TABLE OF text255,
          program_name         TYPE sy-cprog,
          syntax_check_message TYPE c LENGTH 128,
          line_no              TYPE i,
          l_source             TYPE text255,
          l_variable           TYPE text255,
          l_type               TYPE text255.

    DEFINE add_linea.
      l_source = &amp;1.
      IF l_source(7) = &apos;:DEFINE&apos;.
        REPLACE ALL OCCURRENCES OF &apos;.&apos; IN l_source WITH &apos;&apos;.
      ENDIF.
      IF l_source(13) = &apos;:DEFINE_TABLE&apos;.
        l_variable = l_source+14.
        CONCATENATE &apos;FIELD-SYMBOLS &lt;&apos; l_variable &apos;&gt; TYPE TABLE.&apos; INTO l_source.
        APPEND l_source TO i_source.
        CONCATENATE &apos;ASSIGN (&apos;&apos;(&apos; cprog &apos;)&apos; l_variable &apos;&apos;&apos;) TO &lt;&apos; l_variable &apos;&gt;.&apos; INTO l_source.
        APPEND l_source TO i_source.
      ELSEIF l_source(7) = &apos;:DEFINE&apos;.
        SPLIT l_source+8 AT &apos; &apos; INTO l_variable l_type.
        IF l_type IS INITIAL.
          l_type = &apos;ANY&apos;.
        ENDIF.
        CONCATENATE &apos;&gt; TYPE&apos; l_type INTO l_type SEPARATED BY space.
        CONCATENATE &apos;FIELD-SYMBOLS &lt;&apos; l_variable l_type &apos;.&apos; INTO l_source.
        APPEND l_source TO i_source.
        CONCATENATE &apos;ASSIGN (&apos;&apos;(&apos; cprog &apos;)&apos; l_variable &apos;&apos;&apos;) TO &lt;&apos; l_variable &apos;&gt;.&apos; INTO l_source.
        APPEND l_source TO i_source.
      ELSEIF NOT &amp;1 IS INITIAL.
        IF zcl_ap_string=&gt;ultimo_caracter( &amp;1 ) = &apos;.&apos;.
          APPEND &amp;1 TO i_source.
        ELSE.
          CONCATENATE &amp;1 &apos;.&apos; INTO l_source.
          APPEND l_source TO i_source.
        ENDIF.
      ENDIF.
    END-OF-DEFINITION.

    add_linea: &apos;REPORT ZCOMANDO&apos;,
               &apos;FORM COMANDO&apos;,
               l1, l2, l3, l4, l5, l6, l7, l8, l9,
               &apos;ENDFORM&apos;.

    IF i_source IS INITIAL.
      RETURN.
    ENDIF.

    GENERATE SUBROUTINE POOL i_source                  &quot;#EC CI_GENERATE
             NAME program_name
             MESSAGE syntax_check_message
             LINE line_no.
    IF sy-subrc &lt;&gt; 0.
      IF sy-uname = zcl_c=&gt;usuario_ap.
        zcl_ap_utils=&gt;message( p1 = &apos;Error de sintaxis, mensaje&apos;(esm) p2 = syntax_check_message p3 = &apos;en linea&apos;(eli) p4 = line_no ).
      ENDIF.
    ELSE.
      PERFORM comando IN PROGRAM (program_name).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" VERSION="1" LANGU="S" DESCRIPT="User command dynpro" EXPOSURE="2" STATE="1" EDITORDER="40 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="O_ALV" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_ALV_GRID" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="DYNNR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="DYNNR" PARVALUE="&apos;0100&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="SELECCION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="SOLO_CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="FILA_ACTIVA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="ROLLBACK_SI_NO_CAMBIOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="RELANZAR_REPORT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="QUITAR_CAMPOS" VERSION="1" LANGU="S" DESCRIPT="LIGHTS,CHECK,MESSAGE,MENSAJE" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="HAY_SEL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="XFELD" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="I_LISTADO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO" SCONAME="I_LISTADO_INI" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD command_dynpro.
    &quot; TODO: parameter DYNNR is never used (ABAP cleaner)
    &quot; TODO: parameter QUITAR_CAMPOS is never used (ABAP cleaner)

    DATA l_fila_activa TYPE c LENGTH 1.

    FIELD-SYMBOLS &lt;tabla&gt; TYPE table.

    CLEAR: accion_ejecutada,
           ucomm_text.
    ucomm = sy-ucomm.
    IF ( ucomm(1) = &apos;F&apos; OR ucomm(1) = &apos;M&apos; ) AND strlen( ucomm ) = 3.
      IF NOT o_alv IS INITIAL.
        ASSIGN o_alv-&gt;i_botones[ boton = ucomm ] TO FIELD-SYMBOL(&lt;boton&gt;).
        IF sy-subrc = 0.
          ucomm_text = &lt;boton&gt;-text.
          IF NOT &lt;boton&gt;-ucomm IS INITIAL.
            ucomm = &lt;boton&gt;-ucomm.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.
    CLEAR hay_sel.

    CASE ucomm.
      WHEN &apos;BACK&apos; OR &apos;&amp;F15&apos; OR &apos;ECANC&apos;.
        accion_ejecutada = &apos;X&apos;.
        IF i_listado_ini IS SUPPLIED.
          IF NOT o_alv IS INITIAL.
            o_alv-&gt;comprobar_cambios( ).
          ENDIF.
          salir_si_no_cambios( t1                     = i_listado
                               t2                     = i_listado_ini
                               solo_campos            = solo_campos
                               relanzar_report        = relanzar_report
                               rollback_si_no_cambios = rollback_si_no_cambios ).
        ELSE.
          IF relanzar_report = &apos;X&apos;.
            relanzar_report( via_selection_screen = &apos;X&apos; ).
          ELSE.
            LEAVE TO SCREEN 0.
          ENDIF.
        ENDIF.

      WHEN &apos;GRABAR&apos;.
        IF NOT o_alv IS INITIAL.
          o_alv-&gt;comprobar_cambios( ).
          IF seleccion = &apos;X&apos; OR seleccion CS ucomm.
            IF fila_activa = &apos;X&apos; OR fila_activa CS ucomm.
              l_fila_activa = &apos;X&apos;.
            ENDIF.
            o_alv-&gt;set_marca_filas_sel( EXPORTING validar_seleccion = &apos;X&apos; fila_activa = l_fila_activa CHANGING t_tabla = i_listado hay_sel = hay_sel ).
          ENDIF.
        ENDIF.

      WHEN &apos;VISIBLE&apos;.
        accion_ejecutada = &apos;X&apos;.
        zcl_ap_batch_input=&gt;cambiar_modo( CHANGING modo = modo_ct ).
        CLEAR ucomm.

      WHEN &apos;EXCEL&apos;.
        IF NOT o_alv IS INITIAL.
          ASSIGN o_alv-&gt;table_ref-&gt;* TO &lt;tabla&gt;.
          IF sy-subrc = 0.
            SELECT SINGLE clsname FROM seoclass
              &quot; TODO: variable is assigned but never used (ABAP cleaner)
              INTO @DATA(l_clase)
             WHERE clsname = &apos;ZCL_AP_ABAP2XLS&apos;.
            IF sy-subrc = 0.
              exec_method_st( EXPORTING clase   = &apos;ZCL_AP_ABAP2XLS&apos;
                                        metodo  = &apos;ALV_2_XLS&apos;
                                        name1   = &apos;ALV&apos;
                                        value1  = o_alv-&gt;o_grid
                                        name2   = &apos;TABLA&apos;
                                        value2  = &lt;tabla&gt;
                                        name3   = &apos;ABRIR&apos;
                                        value3  = &apos;X&apos;
                                        name4   = &apos;NOMBRE_FICHERO&apos;
                                        value4  = sy-title
                              IMPORTING message = DATA(msg) ).
              IF NOT msg IS INITIAL.
                MESSAGE msg TYPE &apos;I&apos;.
              ENDIF.
            ELSE.
              o_alv-&gt;exportar_excel( ).
            ENDIF.
          ENDIF.
        ENDIF.

      WHEN OTHERS.
        IF seleccion &lt;&gt; &apos;&apos; AND ucomm &lt;&gt; &apos;&apos;.
          IF seleccion = &apos;X&apos; OR seleccion CS ucomm.
            IF fila_activa = &apos;X&apos; OR fila_activa CS ucomm.
              l_fila_activa = &apos;X&apos;.
            ENDIF.
            IF NOT o_alv IS INITIAL.
              o_alv-&gt;set_marca_filas_sel( EXPORTING validar_seleccion = &apos;X&apos; fila_activa = l_fila_activa CHANGING t_tabla = i_listado hay_sel = hay_sel ).
            ENDIF.
          ENDIF.
        ENDIF.

*    WHEN &apos;UBICAR&apos;.
*      o_alv-&gt;set_marca_filas_sel( EXPORTING validar_seleccion = &apos;X&apos; CHANGING t_tabla = i_listado hay_sel = l_hay_sel ).
*      IF l_hay_sel = &apos;X&apos;.
*      LOOP AT i_listado ASSIGNING &lt;listado&gt; WHERE check = &apos;X&apos;.
*        o_prog-&gt;ubicar( CHANGING listado = &lt;listado&gt; ).
*      ENDLOOP.
*      o_alv-&gt;refrescar_grid( ).
*      o_alv-&gt;set_seleccion( CHANGING t_tabla = i_listado ).
*        ENDIF.
*      WHEN &apos;GRABAR&apos;.
*        o_alv-&gt;comprobar_cambios( ).
*        o_prog-&gt;message( p1 = &apos;Se han guardado los cambios&apos; type = &apos;S&apos; no_log = &apos;&apos; ).
*        o_alv-&gt;refrescar_grid( ).
*        i_listado_ini = i_listado.
    ENDCASE.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO_M" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="57 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO_M" SCONAME="UCOMM" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Código función que ha lanzado PAI" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-UCOMM"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO_M" SCONAME="O_GRID" VERSION="1" LANGU="S" DESCRIPT="ALV Grid" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_ALV_GRID" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO_M" SCONAME="DATOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMAND_DYNPRO_M" SCONAME="TITLE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <source>METHOD command_dynpro_m. &quot;#EC EMPTY_PROCEDURE
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="COMMIT" VERSION="1" LANGU="S" DESCRIPT="Commit work" EXPOSURE="2" STATE="1" EDITORDER="22 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMMIT" SCONAME="DEQUEUE_ALL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <source>METHOD commit.
* Hacemos el Commit y esperamos a que se actualice todo
    CALL FUNCTION &apos;BAPI_TRANSACTION_COMMIT&apos;
      EXPORTING
        wait = &apos;X&apos;.
    COMMIT WORK AND WAIT.
*  CALL FUNCTION &apos;C14Z_WAIT_ON_COMMIT&apos;.

    IF dequeue_all = &apos;X&apos;.
      CALL FUNCTION &apos;DEQUEUE_ALL&apos;.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="COMPARAR_REPORTS" VERSION="1" LANGU="S" DESCRIPT="Compara reports" EXPOSURE="2" STATE="1" EDITORDER="4 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMPARAR_REPORTS" SCONAME="TABLA1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMPARAR_REPORTS" SCONAME="TABLA2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="COMPARAR_REPORTS" SCONAME="DIFERENCIAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="VXABAPT255_TAB"/>
  <source>METHOD comparar_reports.
    DATA: i_tab_old TYPE TABLE OF trdir,
          i_tab_new TYPE TABLE OF trdir,
          i_tab_del TYPE TABLE OF xtrdir.

    CLEAR diferencias.
    CALL FUNCTION &apos;SVRS_COMPUTE_DELTA_REPS&apos;
      EXPORTING
        compare_mode            = 1
        ignore_case_differences = &apos;X&apos;
      TABLES
        texttab_old             = tabla1
        texttab_new             = tabla2
        trdirtab_old            = i_tab_old
        trdirtab_new            = i_tab_new
        trdir_delta             = i_tab_del
        text_delta              = diferencias.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" VERSION="1" LANGU="S" DESCRIPT="Constructor" EXPOSURE="2" STATE="1" EDITORDER="1 " DISPID="0 " MTDTYPE="2" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="PROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="SY-CPROG" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="COMMIT_WORK" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="STATUS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;INICIO&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="PARAM_SAP_ALL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="OBJECT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="SUBOBJECT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="NO_PARAM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="GET_NOMBRE_PC" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="GET_DOC_FROM_REPORT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="GUARDAR_LOGZ" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="PROCESO_LOG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="NO_BREAK" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONSTRUCTOR" SCONAME="STATUS_PROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="13 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD constructor.
    DATA: l_status_prog TYPE sy-cprog,
          &quot; TODO: variable is assigned but never used (ABAP cleaner)
          l_obj_name    TYPE tadir-obj_name,
          i_excluir     TYPE TABLE OF char40,
          l_no_param    TYPE c LENGTH 1,
          l_status      TYPE sy-pfkey,
          l_status_ok   TYPE c LENGTH 1,
          l_subobject   TYPE balsubobj,
          l_its         TYPE c LENGTH 1,
          i_source      TYPE TABLE OF text255,
          l_source      TYPE text255.

    IF status_prog IS INITIAL.
      l_status_prog = sy-cprog.
    ELSE.
      l_status_prog = status_prog.
    ENDIF.
    me-&gt;status_prog = l_status_prog.

    o_par = NEW #( clave = prog ).

    o_sgpi = NEW #( commit_work = commit_work ).

    SELECT SINGLE obj_name FROM tadir
      INTO l_obj_name
     WHERE pgmid    = &apos;R3TR&apos;
       AND object   = &apos;CLAS&apos;
       AND obj_name = &apos;ZCL_CACHE&apos;.
    IF sy-subrc &lt;&gt; 0.
      o_cache = NEW #( ).
    ELSE.
      CREATE OBJECT o_cache TYPE (&apos;ZCL_CACHE&apos;).
    ENDIF.

    IF NOT status IS INITIAL.
      IF no_param = &apos;X&apos;.
        APPEND &apos;PARAM&apos; TO i_excluir.
        l_no_param = &apos;X&apos;.
      ELSE.
        IF param_sap_all = &apos;X&apos;.
          IF zcl_ap_autorizacion=&gt;es_sapall( ) = &apos;&apos;.
            APPEND &apos;PARAM&apos; TO i_excluir.
            l_no_param = &apos;X&apos;.
          ENDIF.
        ENDIF.
      ENDIF.
      IF object IS INITIAL AND guardar_logz IS INITIAL.
        APPEND &apos;LOG&apos; TO i_excluir.
      ENDIF.

      l_status = status.
      IF status = &apos;INICIO&apos; AND l_status_prog &lt;&gt; &apos;ZAP_STATUS&apos;.
        IF l_no_param = &apos;X&apos; AND object IS INITIAL.
          l_status = &apos;INICIO&apos;.
        ELSEIF l_no_param = &apos;&apos; AND NOT object IS INITIAL.
          l_status = &apos;INICIO_PARAM_LOG&apos;.
        ELSEIF l_no_param = &apos;&apos; AND object IS INITIAL.
          l_status = &apos;INICIO_PARAM&apos;.
        ELSE.
          l_status = &apos;INICIO_LOG&apos;.
        ENDIF.

        SELECT obj_code FROM rsmptexts                  &quot;#EC CI_GENBUFF
          INTO l_status
          UP TO 1 ROWS
         WHERE progname = l_status_prog
           AND sprsl    = sy-langu
           AND obj_type = &apos;C&apos;
           AND obj_code = l_status
          ORDER BY PRIMARY KEY.
        ENDSELECT.
        IF sy-subrc &lt;&gt; 0.
          SELECT obj_code FROM rsmptexts                &quot;#EC CI_GENBUFF
             INTO l_status
             UP TO 1 ROWS
            WHERE progname = l_status_prog
              AND obj_type = &apos;C&apos;
              AND obj_code = l_status
             ORDER BY PRIMARY KEY.
          ENDSELECT.
          IF sy-subrc &lt;&gt; 0.
            l_status = status.
          ENDIF.
        ENDIF.
      ENDIF.

      IF l_status_ok IS INITIAL.
        SELECT obj_code FROM rsmptexts                  &quot;#EC CI_GENBUFF
          INTO l_status
          UP TO 1 ROWS
         WHERE progname = l_status_prog
           AND sprsl    = sy-langu
           AND obj_type = &apos;C&apos;
           AND obj_code = l_status
          ORDER BY PRIMARY KEY.
        ENDSELECT.
        IF sy-subrc &lt;&gt; 0.
          SELECT obj_code FROM rsmptexts                &quot;#EC CI_GENBUFF
            INTO l_status
            UP TO 1 ROWS
           WHERE progname = l_status_prog
             AND obj_type = &apos;C&apos;
             AND obj_code = l_status
            ORDER BY PRIMARY KEY.
          ENDSELECT.
        ENDIF.
      ENDIF.
      IF sy-subrc = 0 OR l_status_ok = &apos;X&apos;.
*      SET PF-STATUS l_status EXCLUDING i_excluir.
        CALL FUNCTION &apos;RS_SET_SELSCREEN_STATUS&apos;
          EXPORTING
            p_status  = l_status
            p_program = l_status_prog
          TABLES
            p_exclude = i_excluir.
      ELSE.
        SELECT obj_code FROM rsmptextsi                 &quot;#EC CI_GENBUFF
          INTO l_status
          UP TO 1 ROWS
         WHERE progname = l_status_prog
           AND obj_type = &apos;C&apos;
           AND obj_code = l_status
          ORDER BY PRIMARY KEY.
        ENDSELECT.
        IF sy-subrc = 0.
*        SET PF-STATUS l_status OF PROGRAM sy-cprog EXCLUDING i_excluir.
          CALL FUNCTION &apos;RS_SET_SELSCREEN_STATUS&apos;
            EXPORTING
              p_status  = l_status
              p_program = l_status_prog
            TABLES
              p_exclude = i_excluir.
        ENDIF.
      ENDIF.
    ENDIF.

    IF NOT object IS INITIAL.
      me-&gt;object = object.
      IF subobject IS INITIAL.
        l_subobject = prog.
      ELSE.
        l_subobject = subobject.
      ENDIF.
      o_log = NEW #( object                = object
                     subobject             = l_subobject
                     grabar_siempre        = &apos;&apos;
                     guardar_tabla_interna = guardar_logz ).
    ELSEIF NOT proceso_log IS INITIAL.
      o_log = NEW #( object                = proceso_log
                     guardar_tabla_interna = guardar_logz ).
    ENDIF.

    IF get_nombre_pc = &apos;X&apos;.
      IF sy-batch IS INITIAL AND sy-binpt IS INITIAL.
        CALL FUNCTION &apos;GUI_IS_ITS&apos;
          IMPORTING
            return = l_its.
        IF l_its IS INITIAL.
          cl_gui_frontend_services=&gt;get_computer_name( CHANGING   computer_name        = nombre_pc
                                                       EXCEPTIONS cntl_error           = 1
                                                                  error_no_gui         = 2
                                                                  not_supported_by_gui = 3
                                                                  OTHERS               = 4 ).
          IF sy-subrc = 0.
            cl_gui_cfw=&gt;flush( ).
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.

    titulo = sy-title.

    IF get_doc_from_report = &apos;X&apos;.
      i_source = zcl_ap_dev=&gt;get_objeto_como_texto( tipo = &apos;PROG&apos; nombre = sy-cprog ).
      LOOP AT i_source INTO l_source.
        IF l_source(10) = &apos;*-&gt;MANUAL:&apos;.
          url_manual = l_source+10.
          REPLACE ALL OCCURRENCES OF &apos;*&apos; IN url_manual WITH &apos;&apos;.
          SPLIT url_manual AT &apos;,&apos; INTO url_manual url_manual_edt.
          IF NOT url_manual_edt IS INITIAL.
            IF sy-uname = zcl_c=&gt;usuario_ap.
              url_manual = url_manual_edt.
            ELSE.
              IF zcl_ap_lista=&gt;es_elemento( lista = zcl_c=&gt;usuarios_sistemas elemento = sy-uname ) = &apos;X&apos;.
                url_manual = url_manual_edt.
              ENDIF.
            ENDIF.
          ENDIF.
        ELSEIF l_source(13) = &apos;*-&gt;PLANTILLA:&apos;.
          url_plantilla = l_source+13.
          REPLACE ALL OCCURRENCES OF &apos;*&apos; IN url_plantilla WITH &apos;&apos;.
          SPLIT url_plantilla AT &apos;,&apos; INTO url_plantilla url_plantilla_edt.
          IF NOT url_manual_edt IS INITIAL.
            IF sy-uname = zcl_c=&gt;usuario_ap.
              url_plantilla = url_plantilla_edt.
            ELSE.
              IF zcl_ap_lista=&gt;es_elemento( lista = zcl_c=&gt;usuarios_sistemas elemento = sy-uname ) = &apos;X&apos;.
                url_plantilla = url_plantilla_edt.
              ENDIF.
            ENDIF.
          ENDIF.
          EXIT.
        ENDIF.
      ENDLOOP.
    ENDIF.

    IF NOT guardar_logz IS INITIAL.
      IF proceso_log IS INITIAL.
        me-&gt;proceso_log = sy-cprog.
      ELSE.
        me-&gt;proceso_log = proceso_log.
      ENDIF.
    ENDIF.

    me-&gt;no_break = no_break.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="CONTROL_EJECUCION_SIMULTANEA" VERSION="1" LANGU="S" DESCRIPT="Controla ejecuciones simultaneas" EXPOSURE="2" STATE="1" EDITORDER="34 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONTROL_EJECUCION_SIMULTANEA" SCONAME="CPROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="CONTROL_EJECUCION_SIMULTANEA" SCONAME="JOB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD control_ejecucion_simultanea.
    DATA: l_num_jobs TYPE i,
          l_cprog    TYPE sy-cprog.

    IF NOT job IS INITIAL.
      l_num_jobs = zcl_ap_jobs=&gt;num_job_activos( job ).

      IF    ( sy-batch = &apos;X&apos; AND l_num_jobs &gt; 1 )
         OR ( sy-batch = &apos;&apos;  AND l_num_jobs &gt; 0 ).
        MESSAGE &apos;Saliendo debido a que hay otro job activo&apos;(spa) TYPE &apos;I&apos;.
        LEAVE PROGRAM.
      ENDIF.
    ENDIF.

    IF NOT cprog IS INITIAL.
      l_cprog = cprog.
      IF zcl_ap_utils=&gt;bloquear_programa( cprog = l_cprog ) = &apos;X&apos;.
        MESSAGE &apos;Saliendo debido a que el programa ya se está ejecutando.&apos;(spe) TYPE &apos;I&apos;.
        LEAVE PROGRAM.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="DIF_VALORES_CAMPOS" VERSION="1" LANGU="S" DESCRIPT="Diferencia entre valores de campos" EXPOSURE="2" STATE="1" EDITORDER="56 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="DIF_VALORES_CAMPOS" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="DIF_VALORES_CAMPOS" SCONAME="VAR1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="DIF_VALORES_CAMPOS" SCONAME="VAR2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="DIF_VALORES_CAMPOS" SCONAME="CAMPOS_NO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="DIF_VALORES_CAMPOS" SCONAME="DIF" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD dif_valores_campos.
    DATA aux1 TYPE string.

    CLEAR dif.
    DATA(i_campos) = get_fieldcatalog_tabla( tabla = tabla ).
    DATA(r_campos_no) = zcl_ap_lista=&gt;lista2rango( campos_no ).

    LOOP AT i_campos ASSIGNING FIELD-SYMBOL(&lt;campo&gt;) WHERE NOT fieldname IN r_campos_no.
      ASSIGN COMPONENT &lt;campo&gt;-fieldname OF STRUCTURE var1 TO FIELD-SYMBOL(&lt;v1&gt;).
      IF sy-subrc &lt;&gt; 0.
        aux1 = |{ &lt;campo&gt;-fieldname } no existe en VAR1|.
      ELSE.
        ASSIGN COMPONENT &lt;campo&gt;-fieldname OF STRUCTURE var2 TO FIELD-SYMBOL(&lt;v2&gt;).
        IF sy-subrc &lt;&gt; 0.
          aux1 = |{ &lt;campo&gt;-fieldname } no existe en VAR2|.
        ELSE.
          IF &lt;v1&gt; &lt;&gt; &lt;v2&gt;.
            aux1 = |{ &lt;campo&gt;-fieldname }({ &lt;v1&gt; }&lt;&gt;{ &lt;v2&gt; })|.
          ENDIF.
        ENDIF.
      ENDIF.
      IF NOT aux1 IS INITIAL.
        IF dif IS INITIAL.
          dif = aux1.
        ELSE.
          dif = |{ dif } - { aux1 }|.
        ENDIF.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" VERSION="1" LANGU="S" DESCRIPT="Envío mail a destinatarios de tabla parámetros" EXPOSURE="2" STATE="1" EDITORDER="23 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZCAMPO_PARAM" PARVALUE="&apos;CORREO&apos;" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" SCONAME="SUBJECT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" SCONAME="TEXTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" SCONAME="DIRECCION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" SCONAME="URGENTE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" SCONAME="HTML" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" SCONAME="COMMIT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" SCONAME="FORZAR_MAIL_EXTERNO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" SCONAME="CONFIRMACION_LECTURA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BCS_RQST" PARVALUE="&apos;A&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ENVIO_MAIL" SCONAME="EMISOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD envio_mail.
    DATA: i_tabla TYPE zt_parametros,
          o_mail  TYPE REF TO zcl_ap_envio_mail,
          l_texto TYPE string,
          l_param TYPE zv_parametros.

    IF o_par IS INITIAL.
      RETURN.
    ENDIF.

    i_tabla = o_par-&gt;get_tabla_campo( campo ).

    IF i_tabla IS INITIAL.
      RETURN.
    ENDIF.

    o_mail = NEW #( usar_clases = &apos;X&apos; ).

    IF texto IS INITIAL.
      l_texto = subject.
    ELSE.
      l_texto = texto.
    ENDIF.

    o_mail-&gt;set_text( l_texto ).

    LOOP AT i_tabla INTO l_param.
      o_mail-&gt;add_destinatario( l_param-valor ).
    ENDLOOP.

    o_mail-&gt;envio_mail( subject              = subject
                        direccion            = direccion
                        urgente              = urgente
                        html                 = html
                        commit               = commit
                        forzar_mail_externo  = forzar_mail_externo
                        confirmacion_lectura = confirmacion_lectura
                        emisor               = emisor ).

    o_mail-&gt;free( ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="ES_UCOMM_GRABAR" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="46 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ES_UCOMM_GRABAR" SCONAME="UCOMM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-UCOMM" PARVALUE="SY-UCOMM"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="ES_UCOMM_GRABAR" SCONAME="RETURN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ABAP_BOOL"/>
  <source>METHOD es_ucomm_grabar.
    return = zcl_ap_lista=&gt;es_elemento( lista = ucomm_grabar elemento = ucomm ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="50 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="CLASE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="METODO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="NAME1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="VALUE1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="K1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="CL_ABAP_OBJECTDESCR=&gt;EXPORTING"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="NAME2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="VALUE2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="K2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="CL_ABAP_OBJECTDESCR=&gt;EXPORTING"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="NAME3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="VALUE3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="K3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="CL_ABAP_OBJECTDESCR=&gt;EXPORTING"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="NAME4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="VALUE4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="13 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="K4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="14 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="CL_ABAP_OBJECTDESCR=&gt;EXPORTING"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="I_PAR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="15 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_PARMBIND_TAB" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="RETURNING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="16 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="0" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="EXEC_METHOD_ST" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="17 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD exec_method_st.
    DATA: ptab   TYPE abap_parmbind_tab,
          tab    TYPE abap_parmbind,
          o_root TYPE REF TO cx_root.

    CLEAR message.

    ptab = i_par.

    IF NOT name1 IS INITIAL.
      CLEAR tab.
      tab-name = name1.
      tab-kind = k1.
      IF k1 = cl_abap_objectdescr=&gt;returning.
        tab-value = REF #( returning ).
      ELSE.
        tab-value = REF #( value1 ).
      ENDIF.
      INSERT tab INTO TABLE ptab.
    ENDIF.
    IF NOT name2 IS INITIAL.
      CLEAR tab.
      tab-name = name2.
      tab-kind = k2.
      IF k2 = cl_abap_objectdescr=&gt;returning.
        tab-value = REF #( returning ).
      ELSE.
        tab-value = REF #( value2 ).
      ENDIF.
      INSERT tab INTO TABLE ptab.
    ENDIF.
    IF NOT name3 IS INITIAL.
      CLEAR tab.
      tab-name = name3.
      tab-kind = k3.
      IF k3 = cl_abap_objectdescr=&gt;returning.
        tab-value = REF #( returning ).
      ELSE.
        tab-value = REF #( value3 ).
      ENDIF.
      INSERT tab INTO TABLE ptab.
    ENDIF.
    IF NOT name4 IS INITIAL.
      CLEAR tab.
      tab-name = name4.
      tab-kind = k4.
      IF k4 = cl_abap_objectdescr=&gt;returning.
        tab-value = REF #( returning ).
      ELSE.
        tab-value = REF #( value4 ).
      ENDIF.
      INSERT tab INTO TABLE ptab.
    ENDIF.

    TRY.
        CALL METHOD (clase)=&gt;(metodo) PARAMETER-TABLE ptab.

      CATCH cx_root INTO o_root. &quot;#EC *
        message = o_root-&gt;get_longtext( ).
        IF message IS INITIAL.
          message = o_root-&gt;get_text( ).
        ENDIF.
    ENDTRY.

*zcl_ap_dev=&gt;exec_method_st( exporting clase = &apos;ZCL_AP_PEDIDO_SD&apos; metodo = &apos;VISUALIZAR&apos;  name1 = &apos;VBELN&apos; value1 = CONV vbeln_va( &apos;0090670810&apos; ) IMPORTING message = data(msg) ).
*data l_returning type bapi_msg.
*zcl_ap_dev=&gt;exec_method_st( exporting clase = &apos;ZCL_AP_UTILS&apos; metodo = &apos;MESSAGE&apos;
*                                      name1 = &apos;P1&apos; value1 = &apos;parametro1&apos; name2 = &apos;P2&apos; value2 = &apos;parametro2&apos; name3 = &apos;TYPE&apos; value3 = &apos;S&apos;
*                                      name4 = &apos;MESSAGE&apos; k4 = CL_ABAP_OBJECTDESCR=&gt;receiving
*                            IMPORTING returning = l_Returning
*                                      message = data(msg) ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="FIN" VERSION="1" LANGU="S" DESCRIPT="Actualiza variables fin programa" EXPOSURE="2" STATE="1" EDITORDER="24 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD fin.
    IF NOT o_log IS INITIAL.
      o_log-&gt;grabar( ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET" VERSION="1" LANGU="S" DESCRIPT="Recupera variable de cache" EXPOSURE="2" STATE="1" EDITORDER="45 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET" SCONAME="CLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET" SCONAME="CLAVE2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET" SCONAME="CLAVE3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET" SCONAME="NOMBRE_CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET" SCONAME="NOMBRE_CAMPO2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET" SCONAME="IDIOMA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SPRAS" PARVALUE="SY-LANGU"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET" SCONAME="CAMPO_CLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET" SCONAME="CAMPO_IDIOMA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get.
    valor = o_cache-&gt;get( tabla         = tabla
                          clave         = clave
                          clave2        = clave2
                          clave3        = clave3
                          nombre_campo  = nombre_campo
                          nombre_campo2 = nombre_campo2
                          idioma        = idioma
                          campo_clave   = campo_clave
                          campo_idioma  = campo_idioma ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_ATRIBUTOS_CAMPO" VERSION="1" LANGU="S" DESCRIPT="Recupera atributos de un campo" EXPOSURE="2" STATE="1" EDITORDER="11 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_ATRIBUTOS_CAMPO" SCONAME="TABLA_CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_ATRIBUTOS_CAMPO" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_ATRIBUTOS_CAMPO" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_ATRIBUTOS_CAMPO" SCONAME="DD03L" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="DD03L"/>
  <source>METHOD get_atributos_campo.
    DATA: l_tabla TYPE string,
          l_campo TYPE string,
          &quot; TODO: variable is assigned but never used (ABAP cleaner)
          l_aux   TYPE string.

    CLEAR dd03l.
    IF campo IS INITIAL AND tabla_campo CS &apos;-&apos;.
      SPLIT tabla_campo AT &apos;-&apos; INTO l_tabla l_campo.
      IF l_campo CS &apos;(&apos;.
        SPLIT l_campo AT &apos;(&apos; INTO l_campo l_aux.
      ENDIF.
    ELSE.
      l_campo = campo.
      l_tabla = tabla.
    ENDIF.

    SELECT * FROM dd03l
      INTO dd03l
      UP TO 1 ROWS
     WHERE tabname   = l_tabla
       AND fieldname = l_campo
      ORDER BY PRIMARY KEY.
    ENDSELECT.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_CAMPOS_Z" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="62 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_CAMPOS_Z" SCONAME="TABLA" VERSION="1" LANGU="S" DESCRIPT="Nombre de tabla" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_CAMPOS_Z-TABLA"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_CAMPOS_Z" SCONAME="CLAVE" VERSION="1" LANGU="S" DESCRIPT="Clave de objeto" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_CAMPOS_Z-CLAVE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_CAMPOS_Z" SCONAME="DATOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD get_campos_z.
    TRY.
        SELECT campo, valor FROM zap_campos_z
          INTO TABLE @DATA(i_campos)
         WHERE tabla = @tabla
           AND clave = @clave.

        LOOP AT i_campos ASSIGNING FIELD-SYMBOL(&lt;campo&gt;).
          ASSIGN COMPONENT &lt;campo&gt;-campo OF STRUCTURE datos TO FIELD-SYMBOL(&lt;fs&gt;).
          IF sy-subrc = 0.
            &lt;fs&gt; = &lt;campo&gt;-valor.
          ENDIF.
        ENDLOOP.
      CATCH cx_root INTO DATA(o_root). &quot;#EC *
        MESSAGE |Error { o_root-&gt;get_text( ) }| TYPE &apos;S&apos;.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_CAMPO_Z" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="61 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_CAMPO_Z" SCONAME="TABLA" VERSION="1" LANGU="S" DESCRIPT="Nombre de tabla" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_CAMPOS_Z-TABLA"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_CAMPO_Z" SCONAME="CLAVE" VERSION="1" LANGU="S" DESCRIPT="Clave de objeto" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_CAMPOS_Z-CLAVE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_CAMPO_Z" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_CAMPO_Z" SCONAME="VALOR" VERSION="1" LANGU="S" DESCRIPT="Valor" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ZAP_CAMPOS_Z-VALOR"/>
  <source>METHOD get_campo_z.
    TRY.
        CLEAR valor.
        SELECT SINGLE valor FROM zap_campos_z
          INTO valor
         WHERE tabla = tabla
           AND clave = clave
           AND campo = campo.
      CATCH cx_root INTO DATA(o_root). &quot;#EC *
        MESSAGE |Error { o_root-&gt;get_text( ) }| TYPE &apos;S&apos;.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_COMP_DATOS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="30 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_COMP_DATOS" SCONAME="DATOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_COMP_DATOS" SCONAME="I_COMP" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ABAP_COMPONENT_TAB"/>
  <source>METHOD get_comp_datos.
    DATA: lr_data     TYPE REF TO data,
          lo_tabdescr TYPE REF TO cl_abap_structdescr.

    CLEAR i_comp.
    GET REFERENCE OF datos INTO lr_data.
    lo_tabdescr ?= cl_abap_structdescr=&gt;describe_by_data_ref( lr_data ).
    i_comp = lo_tabdescr-&gt;get_components( ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DEFAULT_VARIANT" VERSION="1" LANGU="S" DESCRIPT="Devuelve la variante por defecto" EXPOSURE="2" STATE="1" EDITORDER="14 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DEFAULT_VARIANT" SCONAME="NOMBRE_PC" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <source>METHOD get_default_variant.
    DATA h_repid            TYPE rsvar-report.
    DATA h_variant          TYPE rsvar-variant.
    DATA h_subrc            TYPE sy-subrc.
    DATA l_inicio_inmediato TYPE c LENGTH 1.

    IF sy-slset IS NOT INITIAL.
      RETURN.
    ENDIF.

    h_repid = sy-cprog.
    CLEAR h_variant.
    h_variant = &apos;U_&apos;.
    WRITE sy-uname TO h_variant+2.
*--- User specific variant
    CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
      EXPORTING
        report  = h_repid
        variant = h_variant
      IMPORTING
        r_c     = h_subrc.
    IF h_subrc = 0.
      IF sy-batch = &apos;X&apos;.
        h_subrc = 4.
        CLEAR h_variant.
      ENDIF.
    ELSE.
      CLEAR h_variant.
    ENDIF.
    IF sy-batch = &apos;&apos; AND h_variant IS INITIAL.
      h_variant = &apos;U_&apos;.
      WRITE sy-uname TO h_variant+2.
      CONCATENATE h_variant &apos;#&apos; INTO h_variant.
      CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
        EXPORTING
          report  = h_repid
          variant = h_variant
        IMPORTING
          r_c     = h_subrc.
      IF h_subrc = 0.
        l_inicio_inmediato = &apos;X&apos;.
      ENDIF.
    ENDIF.

    IF NOT h_subrc IS INITIAL.
      IF sy-uname = zcl_c=&gt;usuario_ap.
        IF NOT nombre_pc IS INITIAL.
          IF zcl_c=&gt;nombre_pc CS nombre_pc.
            h_variant = &apos;_PC&apos;.
            CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
              EXPORTING
                report  = h_repid
                variant = h_variant
              IMPORTING
                r_c     = h_subrc.
          ENDIF.
        ENDIF.
        IF NOT h_subrc IS INITIAL.
          h_variant = &apos;P&apos;.
          CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
            EXPORTING
              report  = h_repid
              variant = h_variant
            IMPORTING
              r_c     = h_subrc.
          IF h_subrc &lt;&gt; 0.
            IF sy-tcode = &apos;SADT_START_WB_URI&apos;.
              h_variant = &apos;ECLIPSE&apos;.
              CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
                EXPORTING
                  report  = h_repid
                  variant = h_variant
                IMPORTING
                  r_c     = h_subrc.
            ENDIF.
            IF h_subrc &lt;&gt; 0.
              IF sy-tcode = &apos;SE38&apos; OR sy-tcode = &apos;SADT_START_WB_URI&apos;.
                h_variant = &apos;SE38&apos;.
                CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
                  EXPORTING
                    report  = h_repid
                    variant = h_variant
                  IMPORTING
                    r_c     = h_subrc.
              ENDIF.
            ENDIF.
          ENDIF.
        ENDIF.
      ENDIF.
      IF NOT h_subrc IS INITIAL.
*--- customizing variant
        CLEAR h_variant.
        h_variant = &apos;SAP_TCODE_&apos;.
        WRITE sy-tcode TO h_variant+10.
        CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
          EXPORTING
            report  = h_repid
            variant = h_variant
          IMPORTING
            r_c     = h_subrc.
        IF NOT h_subrc IS INITIAL.
*--- system variant
          CLEAR h_variant.
          h_variant = &apos;SAP&amp;TCODE_&apos;.
          WRITE sy-tcode TO h_variant+10.
          CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
            EXPORTING
              report  = h_repid
              variant = h_variant
            IMPORTING
              r_c     = h_subrc.
        ENDIF.
        IF NOT h_subrc IS INITIAL.
*--- system variant
          CLEAR h_variant.
          h_variant = &apos;DEFAULT&apos;.
          CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
            EXPORTING
              report  = h_repid
              variant = h_variant
            IMPORTING
              r_c     = h_subrc.
        ENDIF.
        IF NOT h_subrc IS INITIAL.
*--- system variant
          CLEAR h_variant.
          h_variant = sy-tcode.
          CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
            EXPORTING
              report  = h_repid
              variant = h_variant
            IMPORTING
              r_c     = h_subrc.
          IF h_subrc &lt;&gt; 0.
            CLEAR h_variant.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.

    IF sy-batch = &apos;X&apos;.
      h_subrc = 4.
      CLEAR h_variant.
    ENDIF.

    IF NOT h_variant IS INITIAL.
      IF l_inicio_inmediato IS INITIAL.
        CALL FUNCTION &apos;RS_SUPPORT_SELECTIONS&apos;
          EXPORTING
            report               = h_repid
            variant              = h_variant
          EXCEPTIONS
            variant_not_existent = 01
            variant_obsolete     = 02.
        IF sy-subrc &lt;&gt; 0.
          IF sy-uname = zcl_c=&gt;usuario_ap.
            MESSAGE &apos;Error recuperando variante&apos;(erv) TYPE &apos;S&apos;.
          ENDIF.
        ENDIF.
      ELSE.
        SUBMIT (sy-cprog) USING SELECTION-SET h_variant. &quot;#EC CI_SUBMIT
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION" VERSION="1" LANGU="S" DESCRIPT="Recupera descripción si es posible" EXPOSURE="2" STATE="1" EDITORDER="18 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION" SCONAME="VALOR2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION" SCONAME="NOMBRE_CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION" SCONAME="NOMBRE_CAMPO2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION" SCONAME="IDIOMA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SPRAS" PARVALUE="SY-LANGU"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION" SCONAME="CAMPO_CLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION" SCONAME="CAMPO_IDIOMA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION" SCONAME="TEXTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_descripcion.
    DATA: i_campos             TYPE ddfields,
          l_campo              TYPE dfies,
          l_campo_idioma       TYPE string,
          l_where              TYPE string,
          l_nombre_campo_texto TYPE string,
          l_ncampos            TYPE i,
          o_cx_root            TYPE REF TO cx_root,
          l_string             TYPE string,
          l_campo_texto2       TYPE string.

    i_campos = get_fieldcatalog_tabla( tabla ).
    DELETE i_campos WHERE fieldname = &apos;MANDT&apos;.           &quot;#EC CI_STDSEQ

    IF campo_idioma IS INITIAL.
      LOOP AT i_campos INTO l_campo WHERE datatype = &apos;LANG&apos;. &quot;#EC CI_STDSEQ
        l_campo_idioma = l_campo-fieldname.
        DELETE i_campos.
        CONCATENATE l_campo_idioma &apos; = &apos;&apos;&apos; idioma &apos;&apos;&apos; AND &apos; INTO l_where.
        EXIT.
      ENDLOOP.
    ELSEIF campo_idioma = &apos;NO&apos;.                    &quot;#EC EMPTY_IF_BRANCH

    ELSE.
      CONCATENATE campo_idioma &apos; = &apos;&apos;&apos; idioma &apos;&apos;&apos; AND &apos; INTO l_where.
    ENDIF.

    l_nombre_campo_texto = nombre_campo.

    IF NOT campo_clave IS INITIAL.
      CONCATENATE l_where campo_clave INTO l_where SEPARATED BY space.
      CONCATENATE l_where &apos; = &apos;&apos;&apos; valor &apos;&apos;&apos;&apos; INTO l_where.
    ELSE.
      l_ncampos = lines( i_campos ).
      IF l_ncampos &gt;= 2.
        READ TABLE i_campos INTO l_campo INDEX 1.
        CONCATENATE l_where l_campo-fieldname INTO l_where SEPARATED BY space.
        CONCATENATE l_where &apos; = &apos;&apos;&apos; valor &apos;&apos;&apos;&apos; INTO l_where.

        IF NOT valor2 IS INITIAL.
          READ TABLE i_campos INTO l_campo INDEX 2.
          CONCATENATE l_where &apos;AND&apos; l_campo-fieldname INTO l_where SEPARATED BY space.
          CONCATENATE l_where &apos; = &apos;&apos;&apos; valor2 &apos;&apos;&apos;&apos; INTO l_where.
          DELETE i_campos INDEX 2.
        ENDIF.

        IF l_nombre_campo_texto IS INITIAL.
          READ TABLE i_campos INTO l_campo WITH KEY rollname = &apos;CVTEXT&apos;.
          IF sy-subrc = 0.
            l_nombre_campo_texto = l_campo-fieldname.
          ELSE.
            READ TABLE i_campos INTO DATA(l_campo2) INDEX 2.
            IF sy-subrc = 0.
              l_nombre_campo_texto = l_campo2-fieldname.
            ENDIF.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.

    IF line_exists( i_campos[ fieldname = &apos;BEGDA&apos; ] ) AND line_exists( i_campos[ fieldname = &apos;ENDDA&apos; ] ).
      l_where = |{ l_where } AND BEGDA &lt;= &apos;{ sy-datum }&apos; AND ENDDA &gt;= &apos;{ sy-datum }&apos;|.
    ENDIF.

    TRY.
        SELECT SINGLE (l_nombre_campo_texto) FROM (tabla)
          INTO texto
         WHERE (l_where).
      CATCH cx_root INTO o_cx_root.                         &quot;#EC *
        IF sy-uname = zcl_c=&gt;usuario_ap.
          l_string = o_cx_root-&gt;get_longtext( ).
          MESSAGE l_string TYPE &apos;I&apos;.
        ENDIF.
    ENDTRY.

    IF NOT nombre_campo2 IS INITIAL.
      SELECT SINGLE (nombre_campo2) FROM (tabla)
        INTO l_campo_texto2
       WHERE (l_where).
      IF sy-subrc = 0.
        CONCATENATE texto l_campo_texto2 INTO texto SEPARATED BY space.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCIONES" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="53 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCIONES" SCONAME="CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCIONES" SCONAME="LIST" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD get_descripciones.
    DATA: i_campos    TYPE TABLE OF string,
          l_campo_ref TYPE string.

    FIELD-SYMBOLS: &lt;campo_ref&gt;  TYPE any,
                   &lt;valor&gt;      TYPE any,
                   &lt;campo_ref2&gt; TYPE any.

    SPLIT campos AT &apos;,&apos; INTO TABLE i_campos.
    LOOP AT i_campos ASSIGNING FIELD-SYMBOL(&lt;campo&gt;).
      CLEAR l_campo_ref.
      CASE &lt;campo&gt;.
        WHEN &apos;STTXT&apos; OR &apos;USTXT&apos;.
          ASSIGN COMPONENT &apos;OBJNR&apos; OF STRUCTURE list TO &lt;campo_ref&gt;.
          IF sy-subrc = 0.
            l_campo_ref = &apos;OBJNR&apos;.
          ELSE.
            ASSIGN COMPONENT &apos;AUFNR&apos; OF STRUCTURE list TO &lt;campo_ref&gt;.
            IF sy-subrc = 0.
              l_campo_ref = &apos;AUFNR&apos;.
            ENDIF.
          ENDIF.
        WHEN &apos;EQKTX&apos;. l_campo_ref = &apos;EQUNR&apos;.
        WHEN &apos;PLTXT&apos;. l_campo_ref = &apos;TPLNR&apos;.
        WHEN &apos;MAKTX&apos; OR &apos;MEINS&apos;. l_campo_ref = &apos;MATNR&apos;.
        WHEN &apos;HKONT_T&apos;. l_campo_ref = &apos;HKONT&apos;.
        WHEN &apos;NAME1_PROV&apos;. l_campo_ref = &apos;LIFNR&apos;.
        WHEN &apos;ENAME&apos;. l_campo_ref = &apos;PERNR&apos;.
        WHEN &apos;DMBTR&apos; OR &apos;WRBTR&apos; OR &apos;MENGE&apos;. l_campo_ref = &apos;SHKZG&apos;.
        WHEN &apos;NOMBRE_USUARIO&apos; OR &apos;EMAIL_USUARIO&apos;.
          l_campo_ref = &apos;UNAME&apos;.
          ASSIGN COMPONENT l_campo_ref OF STRUCTURE list TO &lt;campo_ref&gt;.
          IF sy-subrc &lt;&gt; 0.
            l_campo_ref = &apos;USER_ID&apos;.
          ENDIF.
        WHEN OTHERS.
          IF &lt;campo&gt; CS `_T-D `.
            SPLIT &lt;campo&gt; AT `_T-D ` INTO aux1 aux2.
            ASSIGN COMPONENT aux1 OF STRUCTURE list TO &lt;campo_ref&gt;.
            IF sy-subrc = 0.
              CONCATENATE aux1 &apos;_T&apos; INTO aux1.
              ASSIGN COMPONENT aux1 OF STRUCTURE list TO &lt;valor&gt;.
              IF sy-subrc = 0.
                CONCATENATE &apos;D&apos; aux2 INTO aux2 SEPARATED BY space.
                &lt;valor&gt; = get( tabla = aux2 clave = &lt;campo_ref&gt; ).
              ENDIF.
            ENDIF.
          ENDIF.
      ENDCASE.
      IF NOT l_campo_ref IS INITIAL.
        ASSIGN COMPONENT l_campo_ref OF STRUCTURE list TO &lt;campo_ref&gt;.
        IF sy-subrc = 0.
          ASSIGN COMPONENT &lt;campo&gt; OF STRUCTURE list TO &lt;valor&gt;.
          IF sy-subrc = 0.
            CASE &lt;campo&gt;.
              WHEN &apos;STTXT&apos;.
                CASE l_campo_ref.
                  WHEN &apos;OBJNR&apos;. &lt;valor&gt; = zcl_ap_orden_pp=&gt;get_status_st( objnr = CONV #( &lt;campo_ref&gt; ) ).
                  WHEN &apos;AUFNR&apos;. &lt;valor&gt; = zcl_ap_orden_pp=&gt;get_status_st( aufnr = &lt;campo_ref&gt; ).
                ENDCASE.
              WHEN &apos;USTXT&apos;.
                CASE l_campo_ref.
                  WHEN &apos;OBJNR&apos;. &lt;valor&gt; = zcl_ap_orden_pp=&gt;get_status_st( objnr = CONV #( &lt;campo_ref&gt; ) usuario = &apos;X&apos; ).
                  WHEN &apos;AUFNR&apos;. &lt;valor&gt; = zcl_ap_orden_pp=&gt;get_status_st( aufnr = &lt;campo_ref&gt; usuario = &apos;X&apos; ).
                ENDCASE.
              WHEN &apos;EQKTX&apos;. &lt;valor&gt; = get( tabla = &apos;EQKT&apos; clave = &lt;campo_ref&gt; ).
              WHEN &apos;PLTXT&apos;. &lt;valor&gt; = get( tabla = &apos;IFLOTX&apos; clave = &lt;campo_ref&gt; ).
              WHEN &apos;MAKTX&apos;. &lt;valor&gt; = get( tabla = &apos;MAKT&apos; clave = &lt;campo_ref&gt; ).
              WHEN &apos;MEINS&apos;. &lt;valor&gt; = get( tabla = &apos;MEINS&apos; clave = &lt;campo_ref&gt; ).
              WHEN &apos;HKONT_T&apos;.
                ASSIGN COMPONENT &apos;KTOPL&apos; OF STRUCTURE list TO &lt;campo_ref2&gt;.
                IF sy-subrc = 0.
                  &lt;valor&gt; = get( tabla = &apos;SKAT&apos; clave = &lt;campo_ref&gt; clave2 = &lt;campo_ref2&gt; ).
                ELSE.
                  &lt;valor&gt; = get( tabla = &apos;SKAT&apos; clave = &lt;campo_ref&gt; ).
                ENDIF.
              WHEN &apos;ENAME&apos;. &lt;valor&gt; = get( tabla = &apos;ENAME&apos; clave = &lt;campo_ref&gt; ).
              WHEN &apos;NAME1_PROV&apos;. &lt;valor&gt; = get( tabla = &apos;LFA1&apos; clave = &lt;campo_ref&gt; ).
              WHEN &apos;NOMBRE_USUARIO&apos;. &lt;valor&gt; = get( tabla = &apos;NOMBRE_USUARIO&apos; clave = &lt;campo_ref&gt; ).
              WHEN &apos;EMAIL_USUARIO&apos;. &lt;valor&gt; = get( tabla = &apos;EMAIL_USUARIO&apos; clave = &lt;campo_ref&gt; ).
              WHEN &apos;DMBTR&apos; OR &apos;WRBTR&apos; OR &apos;MENGE&apos;.
                IF &lt;campo_ref&gt; = &apos;H&apos;.
                  &lt;valor&gt; = - &lt;valor&gt;.
                ENDIF.
            ENDCASE.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION_CAMPO" VERSION="1" LANGU="S" DESCRIPT="Recupera descripción de campo" EXPOSURE="2" STATE="1" EDITORDER="12 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION_CAMPO" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION_CAMPO" SCONAME="TABLA_CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION_CAMPO" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION_CAMPO" SCONAME="IDIOMA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-LANGU" PARVALUE="SY-LANGU"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_DESCRIPCION_CAMPO" SCONAME="DDTEXT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="DD04T-DDTEXT"/>
  <source>METHOD get_descripcion_campo.
    DATA l_dd03l TYPE dd03l.

    l_dd03l = get_atributos_campo( campo       = campo
                                   tabla       = tabla
                                   tabla_campo = tabla_campo ).
    IF NOT l_dd03l IS INITIAL.
      SELECT ddtext FROM dd04t
        INTO ddtext
        UP TO 1 ROWS
       WHERE ddlanguage = idioma
         AND rollname   = l_dd03l-rollname
        ORDER BY PRIMARY KEY.
      ENDSELECT.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG" VERSION="1" LANGU="S" DESCRIPT="Recupera catálogo de campos de tabla interna" EXPOSURE="2" STATE="1" EDITORDER="9 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STANDARD TABLE" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG" SCONAME="LIMPIAR_TABLAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG" SCONAME="DESGLOSAR_INCLUDES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG" SCONAME="LINEA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG" SCONAME="SOLO_TIPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG" SCONAME="CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ABAP_COMPONENT_TAB"/>
  <source>METHOD get_fieldcatalog.
    DATA: lr_data         TYPE REF TO data,
          lo_tabdescr     TYPE REF TO cl_abap_structdescr,
          l_linea         TYPE abap_componentdescr,
          lr_tipo         TYPE REF TO cl_abap_typedescr,
          i_mas_campos    TYPE abap_component_tab,
          i_mas_campos2   TYPE abap_component_tab,
          i_nuevos_campos TYPE abap_component_tab.

    IF NOT tabla IS INITIAL.
      CREATE DATA lr_data LIKE LINE OF tabla.
      lo_tabdescr ?= cl_abap_structdescr=&gt;describe_by_data_ref( lr_data ).
    ELSE.
      TRY.
          CREATE DATA lr_data LIKE linea.
          lo_tabdescr ?= cl_abap_structdescr=&gt;describe_by_data_ref( lr_data ).
        CATCH cx_sy_move_cast_error.
          RETURN.
      ENDTRY.
    ENDIF.
    campos = lo_tabdescr-&gt;get_components( ).

    IF limpiar_tablas = &apos;X&apos;.
      DELETE campos WHERE type-&gt;type_kind = &apos;h&apos;.         &quot;#EC CI_STDSEQ
    ENDIF.

    IF desglosar_includes = &apos;X&apos;.
      LOOP AT campos INTO l_linea WHERE NOT name IS INITIAL. &quot;#EC CI_STDSEQ
        TRY.
            lr_tipo ?= l_linea-type.
            IF lr_tipo-&gt;type_kind = &apos;h&apos;.
              DELETE campos.
            ENDIF.
          CATCH cx_sy_move_cast_error INTO DATA(o_cast).
            message = o_cast-&gt;get_text( ).
        ENDTRY.
      ENDLOOP.

      LOOP AT campos INTO l_linea WHERE name IS INITIAL AND as_include = &apos;X&apos;. &quot;#EC CI_STDSEQ
        lo_tabdescr ?= l_linea-type.
        i_mas_campos = lo_tabdescr-&gt;get_components( ).

        LOOP AT i_mas_campos INTO l_linea.
          IF l_linea-name IS INITIAL AND l_linea-as_include = &apos;X&apos;.
            lo_tabdescr ?= l_linea-type.
            i_mas_campos2 = lo_tabdescr-&gt;get_components( ).
            LOOP AT i_mas_campos2 INTO l_linea.
              APPEND l_linea TO i_nuevos_campos.
            ENDLOOP.
          ELSE.
            APPEND l_linea TO i_nuevos_campos.
          ENDIF.
        ENDLOOP.
      ENDLOOP.

      LOOP AT i_nuevos_campos INTO l_linea.
        APPEND l_linea TO campos.
      ENDLOOP.
    ENDIF.

    IF NOT solo_tipos IS INITIAL.
      LOOP AT campos INTO l_linea WHERE NOT name IS INITIAL. &quot;#EC CI_STDSEQ
        TRY.
            lr_tipo ?= l_linea-type.
            IF lr_tipo-&gt;type_kind CN solo_tipos.
              DELETE campos.
            ENDIF.
          CATCH cx_sy_move_cast_error INTO o_cast.
            message = o_cast-&gt;get_text( ).
        ENDTRY.
      ENDLOOP.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_DDIC" VERSION="1" LANGU="S" DESCRIPT="Recupera catálogo de campos de tabla de diccionario" EXPOSURE="2" STATE="1" EDITORDER="10 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_DDIC" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STANDARD TABLE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_DDIC" SCONAME="CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="DDFIELDS"/>
  <source>METHOD get_fieldcatalog_ddic.
    DATA: lr_data     TYPE REF TO data,
          lo_tabdescr TYPE REF TO cl_abap_structdescr.

    CREATE DATA lr_data LIKE LINE OF tabla.

    lo_tabdescr ?= cl_abap_structdescr=&gt;describe_by_data_ref( lr_data ).

*  ls_header = lo_tabdescr-&gt;get_ddic_header( ).

*  campos = lo_tabdescr-&gt;get_ddic_field_list( ).

    lo_tabdescr-&gt;get_ddic_field_list(
*    EXPORTING
*                                                 p_langu      = SY-LANGU
*                                                 p_including_substructres = ABAP_FALSE
      RECEIVING
        p_field_list = campos
      EXCEPTIONS
        not_found    = 1
        no_ddic_type = 2
        OTHERS       = 3 ).
    IF sy-subrc &lt;&gt; 0.
      CLEAR campos.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_TABLA" VERSION="1" LANGU="S" DESCRIPT="Recupera catálogo de campos de tabla de diccionario" EXPOSURE="2" STATE="1" EDITORDER="13 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_TABLA" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_TABLA" SCONAME="SOLO_CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_TABLA" SCONAME="CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="DDFIELDS"/>
  <source>METHOD get_fieldcatalog_tabla.
    &quot; TODO: variable is assigned but never used (ABAP cleaner)
    DATA: l_tabname   TYPE tabname,
          lo_tabdescr TYPE REF TO cl_abap_structdescr.
    DATA i_soloc TYPE TABLE OF fieldname.

    SELECT SINGLE tabname FROM dd02l
      INTO l_tabname
     WHERE tabname = tabla.

    IF sy-subrc &lt;&gt; 0.
      RETURN.
    ENDIF.

    TRY.
        lo_tabdescr ?= cl_abap_structdescr=&gt;describe_by_name( tabla ).
      CATCH cx_root. &quot;#EC *
        RETURN.
    ENDTRY.
*  ls_header = lo_tabdescr-&gt;get_ddic_header( ).

    campos = lo_tabdescr-&gt;get_ddic_field_list( ).

    IF NOT solo_campos IS INITIAL.
      SPLIT solo_campos AT &apos;,&apos; INTO TABLE i_soloc.
      DATA(i_c) = campos.
      CLEAR campos.
      LOOP AT i_soloc ASSIGNING FIELD-SYMBOL(&lt;soloc&gt;).
        ASSIGN i_c[ fieldname = &lt;soloc&gt; ] TO FIELD-SYMBOL(&lt;campo&gt;).
        IF sy-subrc = 0.
          APPEND &lt;campo&gt; TO campos.
        ENDIF.
      ENDLOOP.

*    DATA(r_campos) = zcl_ap_lista=&gt;lista2rango( solo_campos ).
*    DELETE campos WHERE NOT fieldname IN r_campos.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_TABLA_ALV" VERSION="1" LANGU="S" DESCRIPT="Devuelve campos tabla interna usando ALV" EXPOSURE="2" STATE="1" EDITORDER="29 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_TABLA_ALV" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY TABLE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_TABLA_ALV" SCONAME="FIX_REF" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_TABLA_ALV" SCONAME="TABLA_REF" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_FIELDCATALOG_TABLA_ALV" SCONAME="CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="LVC_T_FCAT"/>
  <source>METHOD get_fieldcatalog_tabla_alv.
    DATA: table        TYPE REF TO data,
          salv_table   TYPE REF TO cl_salv_table,
          columns      TYPE REF TO cl_salv_columns_table,
          aggregations TYPE REF TO cl_salv_aggregations.

    FIELD-SYMBOLS &lt;tabla&gt; TYPE any.

    CREATE DATA table LIKE tabla.
    ASSIGN table-&gt;* TO &lt;tabla&gt;.
    TRY.
        cl_salv_table=&gt;factory( IMPORTING r_salv_table = salv_table
                                CHANGING  t_table      = &lt;tabla&gt; ).

        columns = salv_table-&gt;get_columns( ).
        aggregations = salv_table-&gt;get_aggregations( ).
        campos = cl_salv_controller_metadata=&gt;get_lvc_fieldcatalog( r_columns      = columns &quot; ALV Filter
                                                                    r_aggregations = aggregations ). &quot; ALV Aggregations

        IF tabla_ref &lt;&gt; &apos;&apos;.
          LOOP AT campos ASSIGNING FIELD-SYMBOL(&lt;campo&gt;).
            SELECT fieldname
              FROM dd03l
              WHERE tabname   = @tabla_ref
                AND fieldname = @&lt;campo&gt;-fieldname
              ORDER BY PRIMARY KEY
              INTO @&lt;campo&gt;-ref_field
              UP TO 1 ROWS.
            ENDSELECT.
            IF sy-subrc = 0.
              &lt;campo&gt;-ref_table = tabla_ref.
            ENDIF.
          ENDLOOP.
        ENDIF.

        IF fix_ref = &apos;X&apos;.
          LOOP AT campos ASSIGNING &lt;campo&gt; WHERE rollname &lt;&gt; &apos;&apos; AND ref_table IS INITIAL.
            CASE &lt;campo&gt;-rollname.
              WHEN &apos;MAKTX&apos;.
                &lt;campo&gt;-ref_table = &apos;MAKT&apos;.
                &lt;campo&gt;-ref_field = &apos;MAKTX&apos;.
              WHEN &apos;NAME1_GP&apos;.
                &lt;campo&gt;-ref_table = &apos;LFA1&apos;.
                &lt;campo&gt;-ref_field = &apos;NAME1&apos;.
              WHEN &apos;BAPI_MSG&apos;.
                &lt;campo&gt;-ref_table = &apos;BAPIRET2&apos;.
                &lt;campo&gt;-ref_field = &apos;MESSAGE&apos;.
              WHEN OTHERS.
                IF NOT &lt;campo&gt;-domname IS INITIAL.
                  SELECT entitytab
                    FROM dd01l
                    WHERE domname = @&lt;campo&gt;-domname
                    ORDER BY PRIMARY KEY
                    INTO @&lt;campo&gt;-ref_table
                    UP TO 1 ROWS.
                  ENDSELECT.
                  IF NOT &lt;campo&gt;-ref_table IS INITIAL.
                    &lt;campo&gt;-ref_field = &lt;campo&gt;-domname.
                  ENDIF.
                ENDIF.
            ENDCASE.
          ENDLOOP.
        ENDIF.

* APC20221128 En nueva version de Hana da problmeas
        LOOP AT campos ASSIGNING &lt;campo&gt; WHERE ref_field &lt;&gt; &apos;&apos; AND ref_table IS INITIAL.
          CLEAR &lt;campo&gt;-ref_field.
        ENDLOOP.

      CATCH cx_root INTO DATA(o_root).                      &quot;#EC *
        MESSAGE o_root-&gt;get_text( ) TYPE &apos;E&apos;.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_OBJETO_COMO_TEXTO" VERSION="1" LANGU="S" DESCRIPT="Devuelve el contenido del objeto en formato texto plano" EXPOSURE="2" STATE="1" EDITORDER="2 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_OBJETO_COMO_TEXTO" SCONAME="TIPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_OBJETO_COMO_TEXTO" SCONAME="NOMBRE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_OBJETO_COMO_TEXTO" SCONAME="MODO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_OBJETO_COMO_TEXTO" SCONAME="I_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="TTTEXT255"/>
  <source>METHOD get_objeto_como_texto.
    TYPES: BEGIN OF t_trdir,
             name      TYPE trdir-name,
             name_orig TYPE trdir-name,
           END OF t_trdir.
    TYPES: BEGIN OF t_inc_sort,
             orden TYPE string.
             INCLUDE TYPE seop_method_w_include.
    TYPES: END OF t_inc_sort.

    DATA:
      source      TYPE seop_source_string,
      cifref      TYPE REF TO if_oo_clif_incl_naming,
      clsref      TYPE REF TO if_oo_class_incl_naming,
      pool_source TYPE seop_source_string,
      source_line TYPE LINE OF seop_source_string,
      tabix       TYPE sytabix,
      includes    TYPE seop_methods_w_include,
      include     TYPE seop_method_w_include,
      intref      TYPE REF TO if_oo_interface_incl_naming.
    DATA: l_string  TYPE string,
          l_name    TYPE ddobjname,
          &quot; TODO: variable is assigned but never used (ABAP cleaner)
          got_state TYPE ddgotstate,
          ddxx      TYPE dd02v,
          &quot; TODO: variable is assigned but never used (ABAP cleaner)
          ddxx2     TYPE dd09l,
          ddtb_tab  TYPE TABLE OF dd03p,
          ddtb      TYPE dd03p.
    DATA i_inc_sort TYPE TABLE OF t_inc_sort.
    DATA: l_tfdir TYPE tfdir,
          l_tabla TYPE text255.
    DATA: l_trdir TYPE t_trdir,
          l_dd40l TYPE dd40l.
    DATA o_bi TYPE REF TO zcl_ap_batch_input.
    DATA xml  TYPE string.

    IF nombre IS INITIAL.
      RETURN.
    ENDIF.

    CLEAR i_tabla.
    CASE tipo.
      WHEN &apos;PROG&apos;.
        READ REPORT nombre INTO i_tabla.
      WHEN &apos;DDLS&apos;.
        SELECT source
          FROM ddddlsrc
          WHERE ddlname = @nombre
          ORDER BY PRIMARY KEY
          INTO @l_string
          UP TO 1 ROWS.
        ENDSELECT.
        zcl_ap_string=&gt;string2tabla( EXPORTING string = l_string longitud = 255 CHANGING tabla = i_tabla ).
      WHEN &apos;CLAS&apos;.
        TYPE-POOLS:
          seoc,
          seop.

        CLASS cl_oo_include_naming DEFINITION LOAD.

        cl_oo_include_naming=&gt;get_instance_by_cifkey( EXPORTING  cifkey = CONV #( nombre )
                                                      RECEIVING  cifref = cifref
                                                      EXCEPTIONS OTHERS = 1 ).
        IF sy-subrc &lt;&gt; 0.
          RETURN.
        ENDIF.

        CASE cifref-&gt;clstype.
          WHEN seoc_clstype_class.
            clsref ?= cifref.
            READ REPORT clsref-&gt;class_pool
                 INTO pool_source.
            LOOP AT pool_source INTO source_line.
              IF    source_line CS &apos;CLASS-POOL&apos;
                 OR source_line CS &apos;class-pool&apos;.

                IF source_line = &apos;class-pool .&apos; OR source_line = &apos;&apos;. &quot;#EC EMPTY_IF_BRANCH
                ELSE.
                  APPEND source_line TO i_tabla.
                ENDIF.
                tabix = sy-tabix.
                EXIT.
              ENDIF.
            ENDLOOP.

            READ REPORT clsref-&gt;locals_old
                 INTO source.
            LOOP AT source
                 INTO source_line.
              IF source_line NS &apos;*&quot;*&apos; AND source_line &lt;&gt; &apos;&apos;.
                APPEND source_line TO i_tabla.
              ENDIF.
            ENDLOOP.
            READ REPORT clsref-&gt;locals_def
                 INTO source.
            LOOP AT source
                 INTO source_line.
              IF source_line NS &apos;*&quot;*&apos; AND source_line &lt;&gt; &apos;&apos;.
                APPEND source_line TO i_tabla.
              ENDIF.
            ENDLOOP.
            READ REPORT clsref-&gt;locals_imp
                 INTO source.
            LOOP AT source
                 INTO source_line.
              IF source_line NS &apos;*&quot;*&apos; AND source_line &lt;&gt; &apos;&apos;.
                IF source_line = &apos;type-pools abap .&apos;. &quot;#EC EMPTY_IF_BRANCH
                ELSE.
                  APPEND source_line TO i_tabla.
                ENDIF.
              ENDIF.
            ENDLOOP.

            READ REPORT clsref-&gt;macros
                 INTO source.
            LOOP AT source
                 INTO source_line.
              IF source_line NS &apos;*&quot;*&apos;.
                APPEND source_line TO i_tabla.
              ENDIF.
            ENDLOOP.
            READ REPORT clsref-&gt;public_section
                 INTO source.
            LOOP AT source
                 INTO source_line.
              IF source_line NS &apos;*&quot;*&apos;.
                APPEND source_line TO i_tabla.
              ENDIF.
            ENDLOOP.
            READ REPORT clsref-&gt;protected_section
                 INTO source.
            LOOP AT source
                 INTO source_line.
              IF source_line NS &apos;*&quot;*&apos;.
                APPEND source_line TO i_tabla.
              ENDIF.
            ENDLOOP.
            READ REPORT clsref-&gt;private_section
                 INTO source.
            LOOP AT source
                 INTO source_line.
              IF source_line NS &apos;*&quot;*&apos;.
                APPEND source_line TO i_tabla.
              ENDIF.
            ENDLOOP.
            CONCATENATE &apos;CLASS&apos; nombre &apos;IMPLEMENTATION&apos; INTO l_string SEPARATED BY space.
            LOOP AT pool_source
                 FROM tabix
                 INTO source_line.
              IF source_line CS &apos;ENDCLASS&apos;.
                APPEND source_line TO i_tabla.
              ENDIF.
              IF source_line CS l_string.
                APPEND source_line TO i_tabla.
                tabix = sy-tabix.
                EXIT.
              ENDIF.
            ENDLOOP.
* method implementation
            includes = clsref-&gt;get_all_method_includes( ).
            MOVE-CORRESPONDING includes TO i_inc_sort.
            LOOP AT i_inc_sort ASSIGNING FIELD-SYMBOL(&lt;inc&gt;).
              READ REPORT &lt;inc&gt;-incname INTO source.
              READ TABLE source INTO source_line INDEX 1.
              IF sy-subrc = 0.
                &lt;inc&gt;-orden = to_lower( source_line ).
                CONDENSE &lt;inc&gt;-orden NO-GAPS.
              ENDIF.
            ENDLOOP.
            SORT i_inc_sort.
            CLEAR includes.
            MOVE-CORRESPONDING i_inc_sort TO includes.

            LOOP AT includes
                 INTO include.
              READ REPORT include-incname
                   INTO source.
              LOOP AT source
                   INTO source_line.
                APPEND source_line TO i_tabla.
              ENDLOOP.
            ENDLOOP.
            LOOP AT pool_source
                 FROM tabix
                 INTO source_line.
              IF source_line CS &apos;ENDCLASS&apos;.
                APPEND source_line TO i_tabla.
              ENDIF.
            ENDLOOP.

          WHEN seoc_clstype_interface.
            intref ?= cifref.
            READ REPORT intref-&gt;interface_pool
                 INTO source.
            LOOP AT source INTO source_line.
              APPEND source_line TO i_tabla.
            ENDLOOP.
            READ REPORT intref-&gt;public_section
                 INTO source.
            LOOP AT source INTO source_line.
              APPEND source_line TO i_tabla.
            ENDLOOP.

        ENDCASE.
*      SUBMIT seo_class_output
*       AND RETURN
*       WITH cifkey = nombre
*      EXPORTING LIST TO MEMORY.
*
*      DATA list_tab TYPE TABLE OF abaplist.
*      CALL FUNCTION &apos;LIST_FROM_MEMORY&apos;
*        TABLES
*          listobject = list_tab
*        EXCEPTIONS
*          not_found  = 1
*          OTHERS     = 2.
*
*      IF sy-subrc = 0.
*        DATA i_texto TYPE  list_string_table.
*        CALL FUNCTION &apos;LIST_TO_DAT&apos;
*          EXPORTING
*            list_index         = -1
*          CHANGING
*            listobject         = list_tab
*            listdat            = i_texto
*          EXCEPTIONS
*            empty_list         = 1
*            list_index_invalid = 2.
*
*        DATA l_aux6(6).
*        LOOP AT i_texto ASSIGNING FIELD-SYMBOL(&lt;tab&gt;).
*          l_aux6 = &lt;tab&gt;.
*          TRANSLATE l_aux6 TO UPPER CASE.
*          IF l_aux6 = &apos;CLASS&apos;.
*            EXIT.
*          ELSE.
*            DELETE i_texto.
*          ENDIF.
*        ENDLOOP.
*        i_tabla = i_texto.
*      ENDIF.

*      CONCATENATE nombre &apos;=%&apos; INTO l_report.
*      SELECT * FROM trdir
*        INTO CORRESPONDING FIELDS OF TABLE i_trdir
*       WHERE name LIKE l_report
*         AND name NOT LIKE &apos;%=CS&apos;.
*      IF sy-subrc NE 0.
*        CONCATENATE nombre &apos;%&apos; INTO l_report.
*        SELECT * FROM trdir
*          INTO CORRESPONDING FIELDS OF TABLE i_trdir
*         WHERE name LIKE l_report.
*      ENDIF.
*
*      LOOP AT i_trdir INTO l_trdir.
*        l_trdir-name_orig = l_trdir-name.
*        READ REPORT l_trdir-name INTO  i_tabla2.
*        IF sy-subrc = 0.
*          READ TABLE i_tabla2 INTO l_tabla INDEX 1.
*          IF sy-subrc = 0.
*            l_tabix = sy-tabix.
*            TRANSLATE l_tabla TO UPPER CASE.
*            CLEAR l_aux.
*            SPLIT l_tabla AT &apos;METHOD&apos; INTO l_tabla l_aux.
*            IF NOT l_aux IS INITIAL.
*              REPLACE &apos;.&apos; WITH &apos; &apos; INTO l_aux.
*              CONDENSE l_aux NO-GAPS.
*              CONCATENATE nombre &apos;=&apos; l_aux INTO l_trdir-name.
*            ENDIF.
*          ENDIF.
*        ENDIF.
*        MODIFY i_trdir FROM l_trdir.
*      ENDLOOP.
*      SORT i_trdir.
*
*      LOOP AT i_trdir INTO l_trdir.
*        l_tabla = c_lin_sep.
*        APPEND l_tabla TO i_tabla.
*        APPEND l_trdir-name TO i_tabla.
*        l_tabla = c_lin_sep.
*        APPEND l_tabla TO i_tabla.
*        READ REPORT l_trdir-name_orig INTO  i_tabla2.
*        LOOP AT i_tabla2 INTO l_tabla.
*          APPEND l_tabla TO i_tabla.
*        ENDLOOP.
*      ENDLOOP.

      WHEN &apos;FUGR&apos;.
        SELECT SINGLE * FROM tfdir
          INTO l_tfdir
         WHERE funcname = nombre.
        CONCATENATE l_tfdir-pname+3 &apos;U&apos; l_tfdir-include INTO l_trdir-name.
        READ REPORT l_trdir-name INTO i_tabla.
      WHEN &apos;TABL&apos;.

        l_name = nombre.
        CALL FUNCTION &apos;DDIF_TABL_GET&apos;
          EXPORTING
            name          = l_name
            state         = &apos;M&apos;
            langu         = sy-langu
          IMPORTING
            gotstate      = got_state
            dd02v_wa      = ddxx
            dd09l_wa      = ddxx2
          TABLES
            dd03p_tab     = ddtb_tab
*           DD12V_TAB     = DD12V_TAB
          EXCEPTIONS
            illegal_input = 1.
        IF sy-subrc = 0.
          CONCATENATE &apos;TABLA:&apos; ddxx-tabname ddxx-ddtext
                      INTO l_tabla SEPARATED BY space.
          APPEND l_tabla TO i_tabla.
          LOOP AT ddtb_tab INTO ddtb.
            IF modo &lt;&gt; &apos;C&apos;.
              CONCATENATE ddtb-fieldname &apos;;&apos; ddtb-rollname &apos;;&apos;
                          ddtb-inttype &apos;;&apos; ddtb-leng &apos;;&apos;
                          ddtb-ddtext INTO l_tabla.
            ELSE.
              CONCATENATE ddtb-fieldname &apos;;&apos; ddtb-rollname &apos;;&apos;
                          ddtb-inttype &apos;;&apos; ddtb-leng INTO l_tabla.
            ENDIF.
            APPEND l_tabla TO i_tabla.
          ENDLOOP.
        ENDIF.
      WHEN &apos;TTYP&apos;.
        SELECT rowtype FROM  dd40l
          INTO l_dd40l-rowtype
          UP TO 1 ROWS
         WHERE typename = nombre
          ORDER BY PRIMARY KEY.
        ENDSELECT.
        IF sy-subrc = 0.
          CONCATENATE &apos;TIPO TABLA:&apos; l_dd40l-rowtype
                      INTO l_tabla SEPARATED BY space.
          APPEND l_tabla TO i_tabla.
        ENDIF.
      WHEN &apos;SSFO&apos;.
        IF modo &lt;&gt; &apos;C&apos;.
          o_bi = NEW #( ).

          o_bi-&gt;inicio( ).

* SAP Smart Forms: Initial screen
          o_bi-&gt;dynpro( program = &apos;SAPMSSFO&apos; dynpro = &apos;0100&apos; ).
          o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=XMLDOWN&apos; ).

* Smart Forms: Determine form name (create, change, ...)
          o_bi-&gt;dynpro( program = &apos;SAPLSTXB&apos; dynpro = &apos;3000&apos; ).
          o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=ENTER&apos; ).
          o_bi-&gt;campos( campo = &apos;SSFSCREEN-FNAME&apos; valor = nombre ). &quot; Smart Forms: Nombre formulario

* SAP Smart Forms: Initial screen
          o_bi-&gt;dynpro( program = &apos;SAPMSSFO&apos; dynpro = &apos;0100&apos; ).
          o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=BACK&apos; ).
          o_bi-&gt;campos( campo = &apos;RB_SF&apos; valor = &apos;X&apos; ).
          o_bi-&gt;campos( campo = &apos;SSFSCREEN-FNAME&apos; valor = &apos;c:\temp\smartforms&apos; ). &quot; Smart Forms: Nombre formulario

          o_bi-&gt;llamar_transaccion( tcode = &apos;SMARTFORMS&apos; modo = &apos;E&apos; ).
        ENDIF.
      WHEN OTHERS.
        xml = get_saplink_xml( object = tipo nombre = nombre ).

        IF NOT xml IS INITIAL.
          zcl_ap_string=&gt;string2tabla( EXPORTING string   = xml
                                                 longitud = 255 ##NUMBER_OK
                                       CHANGING  tabla    = i_tabla ).

        ENDIF.
    ENDCASE.

    IF modo = &apos;C&apos;.
      texto_comparable( CHANGING i_tabla = i_tabla ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_SAPLINK_XML" VERSION="1" LANGU="S" DESCRIPT="Devuelve un string XML con el objeto en formato SAPLINK" EXPOSURE="2" STATE="1" EDITORDER="8 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_SAPLINK_XML" SCONAME="OBJECT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_SAPLINK_XML" SCONAME="NOMBRE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_SAPLINK_XML" SCONAME="XML" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_saplink_xml.
    TYPES: BEGIN OF t_objecttable,
             classname TYPE string,
             object    TYPE ko100-object,
             text      TYPE ko100-text,
           END OF t_objecttable.

    DATA l_objtable   TYPE TABLE OF t_objecttable.
    DATA l_objline    TYPE t_objecttable.
    DATA _objname     TYPE string.
    DATA targetobject TYPE REF TO zsaplink.
    DATA ixmldocument TYPE REF TO if_ixml_document.
    DATA excclass     TYPE REF TO zcx_saplink.
    &quot; TODO: variable is assigned but never used (ABAP cleaner)
    DATA errormsg     TYPE string.

    CHECK NOT object IS INITIAL AND NOT nombre IS INITIAL.

    zsaplink=&gt;getplugins( CHANGING objecttable = l_objtable ).

    READ TABLE l_objtable INTO l_objline WITH KEY object = object. &quot;#EC CI_STDSEQ
    IF sy-subrc &lt;&gt; 0.
      RETURN.
    ENDIF.

    _objname = nombre.
    CREATE OBJECT targetobject
      TYPE
        (l_objline-classname)
      EXPORTING name = _objname.
    TRY.
        ixmldocument = targetobject-&gt;createixmldocfromobject( ).
      CATCH zcx_saplink INTO excclass.
        errormsg = excclass-&gt;get_text( ).
      CATCH cx_root. &quot;#EC *
        errormsg = &apos;Error generando SLNK&apos;(egs).
    ENDTRY.

    IF NOT ixmldocument IS INITIAL.
      TRY.
          xml = zsaplink=&gt;convertixmldoctostring( ixmldocument ).
        CATCH zcx_saplink INTO excclass.
          errormsg = excclass-&gt;get_text( ).
        CATCH cx_root. &quot;#EC *
          errormsg = &apos;Error generando SLNK&apos;(egs).
      ENDTRY.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_VAL" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="51 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_VAL" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_VAL" SCONAME="LINEA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_VAL" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_VAL" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD get_val.
    FIELD-SYMBOLS &lt;fs&gt; TYPE any.

    IF linea IS INITIAL.
      IF me-&gt;linea IS INITIAL.
        message = &apos;No hay definido línea&apos;.
        RETURN.
      ELSE.
        ASSIGN COMPONENT campo OF STRUCTURE me-&gt;linea TO &lt;fs&gt;.
      ENDIF.
    ELSE.
      ASSIGN COMPONENT campo OF STRUCTURE linea TO &lt;fs&gt;.
    ENDIF.

    IF &lt;fs&gt; IS ASSIGNED.
      valor = &lt;fs&gt;.
    ELSE.
      message = |Estructura no contiene campo { campo }|.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="GET_VALS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="52 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_VALS" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_VALS" SCONAME="LINEA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="GET_VALS" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_vals.
    get_val( EXPORTING campo   = campo
                       linea   = linea
             IMPORTING valor   = valor
                      &quot; TODO: variable is assigned but never used (ABAP cleaner)
                       message = DATA(l_message) ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" VERSION="1" LANGU="S" DESCRIPT="Procesa opciones INITIALITATION" EXPOSURE="2" STATE="1" EDITORDER="17 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" SCONAME="GOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" SCONAME="NOMBRE_PC" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" SCONAME="URL_MANUAL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" SCONAME="BOTON_MANUAL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;@J7@ Manual usuario&apos;(MUS)"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" SCONAME="BOTON_PLANTILLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;@J2@ Ejemplo fichero carga&apos;(EFC)"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" SCONAME="GET_DEFAULT_PARAM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" SCONAME="URL_PLANTILLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" SCONAME="TCODE_DOC" VERSION="1" LANGU="S" DESCRIPT="Código transacción" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZDOCUMENTOS-TCODE" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" SCONAME="BOTON_DOC_TECNICA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;@19@&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION" SCONAME="SSCRFIELDS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="SSCRFIELDS" PAROPTIONL="X"/>
  <source>METHOD initialization.
    DATA l_no_var_def TYPE c LENGTH 1.

    IF sy-batch IS INITIAL AND get_default_param = &apos;X&apos;.
      GET PARAMETER ID &apos;Z_NO_VAR_DEF&apos; FIELD l_no_var_def ##EXISTS.
      IF l_no_var_def IS INITIAL.
        zcl_ap_dev=&gt;get_default_variant( nombre_pc = nombre_pc ).
      ENDIF.
    ENDIF.

    IF gos = &apos;X&apos;.
      zcl_ap_dev=&gt;inserta_boton_gos( ).
    ENDIF.

    IF NOT tcode_doc IS INITIAL.
      DATA(l_tcode_doc) = tcode_doc.
    ELSE.
      l_tcode_doc = sy-cprog.
    ENDIF.

    IF NOT boton_manual IS INITIAL.
      zcl_ap_documentos=&gt;get_documentos_por_clas( EXPORTING tcode = l_tcode_doc
                                                            clasificacion = &apos;MANUAL&apos;
                                                  IMPORTING i_documentos = DATA(i_documentos)
                                                            eliminados = DATA(l_eliminados) ).
      IF NOT i_documentos IS INITIAL.
        sscrfields-functxt_02 = boton_manual.
        IF boton_manual = &apos;@J7@ Manual usuario&apos;(mus).
          LOOP AT i_documentos ASSIGNING FIELD-SYMBOL(&lt;documento&gt;) WHERE boton &lt;&gt; &apos;&apos;.
            sscrfields-functxt_02 = &lt;documento&gt;-boton.
            EXIT.
          ENDLOOP.
        ENDIF.
      ELSEIF l_eliminados = 0.
        IF    zcl_ap_documentos=&gt;existe_doc( tcode = l_tcode_doc
                                             nombre = &apos;MANUAL&apos;
                                             clasificacion = &apos;&apos; ) &quot; Documentacion formato antiguo sin permisos
              = &apos;X&apos;
           OR url_manual &lt;&gt; &apos;&apos;.
          sscrfields-functxt_02 = boton_manual.
        ENDIF.
      ENDIF.
    ENDIF.

    IF NOT boton_plantilla IS INITIAL.
      IF zcl_ap_documentos=&gt;existe_doc( &apos;PLANTILLA&apos; ) = &apos;X&apos; OR url_plantilla &lt;&gt; &apos;&apos;.
        sscrfields-functxt_03 = boton_plantilla.
      ENDIF.
    ENDIF.

    IF NOT boton_plantilla IS INITIAL.
      zcl_ap_documentos=&gt;get_documentos_por_clas( EXPORTING tcode = l_tcode_doc
                                                            clasificacion = &apos;PLANTILLA&apos;
                                                  IMPORTING i_documentos = i_documentos
                                                            eliminados = l_eliminados ).
      IF NOT i_documentos IS INITIAL.
        sscrfields-functxt_03 = boton_plantilla.
        IF boton_plantilla = &apos;@J2@ Ejemplo fichero carga&apos;(efc).
          LOOP AT i_documentos ASSIGNING &lt;documento&gt; WHERE boton &lt;&gt; &apos;&apos;.
            sscrfields-functxt_03 = &lt;documento&gt;-boton.
            EXIT.
          ENDLOOP.
        ENDIF.
      ELSEIF l_eliminados = 0.
        IF    zcl_ap_documentos=&gt;existe_doc( tcode = l_tcode_doc
                                             nombre = &apos;PLANTILLA&apos;
                                             clasificacion = &apos;&apos; ) &quot; Documentacion formato antiguo sin permisos
              = &apos;X&apos;
           OR url_plantilla &lt;&gt; &apos;&apos;.
          sscrfields-functxt_03 = boton_plantilla.
        ENDIF.
      ENDIF.
    ENDIF.

    IF NOT boton_doc_tecnica IS INITIAL.
      zcl_ap_documentos=&gt;get_documentos_por_clas( EXPORTING tcode = l_tcode_doc
                                                            clasificacion = &apos;DOC_TEC&apos;
                                                  IMPORTING i_documentos = i_documentos
                                                            eliminados = l_eliminados ).
      IF NOT i_documentos IS INITIAL OR l_eliminados &gt; 0.
        sscrfields-functxt_04 = boton_doc_tecnica.
        IF boton_doc_tecnica = icon_message_information.
          LOOP AT i_documentos ASSIGNING &lt;documento&gt; WHERE boton &lt;&gt; &apos;&apos;.
            sscrfields-functxt_04 = &lt;documento&gt;-boton.
            EXIT.
          ENDLOOP.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_I" VERSION="1" LANGU="S" DESCRIPT="Procesa opciones INITIALITATION" EXPOSURE="2" STATE="1" EDITORDER="32 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_I" SCONAME="GOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_I" SCONAME="BOTON_MANUAL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;@J7@ Manual usuario&apos;(MUS)"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_I" SCONAME="BOTON_PLANTILLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;@J2@ Ejemplo fichero carga&apos;(EFC)"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_I" SCONAME="GET_DEFAULT_PARAM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_I" SCONAME="TCODE_DOC" VERSION="1" LANGU="S" DESCRIPT="Código transacción" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZDOCUMENTOS-TCODE" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_I" SCONAME="BOTON_DOC_TECNICA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;@19\Q*Documentación técnica@&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_I" SCONAME="BOTON_FC05" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZDOCUMENTOS-CLASIFICACION" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_I" SCONAME="SSCRFIELDS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="SSCRFIELDS" PAROPTIONL="X"/>
  <source>METHOD initialization_i.
    DATA l_no_var_def TYPE c LENGTH 1.

    IF sy-batch IS INITIAL AND get_default_param = &apos;X&apos;.
      GET PARAMETER ID &apos;Z_NO_VAR_DEF&apos; FIELD l_no_var_def ##EXISTS.
      IF l_no_var_def IS INITIAL.
        get_default_variant( nombre_pc = me-&gt;nombre_pc ).
      ENDIF.
    ENDIF.

    IF gos = &apos;X&apos;.
      inserta_boton_gos( ).
    ENDIF.

    IF NOT tcode_doc IS INITIAL.
      DATA(l_tcode_doc) = tcode_doc.
    ELSE.
      l_tcode_doc = sy-cprog.
    ENDIF.

    IF NOT boton_manual IS INITIAL.
      zcl_ap_documentos=&gt;get_documentos_por_clas( EXPORTING tcode = l_tcode_doc
                                                            clasificacion = &apos;MANUAL&apos;
                                                  IMPORTING i_documentos = DATA(i_documentos)
                                                            eliminados = DATA(l_eliminados) ).
      IF NOT i_documentos IS INITIAL.
        sscrfields-functxt_02 = boton_manual.
        IF boton_manual = &apos;@J7@ Manual usuario&apos;(mus).
          LOOP AT i_documentos ASSIGNING FIELD-SYMBOL(&lt;documento&gt;) WHERE boton &lt;&gt; &apos;&apos;.
            sscrfields-functxt_02 = &lt;documento&gt;-boton.
            EXIT.
          ENDLOOP.
        ENDIF.
      ELSEIF l_eliminados = 0.
        IF    zcl_ap_documentos=&gt;existe_doc( tcode = l_tcode_doc
                                             nombre = &apos;MANUAL&apos;
                                             clasificacion = &apos;&apos; ) &quot; Documentacion formato antiguo sin permisos
              = &apos;X&apos;
           OR me-&gt;url_manual &lt;&gt; &apos;&apos;.
          sscrfields-functxt_02 = boton_manual.
        ENDIF.
      ENDIF.
    ENDIF.

    IF NOT boton_plantilla IS INITIAL.
      zcl_ap_documentos=&gt;get_documentos_por_clas( EXPORTING tcode = l_tcode_doc
                                                            clasificacion = &apos;PLANTILLA&apos;
                                                  IMPORTING i_documentos = i_documentos
                                                            eliminados = l_eliminados ).
      IF NOT i_documentos IS INITIAL.
        sscrfields-functxt_03 = boton_plantilla.
        IF boton_plantilla = &apos;@J2@ Ejemplo fichero carga&apos;(efc).
          LOOP AT i_documentos ASSIGNING &lt;documento&gt; WHERE boton &lt;&gt; &apos;&apos;.
            sscrfields-functxt_03 = &lt;documento&gt;-boton.
            EXIT.
          ENDLOOP.
        ENDIF.
      ELSEIF l_eliminados = 0.
        IF    zcl_ap_documentos=&gt;existe_doc( tcode = l_tcode_doc
                                             nombre = &apos;PLANTILLA&apos;
                                             clasificacion = &apos;&apos; ) &quot; Documentacion formato antiguo sin permisos
              = &apos;X&apos;
           OR me-&gt;url_plantilla &lt;&gt; &apos;&apos;.
          sscrfields-functxt_03 = boton_plantilla.
        ENDIF.
      ENDIF.
    ENDIF.

    IF NOT boton_doc_tecnica IS INITIAL.
      zcl_ap_documentos=&gt;get_documentos_por_clas( EXPORTING tcode = l_tcode_doc
                                                            clasificacion = &apos;DOC_TEC&apos;
                                                  IMPORTING i_documentos = i_documentos
                                                            eliminados = l_eliminados ).
      IF NOT i_documentos IS INITIAL.
        sscrfields-functxt_04 = boton_doc_tecnica.
        IF boton_doc_tecnica = icon_message_information.
          LOOP AT i_documentos ASSIGNING &lt;documento&gt; WHERE boton &lt;&gt; &apos;&apos;.
            sscrfields-functxt_04 = &lt;documento&gt;-boton.
            EXIT.
          ENDLOOP.
        ENDIF.
      ENDIF.
    ENDIF.

    IF NOT boton_fc05 IS INITIAL.
      zcl_ap_documentos=&gt;get_documentos_por_clas( EXPORTING tcode = CONV #( sy-cprog )
                                                            clasificacion = boton_fc05
                                                  IMPORTING i_documentos = i_documentos ).
      LOOP AT i_documentos ASSIGNING &lt;documento&gt; WHERE boton &lt;&gt; &apos;&apos;.
        sscrfields-functxt_05 = &lt;documento&gt;-boton.
        EXIT.
      ENDLOOP.
    ENDIF.

    IF me-&gt;status_prog = &apos;ZAP_STATUS&apos;.
      PERFORM set_sscrfields IN PROGRAM zap_status USING sscrfields IF FOUND.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_V2" VERSION="1" LANGU="S" DESCRIPT="Procesa opciones INITIALITATION" EXPOSURE="2" STATE="1" EDITORDER="54 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_V2" SCONAME="GOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_V2" SCONAME="BOTON_MANUAL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;@J7@ Manual usuario&apos;(MUS)"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_V2" SCONAME="BOTON_PLANTILLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;@J2@ Ejemplo fichero carga&apos;(EFC)"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_V2" SCONAME="GET_DEFAULT_PARAM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_V2" SCONAME="BATCH" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Procesamiento de fondo activo" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SYST_BATCH" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="INITIALIZATION_V2" SCONAME="SSCRFIELDS" VERSION="1" LANGU="S" DESCRIPT="Campos en las imágenes de selección" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="SSCRFIELDS" PAROPTIONL="X"/>
  <source>METHOD initialization_v2.
*    DATA l_no_var_def.

*    IF batch IS INITIAL AND get_default_param = &apos;X&apos;.
*      GET PARAMETER ID &apos;Z_NO_VAR_DEF&apos; FIELD l_no_var_def.   &quot;#EC EXISTS
*      IF l_no_var_def IS INITIAL.
*        get_default_variant( nombre_pc = me-&gt;nombre_pc ).
*      ENDIF.
*    ENDIF.

    IF gos = &apos;X&apos;.
      inserta_boton_gos( ).
    ENDIF.

    IF NOT boton_manual IS INITIAL.
      IF zcl_ap_documentos=&gt;existe_doc( &apos;MANUAL&apos; ) = &apos;X&apos; OR me-&gt;url_manual &lt;&gt; &apos;&apos;.
        sscrfields-functxt_02 = boton_manual.
      ENDIF.
    ENDIF.

    IF NOT boton_plantilla IS INITIAL.
      IF zcl_ap_documentos=&gt;existe_doc( &apos;PLANTILLA&apos; ) = &apos;X&apos; OR me-&gt;url_plantilla &lt;&gt; &apos;&apos;.
        sscrfields-functxt_03 = boton_plantilla.
      ENDIF.
    ENDIF.

    IF me-&gt;status_prog = &apos;ZAP_STATUS&apos;.
      PERFORM set_sscrfields IN PROGRAM zap_status USING sscrfields IF FOUND.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="INSERTA_BOTON_GOS" VERSION="1" LANGU="S" DESCRIPT="Inserta botón GOS para reports ZAPC" EXPOSURE="2" STATE="1" EDITORDER="15 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD inserta_boton_gos.
    boton_gos_obj( objeto = &apos;ZREP_APC&apos;
                   clave  = sy-cprog ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" VERSION="1" LANGU="S" DESCRIPT="Envia por mail información del programa" EXPOSURE="2" STATE="1" EDITORDER="47 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="DIRECCION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="ZCL_C=&gt;DEST_AVISOS_MAIL"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="ASUNTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="TABLA1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="TABLA2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="TABLA3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="O_ALV1" VERSION="1" LANGU="S" DESCRIPT="ALV" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_ALV" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="TABLA_ALV1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="NOMBRE_TABLA1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="NOMBRE_TABLA2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="NOMBRE_TABLA3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="NOMBRE_ALV1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="COMMIT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="TEXTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="13 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="I_TEXTOS" VERSION="1" LANGU="S" DESCRIPT="Tablas con texto claro (línea en blanco = párrafo)" CMPTYPE="1" MTDTYPE="0" EDITORDER="14 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="RSPC_T_TEXT" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="INFO_PROGRAMA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="15 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="INFO_VARIANTE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="16 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="INFO_ALV" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="17 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="INFO_LOG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="18 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="INFO_VARIABLES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="19 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="O_ALV2" VERSION="1" LANGU="S" DESCRIPT="ALV" CMPTYPE="1" MTDTYPE="0" EDITORDER="20 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_ALV" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="TABLA_ALV2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="21 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="NOMBRE_ALV2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="22 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="O_GRID2" VERSION="1" LANGU="S" DESCRIPT="ALV Grid" CMPTYPE="1" MTDTYPE="0" EDITORDER="23 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_ALV_GRID" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="TABLA_GRID2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="24 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="NOMBRE_GRID2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="25 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_INFO" SCONAME="MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="26 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD mail_info.
    DATA: lt_globals   TYPE TABLE OF rfieldlist,
          lv_fieldname TYPE string.
    DATA: subject    TYPE string,
          tab        TYPE abap_parmbind,
          ptab       TYPE abap_parmbind_tab,
          l_texto    TYPE solisti1,
          i_textosl  TYPE rspc_t_text,
          o_variante TYPE REF TO zcl_ap_variante,
          l_var      TYPE rsparams,
          l_metodo   TYPE string                 VALUE &apos;MAIL&apos;,
          l_clase    TYPE string                 VALUE &apos;ZCL_AP_ABAP2XLS&apos;.
    DATA l_tipo_alv TYPE string.
    DATA l_jobname  TYPE tbtcm-jobname.

    FIELD-SYMBOLS: &lt;tabla&gt; TYPE table,
                   &lt;alv&gt;   TYPE any.
    FIELD-SYMBOLS: &lt;global&gt; LIKE LINE OF lt_globals,
                   &lt;field&gt;  TYPE any.

    DEFINE set_par.
      IF NOT &amp;1 IS INITIAL.
        tab-name  = &apos;&amp;1&apos;.
        tab-value = REF #( &amp;1 ).
        INSERT tab INTO TABLE ptab.
      ENDIF.
    END-OF-DEFINITION.

    TRY.
        IF asunto IS INITIAL.
          subject = sy-cprog.
        ELSE.
          subject = asunto.
        ENDIF.

        set_par: direccion, subject,
                 tabla1, tabla2, tabla3,
                 nombre_tabla1, nombre_tabla2, nombre_tabla3,
                 commit, texto,
                 o_alv2, tabla_alv2, nombre_alv2,
                 o_grid2, tabla_grid2, nombre_grid2.

        IF NOT info_alv IS INITIAL.
          ASSIGN (&apos;ME-&gt;I_LISTADO&apos;) TO &lt;tabla&gt;.
          IF sy-subrc = 0.
            ASSIGN (&apos;ME-&gt;O_ALV&apos;) TO &lt;alv&gt;.
            IF sy-subrc = 0.
              IF NOT &lt;alv&gt; IS INITIAL.

                l_tipo_alv = cl_abap_classdescr=&gt;get_class_name( &lt;alv&gt; ).
                IF l_tipo_alv CS &apos;ZCL_AP_ALV_GRID&apos;.
                  tab-name  = &apos;O_GRID1&apos;.
                  tab-value = REF #( &lt;alv&gt; ).
                  INSERT tab INTO TABLE ptab.

                  tab-name  = &apos;TABLA_GRID1&apos;.
                  tab-value = REF #( &lt;tabla&gt; ).
                  INSERT tab INTO TABLE ptab.

                  tab-name = &apos;NOMBRE_GRID1&apos;.

                ELSE.
                  tab-name  = &apos;O_ALV1&apos;.
                  tab-value = REF #( &lt;alv&gt; ).
                  INSERT tab INTO TABLE ptab.

                  tab-name  = &apos;TABLA_ALV1&apos;.
                  tab-value = REF #( &lt;tabla&gt; ).
                  INSERT tab INTO TABLE ptab.

                  tab-name = &apos;NOMBRE_ALV1&apos;.
                ENDIF.
                IF nombre_alv1 IS INITIAL.
                  tab-value = REF #( &apos;LISTADO&apos; ).
                ELSE.
                  tab-value = REF #( nombre_alv1 ).
                ENDIF.
                INSERT tab INTO TABLE ptab.
              ENDIF.
            ENDIF.
          ENDIF.
        ENDIF.

        IF NOT info_log IS INITIAL.
          UNASSIGN &lt;tabla&gt;.
          ASSIGN (&apos;ME-&gt;O_LOG-&gt;I_LOG&apos;) TO &lt;tabla&gt;.
          IF sy-subrc = 0.
            IF NOT &lt;tabla&gt; IS INITIAL.
              DATA(o_alv_log) = NEW zcl_ap_alv( ).
              o_alv_log-&gt;constructor_tabla( CHANGING t_tabla = &lt;tabla&gt; ).
              o_alv_log-&gt;set_field_quitar( &apos;MANDT,PROCESO,PROGNAME,USUARIO,INDICE&apos; ).
              o_alv_log-&gt;set_field_quitar( &apos;MSGV1,MSGV2,MSGV3,MSGV4,MSGNO,MSGID,FICHERO&apos; ).

              tab-name  = &apos;O_ALV2&apos;.
              tab-value = REF #( o_alv_log ).
              INSERT tab INTO TABLE ptab.

              tab-name  = &apos;TABLA_ALV2&apos;.
              tab-value = REF #( &lt;tabla&gt; ).
              INSERT tab INTO TABLE ptab.

              tab-name = &apos;NOMBRE_ALV2&apos;.
              IF nombre_alv2 IS INITIAL.
                tab-value = REF #( &apos;LOG&apos; ).
              ELSE.
                tab-value = REF #( nombre_alv2 ).
              ENDIF.
              INSERT tab INTO TABLE ptab.
            ENDIF.
          ENDIF.
        ENDIF.

        IF info_programa = &apos;X&apos;.
          CONCATENATE &apos;Programa:&apos; sy-cprog &apos;Transaccion:&apos;(tra) sy-tcode INTO l_texto SEPARATED BY space ##NO_TEXT.
          APPEND l_texto TO i_textosl.
          CONCATENATE &apos;Usuario:&apos; sy-uname &apos;Idioma:&apos; sy-langu INTO l_texto SEPARATED BY space ##NO_TEXT.
          APPEND l_texto TO i_textosl.
          CONCATENATE &apos;Sistema:&apos; sy-sysid &apos;Mandante:&apos; sy-mandt INTO l_texto SEPARATED BY space ##NO_TEXT.
          APPEND l_texto TO i_textosl.

          IF sy-batch = &apos;X&apos;.
            CALL FUNCTION &apos;GET_JOB_RUNTIME_INFO&apos;
              IMPORTING
                jobname = l_jobname.

            l_texto-line = |Ejecucion en fondo. Job { l_jobname }. Variante { sy-slset }|.
            APPEND l_texto-line TO i_textosl ##NO_TEXT.
          ENDIF.
          IF sy-binpt = &apos;X&apos;.
            APPEND &apos;Ejecucion en batch input&apos; TO i_textosl ##NO_TEXT.
          ENDIF.
        ENDIF.

        IF info_variante = &apos;X&apos;.
          IF NOT sy-slset IS INITIAL.
            CONCATENATE &apos;Variante:&apos; sy-slset INTO l_texto SEPARATED BY space ##NO_TEXT.
            APPEND l_texto TO i_textosl.
          ENDIF.

          o_variante = NEW #( ).
          o_variante-&gt;get_variante_actual( ).
          LOOP AT o_variante-&gt;i_valores INTO l_var.
            IF l_var-kind = &apos;P&apos;.
              CONCATENATE l_var-selname &apos;=&apos; l_var-low INTO l_texto SEPARATED BY space.
            ELSE.
              CONCATENATE l_var-selname l_var-sign l_var-option l_var-low l_var-high INTO l_texto SEPARATED BY space.
            ENDIF.
            APPEND l_texto TO i_textosl.
          ENDLOOP.
        ENDIF.

        IF info_variables = &apos;X&apos;.
          CALL FUNCTION &apos;GET_GLOBAL_SYMBOLS&apos;
            EXPORTING
              program   = sy-cprog
            TABLES
              fieldlist = lt_globals.

          LOOP AT lt_globals ASSIGNING &lt;global&gt; WHERE name(1) &lt;&gt; &apos;%&apos; AND type &lt;&gt; &apos;r&apos; AND type &lt;&gt; &apos;u&apos; AND type &lt;&gt; &apos;h&apos; AND type &lt;&gt; &apos;v&apos; AND name(3) &lt;&gt; &apos;SY-&apos; AND name(5) &lt;&gt; &apos;SYST-&apos; AND name(5) &lt;&gt; &apos;ICON_&apos; AND name(2) &lt;&gt; &apos;TC_&apos; AND flitl = &apos;&apos;.
            IF o_variante IS INITIAL.
              CONCATENATE &apos;(&apos; sy-cprog &apos;)&apos; &lt;global&gt;-name INTO lv_fieldname.
              ASSIGN (lv_fieldname) TO &lt;field&gt;.
              IF sy-subrc = 0.
                l_texto-line = |{ &lt;global&gt;-name } = { &lt;field&gt; }|.
                APPEND l_texto TO i_textosl.
              ENDIF.
            ELSE.
              IF NOT line_exists( o_variante-&gt;i_valores[ selname = &lt;global&gt;-name ] ).
                CONCATENATE &apos;(&apos; sy-cprog &apos;)&apos; &lt;global&gt;-name INTO lv_fieldname.
                ASSIGN (lv_fieldname) TO &lt;field&gt;.
                IF sy-subrc = 0.
                  l_texto-line = |{ &lt;global&gt;-name } = { &lt;field&gt; }|.
                  APPEND l_texto TO i_textosl.
                ENDIF.
              ENDIF.
            ENDIF.
          ENDLOOP.

        ENDIF.

        APPEND LINES OF i_textos TO i_textosl.

        IF NOT i_textosl IS INITIAL.
          tab-name  = &apos;I_TEXTOS&apos;.
          tab-value = REF #( i_textosl ).
          INSERT tab INTO TABLE ptab.
        ENDIF.

        TRY.
            l_metodo = &apos;MAIL&apos;.
            CALL METHOD (l_clase)=&gt;(l_metodo) PARAMETER-TABLE ptab.
          CATCH cx_root INTO cx_root. &quot;#EC *
            IF sy-uname = zcl_c=&gt;usuario_ap.
              MESSAGE cx_root-&gt;get_longtext( ) TYPE &apos;I&apos;.
            ENDIF.
        ENDTRY.

      CATCH cx_root INTO cx_root. &quot;#EC *
        IF sy-uname = zcl_c=&gt;usuario_ap.
          MESSAGE cx_root-&gt;get_longtext( ) TYPE &apos;I&apos;.
        ENDIF.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_SI_ERROR" VERSION="1" LANGU="S" DESCRIPT="Envia mail si se detecta error" EXPOSURE="2" STATE="1" EDITORDER="59 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_SI_ERROR" SCONAME="REPORT" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Programa de llamada" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_SI_ERROR" SCONAME="MSGID" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Clase de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-MSGID" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_SI_ERROR" SCONAME="MSGNO" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Número de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-MSGNO" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_SI_ERROR" SCONAME="MENSAJE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_SI_ERROR" SCONAME="CLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MAIL_SI_ERROR" SCONAME="VARIABLES" VERSION="1" LANGU="S" DESCRIPT="Key value pairs" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="APB_LPD_T_KEY_VALUE" PAROPTIONL="X"/>
  <source>METHOD mail_si_error.
    DATA: zap_textos_mail TYPE zap_textos_mail,
          l_message       TYPE bapi_msg.

    CLEAR zap_textos_mail.
    zap_textos_mail-grupo = &apos;ERROR&apos;.

    IF NOT mensaje IS INITIAL.
      &quot; TODO: variable is assigned but never used (ABAP cleaner)
      DATA(l_msg) = |%{ mensaje }%|.
      SELECT emails, asunto, cuerpo, proceso, mensaje FROM zap_mail_errores
        INTO TABLE @DATA(i_mails)
       WHERE report   = @report
         AND mensaje &lt;&gt; &apos;&apos;.
      LOOP AT i_mails ASSIGNING FIELD-SYMBOL(&lt;mail&gt;).
        IF NOT mensaje CS &lt;mail&gt;-mensaje.
          DELETE i_mails.
        ENDIF.
      ENDLOOP.
    ENDIF.

    IF NOT msgno IS INITIAL.
      SELECT emails, asunto, cuerpo, proceso FROM zap_mail_errores
        APPENDING CORRESPONDING FIELDS OF TABLE @i_mails
       WHERE report = @report
         AND msgid  = @msgid
         AND msgno  = @msgno.
    ENDIF.

    LOOP AT i_mails ASSIGNING &lt;mail&gt;.
      zap_textos_mail-codigo = &lt;mail&gt;-proceso.
      zap_textos_mail-asunto = &lt;mail&gt;-asunto.
      zap_textos_mail-texto  = &lt;mail&gt;-cuerpo.
      LOOP AT variables ASSIGNING FIELD-SYMBOL(&lt;var&gt;).
        REPLACE ALL OCCURRENCES OF &lt;var&gt;-key IN zap_textos_mail-texto WITH &lt;var&gt;-value IGNORING CASE.

        REPLACE ALL OCCURRENCES OF &lt;var&gt;-key IN zap_textos_mail-asunto WITH &lt;var&gt;-value IGNORING CASE.
      ENDLOOP.
      CONDENSE zap_textos_mail-asunto.

* Añadimos info adicional.
      DATA(l_tcode) = |Transaccion: { sy-tcode }|.
      DATA(l_report) = |Report: { report }|.
      DATA(l_uname) = |Usuario: { sy-uname }|.

      CONCATENATE zap_textos_mail-texto cl_abap_char_utilities=&gt;cr_lf l_tcode l_report l_uname
                  INTO zap_textos_mail-texto SEPARATED BY cl_abap_char_utilities=&gt;cr_lf.

      zcl_ap_envio_mail=&gt;mail( EXPORTING direccion = &lt;mail&gt;-emails
                                         plantilla = zap_textos_mail
                                         clave     = clave
                                         variables = variables
                               IMPORTING message   = DATA(l_msg_m) ).

      IF &lt;mail&gt;-proceso IS INITIAL.
        CONTINUE.
      ENDIF.

      IF NOT mensaje IS INITIAL.
        l_message = mensaje.
      ELSE.
        MESSAGE ID msgid TYPE &apos;S&apos; NUMBER msgno INTO l_message.
      ENDIF.
      zcl_ap_log=&gt;set_log( proceso = &lt;mail&gt;-proceso
                           clave   = clave
                           message = l_message ).

      IF NOT l_msg_m IS INITIAL.
        zcl_ap_log=&gt;set_log( proceso = &lt;mail&gt;-proceso
                             clave   = clave
                             message = |Error enviando mail { l_msg_m }| ).
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_ENHANCEMENT" VERSION="1" LANGU="S" DESCRIPT="Marca enhancement" EXPOSURE="2" STATE="1" EDITORDER="44 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_ENHANCEMENT" SCONAME="PARAR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_ENHANCEMENT" SCONAME="UNAME" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-UNAME" PARVALUE="ZCL_C=&gt;USUARIO_AP"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_ENHANCEMENT" SCONAME="INCLUDE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_ENHANCEMENT" SCONAME="FORM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_ENHANCEMENT" SCONAME="SUBCLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_ENHANCEMENT" SCONAME="CPROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_ENHANCEMENT" SCONAME="TCODE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-TCODE" PARVALUE="SY-TCODE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_ENHANCEMENT" SCONAME="ENHANCEMENT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD marca_enhancement.
    DATA l_subclave TYPE ztemp-subclave.

    IF NOT subclave IS INITIAL.
      l_subclave = subclave.
    ELSE.
      IF NOT include IS INITIAL AND NOT form IS INITIAL.
        CONCATENATE include form INTO l_subclave SEPARATED BY &apos;-&apos;.
      ELSE.
        CONCATENATE cprog include form INTO l_subclave SEPARATED BY &apos;-&apos;.
      ENDIF.
    ENDIF.

    zcl_ap_temp=&gt;set_st( clave      = &apos;ENHANCEMEN&apos;
                         subclave   = l_subclave
                         valor1     = tcode
                         valor2     = cprog
                         valor3     = enhancement
                         texto      = include
                         texto2     = form
                         permanente = &apos;X&apos; ).
    IF parar = &apos;X&apos; AND ( sy-uname = uname OR uname = &apos;*&apos; ).
      BREAK-POINT.                                          &quot;#EC *
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_MOD_ESTANDARD" VERSION="1" LANGU="S" DESCRIPT="Marca modificación al estándar" EXPOSURE="2" STATE="1" EDITORDER="43 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_MOD_ESTANDARD" SCONAME="PARAR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_MOD_ESTANDARD" SCONAME="UNAME" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-UNAME" PARVALUE="ZCL_C=&gt;USUARIO_AP"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_MOD_ESTANDARD" SCONAME="INCLUDE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_MOD_ESTANDARD" SCONAME="FORM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_MOD_ESTANDARD" SCONAME="SUBCLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_MOD_ESTANDARD" SCONAME="CPROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MARCA_MOD_ESTANDARD" SCONAME="TCODE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-TCODE" PARVALUE="SY-TCODE"/>
  <source>METHOD marca_mod_estandard.
    DATA: l_subclave TYPE ztemp-subclave,
          l_zbc003   TYPE zbc003.

    IF NOT subclave IS INITIAL.
      l_subclave = subclave.
    ELSE.
      IF NOT include IS INITIAL AND NOT form IS INITIAL.
        CONCATENATE include form INTO l_subclave SEPARATED BY &apos;-&apos;.
      ELSEIF NOT form IS INITIAL.
        CONCATENATE cprog form INTO l_subclave SEPARATED BY &apos;-&apos;.
      ELSEIF NOT include IS INITIAL.
        CONCATENATE cprog include INTO l_subclave SEPARATED BY &apos;-&apos;.
      ENDIF.
    ENDIF.

    zcl_ap_temp=&gt;set_st( clave      = &apos;MOD_STAND&apos;
                         subclave   = l_subclave
                         valor1     = tcode
                         valor2     = cprog
                         texto      = include
                         texto2     = form
                         permanente = &apos;X&apos; ).
    IF parar = &apos;X&apos; AND ( sy-uname = uname OR uname = &apos;*&apos; ).
      BREAK-POINT.                                          &quot;#EC *
    ELSEIF NOT include IS INITIAL OR NOT cprog IS INITIAL.
      IF NOT include IS INITIAL.
        SELECT * FROM zbc003
          INTO l_zbc003
          UP TO 1 ROWS
         WHERE name = include
          ORDER BY PRIMARY KEY.
        ENDSELECT.
      ELSE.
        SELECT * FROM zbc003
          UP TO 1 ROWS
          INTO l_zbc003
         WHERE name = cprog
          ORDER BY PRIMARY KEY.
        ENDSELECT.
      ENDIF.
      IF l_zbc003 IS INITIAL.
        CLEAR l_zbc003.
        IF NOT include IS INITIAL.
          l_zbc003-name = include.
        ELSE.
          l_zbc003-name = cprog.
        ENDIF.
        l_zbc003-tcode      = tcode.
        l_zbc003-estado     = &apos;M&apos;.
        l_zbc003-asignado_a = uname.
        l_zbc003-grupo      = &apos;AUTO&apos;.
        INSERT zbc003 FROM l_zbc003.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Muestra mensaje (y guarda en log si se indica)" EXPOSURE="2" STATE="1" EDITORDER="36 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="TYPE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="MSGTY" PARVALUE="&apos;E&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P5" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P6" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P7" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="MEINS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="MEINS" PARVALUE="&apos;ST&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="CLAVE_LOG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P8" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P9" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="MAIL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="13 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="SOLO_LOG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="14 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="NO_LOG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="15 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="USUARIOS_CAMBIO_ERROR_X_WARNIN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="16 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="SOLO_PRIMERA_VEZ" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="17 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="POSTPONER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="18 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="MSGV1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="19 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="MSGV2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="20 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="MSGV3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="21 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="MSGV4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="22 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P10" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="23 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="P11" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="24 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MESSAGE" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="25 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD message.
    DATA: l_guardar_log TYPE c LENGTH 1,
          l_solo_log    TYPE c LENGTH 1,
          l_no_log      TYPE c LENGTH 1,
          zlog          TYPE zlog_ap.

    IF NOT me-&gt;proceso_log IS INITIAL AND no_log IS INITIAL.
      l_guardar_log = &apos;X&apos;.
    ENDIF.

    l_solo_log = solo_log.
    IF postponer = &apos;X&apos; AND NOT o_log IS INITIAL.
      l_solo_log = &apos;X&apos;.
    ENDIF.
    message = zcl_ap_utils=&gt;message( p1               = p1
                                     p2               = p2
                                     p3               = p3
                                     p4               = p4
                                     p5               = p5
                                     p6               = p6
                                     p7               = p7
                                     p8               = p8
                                     p9               = p9
                                     p10              = p10
                                     p11              = p11
                                     meins            = meins
                                     solo_log         = l_solo_log
                                     solo_primera_vez = solo_primera_vez
                                     type             = type
                                     guardar_log      = l_guardar_log
                                     proceso_log      = me-&gt;proceso_log
                                     clave_log        = clave_log
                                     mail             = mail
                                     no_break         = no_break
                                     msgv1            = msgv1
                                     msgv2            = msgv2
                                     msgv3            = msgv3
                                     msgv4            = msgv4 ).

    IF postponer &lt;&gt; &apos;X&apos; OR o_log IS INITIAL.
      RETURN.
    ENDIF.

    IF solo_primera_vez = &apos;X&apos;.
      IF line_exists( o_log-&gt;i_log[ message = message
                                    msgty   = type
                                    msgv1   = msgv1
                                    msgv2   = msgv2
                                    msgv3   = msgv3
                                    msgv4   = msgv4 ] ).
        l_no_log = &apos;X&apos;.
      ENDIF.
    ENDIF.

    IF l_no_log IS INITIAL.
      CLEAR zlog.
      zlog-message  = message.
      zlog-proceso  = me-&gt;proceso_log.
      zlog-clave    = clave_log.
      zlog-progname = sy-cprog.
      zlog-fecha    = sy-datum.
      zlog-hora     = sy-uzeit.
      zlog-usuario  = sy-uname.
      zlog-msgty    = type.
      zlog-msgv1    = msgv1.
      zlog-msgv2    = msgv2.
      zlog-msgv3    = msgv3.
      zlog-msgv4    = msgv4.
      IF type = &apos;Y&apos;.
        zlog-msgty = &apos;E&apos;.
      ENDIF.
      APPEND zlog TO o_log-&gt;i_log.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="MSG" VERSION="1" LANGU="S" DESCRIPT="Gestiona mensaje" EXPOSURE="2" STATE="1" EDITORDER="25 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MSG" SCONAME="MSGTY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;E&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="MSG" SCONAME="TEXTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X" PARPREFERD="X"/>
  <source>METHOD msg.
    IF o_log IS INITIAL.
      CASE msgty.
        WHEN &apos;E&apos;. o_log-&gt;msg_error( msgv1 = texto ).
        WHEN &apos;W&apos;. o_log-&gt;msg_warning( msgv1 = texto ).
        WHEN &apos;I&apos;. o_log-&gt;msg_info( msgv1 = texto ).
        WHEN &apos;S&apos;. o_log-&gt;msg_succes( msgv1 = texto ).
      ENDCASE.
    ENDIF.

    MESSAGE texto TYPE msgty.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="POPUP_CAMBIO_CLASE_DESARROLLO" VERSION="1" LANGU="S" DESCRIPT="Popup cambio clase de desarrollo" EXPOSURE="2" STATE="1" EDITORDER="6 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="POPUP_CAMBIO_CLASE_DESARROLLO" SCONAME="OBJECT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="E071-OBJECT"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="POPUP_CAMBIO_CLASE_DESARROLLO" SCONAME="OBJ_NAME" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="E071-OBJ_NAME"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="POPUP_CAMBIO_CLASE_DESARROLLO" SCONAME="DEVCLASS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TADIR-DEVCLASS"/>
  <source>METHOD popup_cambio_clase_desarrollo.
    CALL FUNCTION &apos;TR_TADIR_POPUP_ENTRY_E071&apos;
      EXPORTING
        wi_e071_pgmid             = &apos;R3TR&apos;
        wi_e071_object            = object
        wi_e071_obj_name          = obj_name
        wi_tadir_devclass         = devclass
      EXCEPTIONS
        display_mode              = 1
        exit                      = 2
        global_tadir_insert_error = 3
        no_repair_selected        = 4
        no_systemname             = 5
        no_systemtype             = 6
        no_tadir_type             = 7
        reserved_name             = 8
        tadir_enqueue_failed      = 9
        devclass_not_found        = 10
        tadir_not_exist           = 11
        object_exists             = 12
        internal_error            = 13
        object_append_error       = 14
        tadir_modify_error        = 15
        object_locked             = 16
        no_object_authority       = 17
        OTHERS                    = 18.

    IF sy-subrc &lt;&gt; 0.
      MESSAGE &apos;Error cambiando clase de desarrollo&apos;(ecc) TYPE &apos;E&apos;.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="PRUEBAS" VERSION="1" LANGU="S" DESCRIPT="Ejecución en test?" EXPOSURE="2" STATE="1" EDITORDER="38 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="PRUEBAS" SCONAME="CPROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="PRUEBAS" SCONAME="TEXTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;%TEST%&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="PRUEBAS" SCONAME="TEST" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ABAP_BOOL"/>
  <source>METHOD pruebas.
    &quot; TODO: variable is assigned but never used (ABAP cleaner)
    DATA l_cprog TYPE sy-cprog.

    CLEAR test.
    TRY.
        SELECT SINGLE cprog FROM zap_break
          INTO l_cprog
         WHERE cprog    = cprog
           AND uname    = sy-uname
           AND texto    = texto
           AND inactivo = &apos;&apos;.
        IF sy-subrc = 0.
          test = &apos;X&apos;.
        ENDIF.
      CATCH cx_root INTO DATA(o_root).                      &quot;#EC *
        MESSAGE o_root-&gt;get_text( ) TYPE &apos;E&apos;.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" VERSION="1" LANGU="S" DESCRIPT="Relanzar Report con los mismos parámetros que los actuales" EXPOSURE="2" STATE="1" EDITORDER="28 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="REPORT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="VIA_SELECTION_SCREEN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="PARAMETROS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="PARAM1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="VALOR1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="PARAM2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="VALOR2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="PARAM3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="VALOR3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="RETURN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="PARAM4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="RELANZAR_REPORT" SCONAME="VALOR4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD relanzar_report.
    DATA: o_var        TYPE REF TO zcl_ap_variante,
          l_parametros TYPE string,
          i_param      TYPE zap_lista_t,
          l_valor      TYPE rsparams.

    FIELD-SYMBOLS: &lt;param&gt; TYPE zap_lista,
                   &lt;valor&gt; TYPE rsparams.

    o_var = NEW #( ).

    o_var-&gt;get_variante_actual( report = report ).

    l_parametros = parametros.
    IF NOT param1 IS INITIAL.
      zcl_ap_lista=&gt;add_lista( EXPORTING valor = param1 subvalor = valor1 CHANGING lista = l_parametros ).
    ENDIF.
    IF NOT param2 IS INITIAL.
      zcl_ap_lista=&gt;add_lista( EXPORTING valor = param2 subvalor = valor2 CHANGING lista = l_parametros ).
    ENDIF.
    IF NOT param3 IS INITIAL.
      zcl_ap_lista=&gt;add_lista( EXPORTING valor = param3 subvalor = valor3 CHANGING lista = l_parametros ).
    ENDIF.
    IF NOT param4 IS INITIAL.
      zcl_ap_lista=&gt;add_lista( EXPORTING valor = param4 subvalor = valor4 CHANGING lista = l_parametros ).
    ENDIF.

    IF NOT l_parametros IS INITIAL.
      SET PARAMETER ID &apos;Z_NO_VAR_DEF&apos; FIELD &apos;X&apos; ##EXISTS.
      i_param = zcl_ap_lista=&gt;get_valores_lista( lista = l_parametros descomponer_subvalores = &apos;X&apos; ).
      LOOP AT i_param ASSIGNING &lt;param&gt;.
        ASSIGN o_var-&gt;i_valores[ selname = &lt;param&gt;-valor ] TO &lt;valor&gt;.
        IF sy-subrc &lt;&gt; 0.
          CONTINUE.
        ENDIF.

        IF &lt;valor&gt;-low IS INITIAL.
          &lt;valor&gt;-low = &lt;param&gt;-subvalor.
          IF &lt;valor&gt;-kind = &apos;S&apos;.
            &lt;valor&gt;-sign   = &apos;I&apos;.
            &lt;valor&gt;-option = &apos;EQ&apos;.
          ENDIF.
        ELSE.
          l_valor = &lt;valor&gt;.
          l_valor-low = &lt;param&gt;-subvalor.
          APPEND l_valor TO o_var-&gt;i_valores.
        ENDIF.
      ENDLOOP.
    ENDIF.

    IF via_selection_screen IS INITIAL.
      IF return IS INITIAL.
        SUBMIT (report)                                  &quot;#EC CI_SUBMIT
               WITH SELECTION-TABLE o_var-&gt;i_valores.
      ELSE.
        SUBMIT (report)                                  &quot;#EC CI_SUBMIT
               WITH SELECTION-TABLE o_var-&gt;i_valores
               AND RETURN.
      ENDIF.
    ELSE.
      IF sy-batch = &apos;X&apos;.
        RETURN. &quot; En fondo la ejecucion es inmediata y se pueden hacer bucles
      ENDIF.
      IF return IS INITIAL.
        SUBMIT (report)                                  &quot;#EC CI_SUBMIT
               VIA SELECTION-SCREEN
               WITH SELECTION-TABLE o_var-&gt;i_valores.
      ELSE.
        SUBMIT (report)                                  &quot;#EC CI_SUBMIT
               VIA SELECTION-SCREEN
               WITH SELECTION-TABLE o_var-&gt;i_valores
               AND RETURN.
      ENDIF.
    ENDIF.

    IF NOT l_parametros IS INITIAL.
      SET PARAMETER ID &apos;Z_NO_VAR_DEF&apos; FIELD &apos;&apos; ##EXISTS.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="SALIR_SI_NO_CAMBIOS" VERSION="1" LANGU="S" DESCRIPT="Comprueba cambios en tablas y si no salir" EXPOSURE="2" STATE="1" EDITORDER="31 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SALIR_SI_NO_CAMBIOS" SCONAME="T1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SALIR_SI_NO_CAMBIOS" SCONAME="T2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SALIR_SI_NO_CAMBIOS" SCONAME="QUITAR_CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;LIGHTS,CHECK,MESSAGE,MENSAJE&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SALIR_SI_NO_CAMBIOS" SCONAME="SOLO_CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SALIR_SI_NO_CAMBIOS" SCONAME="ROLLBACK_SI_NO_CAMBIOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SALIR_SI_NO_CAMBIOS" SCONAME="RELANZAR_REPORT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <source>METHOD salir_si_no_cambios.
    IF zcl_ap_itab=&gt;tablas_iguales( t1            = t1
                                    t2            = t2
                                    quitar_campos = quitar_campos
                                    solo_campos   = solo_campos ) = &apos;X&apos;.
      IF rollback_si_no_cambios = &apos;X&apos;.
        ROLLBACK WORK. &quot;#EC CI_ROLLBACK
      ENDIF.
      IF relanzar_report = &apos;X&apos;.
        relanzar_report( via_selection_screen = &apos;X&apos; ).
      ELSE.
        LEAVE TO SCREEN 0.
      ENDIF.
    ELSE.
      IF zcl_ap_popup=&gt;confirmar_grabacion( ) = &apos;X&apos;.
        IF rollback_si_no_cambios = &apos;X&apos;.
          ROLLBACK WORK. &quot;#EC CI_ROLLBACK
        ENDIF.
        IF relanzar_report = &apos;X&apos;.
          relanzar_report( via_selection_screen = &apos;X&apos; ).
        ELSE.
          LEAVE TO SCREEN 0.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="SET_CAMPO_Z" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="60 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_CAMPO_Z" SCONAME="TABLA" VERSION="1" LANGU="S" DESCRIPT="Nombre de tabla" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_CAMPOS_Z-TABLA"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_CAMPO_Z" SCONAME="CLAVE" VERSION="1" LANGU="S" DESCRIPT="Clave de objeto" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_CAMPOS_Z-CLAVE"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_CAMPO_Z" SCONAME="CAMPO" VERSION="1" LANGU="S" DESCRIPT="Nombre de campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_CAMPOS_Z-CAMPO"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_CAMPO_Z" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD set_campo_z.
    DATA: l_valor_c    TYPE zap_campos_z-valor,
          zap_campos_z TYPE zap_campos_z.

    TRY.
        l_valor_c = valor.
        SELECT SINGLE valor FROM zap_campos_z
          INTO @DATA(l_valor)
         WHERE tabla = @tabla
           AND clave = @clave
           AND campo = @campo.
        IF l_valor &lt;&gt; l_valor_c.
          IF valor IS INITIAL.
            DELETE FROM zap_campos_z
             WHERE tabla = tabla
               AND clave = clave.
          ELSE.
            CLEAR zap_campos_z.
            zap_campos_z-tabla = tabla.
            zap_campos_z-clave = clave.
            zap_campos_z-campo = campo.
            zap_campos_z-valor = valor.
            zap_campos_z-erdat = sy-datum.
            zap_campos_z-erzet = sy-uzeit.
            zap_campos_z-ernam = sy-uname.
            zap_campos_z-tcode = sy-tcode.
            MODIFY zap_campos_z FROM zap_campos_z.
          ENDIF.
        ENDIF.
      CATCH cx_root INTO DATA(o_root). &quot;#EC *
        MESSAGE |Error { o_root-&gt;get_text( ) }| TYPE &apos;S&apos;.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS" VERSION="1" LANGU="S" DESCRIPT="Fija status en report" EXPOSURE="2" STATE="1" EDITORDER="27 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS" SCONAME="STATUS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS" SCONAME="EXCLUIR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS" SCONAME="CPROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <source>METHOD set_status.
    CLEAR i_exc.
    SPLIT excluir AT &apos;,&apos; INTO TABLE i_exc.
    SET PF-STATUS status OF PROGRAM cprog EXCLUDING i_exc.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" VERSION="1" LANGU="S" DESCRIPT="Fija atributos listado" EXPOSURE="2" STATE="1" EDITORDER="41 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="ICONO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="COLOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="CAMPOS_EDITABLES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="CAMPOS_NO_EDITABLES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="INT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT1" PARVALUE="0"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="INV" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PARVALUE="0"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="CRITERIO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="CAMPOS_COLOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="TEXTO_ICONO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="RESALTAR_CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="COLOR_RESALTE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;A&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST" SCONAME="LIST" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="13 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD set_status_list.
    DATA: l_message      TYPE string,
          l_message_ok   TYPE string,
          l_check        TYPE xfeld,
          l_icono        TYPE icon_d,
          l_color        TYPE string,
          l_campos_color TYPE string.

    FIELD-SYMBOLS &lt;fs&gt; TYPE any.

    IF NOT message IS INITIAL.
      l_message = message.
      ASSIGN (&apos;LIST-MESSAGE&apos;) TO &lt;fs&gt;.
      IF sy-subrc = 0.
        &lt;fs&gt; = message.
      ENDIF.
    ELSE.
      ASSIGN (&apos;LIST-MESSAGE&apos;) TO &lt;fs&gt;.
      IF sy-subrc = 0.
        l_message = &lt;fs&gt;.
      ENDIF.
    ENDIF.

    ASSIGN (&apos;LIST-MESSAGE_OK&apos;) TO &lt;fs&gt;.
    IF sy-subrc = 0.
      l_message_ok = &lt;fs&gt;.
    ENDIF.

    ASSIGN (&apos;LIST-CHECK&apos;) TO &lt;fs&gt;.
    IF sy-subrc = 0.
      l_check = &lt;fs&gt;.
    ENDIF.

    IF NOT icono IS INITIAL.
      l_icono = icono.
    ELSEIF criterio = &apos;A&apos;.
      IF l_message IS INITIAL.
        l_icono = zcl_ap_alv=&gt;c_ico_ambar.
      ELSE.
        l_icono = zcl_ap_alv=&gt;c_ico_rojo.
      ENDIF.
    ELSEIF criterio = &apos;V&apos;.
      IF l_message IS INITIAL.
        l_icono = zcl_ap_alv=&gt;c_ico_verde.
      ELSE.
        l_icono = zcl_ap_alv=&gt;c_ico_rojo.
      ENDIF.
    ELSEIF criterio = &apos;R&apos;.
      IF NOT l_message IS INITIAL.
        l_icono = zcl_ap_alv=&gt;c_ico_rojo.
      ELSEIF NOT l_message_ok IS INITIAL.
        l_icono = zcl_ap_alv=&gt;c_ico_verde.
      ENDIF.
    ELSEIF criterio = &apos;C&apos;.
      IF l_message IS INITIAL.
        IF l_check IS INITIAL.
          l_icono = zcl_ap_alv=&gt;c_ico_verde.
        ELSE.
          l_icono = zcl_ap_alv=&gt;c_ico_ambar.
        ENDIF.
      ELSE.
        l_icono = zcl_ap_alv=&gt;c_ico_rojo.
      ENDIF.
    ENDIF.

    IF NOT l_icono IS INITIAL.
      ASSIGN (&apos;LIST-LIGHTS&apos;) TO &lt;fs&gt;.
      IF sy-subrc = 0.
        IF texto_icono IS INITIAL.
          IF l_message IS INITIAL AND NOT l_message_ok IS INITIAL.
            &lt;fs&gt; = zcl_ap_alv=&gt;set_icono( icono = l_icono mensaje = l_message_ok ).
          ELSE.
            &lt;fs&gt; = zcl_ap_alv=&gt;set_icono( icono = l_icono mensaje = l_message ).
          ENDIF.
        ELSE.
          &lt;fs&gt; = zcl_ap_alv=&gt;set_icono( icono = l_icono mensaje = texto_icono ).
        ENDIF.
      ENDIF.
    ENDIF.

    IF NOT color IS INITIAL.
      l_color = color.
    ELSEIF NOT criterio IS INITIAL.
      sy-tfill = strlen( criterio ).
      IF sy-tfill = 2.
        IF criterio+1(1) = &apos;C&apos;.
          IF NOT l_message IS INITIAL.
            l_color = &apos;R&apos;.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.

    IF l_color IS INITIAL AND NOT resaltar_campos IS INITIAL AND campos_color IS INITIAL.
      l_campos_color = resaltar_campos.
      l_color = color_resalte.
    ELSE.
      l_campos_color = campos_color.
    ENDIF.

    IF NOT l_color IS INITIAL OR NOT int IS INITIAL OR NOT inv IS INITIAL.
      UNASSIGN &lt;fs&gt;.
      ASSIGN (&apos;LIST-COLOR_ALV&apos;) TO &lt;fs&gt;.
      IF sy-subrc &lt;&gt; 0.
        ASSIGN (&apos;LIST-COLOR&apos;) TO &lt;fs&gt;.
      ENDIF.
      IF &lt;fs&gt; IS ASSIGNED.
        zcl_ap_alv_grid=&gt;append_color( EXPORTING campo = l_campos_color colorc = l_color int = int inv = inv CHANGING tabla_color = &lt;fs&gt; ).
      ENDIF.
    ENDIF.

    IF NOT campos_editables IS INITIAL.
      ASSIGN (&apos;LIST-STYLE&apos;) TO &lt;fs&gt;.
      IF sy-subrc = 0.
        zcl_ap_alv_grid=&gt;append_style_edit( EXPORTING campo = campos_editables CHANGING tabla_style = &lt;fs&gt; ).
      ENDIF.
    ENDIF.

    IF NOT campos_no_editables IS INITIAL.
      ASSIGN (&apos;LIST-STYLE&apos;) TO &lt;fs&gt;.
      IF sy-subrc = 0.
        zcl_ap_alv_grid=&gt;append_style_no_edit( EXPORTING campo = campos_no_editables CHANGING tabla_style = &lt;fs&gt; ).
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST_STOP" VERSION="1" LANGU="S" DESCRIPT="Fija atributos listado con STOP / ROJO" EXPOSURE="2" STATE="1" EDITORDER="42 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST_STOP" SCONAME="ICONO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="ZCL_AP_ALV=&gt;C_ICO_STOP"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST_STOP" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST_STOP" SCONAME="COLOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;R&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST_STOP" SCONAME="CAMPOS_EDITABLES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST_STOP" SCONAME="CAMPOS_NO_EDITABLES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST_STOP" SCONAME="INT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT1" PARVALUE="0"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST_STOP" SCONAME="INV" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PARVALUE="0"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST_STOP" SCONAME="CAMPOS_COLOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SET_STATUS_LIST_STOP" SCONAME="LIST" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD set_status_list_stop.
    set_status_list( EXPORTING color               = color
                               icono               = icono
                               message             = message
                               campos_editables    = campos_editables
                               campos_no_editables = campos_no_editables
                               campos_color        = campos_color
                               int                 = int
                               inv                 = inv
                     CHANGING  list                = list ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="SGPI_TEXTO" VERSION="1" LANGU="S" DESCRIPT="Muestra texto en barra inferior" EXPOSURE="2" STATE="1" EDITORDER="21 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SGPI_TEXTO" SCONAME="TEXTO1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SGPI_TEXTO" SCONAME="TEXTO2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SGPI_TEXTO" SCONAME="TEXTO3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SGPI_TEXTO" SCONAME="QUITAR_CEROS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SGPI_TEXTO" SCONAME="CANT_PORC" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I" PARVALUE="0"/>
  <source>METHOD sgpi_texto.
    DATA l_texto TYPE string.

    IF no_sgpi = &apos;X&apos;.
      RETURN.
    ENDIF.

    l_texto = zcl_ap_utils=&gt;concat( p1 = texto1 p2 = texto2 p3 = texto3 ).

    IF cant_porc IS INITIAL.
      o_sgpi-&gt;texto( texto1       = texto1
                     texto2       = texto2
                     texto3       = texto3
                     quitar_ceros = quitar_ceros ).
    ELSE.
      o_sgpi-&gt;porcentaje( texto = l_texto cantidad = cant_porc ).
    ENDIF.

    IF no_break IS INITIAL.
      break_condicional( texto = l_texto ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="SHOW_DOCU" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="49 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SHOW_DOCU" SCONAME="TITULO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;Documentacion&apos;(DOC)"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="SHOW_DOCU" SCONAME="ID" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="DOKHL-OBJECT"/>
  <source>METHOD show_docu.
* La documentacion se mantiene desde SE61, clase de documentos &quot;Texto en dialogo&quot;

*SELECTION-SCREEN BEGIN OF LINE.
*  PARAMETERS: p_incd   AS CHECKBOX MODIF ID sup.
*  SELECTION-SCREEN COMMENT 2(26) TEXT-inc FOR FIELD p_incd.
*  SELECTION-SCREEN PUSHBUTTON 30(4) b_incd USER-COMMAND incd.
*SELECTION-SCREEN END OF LINE.

*SELECTION-SCREEN BEGIN OF LINE.
*SELECTION-SCREEN COMMENT 1(31) TEXT-bus.
*PARAMETERS: p_busl   LIKE zap_exits_est-id2.
*SELECTION-SCREEN PUSHBUTTON 76(4) b_busl USER-COMMAND docu_zexits_busqueda.
*SELECTION-SCREEN END OF LINE.

    CALL FUNCTION &apos;POPUP_DISPLAY_TEXT&apos;
      EXPORTING
        popup_title    = titulo
        text_object    = id
      EXCEPTIONS
        text_not_found = 1
        OTHERS         = 2.
    IF sy-subrc &lt;&gt; 0.
      MESSAGE |No se ha entrado el texto { id }| TYPE &apos;I&apos;.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" VERSION="1" LANGU="S" DESCRIPT="Status dynpro" EXPOSURE="2" STATE="1" EDITORDER="39 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="O_ALV" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_ALV_GRID" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="STATUS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;ST_0100&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="VARIANT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="ALV_STANDARD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="DYNNR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="DYNNR" PARVALUE="&apos;0100&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="CAMPOS_BORRAR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;CHECK,TABIX&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="TABINT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="EXCLUIR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="STYLE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="COLOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="CPROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="TITULO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="LIGHTS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="13 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;LIGHTS&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO" SCONAME="I_LISTADO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="14 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD status_dynpro.
    set_status( status = status excluir = excluir cprog = cprog ).

    IF titulo IS INITIAL.
      SET TITLEBAR &apos;100&apos; OF PROGRAM cprog WITH me-&gt;titulo.
    ELSE.
      SET TITLEBAR &apos;100&apos; OF PROGRAM cprog WITH titulo.
    ENDIF.

    IF o_alv IS INITIAL.
      RETURN.
    ENDIF.

    IF inicio IS NOT INITIAL.
      RETURN.
    ENDIF.

    inicio = &apos;X&apos;.

    o_alv-&gt;variant-variant = variant.

    IF alv_standard = &apos;X&apos;.
      o_alv-&gt;set_layout( no_rowmove = &apos;X&apos;
                         no_rowins  = &apos;X&apos;
                         style      = style
                         colort     = color ).
      o_alv-&gt;quitar_opciones( cl_gui_alv_grid=&gt;mc_fc_refresh ).
      IF tabint = &apos;X&apos;.
        o_alv-&gt;set_campos_tabint( i_listado ).
      ENDIF.
      IF NOT lights IS INITIAL.
        o_alv-&gt;set_field( campo = lights op = &apos;FIX&apos; ).
      ENDIF.
    ENDIF.

    sgpi_texto( &apos;Generando informe&apos;(gin) ).
    o_alv-&gt;show( CHANGING tabla = i_listado ).
    IF alv_standard = &apos;X&apos;.
      o_alv-&gt;actualiza_campos_grid( campos_borrar = campos_borrar ).
      o_alv-&gt;set_seleccion( CHANGING t_tabla = i_listado ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO_M" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="58 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO_M" SCONAME="O_GRID" VERSION="1" LANGU="S" DESCRIPT="ALV Grid" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_ALV_GRID"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO_M" SCONAME="TITLE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="STATUS_DYNPRO_M" SCONAME="DATOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <source>METHOD status_dynpro_m.  &quot;#EC EMPTY_PROCEDURE
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="TEXTO_COMPARABLE" VERSION="1" LANGU="S" DESCRIPT="Elimina determinados objetos para comparar código" EXPOSURE="2" STATE="1" EDITORDER="3 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="TEXTO_COMPARABLE" SCONAME="I_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <source>METHOD texto_comparable.
    DATA l_tabla TYPE text255.

    LOOP AT i_tabla INTO l_tabla.
      IF    l_tabla    IS INITIAL           OR l_tabla CS &apos;&quot;NOLIB&apos;
         OR l_tabla(1)  = &apos;*&apos;               OR l_tabla  = c_lin_sep
         OR l_tabla(4)  = &apos;ZCL_&apos;
         OR l_tabla    CS &apos;DEFINITION LOAD&apos;.
        DELETE i_tabla.
      ELSE.
        CALL FUNCTION &apos;SCP_REPLACE_STRANGE_CHARS&apos;
     EXPORTING  intext            = l_tabla
                replacement       = &apos;&apos;
     IMPORTING  outtext           = l_tabla
     EXCEPTIONS invalid_codepage  = 1
                codepage_mismatch = 2
                internal_error    = 3
                cannot_convert    = 4
                fields_not_type_c = 5
                OTHERS            = 6.

        SPLIT l_tabla AT ` &quot;EC` INTO l_tabla DATA(l_aux).
        SPLIT l_tabla AT ` ##` INTO l_tabla l_aux.
        IF l_aux CS &apos;.&apos;.
          CONCATENATE l_tabla &apos;.&apos; INTO l_tabla.
        ENDIF.
        REPLACE ALL OCCURRENCES OF &apos;á&apos; IN l_tabla WITH &apos;a&apos;.
        REPLACE ALL OCCURRENCES OF &apos;é&apos; IN l_tabla WITH &apos;e&apos;.
        REPLACE ALL OCCURRENCES OF &apos;í&apos; IN l_tabla WITH &apos;i&apos;.
        REPLACE ALL OCCURRENCES OF &apos;ó&apos; IN l_tabla WITH &apos;o&apos;.
        REPLACE ALL OCCURRENCES OF &apos;ú&apos; IN l_tabla WITH &apos;u&apos;.
        REPLACE ALL OCCURRENCES OF &apos;Á&apos; IN l_tabla WITH &apos;A&apos;.
        REPLACE ALL OCCURRENCES OF &apos;É&apos; IN l_tabla WITH &apos;E&apos;.
        REPLACE ALL OCCURRENCES OF &apos;Í&apos; IN l_tabla WITH &apos;I&apos;.
        REPLACE ALL OCCURRENCES OF &apos;Ó&apos; IN l_tabla WITH &apos;O&apos;.
        REPLACE ALL OCCURRENCES OF &apos;Ú&apos; IN l_tabla WITH &apos;U&apos;.
        REPLACE ALL OCCURRENCES OF &apos;A*3&apos; IN l_tabla WITH &apos;O&apos;.
        REPLACE ALL OCCURRENCES OF &apos;&apos;&apos;A?&apos; IN l_tabla WITH &apos;&apos;&apos;?&apos;.

        MODIFY i_tabla FROM l_tabla.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_DEV" CMPNAME="VALIDAR_SELECCION_OBLIGATORIA" VERSION="1" LANGU="S" DESCRIPT="Valida selección obligatoria" EXPOSURE="2" STATE="1" EDITORDER="48 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="VALIDAR_SELECCION_OBLIGATORIA" SCONAME="CPROG" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Programa de llamada" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="VALIDAR_SELECCION_OBLIGATORIA" SCONAME="CAMPOS_OR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="VALIDAR_SELECCION_OBLIGATORIA" SCONAME="CAMPOS_AND" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="VALIDAR_SELECCION_OBLIGATORIA" SCONAME="EXCLUIR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="VALIDAR_SELECCION_OBLIGATORIA" SCONAME="MSGTY" VERSION="1" LANGU="S" DESCRIPT="Clase de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="MSGTY" PARVALUE="&apos;E&apos;"/>
  <parameter CLSNAME="ZCL_AP_DEV" CMPNAME="VALIDAR_SELECCION_OBLIGATORIA" SCONAME="MENSAJE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="MSGTY" PARVALUE="&apos;&apos;"/>
  <source>METHOD validar_seleccion_obligatoria.
    DATA: selection_table TYPE STANDARD TABLE OF rsparams,
          r_campos        TYPE rstt_t_range_string,
          l_ok            TYPE c LENGTH 1,
          textpooltable   TYPE STANDARD TABLE OF textpool,
          sel             TYPE rsparams,
          texto           TYPE textpool,
          l_descr_campos  TYPE string.

    CHECK NOT campos_or IS INITIAL OR NOT campos_and IS INITIAL.

    CALL FUNCTION &apos;RS_REFRESH_FROM_SELECTOPTIONS&apos;
      EXPORTING
        curr_report     = cprog
      TABLES
        selection_table = selection_table
      EXCEPTIONS
        not_found       = 1
        no_report       = 2.

    IF sy-subrc &lt;&gt; 0.
      RETURN.
    ENDIF.

    IF NOT campos_or IS INITIAL.
      IF campos_or &lt;&gt; &apos;*&apos;.
        r_campos = zcl_ap_lista=&gt;lista2rango( lista = campos_or option = &apos;E*&apos; ).
      ELSE.
        IF NOT excluir IS INITIAL.
          r_campos = zcl_ap_lista=&gt;lista2rango( lista = excluir sign = &apos;E&apos; option = &apos;E*&apos; ).
        ENDIF.
      ENDIF.

      LOOP AT selection_table TRANSPORTING NO FIELDS WHERE     selname IN r_campos
                                                           AND ( low &lt;&gt; &apos;&apos; OR option &lt;&gt; &apos;&apos; ).
        l_ok = &apos;X&apos;.
        EXIT.
      ENDLOOP.

      IF l_ok IS INITIAL.
        IF campos_or = &apos;*&apos;.
          IF NOT mensaje IS INITIAL.
            MESSAGE mensaje TYPE msgty.
          ELSE.
            IF msgty = &apos;E&apos;.
              MESSAGE &apos;Informe algun criterio de seleccion&apos;(ics) TYPE msgty ##NO_TEXT.
            ELSE.
              MESSAGE &apos;Deberia informar algun criterio de seleccion&apos;(dic) TYPE msgty ##NO_TEXT.
            ENDIF.
          ENDIF.
        ELSE.
          IF NOT mensaje IS INITIAL.
            MESSAGE mensaje TYPE msgty.
          ELSE.
            READ TEXTPOOL cprog INTO textpooltable LANGUAGE sy-langu.

            LOOP AT selection_table INTO sel WHERE selname IN r_campos. &quot;#EC CI_STDSEQ
              CLEAR texto.
              READ TABLE textpooltable INTO texto WITH KEY key = sel-selname. &quot;#EC CI_STDSEQ
              IF sy-subrc = 0.
                IF texto-entry+1 = &apos;       .&apos;.
                  CLEAR texto.
                ENDIF.
              ENDIF.

              IF NOT texto-entry IS INITIAL.
                CONDENSE texto-entry.
                __add_lista l_descr_campos texto-entry.
              ELSE.
                __add_lista l_descr_campos sel-selname.
              ENDIF.
            ENDLOOP.

            CONCATENATE &apos;Informe uno de estos filtros:&apos; l_descr_campos INTO l_descr_campos SEPARATED BY space ##NO_TEXT.
            MESSAGE l_descr_campos TYPE msgty.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.

    IF NOT campos_and IS INITIAL.
      r_campos = zcl_ap_lista=&gt;lista2rango( campos_and ).

      LOOP AT selection_table INTO sel WHERE     selname IN r_campos &quot;#EC CI_STDSEQ
                                             AND ( low &lt;&gt; &apos;&apos; OR option &lt;&gt; &apos;&apos; ).
        DELETE r_campos WHERE low = sel-selname.         &quot;#EC CI_STDSEQ
      ENDLOOP.

      IF NOT r_campos IS INITIAL.
        IF NOT mensaje IS INITIAL.
          MESSAGE mensaje TYPE msgty.
        ELSE.

          IF textpooltable IS INITIAL.
            READ TEXTPOOL cprog INTO textpooltable LANGUAGE sy-langu.
          ENDIF.

          LOOP AT selection_table INTO sel WHERE selname IN r_campos. &quot;#EC CI_STDSEQ
            READ TABLE textpooltable INTO texto WITH KEY key = sel-selname. &quot;#EC CI_STDSEQ
            IF sy-subrc = 0.
              IF texto-entry+1 = &apos;       .&apos;.
                CLEAR texto.
              ENDIF.
            ENDIF.

            IF NOT texto-entry IS INITIAL.
              __add_lista l_descr_campos texto-entry.
            ELSE.
              __add_lista l_descr_campos sel-selname.
            ENDIF.
          ENDLOOP.

          CONCATENATE &apos;Informe todos estos filtros:&apos; l_descr_campos INTO l_descr_campos SEPARATED BY space ##NO_TEXT.
          MESSAGE l_descr_campos TYPE msgty.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
</CLAS>
