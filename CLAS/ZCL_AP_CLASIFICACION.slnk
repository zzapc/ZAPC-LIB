<?xml version="1.0" encoding="utf-8"?>
<CLAS CLSNAME="ZCL_AP_CLASIFICACION" VERSION="1" LANGU="S" DESCRIPT="Clasificación" CATEGORY="00" EXPOSURE="2" STATE="1" RELEASE="0" CLSCCINCL="X" FIXPT="X" UNICODE="X" CLSBCCAT="00" DURATION_TYPE="0 " RISK_LEVEL="0 ">
 <localImplementation>*&quot;* local class implementation for public class
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</localImplementation>
 <localTypes>*&quot;* use this source file for any type declarations (class
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</localTypes>
 <localMacros>*&quot;* use this source file for any macro definitions you need
*&quot;* in the implementation part of the class</localMacros>
 <typeUsage CLSNAME="ZCL_AP_CLASIFICACION" TYPEGROUP="ABAP" VERSION="1" TPUTYPE="0" IMPLICIT="X"/>
 <forwardDeclaration>ABAP</forwardDeclaration>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CARACTERISTICA" VERSION="1" LANGU="S" DESCRIPT="Característica" EXPOSURE="2" STATE="1" EDITORDER="15 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="WRF_APC_CHAR_STY" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Interfase API p. valor de una característica(repres.interna)" EXPOSURE="2" STATE="1" EDITORDER="18 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="API_VALI" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CAR_CHAR" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_CHAR" EXPOSURE="2" STATE="1" EDITORDER="5 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPI1003_ALLOC_VALUES_CHAR" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CAR_CURR" VERSION="1" LANGU="S" DESCRIPT="Clasificación BAPI: Valoraciones tipo CURR" EXPOSURE="2" STATE="1" EDITORDER="7 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPI1003_ALLOC_VALUES_CURR" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CAR_NUM" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_NUM" EXPOSURE="2" STATE="1" EDITORDER="6 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPI1003_ALLOC_VALUES_NUM" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CAR_UNIF" VERSION="1" LANGU="S" DESCRIPT="Estructura seleccion característica" EXPOSURE="2" STATE="1" EDITORDER="20 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ZSEL_CAR" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CLASSNUM" VERSION="1" LANGU="S" DESCRIPT="N° de clase" EXPOSURE="2" STATE="1" EDITORDER="10 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPI1003_KEY-CLASSNUM" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CLASSTYPE" VERSION="1" LANGU="S" DESCRIPT="Categoría de la clase" EXPOSURE="2" STATE="1" EDITORDER="11 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPI1003_KEY-CLASSTYPE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="C_OBJECTCLAS" VERSION="1" LANGU="S" DESCRIPT="Clase de objeto" EXPOSURE="2" STATE="1" EDITORDER="22 " ATTDECLTYP="2" ATTVALUE="&apos;CLASSIFY&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="CDHDR-OBJECTCLAS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="HAY_CARACT_MEM" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="19 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="I_CARACTERISTICAS" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_CHAR" EXPOSURE="2" STATE="1" EDITORDER="14 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="WRF_APC_CHAR_TTY" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="I_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para API_VALI" EXPOSURE="2" STATE="1" EDITORDER="17 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TT_API_VALI" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="I_CAR_CHAR" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_CHAR" EXPOSURE="2" STATE="1" EDITORDER="2 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TT_BAPI1003_ALLOC_VALUES_CHAR" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="I_CAR_CURR" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_CURR" EXPOSURE="2" STATE="1" EDITORDER="3 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TT_BAPI1003_ALLOC_VALUES_CURR" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="I_CAR_NUM" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_NUM" EXPOSURE="2" STATE="1" EDITORDER="1 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TT_BAPI1003_ALLOC_VALUES_NUM" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="I_CAR_UNIF" VERSION="1" LANGU="S" DESCRIPT="Estructura seleccion característica" EXPOSURE="2" STATE="1" EDITORDER="16 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ZT_SEL_CAR" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="I_LISTA_CHAR" VERSION="1" LANGU="S" DESCRIPT="Lista de caracteristicas" EXPOSURE="2" STATE="1" EDITORDER="12 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TT_BAPI1003_ALLOC_VALUES_CHAR" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="I_RETURN" VERSION="1" LANGU="S" DESCRIPT="Tabla retorno" EXPOSURE="2" STATE="1" EDITORDER="4 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPIRET2_T" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="OBJECTKEY" VERSION="1" LANGU="S" DESCRIPT="Clave del objeto a clasificar" EXPOSURE="2" STATE="1" EDITORDER="21 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPI1003_KEY-OBJECT" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="OBJECTNAME" VERSION="1" LANGU="S" DESCRIPT="Clave del objeto a clasificar" EXPOSURE="2" STATE="1" EDITORDER="13 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPI1003_KEY-OBJECT" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="OBJECTTABLE" VERSION="1" LANGU="S" DESCRIPT="Nombre de la tabla de base datos del objeto" EXPOSURE="2" STATE="1" EDITORDER="9 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPI1003_KEY-OBJECTTABLE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="RETURN" VERSION="1" LANGU="S" DESCRIPT="Parámetro de retorno" EXPOSURE="2" STATE="1" EDITORDER="8 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPIRET2" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ASIGNAR_CLASE" VERSION="1" LANGU="S" DESCRIPT="Asigna clase a objeto" EXPOSURE="2" STATE="1" EDITORDER="50 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ASIGNAR_CLASE" SCONAME="CLASSNUM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ASIGNAR_CLASE" SCONAME="CLASSTYPE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ASIGNAR_CLASE" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ASIGNAR_CLASE" SCONAME="OBJECTKEY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ASIGNAR_CLASE" SCONAME="COMMIT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ASIGNAR_CLASE" SCONAME="MENSAJE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD asignar_clase.
    DATA: l_objectkey TYPE bapi1003_key-object,
          l_tabla     TYPE bapi1003_key-objecttable,
          l_classtype TYPE bapi1003_key-classtype,
          l_classnum  TYPE bapi1003_key-classnum,
          i_return    TYPE TABLE OF bapiret2,
          l_return    TYPE bapiret2.

    l_objectkey = objectkey.
    l_tabla     = tabla.
    l_classtype = classtype.
    l_classnum  = classnum.
    CALL FUNCTION &apos;BAPI_OBJCL_CREATE&apos;
      EXPORTING
        objectkeynew   = l_objectkey
        objecttablenew = l_tabla
        classnumnew    = l_classnum
        classtypenew   = l_classtype
        keydate        = sy-datum
      TABLES
        return         = i_return.

    LOOP AT i_return INTO l_return WHERE type = &apos;E&apos;.
      IF mensaje IS INITIAL.
        mensaje = l_return-message.
      ELSE.
        CONCATENATE mensaje l_return-message INTO mensaje SEPARATED BY space.
      ENDIF.
    ENDLOOP.
    IF sy-subrc &lt;&gt; 0.
      IF commit = &apos;X&apos;.
        zcl_ap_dev=&gt;commit( ).
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CONSTRUCTOR" VERSION="1" LANGU="S" DESCRIPT="CONSTRUCTOR" EXPOSURE="2" STATE="1" EDITORDER="1 " DISPID="0 " MTDTYPE="2" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CONSTRUCTOR" SCONAME="OBJECTTABLE" VERSION="1" LANGU="S" DESCRIPT="Nombre de la tabla de base datos del objeto" CMPTYPE="1" MTDTYPE="2" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI1003_KEY-OBJECTTABLE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CONSTRUCTOR" SCONAME="CLASSNUM" VERSION="1" LANGU="S" DESCRIPT="N° de clase" CMPTYPE="1" MTDTYPE="2" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CONSTRUCTOR" SCONAME="CLASSTYPE" VERSION="1" LANGU="S" DESCRIPT="Tipo de clase: Leer o escribir" CMPTYPE="1" MTDTYPE="2" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI1003_KEY-CLASSTYPE"/>
  <source>METHOD constructor.
    me-&gt;classnum  = classnum.
    me-&gt;classtype = classtype.

    IF objecttable IS INITIAL.
      SELECT SINGLE obtab FROM tcla
        INTO me-&gt;objecttable
       WHERE klart = classtype.
    ELSE.
      me-&gt;objecttable = objecttable.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="COPY_CARACT_BD_TO_MEM" VERSION="1" LANGU="S" DESCRIPT="Copia caracteristicas en formato BD a formato memoria" EXPOSURE="2" STATE="1" EDITORDER="48 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <source>METHOD copy_caract_bd_to_mem.
    DATA l_caract_mem TYPE api_vali.

    FIELD-SYMBOLS: &lt;car_char&gt; TYPE bapi1003_alloc_values_char,
                   &lt;car_num&gt;  TYPE bapi1003_alloc_values_num,
                   &lt;car_curr&gt; TYPE bapi1003_alloc_values_curr.

    CLEAR i_caract_mem.
    LOOP AT i_car_char ASSIGNING &lt;car_char&gt;.
      CLEAR l_caract_mem.
      l_caract_mem-atnam = &lt;car_char&gt;-charact.
      l_caract_mem-atinn = get_caract_interno( l_caract_mem-atnam ).
      l_caract_mem-atwrt = &lt;car_char&gt;-value_char.
      l_caract_mem-atbez = &lt;car_char&gt;-charact_descr.
      APPEND l_caract_mem TO i_caract_mem.
    ENDLOOP.

    LOOP AT i_car_num ASSIGNING &lt;car_num&gt;.
      CLEAR l_caract_mem.
      l_caract_mem-atnam = &lt;car_num&gt;-charact.
      l_caract_mem-atinn = get_caract_interno( l_caract_mem-atnam ).
      l_caract_mem-atflv = &lt;car_num&gt;-value_from.
      l_caract_mem-atflb = &lt;car_num&gt;-value_to.
      l_caract_mem-atbez = &lt;car_num&gt;-charact_descr.
      APPEND l_caract_mem TO i_caract_mem.
    ENDLOOP.

    LOOP AT i_car_curr ASSIGNING &lt;car_curr&gt;.
      CLEAR l_caract_mem.
      l_caract_mem-atnam = &lt;car_curr&gt;-charact.
      l_caract_mem-atinn = get_caract_interno( l_caract_mem-atnam ).
      l_caract_mem-atflv = &lt;car_curr&gt;-value_from.
      l_caract_mem-atflb = &lt;car_curr&gt;-value_to.
      l_caract_mem-atbez = &lt;car_curr&gt;-charact_descr.
      APPEND l_caract_mem TO i_caract_mem.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CREAR_CLASE" VERSION="1" LANGU="S" DESCRIPT="Crear clase" EXPOSURE="2" STATE="1" EDITORDER="27 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CREAR_CLASE" SCONAME="OBJECTKEY" VERSION="1" LANGU="S" DESCRIPT="Clave del objeto a clasificar" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CREAR_CLASE" SCONAME="COMMIT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="CREAR_CLASE" SCONAME="DEQUEUE_ALL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <source>METHOD crear_clase.
    DATA l_objectkey TYPE bapi1003_key-object.

    l_objectkey = objectkey.
    CALL FUNCTION &apos;BAPI_OBJCL_CREATE&apos;
      EXPORTING
        objectkeynew           = l_objectkey
        objecttablenew         = objecttable
        classnumnew            = classnum
        classtypenew           = classtype
*   KEYDATE                = SY-DATUM
*   UNVALUATED_CHARS       = &apos; &apos;
*   LANGUAGE               = SY-LANGU
* IMPORTING
*   STATUS                 =
*   STANDARDCLASS          =
      TABLES
        allocvaluesnum         = i_car_num
        allocvalueschar        = i_car_char
        allocvaluescurr        = i_car_curr
        return                 = i_return.

    IF commit = &apos;X&apos;.
      CALL FUNCTION &apos;BAPI_TRANSACTION_COMMIT&apos;
        EXPORTING
          wait = &apos;X&apos;.

      IF dequeue_all = &apos;X&apos;.
        CALL FUNCTION &apos;DEQUEUE_ALL&apos;.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="DEL_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Borra caracteristica char en memoria" EXPOSURE="2" STATE="1" EDITORDER="46 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="DEL_CARACT_MEM" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="DEL_CARACT_MEM" SCONAME="ATINN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <source>METHOD del_caract_mem.
    DATA l_atinn TYPE atinn.

    IF atinn IS INITIAL.
      l_atinn = get_caract_interno( caract ).
    ELSE.
      l_atinn = atinn.
    ENDIF.

    DELETE i_caract_mem WHERE atinn = l_atinn.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="DEL_CARACT_MEM_ST" VERSION="1" LANGU="S" DESCRIPT="Borra caracteristicas en memoria" EXPOSURE="2" STATE="1" EDITORDER="32 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="DEL_CARACT_MEM_ST" SCONAME="I_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para API_VALI" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_API_VALI"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="DEL_CARACT_MEM_ST" SCONAME="SUBRC" VERSION="1" LANGU="S" DESCRIPT="Subrutina código return" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="SUBRC"/>
  <source>METHOD del_caract_mem_st.
    DATA: l_caract_mem TYPE api_vali,
          l_value      TYPE api_val_i,
          i_values     TYPE TABLE OF api_val_i.

    LOOP AT i_caract_mem INTO l_caract_mem.
      MOVE-CORRESPONDING l_caract_mem TO l_value.
      l_value-atwtb = l_caract_mem-atwrt.
      APPEND l_value TO i_values.
    ENDLOOP.

    CALL FUNCTION &apos;CTMS_DDB_DEL_VALUE&apos;
* EXPORTING
*   INSTANCE                            =
*   UDEF_INSTANCE                       =
*   MESSAGE                             = &apos; &apos;
* IMPORTING
*   EXP_NOT_SELECTED                    =
      TABLES
        imp_values                          = i_values
*   EXP_VALUES_ERROR                    =
     EXCEPTIONS
       currency_check                      = 1
       date_check                          = 2
       format_check                        = 3
       illegal_internal_baseunit           = 4
       interval_check                      = 5
       pattern_check                       = 6
       time_check                          = 7
       unit_check                          = 8
       value_not_found                     = 9
       display_mode                        = 10
       characteristic_not_found            = 11
       characteristic_enqueue              = 12
       objectcharacteristic                = 13
       characteristic_not_selectable       = 14
       no_valid_dimension                  = 15
       interval_not_allowed                = 16
       input_to_long                       = 17
       value_contradiction                 = 18
       OTHERS                              = 19.
    IF sy-subrc &lt;&gt; 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="DEL_DATOS" VERSION="1" LANGU="S" DESCRIPT="Borra clasificación de un objeto" EXPOSURE="2" STATE="1" EDITORDER="40 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="DEL_DATOS" SCONAME="OBJECTKEY" VERSION="1" LANGU="S" DESCRIPT="Clave del objeto a clasificar" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI1003_KEY-OBJECT"/>
  <source>METHOD del_datos.
    CLEAR i_return.

    CALL FUNCTION &apos;BAPI_OBJCL_DELETE&apos;
      EXPORTING
        objectkey              = objectkey
        objecttable            = objecttable
        classnum               = classnum
        classtype              = classtype
*     CHANGENUMBER       =
*     KEYDATE            = SY-DATUM
      TABLES
        return             = i_return.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ES_VALOR_CARACT_VALIDO" VERSION="1" LANGU="S" DESCRIPT="Verifica si el valor de la característica es válido" EXPOSURE="2" STATE="1" EDITORDER="22 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ES_VALOR_CARACT_VALIDO" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ES_VALOR_CARACT_VALIDO" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="ES_VALOR_CARACT_VALIDO" SCONAME="ES_VALIDO" VERSION="1" LANGU="S" DESCRIPT="Valor válido" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ABAP_BOOL"/>
  <source>METHOD es_valor_caract_valido.
    DATA: l_atinn TYPE atinn,
          &quot; TODO: variable is assigned but never used (ABAP cleaner)
          l_ATWRT TYPE atwrt.

    l_atinn = get_caract_interno( caract ).

    CLEAR es_valido.
    SELECT SINGLE atwrt FROM cawn
      INTO l_atwrt
     WHERE atinn = l_atinn
       AND atwrt = valor.
    IF sy-subrc = 0.
      es_valido = &apos;X&apos;.
    ELSE.
      SELECT SINGLE atwrt FROM cawn
        INTO l_atwrt
       WHERE atinn = l_atinn.
      IF sy-subrc &lt;&gt; 0.
        es_valido = &apos;X&apos;.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="EXISTE_CLASE" VERSION="1" LANGU="S" DESCRIPT="¿La clase está creada?" EXPOSURE="2" STATE="1" EDITORDER="28 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="EXISTE_CLASE" SCONAME="CLASSTYPE" VERSION="1" LANGU="S" DESCRIPT="Categoría de la clase" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="EXISTE_CLASE" SCONAME="OBJECT" VERSION="1" LANGU="S" DESCRIPT="Clave del objeto a clasificar" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="EXISTE_CLASE" SCONAME="OBJECTTABLE" VERSION="1" LANGU="S" DESCRIPT="Nombre de la tabla de base datos del objeto" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="EXISTE_CLASE" SCONAME="EXISTE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ABAP_BOOL"/>
  <source>METHOD existe_clase.
    &quot; TODO: variable is assigned but never used (ABAP cleaner)
    DATA l_inob TYPE inob.

    CLEAR existe.
    IF classtype = &apos;023&apos;.
      SELECT SINGLE klart FROM inob
        INTO l_inob-klart
       WHERE klart = classtype
         AND obtab = objecttable
         AND objek = object.
      IF sy-subrc = 0.
        existe = &apos;X&apos;.
      ENDIF.
    ELSE.
      SELECT SINGLE klart FROM kssk
        INTO l_inob-klart
       WHERE objek = object
         AND klart = classtype.
      IF sy-subrc = 0.
        existe = &apos;X&apos;.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="FREE" VERSION="1" LANGU="S" DESCRIPT="Libera memoria del objeto" EXPOSURE="2" STATE="1" EDITORDER="11 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <source>METHOD free.
    CLEAR: i_car_num, i_car_char, i_car_curr, i_return.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CAMBIOS" VERSION="1" LANGU="S" DESCRIPT="Devuelve control de cambios" EXPOSURE="2" STATE="1" EDITORDER="39 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CAMBIOS" SCONAME="CLASS_TYPE" VERSION="1" LANGU="S" DESCRIPT="Categoría de la clase" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TCLA-KLART"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CAMBIOS" SCONAME="OBJECT_ID" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CAMBIOS" SCONAME="TABLE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CAMBIOS" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CAMBIOS" SCONAME="I_CDPOS" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla en base a la estructura generada iscdpos" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ISCDPOS_TAB"/>
  <source>METHOD get_cambios.
    DATA: l_object   TYPE inob-cuobj,
          l_objectid TYPE cdhdr-objectid,
          l_atinn    TYPE atinn,
          l_tabkey   TYPE cdpos-tabkey.

    FIELD-SYMBOLS &lt;cdpos&gt; TYPE iscdpos.

    l_object = get_object_number( class_type = class_type
                                  object_id  = object_id
                                  table      = table ).
    CONCATENATE l_object &apos;O&apos; INTO l_objectid.

    i_cdpos = zcl_ap_control_cambios=&gt;get_cdpos( objectclas = &apos;CLASSIFY&apos;
                                                 objectid   = l_objectid ).

    IF NOT caract IS INITIAL.
      l_atinn = get_caract_interno( caract ).
      CONCATENATE l_object l_atinn INTO l_tabkey.
      LOOP AT i_cdpos ASSIGNING &lt;cdpos&gt;.
        IF NOT ( &lt;cdpos&gt;-tabname = &apos;ABAUSP&apos; AND &lt;cdpos&gt;-tabkey(28) = l_tabkey ).
          DELETE i_cdpos.
        ENDIF.
      ENDLOOP.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CAMBIOS_CARACT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="56 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CAMBIOS_CARACT" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CAMBIOS_CARACT" SCONAME="R_UDATE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="RSTT_T_RANGE_DATE"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CAMBIOS_CARACT" SCONAME="I_CDPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ISCDPOS_TAB"/>
  <source>METHOD get_cambios_caract.
    DATA: i_cdhdr  TYPE TABLE OF iscdpos,
          r_tabkey TYPE RANGE OF cdpos-tabkey.
    DATA l_atflv    TYPE ausp-atflv.
    DATA l_ctd_char TYPE cha_class_view-sollwert.

    SELECT * FROM cdhdr
      INTO CORRESPONDING FIELDS OF TABLE i_cdhdr
     WHERE objectclas  = c_objectclas
       AND udate      IN r_udate.
    IF sy-subrc &lt;&gt; 0.
      RETURN.
    ENDIF.

    IF NOT caract IS INITIAL.
      DATA(l_atinn) = get_caract_interno( caract ).
      r_tabkey = VALUE #( ( option = &apos;CP&apos; sign = &apos;I&apos; low = |*{ l_atinn }*| ) ).
    ENDIF.

    SELECT * FROM cdpos &quot;#EC CI_NO_TRANSFORM
      INTO CORRESPONDING FIELDS OF TABLE i_cdpos
      FOR ALL ENTRIES IN i_cdhdr
     WHERE objectclas  = c_objectclas
       AND objectid    = i_cdhdr-objectid
       AND tabname     = &apos;ABAUSP&apos;
       AND tabkey     IN r_tabkey
      ORDER BY PRIMARY KEY.
    LOOP AT i_cdpos ASSIGNING FIELD-SYMBOL(&lt;cdpos&gt;).
      ASSIGN i_cdhdr[ objectid = &lt;cdpos&gt;-objectid ] TO FIELD-SYMBOL(&lt;cdhdr&gt;).
      IF sy-subrc = 0.
        &lt;cdpos&gt;-username = &lt;cdhdr&gt;-username.
        &lt;cdpos&gt;-udate    = &lt;cdhdr&gt;-udate.
        &lt;cdpos&gt;-utime    = &lt;cdhdr&gt;-utime.
        &lt;cdpos&gt;-tcode    = &lt;cdhdr&gt;-tcode.
      ENDIF.

* En cantidades, hace cosas raras, con los decimales, si detectamos que tiene muchos, formateamos
      IF &lt;cdpos&gt;-fname &lt;&gt; &apos;ATFLV&apos;.
        CONTINUE.
      ENDIF.

      SPLIT &lt;cdpos&gt;-value_new AT &apos;.&apos; INTO DATA(l_entero) DATA(l_decimal).
      IF strlen( l_decimal ) &gt; 2.
        l_atflv = &lt;cdpos&gt;-value_new.
        CALL FUNCTION &apos;QSS0_FLTP_TO_CHAR_CONVERSION&apos;
          EXPORTING
            i_number_of_digits = 6
            i_fltp_value       = l_atflv
          IMPORTING
            e_char_field       = l_ctd_char.
        &lt;cdpos&gt;-value_new = l_ctd_char.
        REPLACE ALL OCCURRENCES OF &apos;,&apos; IN &lt;cdpos&gt;-value_new WITH &apos;.&apos;.
      ENDIF.

      SPLIT &lt;cdpos&gt;-value_old AT &apos;.&apos; INTO l_entero l_decimal.
      IF strlen( l_decimal ) &gt; 2.
        l_atflv = &lt;cdpos&gt;-value_old.
        CALL FUNCTION &apos;QSS0_FLTP_TO_CHAR_CONVERSION&apos;
          EXPORTING
            i_number_of_digits = 6
            i_fltp_value       = l_atflv
          IMPORTING
            e_char_field       = l_ctd_char.
        &lt;cdpos&gt;-value_old = l_ctd_char.
        REPLACE ALL OCCURRENCES OF &apos;,&apos; IN &lt;cdpos&gt;-value_old WITH &apos;.&apos;.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_EXTERNO" VERSION="1" LANGU="S" DESCRIPT="Devuelve el nº interno de una característica" EXPOSURE="2" STATE="1" EDITORDER="13 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_EXTERNO" SCONAME="ATINN" VERSION="1" LANGU="S" DESCRIPT="Característica interna" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="1" TYPE="ATINN"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_EXTERNO" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_caract_externo.
    CALL FUNCTION &apos;CONVERSION_EXIT_ATINN_OUTPUT&apos;
      EXPORTING
        input  = atinn
      IMPORTING
        output = caract.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_INTERNO" VERSION="1" LANGU="S" DESCRIPT="Devuelve el nº interno de una característica" EXPOSURE="2" STATE="1" EDITORDER="8 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_INTERNO" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_INTERNO" SCONAME="ATINN" VERSION="1" LANGU="S" DESCRIPT="Característica interna" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ATINN"/>
  <source>METHOD get_caract_interno.
    CALL FUNCTION &apos;CONVERSION_EXIT_ATINN_INPUT&apos;
      EXPORTING
        input         = caract
     IMPORTING
        output        = atinn.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Recupera caracteristicas en memoria" EXPOSURE="2" STATE="1" EDITORDER="30 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_MEM" SCONAME="DEFAULT_VALUES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <source>METHOD get_caract_mem.
    FIELD-SYMBOLS &lt;fs&gt; TYPE table.

    CLEAR hay_caract_mem.
    i_caract_mem = get_caract_mem_st( default_values = default_values ).

    IF NOT me-&gt;i_caract_mem IS INITIAL.
      hay_caract_mem = &apos;X&apos;.
    ELSE.
      ASSIGN (&apos;(SAPLCTMS)MI[]&apos;) TO &lt;fs&gt;. &quot;#EC *
      IF sy-subrc = 0.
        IF NOT &lt;fs&gt; IS INITIAL.
          hay_caract_mem = &apos;X&apos;.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_MEM_ST" VERSION="1" LANGU="S" DESCRIPT="Recupera caracteristicas en memoria" EXPOSURE="2" STATE="1" EDITORDER="31 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_MEM_ST" SCONAME="DEFAULT_VALUES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_MEM_ST" SCONAME="I_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para API_VALI" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="TT_API_VALI"/>
  <source>METHOD get_caract_mem_st.
    DATA i_imp TYPE TABLE OF api_char.

    CLEAR i_caract_mem.
    CALL FUNCTION &apos;CTMS_DDB_HAS_VALUES_INTERNAL&apos;
      EXPORTING
        assigned_values            = &apos;X&apos;
        allowed_values             = &apos; &apos;
        valid_values               = &apos; &apos;
*   INCONSISTENT_VALUES        = &apos; &apos;
*   FIRST_ASSIGNED_VALUE       = &apos; &apos;
        default_values             = default_values
*   LANGUAGE                   = SY-LANGU
*   DOCUMENT_INFO              = &apos; &apos;
*   EXCL_KNOWLEDGE             = &apos; &apos;
*   I_CALLED_FROM_DDB          = &apos; &apos;
      TABLES
        imp_characteristics        = i_imp
        exp_values                 = i_caract_mem
     EXCEPTIONS
       not_found                  = 1
       OTHERS                     = 2.
    IF sy-subrc &lt;&gt; 0.
*      message &apos;No hay datos en memoria&apos; type &apos;S&apos;.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_SIMPLE" VERSION="1" LANGU="S" DESCRIPT="Transforma a tabla caracteristicas simple" EXPOSURE="2" STATE="1" EDITORDER="25 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_SIMPLE" SCONAME="I_CAR_CHAR" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_CHAR" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_BAPI1003_ALLOC_VALUES_CHAR" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_SIMPLE" SCONAME="I_CAR_NUM" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_NUM" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_BAPI1003_ALLOC_VALUES_NUM" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_SIMPLE" SCONAME="I_CAR_CURR" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_CURR" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_BAPI1003_ALLOC_VALUES_CURR" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CARACT_SIMPLE" SCONAME="I_CARACT" VERSION="1" LANGU="S" DESCRIPT="Tipo tabla selección características" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ZT_SEL_CAR"/>
  <source>METHOD get_caract_simple.
    DATA: l_car_char TYPE bapi1003_alloc_values_char,
          l_orden    TYPE zsel_car-orden,
          l_caract   TYPE zsel_car,
          l_car_num  TYPE bapi1003_alloc_values_num,
          l_car_curr TYPE bapi1003_alloc_values_curr.
    DATA: l_num   TYPE i,
          l_fecha TYPE d.

    CLEAR i_caract.

    LOOP AT i_car_char INTO l_car_char.
      l_orden = l_orden + 1.
      CLEAR l_caract.
      l_caract-charact       = l_car_char-charact.
      l_caract-charact_descr = l_car_char-charact_descr.
      l_caract-atinn         = get_caract_interno( l_car_char-charact ).
      l_caract-tipo_car      = &apos;C&apos;.
      l_caract-orden         = l_orden.
      IF NOT l_car_char-value_neutral IS INITIAL.
        l_caract-value = l_car_char-value_neutral.
      ELSE.
        l_caract-value = l_car_char-value_char.
      ENDIF.
      IF NOT l_car_char-value_char IS INITIAL.
        l_caract-value_desc = l_car_char-value_char.
      ELSE.
        l_caract-value_desc = l_car_char-value_neutral.
      ENDIF.

      APPEND l_caract TO i_caract.
    ENDLOOP.

    LOOP AT i_car_num INTO l_car_num.
      l_orden = l_orden + 1.
      CLEAR l_caract.
      l_caract-charact       = l_car_num-charact.
      l_caract-charact_descr = l_car_num-charact_descr.
      l_caract-atinn         = get_caract_interno( l_car_num-charact ).
      l_caract-tipo_car      = &apos;N&apos;.
      l_caract-orden         = l_orden.

      l_num = l_car_num-value_from.
      IF l_num &gt;= &apos;20010101&apos; AND l_num &lt;= &apos;99991231&apos;.
        WRITE l_num TO l_fecha.
        IF zcl_ap_fechas=&gt;es_valida( l_fecha ) = &apos;X&apos;.
          WRITE l_fecha TO l_caract-value.
        ENDIF.
      ENDIF.
      IF l_caract-value IS INITIAL.
        l_caract-value = zcl_ap_string=&gt;string_pot_2importe( l_car_num-value_from ).
      ENDIF.
      IF NOT l_car_num-value_to IS INITIAL.
        l_caract-value_to = zcl_ap_string=&gt;string_pot_2importe( l_car_num-value_to ).
      ENDIF.

      CONDENSE l_caract-value NO-GAPS.
      CONDENSE l_caract-value_to NO-GAPS.
      l_caract-value_num    = l_car_num-value_from.
      l_caract-value_num_to = l_car_num-value_to.
      l_caract-value_desc   = l_car_num-value_from.
      APPEND l_caract TO i_caract.
    ENDLOOP.

    LOOP AT i_car_curr INTO l_car_curr.
      l_orden = l_orden + 1.
      CLEAR l_caract.
      l_caract-charact       = l_car_curr-charact.
      l_caract-charact_descr = l_car_curr-charact_descr.
      l_caract-atinn         = get_caract_interno( l_car_curr-charact ).
      l_caract-tipo_car      = &apos;C&apos;.
      l_caract-orden         = l_orden.
      l_caract-value         = zcl_ap_string=&gt;string_pot_2importe( l_car_num-value_from ).
      l_caract-value_to      = zcl_ap_string=&gt;string_pot_2importe( l_car_num-value_to ).
      CONDENSE l_caract-value NO-GAPS.
      CONDENSE l_caract-value_to NO-GAPS.

      l_caract-value_num    = l_car_num-value_from.
      l_caract-value_num_to = l_car_num-value_to.
      l_caract-value_desc   = l_car_curr-value_from.
      APPEND l_caract TO i_caract.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR" VERSION="1" LANGU="S" DESCRIPT="Recupera valor CHAR" EXPOSURE="2" STATE="1" EDITORDER="3 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR" SCONAME="NOMBRE_CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR" SCONAME="NOMBRE_CAMPO2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR" SCONAME="IDIOMA" VERSION="1" LANGU="S" DESCRIPT="Clave de idioma" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SPRAS" PARVALUE="SY-LANGU"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR" SCONAME="CAMPO_CLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR" SCONAME="GET_CLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_char.
    CLEAR valor.
    READ TABLE i_car_char INTO car_char WITH KEY charact = charact.
    IF sy-subrc &lt;&gt; 0.
      RETURN.
    ENDIF.

    IF get_clave = &apos;X&apos;.
      valor = car_char-value_neutral.
    ELSE.
      valor = car_char-value_char.

      IF NOT tabla IS INITIAL.
        valor = zcl_ap_dev=&gt;get_descripcion( tabla = tabla
                                             valor = valor
                                             campo_clave = campo_clave
                                             nombre_campo = nombre_campo
                                             nombre_campo2 = nombre_campo2
                                             idioma = idioma ).
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_CLAVE" VERSION="1" LANGU="S" DESCRIPT="Recupera valor CHAR" EXPOSURE="2" STATE="1" EDITORDER="7 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_CLAVE" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_CLAVE" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_char_clave.
    CLEAR valor.
    READ TABLE i_car_char INTO car_char WITH KEY charact = charact.
    IF sy-subrc = 0.
      valor = car_char-value_neutral.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_LISTA" VERSION="1" LANGU="S" DESCRIPT="Recupera lista de valores CHAR" EXPOSURE="2" STATE="1" EDITORDER="42 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_LISTA" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_LISTA" SCONAME="FUNCION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_LISTA" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_LISTA" SCONAME="NOMBRE_CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_LISTA" SCONAME="NOMBRE_CAMPO2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_LISTA" SCONAME="IDIOMA" VERSION="1" LANGU="S" DESCRIPT="Clave de idioma" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SPRAS" PARVALUE="SY-LANGU"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_LISTA" SCONAME="SEPARADOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;,&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_LISTA" SCONAME="CLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_LISTA" SCONAME="LISTA" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_CHAR" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_char_lista.
    DATA: l_valor     TYPE cawn-atwrt,
          l_atinn     TYPE atinn,
          l_valor_new TYPE cawn-atwrt.

    CLEAR lista.
    LOOP AT i_car_char INTO car_char WHERE charact = charact.
      IF clave IS INITIAL.
        l_valor = car_char-value_char.
      ELSE.
        l_valor = car_char-value_neutral.
      ENDIF.

      IF NOT funcion IS INITIAL.
        l_atinn = get_caract_interno( charact ).
        CALL FUNCTION funcion
          EXPORTING
            charact_no = l_atinn
            charact    = charact
            value      = l_valor_new
          EXCEPTIONS
            not_found  = 1.
        IF sy-subrc = 0.
          l_valor = l_valor_new.
        ENDIF.
      ENDIF.

      IF NOT tabla IS INITIAL.
        l_valor = zcl_ap_dev=&gt;get_descripcion( tabla = tabla
                                               valor = l_valor
                                               nombre_campo = nombre_campo
                                               nombre_campo2 = nombre_campo2
                                               idioma = idioma ).
      ENDIF.

      IF lista IS INITIAL.
        lista = l_valor.
      ELSE.
        CONCATENATE lista separador INTO lista.
        CONCATENATE lista l_valor INTO lista SEPARATED BY space.
      ENDIF.

    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_TABLA" VERSION="1" LANGU="S" DESCRIPT="Recupera tabla de valores CHAR" EXPOSURE="2" STATE="1" EDITORDER="6 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_TABLA" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_TABLA" SCONAME="TABLA" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_CHAR" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="TT_BAPI1003_ALLOC_VALUES_CHAR"/>
  <source>METHOD get_char_tabla.
    CLEAR tabla.
    LOOP AT i_car_char INTO car_char WHERE charact = charact.
      APPEND car_char TO tabla.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_TABLA_STRING" VERSION="1" LANGU="S" DESCRIPT="Recupera tabla de valores CHAR" EXPOSURE="2" STATE="1" EDITORDER="44 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_TABLA_STRING" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_TABLA_STRING" SCONAME="SEPARADOR_ENTER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CHAR_TABLA_STRING" SCONAME="VALORES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_char_tabla_string.
    DATA tabla TYPE tt_bapi1003_alloc_values_char.

    FIELD-SYMBOLS &lt;tabla&gt; TYPE bapi1003_alloc_values_char.

    CLEAR valores.
    tabla = get_char_tabla( charact ).

    LOOP AT tabla ASSIGNING &lt;tabla&gt;.
      IF sy-tabix = 1.
        valores = &lt;tabla&gt;-value_char.
      ELSEIF sy-tabix &gt; 1.
        IF separador_enter IS INITIAL.
          CONCATENATE valores &apos;,&apos; INTO valores.
          CONCATENATE valores &lt;tabla&gt;-value_char INTO valores SEPARATED BY space.
        ELSE.
          CONCATENATE valores cl_abap_char_utilities=&gt;newline INTO valores.
          CONCATENATE valores &lt;tabla&gt;-value_char INTO valores.
        ENDIF.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CURR" VERSION="1" LANGU="S" DESCRIPT="Recupera valor CURR" EXPOSURE="2" STATE="1" EDITORDER="23 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CURR" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CURR" SCONAME="VALOR" VERSION="1" LANGU="S" DESCRIPT="Valor de coma flotante interno de" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="TSLVT"/>
  <source>METHOD get_curr.
    DATA l_valor TYPE glt0-tslvt.

    CLEAR valor.
    READ TABLE i_car_curr INTO car_curr WITH KEY charact = charact.
    IF sy-subrc = 0.
      l_valor = car_curr-value_from.
      valor = l_valor.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CURR_CLAVE" VERSION="1" LANGU="S" DESCRIPT="Recupera valor CURR" EXPOSURE="2" STATE="1" EDITORDER="18 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CURR_CLAVE" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_CURR_CLAVE" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_curr_clave.
    DATA l_p TYPE p LENGTH 16 DECIMALS 8.

    CLEAR valor.
    READ TABLE i_car_curr INTO car_curr WITH KEY charact = charact.
    IF sy-subrc = 0.
      l_p   = car_curr-value_from.
      valor = l_p.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_DATOS" VERSION="1" LANGU="S" DESCRIPT="Recupera datos de la clase" EXPOSURE="2" STATE="1" EDITORDER="2 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_DATOS" SCONAME="OBJECTKEY" VERSION="1" LANGU="S" DESCRIPT="Clave del objeto a clasificar" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_DATOS" SCONAME="UNIF" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_DATOS" SCONAME="UNVALUATED_CHARS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_DATOS" SCONAME="LANGUAGE" VERSION="1" LANGU="S" DESCRIPT="Clave de idioma" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SPRAS" PARVALUE="SY-LANGU"/>
  <source>METHOD get_datos.
    CLEAR: i_car_num, i_car_char, i_car_curr, i_return.

    me-&gt;objectkey = objectkey.

    CALL FUNCTION &apos;BAPI_OBJCL_GETDETAIL&apos;
      EXPORTING
        objectkey              = me-&gt;objectkey
        objecttable            = objecttable
        classnum               = classnum
        classtype              = classtype
*   KEYDATE                = SY-DATUM
        unvaluated_chars       = unvaluated_chars
*   LANGUAGE               = SY-LANGU
        language               = language
* IMPORTING
*   STATUS                 =
*   STANDARDCLASS          =
      TABLES
        allocvaluesnum         = i_car_num
        allocvalueschar        = i_car_char
        allocvaluescurr        = i_car_curr
        return                 = i_return.

    IF unif = &apos;X&apos;.
      i_car_unif = get_caract_simple( i_car_char = i_car_char
                                      i_car_num  = i_car_num
                                      i_car_curr = i_car_curr ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_DESC_CARACT" VERSION="1" LANGU="S" DESCRIPT="Devuelve la descripción de una característica" EXPOSURE="2" STATE="1" EDITORDER="26 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_DESC_CARACT" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_DESC_CARACT" SCONAME="ATINN" VERSION="1" LANGU="S" DESCRIPT="Característica interna" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ATINN" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_DESC_CARACT" SCONAME="SPRAS" VERSION="1" LANGU="S" DESCRIPT="Clave de idioma del entorno de texto actual" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-LANGU" PARVALUE="SY-LANGU"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_DESC_CARACT" SCONAME="DESCRIPCION" VERSION="1" LANGU="S" DESCRIPT="Denominación de la característica" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ATBEZ"/>
  <source>METHOD get_desc_caract.
    DATA l_atinn TYPE atinn.

    IF atinn IS INITIAL.
      l_atinn = get_caract_interno( caract ).
    ELSE.
      l_atinn = atinn.
    ENDIF.

    CLEAR descripcion.
    SELECT atbez
      INTO descripcion
      UP TO 1 ROWS
      FROM cabn JOIN cabnt ON  cabn~atinn = cabnt~atinn
                           AND cabn~adzhl = cabnt~adzhl
     WHERE cabn~atinn  = l_atinn
       AND cabnt~spras = spras
       ORDER BY cabn~atinn cabn~adzhl cabnt~spras.
    ENDSELECT.
    IF sy-subrc &lt;&gt; 0.
      SELECT atbez
        INTO descripcion
        UP TO 1 ROWS
        FROM cabn JOIN cabnt ON  cabn~atinn = cabnt~atinn
                             AND cabn~adzhl = cabnt~adzhl
       WHERE cabn~atinn  = l_atinn
         AND cabnt~spras = &apos;E&apos;
        ORDER BY cabn~atinn cabn~adzhl cabnt~spras.
      ENDSELECT.
      IF sy-subrc &lt;&gt; 0.
        SELECT atbez
          INTO descripcion
          UP TO 1 ROWS
          FROM cabn JOIN cabnt ON  cabn~atinn = cabnt~atinn
                               AND cabn~adzhl = cabnt~adzhl
         WHERE cabn~atinn = l_atinn
          ORDER BY cabn~atinn cabn~adzhl cabnt~spras.
        ENDSELECT.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_FECHA" VERSION="1" LANGU="S" DESCRIPT="Recupera valor de tipo fecha" EXPOSURE="2" STATE="1" EDITORDER="5 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_FECHA" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_FECHA" SCONAME="VALOR" VERSION="1" LANGU="S" DESCRIPT="Valor de coma flotante interno de" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="DATUM"/>
  <source>METHOD get_fecha.
    DATA: l_num TYPE i,
          l_str TYPE string.

    CLEAR valor.
    l_num = get_num( charact ).
    IF l_num &lt;&gt; 0.
      l_str = l_num.
      valor = l_str.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_FECHA_CAMBIO_VALOR" VERSION="1" LANGU="S" DESCRIPT="Devuelve la ultima fecha en que una caract.obtuvo el valor" EXPOSURE="2" STATE="1" EDITORDER="55 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_FECHA_CAMBIO_VALOR" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;ATWRT&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_FECHA_CAMBIO_VALOR" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_FECHA_CAMBIO_VALOR" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_FECHA_CAMBIO_VALOR" SCONAME="OBJECTID" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_FECHA_CAMBIO_VALOR" SCONAME="FECHA" VERSION="1" LANGU="S" DESCRIPT="Campo de tipo DATS" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="DATS"/>
  <source>METHOD get_fecha_cambio_valor.
    &quot; TODO: parameter CAMPO is never used (ABAP cleaner)

    DATA: l_atinn    TYPE atinn,
          l_tabkey   TYPE cdpos-tabkey,
          l_objectid TYPE cdpos-objectid,
          l_cdpos    TYPE cdpos.

    l_atinn = get_caract_interno( caract ).
    CONCATENATE objectid l_atinn &apos;%&apos; INTO l_tabkey.
    CONCATENATE objectid &apos;O&apos; INTO l_objectid.

    SELECT * FROM cdpos
      INTO l_cdpos
      UP TO 1 ROWS
     WHERE objectclas    = c_objectclas
       AND objectid      = l_objectid
       AND tabname       = &apos;ABAUSP&apos;
       AND tabkey     LIKE l_tabkey
       AND value_new     = valor
      ORDER BY PRIMARY KEY.
    ENDSELECT.
    IF NOT l_cdpos IS INITIAL.
      SELECT SINGLE udate FROM cdhdr
        INTO fecha
       WHERE objectclas = c_objectclas
         AND objectid   = l_objectid
         AND changenr   = l_cdpos-changenr.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_LISTA_CARACT" VERSION="1" LANGU="S" DESCRIPT="Devuelve la lista de características" EXPOSURE="2" STATE="1" EDITORDER="14 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <source>METHOD get_lista_caract.
    CLEAR i_caracteristicas.
    SELECT *
      INTO CORRESPONDING FIELDS OF TABLE i_caracteristicas
      FROM klah INNER JOIN ksml ON klah~clint = ksml~clint
                INNER JOIN cabn ON  ksml~imerk = cabn~atinn
                                AND ksml~adzhl = cabn~adzhl
     WHERE klah~class = classnum.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_LISTA_VALORES_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Recupera tabla con valores caracteristica en memoria" EXPOSURE="2" STATE="1" EDITORDER="47 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_LISTA_VALORES_CARACT_MEM" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_LISTA_VALORES_CARACT_MEM" SCONAME="ATINN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_LISTA_VALORES_CARACT_MEM" SCONAME="LISTA" VERSION="1" LANGU="S" DESCRIPT="Valor de la característica" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_lista_valores_caract_mem.
    DATA valores TYPE wisp_t_atwrt.

    FIELD-SYMBOLS &lt;valor&gt; TYPE atwrt.

    valores = get_tabla_valores_caract_mem( caract = caract atinn = atinn ).

    LOOP AT valores ASSIGNING &lt;valor&gt;.
      IF lista IS INITIAL.
        lista = &lt;valor&gt;.
      ELSE.
        CONCATENATE lista &lt;valor&gt; INTO lista SEPARATED BY &apos;,&apos;.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_NUM" VERSION="1" LANGU="S" DESCRIPT="Recupera valor NUM" EXPOSURE="2" STATE="1" EDITORDER="4 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_NUM" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_NUM" SCONAME="VALOR" VERSION="1" LANGU="S" DESCRIPT="Valor de coma flotante interno de" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ATFLV"/>
  <source>METHOD get_num.
    CLEAR valor.
    READ TABLE i_car_num INTO car_num WITH KEY charact = charact.
    IF sy-subrc = 0.
      valor = car_num-value_from.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_OBJECT_NUMBER" VERSION="1" LANGU="S" DESCRIPT="Recupera CUOB" EXPOSURE="2" STATE="1" EDITORDER="38 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_OBJECT_NUMBER" SCONAME="CLASS_TYPE" VERSION="1" LANGU="S" DESCRIPT="Categoría de la clase" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TCLA-KLART"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_OBJECT_NUMBER" SCONAME="OBJECT_ID" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_OBJECT_NUMBER" SCONAME="TABLE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_OBJECT_NUMBER" SCONAME="OBJECT_NUMBER" VERSION="1" LANGU="S" DESCRIPT="Configuración (número de objeto interno)" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="INOB-CUOBJ"/>
  <source>METHOD get_object_number.
    DATA l_object_id TYPE kssk-objek.

    l_object_id = object_id.

    CALL FUNCTION &apos;CUOB_GET_NUMBER&apos;
      EXPORTING
        class_type             = class_type
        object_id              = l_object_id
        table                  = table
*     I_READ_DB_FIRST        = &apos; &apos;
     IMPORTING
       object_number          = object_number
     EXCEPTIONS
       lock_problem           = 1
       object_not_found       = 2.
    IF sy-subrc &lt;&gt; 0.
      MESSAGE &apos;No se ha encontrado el objeto&apos; TYPE &apos;S&apos;.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_TABLA_VALORES_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Recupera tabla con valores caracteristica en memoria" EXPOSURE="2" STATE="1" EDITORDER="45 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_TABLA_VALORES_CARACT_MEM" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_TABLA_VALORES_CARACT_MEM" SCONAME="ATINN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_TABLA_VALORES_CARACT_MEM" SCONAME="VALORES" VERSION="1" LANGU="S" DESCRIPT="Valor de la característica" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="WISP_T_ATWRT"/>
  <source>METHOD get_tabla_valores_caract_mem.
    DATA l_atinn TYPE atinn.

    FIELD-SYMBOLS &lt;caract&gt; TYPE api_vali.

    IF atinn IS INITIAL.
      l_atinn = get_caract_interno( caract ).
    ELSE.
      l_atinn = atinn.
    ENDIF.

    CLEAR valores.
    LOOP AT i_caract_mem ASSIGNING &lt;caract&gt; WHERE atinn = l_atinn.
      APPEND &lt;caract&gt;-atwrt TO valores.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALORES_CARACT" VERSION="1" LANGU="S" DESCRIPT="Devuelve los posibles valores de una característica" EXPOSURE="2" STATE="1" EDITORDER="9 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALORES_CARACT" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALORES_CARACT" SCONAME="I_CAWN" VERSION="1" LANGU="S" DESCRIPT="Característica interna" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="TT_CAWN"/>
  <source>METHOD get_valores_caract.
    DATA l_atinn TYPE atinn.

    l_atinn = get_caract_interno( caract ).

    CLEAR i_cawn.
    SELECT * FROM cawn
      INTO TABLE i_cawn
     WHERE atinn = l_atinn.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALORES_CARACT_TEXT" VERSION="1" LANGU="S" DESCRIPT="Devuelve tabla de valores con textos de una característica" EXPOSURE="2" STATE="1" EDITORDER="10 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALORES_CARACT_TEXT" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALORES_CARACT_TEXT" SCONAME="I_CAWNT" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para CAWNT" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="TT_CAWNT"/>
  <source>METHOD get_valores_caract_text.
    DATA l_atinn TYPE atinn.

    l_atinn = get_caract_interno( caract ).

    CLEAR i_cawnt.
    SELECT * FROM cawnt
      INTO TABLE i_cawnt
     WHERE spras = sy-langu
       AND atinn = l_atinn.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Recupera valor caracteristica en memoria" EXPOSURE="2" STATE="1" EDITORDER="36 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_MEM" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_MEM" SCONAME="ATINN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_MEM" SCONAME="VALOR" VERSION="1" LANGU="S" DESCRIPT="Valor de la característica" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ATWRT"/>
  <source>METHOD get_valor_caract_mem.
    DATA l_atinn TYPE atinn.

    FIELD-SYMBOLS &lt;caract&gt; TYPE api_vali.

    IF atinn IS INITIAL.
      l_atinn = get_caract_interno( caract ).
    ELSE.
      l_atinn = atinn.
    ENDIF.

    CLEAR valor.
    ASSIGN i_caract_mem[ atinn = l_atinn ] TO &lt;caract&gt;.
    IF sy-subrc = 0.
      valor = &lt;caract&gt;-atwrt.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_MEM_P" VERSION="1" LANGU="S" DESCRIPT="Recupera valor caracteristica en memoria (NUMERO)" EXPOSURE="2" STATE="1" EDITORDER="43 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_MEM_P" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_MEM_P" SCONAME="ATINN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_MEM_P" SCONAME="VALOR" VERSION="1" LANGU="S" DESCRIPT="Valor de la característica" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ATFLV"/>
  <source>METHOD get_valor_caract_mem_p.
    DATA l_atinn TYPE atinn.

    FIELD-SYMBOLS &lt;caract&gt; TYPE api_vali.

    IF atinn IS INITIAL.
      l_atinn = get_caract_interno( caract ).
    ELSE.
      l_atinn = atinn.
    ENDIF.

    CLEAR valor.
    ASSIGN i_caract_mem[ atinn = l_atinn ] TO &lt;caract&gt;.
    IF sy-subrc = 0.
      valor = &lt;caract&gt;-atflv.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT" VERSION="1" LANGU="S" DESCRIPT="Devuelve valor con texto de una característica" EXPOSURE="2" STATE="1" EDITORDER="17 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT" SCONAME="CARACT_INT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT" SCONAME="SPRAS" VERSION="1" LANGU="S" DESCRIPT="Clave de idioma del entorno de texto actual" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-LANGU" PARVALUE="SY-LANGU"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT" SCONAME="SOLO_IDIOMA_INDICADO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT" SCONAME="DESCRIPCION" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para CAWNT" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ATWTB"/>
  <source>METHOD get_valor_caract_text.
    DATA l_atinn TYPE atinn.

    IF caract_int IS INITIAL.
      l_atinn = get_caract_interno( caract ).
    ELSE.
      l_atinn = caract_int.
    ENDIF.

    CLEAR descripcion.
    SELECT atwtb INTO descripcion
      UP TO 1 ROWS
      FROM cawnt JOIN cawn ON  cawn~atinn = cawnt~atinn
                           AND cawn~atzhl = cawnt~atzhl
                           AND cawn~adzhl = cawnt~adzhl
     WHERE cawn~atinn  = l_atinn
       AND cawn~atwrt  = valor
       AND cawnt~spras = spras
        ORDER BY cawnt~atinn cawnt~atzhl cawnt~adzhl cawnt~spras.
    ENDSELECT.
    IF sy-subrc = 0.
      RETURN.
    ENDIF.

    IF solo_idioma_indicado IS INITIAL.
      SELECT atwtb INTO descripcion
        UP TO 1 ROWS
            FROM cawnt JOIN cawn ON  cawn~atinn = cawnt~atinn
                                 AND cawn~atzhl = cawnt~atzhl
                                 AND cawn~adzhl = cawnt~adzhl
           WHERE cawn~atinn  = l_atinn
             AND cawn~atwrt  = valor
             AND cawnt~spras = &apos;E&apos;
          ORDER BY cawnt~atinn cawnt~atzhl cawnt~adzhl cawnt~spras.
      ENDSELECT.
      IF sy-subrc &lt;&gt; 0.
        SELECT atwtb INTO descripcion
          UP TO 1 ROWS
                FROM cawnt JOIN cawn ON  cawn~atinn = cawnt~atinn
                                     AND cawn~atzhl = cawnt~atzhl
                                     AND cawn~adzhl = cawnt~adzhl
               WHERE cawn~atinn = l_atinn
                 AND cawn~atwrt = valor
            ORDER BY cawnt~atinn cawnt~atzhl cawnt~adzhl cawnt~spras.
        ENDSELECT.
        IF sy-subrc &lt;&gt; 0.
          descripcion = valor.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT2KEY" VERSION="1" LANGU="S" DESCRIPT="Devuelve valor con texto de una característica" EXPOSURE="2" STATE="1" EDITORDER="24 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT2KEY" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT2KEY" SCONAME="CARACT_INT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT2KEY" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CARACT_TEXT2KEY" SCONAME="DESCRIPCION" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para CAWNT" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ATWRT"/>
  <source>METHOD get_valor_caract_text2key.
    DATA l_atinn TYPE atinn.

    IF caract_int IS INITIAL.
      l_atinn = get_caract_interno( caract ).
    ELSE.
      l_atinn = caract_int.
    ENDIF.

    CLEAR descripcion.
    SELECT atwrt
      INTO descripcion
      UP TO 1 ROWS
      FROM cawnt JOIN cawn ON  cawn~atinn = cawnt~atinn
                           AND cawn~atzhl = cawnt~atzhl
                           AND cawn~adzhl = cawnt~adzhl
     WHERE cawn~atinn  = l_atinn
       AND cawnt~atwtb = valor
       AND cawnt~spras = sy-langu
              ORDER BY cawnt~atinn cawnt~atzhl cawnt~adzhl cawnt~spras.
    ENDSELECT.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_MULTIPLE" VERSION="1" LANGU="S" DESCRIPT="Recupera una tabla con valores de una característica" EXPOSURE="2" STATE="1" EDITORDER="53 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_MULTIPLE" SCONAME="CLASSNUM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_MULTIPLE" SCONAME="CLASSTYPE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_MULTIPLE" SCONAME="OBJECTKEY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_MULTIPLE" SCONAME="TIPO" VERSION="1" LANGU="S" DESCRIPT="Char/Num/Fecha" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;C&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_MULTIPLE" SCONAME="CARACTERISTICA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_MULTIPLE" SCONAME="TABLA" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para BAPI1003_ALLOC_VALUES_CHAR" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="TT_BAPI1003_ALLOC_VALUES_CHAR"/>
  <source>METHOD get_valor_clase_multiple.
    DATA o_cl TYPE REF TO zcl_ap_clasificacion.

    o_cl = NEW #(
        classnum  = classnum
        classtype = classtype ).

    o_cl-&gt;get_datos( objectkey = objectkey ).

    CASE tipo.
      WHEN &apos;C&apos;.
        tabla = o_cl-&gt;get_char_tabla( caracteristica ).
    ENDCASE.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_SIMPLE" VERSION="1" LANGU="S" DESCRIPT="Recupera el valor de clase simple" EXPOSURE="2" STATE="1" EDITORDER="54 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_SIMPLE" SCONAME="CLASSNUM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_SIMPLE" SCONAME="CLASSTYPE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_SIMPLE" SCONAME="OBJECTKEY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_SIMPLE" SCONAME="TIPO" VERSION="1" LANGU="S" DESCRIPT="Char/Num/Fecha" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;C&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_SIMPLE" SCONAME="CARACTERISTICA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_SIMPLE" SCONAME="GET_CLAVE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="GET_VALOR_CLASE_SIMPLE" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="0" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD get_valor_clase_simple.
    DATA o_cl TYPE REF TO zcl_ap_clasificacion.

    o_cl = NEW #(
        classnum  = classnum
        classtype = classtype ).

    o_cl-&gt;get_datos( objectkey = objectkey ).

    CASE tipo.
      WHEN &apos;C&apos;.
        valor = o_cl-&gt;get_char( charact = caracteristica get_clave = get_clave ).
      WHEN &apos;P&apos;.
        valor = o_cl-&gt;get_num( charact = caracteristica ).
      WHEN &apos;F&apos;.
        valor = o_cl-&gt;get_fecha( caracteristica ).
    ENDCASE.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="MATCHCODE_CARACT" VERSION="1" LANGU="S" DESCRIPT="Matchcode caracteríticas" EXPOSURE="2" STATE="1" EDITORDER="29 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="MATCHCODE_CARACT" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="MATCHCODE_CARACT" SCONAME="VALOR" VERSION="1" LANGU="S" DESCRIPT="Valor de la característica" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ATWRT"/>
  <source>METHOD matchcode_caract.
    DATA: i_cawn  TYPE TABLE OF cawn,
          o_mc    TYPE REF TO zcl_ap_matchcode_z,
          l_cawn  TYPE cawn,
          l_cawnt TYPE cawnt.

    i_cawn = get_valores_caract( caract ).
    IF i_cawn IS INITIAL.
      RETURN.
    ENDIF.

    o_mc = NEW #(
        tabname = &apos;CAWN&apos; ).

    o_mc-&gt;add_field( field = &apos;ATWRT&apos; selectflag = &apos;X&apos; ).
    o_mc-&gt;add_field( tabname = &apos;CAWNT&apos; field = &apos;ATWTB&apos; ).

    LOOP AT i_cawn INTO l_cawn.
      o_mc-&gt;add_valor( l_cawn-atwrt ).

      CLEAR l_cawnt.
      SELECT SINGLE atwtb FROM  cawnt
        INTO l_cawnt-atwtb
       WHERE atinn = l_cawn-atinn
         AND atzhl = l_cawn-atzhl
         AND spras = sy-langu
         AND adzhl = l_cawn-adzhl.
      IF sy-subrc &lt;&gt; 0.
        SELECT atwtb FROM  cawnt
          INTO l_cawnt-atwtb
          UP TO 1 ROWS
         WHERE atinn = l_cawn-atinn
           AND atzhl = l_cawn-atzhl
           AND adzhl = l_cawn-adzhl
         ORDER BY PRIMARY KEY.
        ENDSELECT.
      ENDIF.
      o_mc-&gt;add_valor( l_cawnt-atwtb ).
    ENDLOOP.

    o_mc-&gt;matchcode( CHANGING valor = valor ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="NOMBRE2NUM" VERSION="1" LANGU="S" DESCRIPT="Traduce nombre característica a numero interno" EXPOSURE="2" STATE="1" EDITORDER="12 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="NOMBRE2NUM" SCONAME="NOMBRE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="NOMBRE2NUM" SCONAME="NUMERO" VERSION="1" LANGU="S" DESCRIPT="Característica interna" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ATINN"/>
  <source>METHOD nombre2num.
    CALL FUNCTION &apos;CONVERSION_EXIT_ATINN_INPUT&apos;
      EXPORTING
        input         = nombre
      IMPORTING
        output        = numero.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_BY_KEY" VERSION="1" LANGU="S" DESCRIPT="Fija clave objetor por clave" EXPOSURE="2" STATE="1" EDITORDER="16 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_BY_KEY" SCONAME="OBJECTKEY" VERSION="1" LANGU="S" DESCRIPT="Configuración (número de objeto interno)" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI1003_KEY-OBJECT_GUID"/>
  <source>METHOD set_by_key.
    CALL FUNCTION &apos;BAPI_OBJCL_GET_OBJECT_OF_KEY&apos;
      EXPORTING
        clobjectkeyin = objectkey
      IMPORTING
        objectname    = objectname
        objecttable   = objecttable
        classtype     = classtype
      TABLES
        return        = i_return.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Cambia caracteristicas en memoria" EXPOSURE="2" STATE="1" EDITORDER="34 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CARACT_MEM" SCONAME="FORZAR_CAMBIO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CARACT_MEM" SCONAME="SUBRC" VERSION="1" LANGU="S" DESCRIPT="Código retorno de sentencias ABAP" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="SY-SUBRC"/>
  <source>METHOD set_caract_mem.
    IF hay_caract_mem = &apos;X&apos;.
      subrc = set_caract_mem_st( i_caract_mem  = i_caract_mem forzar_cambio = forzar_cambio ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CARACT_MEM_ST" VERSION="1" LANGU="S" DESCRIPT="Cambia caracteristicas en memoria" EXPOSURE="2" STATE="1" EDITORDER="33 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CARACT_MEM_ST" SCONAME="I_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Tipo de tabla para API_VALI" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_API_VALI"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CARACT_MEM_ST" SCONAME="FORZAR_CAMBIO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CARACT_MEM_ST" SCONAME="SUBRC" VERSION="1" LANGU="S" DESCRIPT="Subrutina código return" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="SUBRC"/>
  <source>METHOD set_caract_mem_st.
    DATA t_sel TYPE STANDARD TABLE OF comw.
    DATA: l_caract_mem TYPE api_vali,
          l_cabn       TYPE cabn,
          l_value      TYPE api_val_i,
          l_num        TYPE i,
          i_values     TYPE TABLE OF api_val_i.

    FIELD-SYMBOLS &lt;fs&gt; TYPE any.

    CALL FUNCTION &apos;CTMS_DDB_CLOSE&apos;
      TABLES
        exp_selection  = t_sel
      EXCEPTIONS
        inconsistency  = 1
        incomplete     = 2
        verification   = 3
        not_assigned   = 4
        another_object = 5
        other_objects  = 6
        display_mode   = 7
        OTHERS         = 8.
    IF sy-subrc &lt;&gt; 0.
*      message &apos;Error seleccioanndo datos de memoria&apos; type &apos;S&apos;.
    ENDIF.

    LOOP AT i_caract_mem INTO l_caract_mem.
      ASSIGN t_sel[ atinn = l_caract_mem-atinn ] TO FIELD-SYMBOL(&lt;sel&gt;).
      IF sy-subrc = 0.
        IF NOT &lt;sel&gt;-ataut IS INITIAL.
          CONTINUE.
        ENDIF.
      ENDIF.

      SELECT atfor FROM cabn
        INTO l_cabn-atfor
        UP TO 1 ROWS
       WHERE atinn = l_caract_mem-atinn
      ORDER BY PRIMARY KEY.
      ENDSELECT.
      IF sy-subrc = 0.
        MOVE-CORRESPONDING l_caract_mem TO l_value.
        IF l_cabn-atfor = &apos;NUM&apos;.
          l_num = l_caract_mem-atflv.
          l_value-atwtb = l_num.
          CONDENSE l_value-atwtb NO-GAPS.
        ELSE.
          l_value-atwtb = l_caract_mem-atwrt.
        ENDIF.
        APPEND l_value TO i_values.
      ENDIF.
    ENDLOOP.

    IF forzar_cambio = &apos;X&apos;.
      ASSIGN (&apos;(SAPLCTMS)F_MODE&apos;) TO &lt;fs&gt;.
      IF sy-subrc = 0.
        IF &lt;fs&gt; IS INITIAL.
          &lt;fs&gt; = &apos;S&apos;.
        ENDIF.
      ENDIF.
    ENDIF.

    CALL FUNCTION &apos;CTMS_DDB_SET_VALUE&apos;
* EXPORTING
*   INSTANCE                            =
*   MESSAGE                             = &apos; &apos;
*   UDEF_INSTANCE                       =
      TABLES
        imp_values                    = i_values
*     EXP_VALUES_ERROR              =
      EXCEPTIONS
        currency_check                = 1
        date_check                    = 2
        format_check                  = 3
        illegal_internal_baseunit     = 4
        interval_check                = 5
        pattern_check                 = 6
        time_check                    = 7
        unit_check                    = 8
        value_not_found               = 9
        no_valid_dimension            = 10
        interval_not_allowed          = 11
        display_mode                  = 12
        characteristic_not_found      = 13
        value_not_possible            = 14
        characteristic_enqueue        = 15
        objectcharacteristic          = 16
        only_one_value_allowed        = 17
        characteristic_not_selectable = 18
        input_to_long                 = 19
        value_contradiction           = 20
        OTHERS                        = 21.
    subrc = sy-subrc.

*  CALL FUNCTION &apos;CTMS_DDB_SET_VALUE_INTERNAL&apos;
*    TABLES
*      imp_values                          = i_caract_mem
**     EXP_VALUES_ERROR                    =
*   EXCEPTIONS
*     currency_check                      = 1
*     date_check                          = 2
*     format_check                        = 3
*     illegal_internal_baseunit           = 4
*     interval_check                      = 5
*     pattern_check                       = 6
*     time_check                          = 7
*     unit_check                          = 8
*     value_not_found                     = 9
*     no_valid_dimension                  = 10
*     interval_not_allowed                = 11
*     display_mode                        = 12
*     characteristic_not_found            = 13
*     value_not_possible                  = 14
*     characteristic_enqueue              = 15
*     objectcharacteristic                = 16
*     only_one_value_allowed              = 17
*     characteristic_not_selectable       = 18
*     input_to_long                       = 19
*     value_contradiction                 = 20
*     OTHERS                              = 21.
*
*  subrc = sy-subrc.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CHAR" VERSION="1" LANGU="S" DESCRIPT="Cambia valor CHAR" EXPOSURE="2" STATE="1" EDITORDER="19 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CHAR" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CHAR" SCONAME="VALUE_CHAR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CHAR" SCONAME="VALUE_NEUTRAL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CHAR" SCONAME="CHARACT_DESCR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CHAR" SCONAME="ADD_NEW" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CHAR" SCONAME="DELETE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <source>METHOD set_char.
    &quot; TODO: parameter CHARACT_DESCR is only used in commented-out code (ABAP cleaner)

    IF delete = &apos;X&apos;.
      IF NOT value_char IS INITIAL.
        DELETE i_car_char WHERE     charact    = charact
                                AND value_char = value_char.
      ELSE.
        DELETE i_car_char WHERE     charact       = charact
                                AND value_neutral = value_char.
      ENDIF.
    ELSE.
      READ TABLE i_car_char INTO car_char WITH KEY charact = charact.
      IF sy-subrc = 0 AND add_new = &apos;&apos;.
        car_char-value_char = value_char.
        IF value_neutral IS SUPPLIED.
          car_char-value_neutral = value_neutral.
        ELSE.
          car_char-value_neutral = value_char.
        ENDIF.
        MODIFY i_car_char FROM car_char INDEX sy-tabix.
      ELSE.
        CLEAR car_char.
        car_char-charact    = charact.
*    IF charact_descr IS INITIAL.
*      car_char-charact_descr  = charact.
*    ELSE.
*      car_char-charact_descr  = charact_descr.
*    ENDIF.
        car_char-value_char = value_char.
        IF value_neutral IS SUPPLIED.
          car_char-value_neutral = value_neutral.
        ELSE.
          car_char-value_neutral = value_char.
        ENDIF.
        APPEND car_char TO i_car_char.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CURR" VERSION="1" LANGU="S" DESCRIPT="Cambia valor CURR" EXPOSURE="2" STATE="1" EDITORDER="21 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CURR" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CURR" SCONAME="VALUE_FROM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_CURR" SCONAME="CHARACT_DESCR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <source>METHOD set_curr.
    READ TABLE i_car_curr INTO car_curr WITH KEY charact = charact.
    IF sy-subrc = 0.
      car_curr-value_from = value_from.
      MODIFY i_car_curr FROM car_curr INDEX sy-tabix.
    ELSE.
      CLEAR car_curr.
      car_curr-charact = charact.
      IF charact_descr IS INITIAL.
        car_curr-charact_descr = charact.
      ELSE.
        car_curr-charact_descr = charact_descr.
      ENDIF.
      car_curr-value_from = value_from.
      APPEND car_curr TO i_car_curr.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_DATOS" VERSION="1" LANGU="S" DESCRIPT="Modifica datos de la clase" EXPOSURE="2" STATE="1" EDITORDER="15 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_DATOS" SCONAME="OBJECTKEY" VERSION="1" LANGU="S" DESCRIPT="Clave del objeto a clasificar" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_DATOS" SCONAME="COMMIT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_DATOS" SCONAME="DEQUEUE_ALL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <source>METHOD set_datos.
    DATA l_objectkey TYPE bapi1003_key-object.

    IF objectkey IS INITIAL.
      l_objectkey = me-&gt;objectkey.
    ELSE.
      l_objectkey = objectkey.
    ENDIF.

    SET UPDATE TASK LOCAL.
    CALL FUNCTION &apos;BAPI_OBJCL_CHANGE&apos;
      EXPORTING
        objectkey              = l_objectkey
        objecttable            = objecttable
        classnum               = classnum
        classtype              = classtype
*   KEYDATE                = SY-DATUM
*   UNVALUATED_CHARS       = &apos; &apos;
*   LANGUAGE               = SY-LANGU
* IMPORTING
*   STATUS                 =
*   STANDARDCLASS          =
      TABLES
        allocvaluesnumnew         = i_car_num
        allocvaluescharnew        = i_car_char
        allocvaluescurrnew        = i_car_curr
        return                 = i_return.

    IF commit = &apos;X&apos;.
      CALL FUNCTION &apos;BAPI_TRANSACTION_COMMIT&apos;
        EXPORTING
          wait = &apos;X&apos;.

      IF dequeue_all = &apos;X&apos;.
        CALL FUNCTION &apos;DEQUEUE_ALL&apos;.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_FECHA" VERSION="1" LANGU="S" DESCRIPT="Cambia valor NUM (tipo FECHA)" EXPOSURE="2" STATE="1" EDITORDER="49 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_FECHA" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_FECHA" SCONAME="FECHA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_FECHA" SCONAME="CHARACT_DESCR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <source>METHOD set_fecha.
    DATA: l_fechac TYPE c LENGTH 8,
          l_atflv  TYPE atflv.

    l_fechac = fecha.
    l_atflv = l_fechac.
    set_num( charact = charact value_from = l_atflv charact_descr = charact_descr ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_NUM" VERSION="1" LANGU="S" DESCRIPT="Cambia valor NUM" EXPOSURE="2" STATE="1" EDITORDER="20 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_NUM" SCONAME="CHARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_NUM" SCONAME="VALUE_FROM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_NUM" SCONAME="CHARACT_DESCR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_NUM" SCONAME="VALUE_TO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <source>METHOD set_num.
    READ TABLE i_car_num INTO car_num WITH KEY charact = charact.
    IF sy-subrc = 0.
      car_num-value_from = value_from.
      car_num-value_to   = value_to.
      MODIFY i_car_num FROM car_num INDEX sy-tabix.
    ELSE.
      CLEAR car_num.
      car_num-charact = charact.
      IF charact_descr IS INITIAL.
        car_num-charact_descr = charact.
      ELSE.
        car_num-charact_descr = charact_descr.
      ENDIF.
      car_num-value_from = value_from.
      car_num-value_to   = value_to.
      APPEND car_num TO i_car_num.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM" VERSION="1" LANGU="S" DESCRIPT="Cambia valor caracteristica char en memoria" EXPOSURE="2" STATE="1" EDITORDER="35 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM" SCONAME="ATINN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM" SCONAME="MULTIPLE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD set_valor_caract_mem.
    DATA l_atinn TYPE atinn.

    FIELD-SYMBOLS &lt;caract&gt; TYPE api_vali.

    IF atinn IS INITIAL.
      l_atinn = get_caract_interno( caract ).
    ELSE.
      l_atinn = atinn.
    ENDIF.

    IF multiple IS INITIAL.
      ASSIGN i_caract_mem[ atinn = l_atinn ] TO &lt;caract&gt;.
      IF sy-subrc = 0.
        &lt;caract&gt;-atwrt = valor.
      ELSE.
        CLEAR caract_mem.
        caract_mem-atinn = l_atinn.
        caract_mem-atwrt = valor.
        APPEND caract_mem TO i_caract_mem.
      ENDIF.
    ELSE.
      ASSIGN i_caract_mem[ atinn = l_atinn
                           atwrt = valor ] TO &lt;caract&gt;.
      IF sy-subrc = 0.
        &lt;caract&gt;-atwrt = valor.
      ELSE.
        CLEAR caract_mem.
        caract_mem-atinn = l_atinn.
        caract_mem-atwrt = valor.
        APPEND caract_mem TO i_caract_mem.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM_DATE" VERSION="1" LANGU="S" DESCRIPT="Cambia valor caracteristica fecha en memoria" EXPOSURE="2" STATE="1" EDITORDER="37 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM_DATE" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM_DATE" SCONAME="ATINN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM_DATE" SCONAME="VALOR" VERSION="1" LANGU="S" DESCRIPT="Campo de tipo DATS" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="DATS"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM_DATE" SCONAME="FORZAR_CAMBIO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD set_valor_caract_mem_date.
    DATA: l_atinn TYPE atinn,
          l_atnam TYPE atnam,
          l_fecha TYPE d,
          l_atwrt TYPE atwrt.

    FIELD-SYMBOLS &lt;caract&gt; TYPE api_vali.
    FIELD-SYMBOLS: &lt;fs&gt;    TYPE table,
                   &lt;line&gt;  TYPE any,
                   &lt;atinn&gt; TYPE any,
                   &lt;atglo&gt; TYPE any.

    IF atinn IS INITIAL.
      l_atinn = get_caract_interno( caract ).
      l_atnam = caract.
    ELSE.
      l_atinn = atinn.
      l_atnam = get_caract_externo( l_atinn ).
    ENDIF.

    WRITE valor TO l_fecha.
    l_atwrt = valor.
    ASSIGN i_caract_mem[ atinn = l_atinn ] TO &lt;caract&gt;.
    IF sy-subrc = 0.
      &lt;caract&gt;-atwrt = l_fecha.
      &lt;caract&gt;-atwtb = l_fecha.
      CALL FUNCTION &apos;CTCV_CONVERT_DATE_TO_FLOAT&apos;
        EXPORTING
          date  = l_atwrt
        IMPORTING
          float = &lt;caract&gt;-atflv.
    ELSE.
      CLEAR caract_mem.
      caract_mem-atinn = l_atinn.
      caract_mem-atnam = l_atnam.
      caract_mem-atwrt = l_fecha.
      caract_mem-atwtb = l_fecha.
      CALL FUNCTION &apos;CTCV_CONVERT_DATE_TO_FLOAT&apos;
        EXPORTING
          date  = l_atwrt
        IMPORTING
          float = caract_mem-atflv.
      APPEND caract_mem TO i_caract_mem.
    ENDIF.

    IF forzar_cambio = &apos;X&apos;.
      DATA l_data TYPE REF TO data.

      ASSIGN (&apos;(SAPLCTMS)MI[]&apos;) TO &lt;fs&gt;. &quot;#EC *
      IF sy-subrc = 0.
        IF NOT &lt;fs&gt; IS INITIAL.
          LOOP AT &lt;fs&gt; ASSIGNING &lt;line&gt;.
            ASSIGN COMPONENT &apos;ATINN&apos; OF STRUCTURE &lt;line&gt; TO &lt;atinn&gt;.
            IF sy-subrc = 0.
              IF &lt;atinn&gt; = l_atinn.
                ASSIGN COMPONENT &apos;ATGLO&apos; OF STRUCTURE &lt;line&gt; TO &lt;atglo&gt;.
                IF sy-subrc = 0.
                  &lt;atglo&gt; = &apos;X&apos;.
                ENDIF.
              ENDIF.
            ENDIF.
          ENDLOOP.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM_NUM" VERSION="1" LANGU="S" DESCRIPT="Cambia valor caracteristica numérica en memoria" EXPOSURE="2" STATE="1" EDITORDER="41 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM_NUM" SCONAME="CARACT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM_NUM" SCONAME="ATINN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CARACT_MEM_NUM" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD set_valor_caract_mem_num.
    DATA l_atinn TYPE atinn.

    FIELD-SYMBOLS &lt;caract&gt; TYPE api_vali.

    IF atinn IS INITIAL.
      l_atinn = get_caract_interno( caract ).
    ELSE.
      l_atinn = atinn.
    ENDIF.

    ASSIGN i_caract_mem[ atinn = l_atinn ] TO &lt;caract&gt;.
    IF sy-subrc = 0.
      &lt;caract&gt;-atflv = valor.
    ELSE.
      CLEAR caract_mem.
      caract_mem-atinn = l_atinn.
      caract_mem-atflv = valor.
      APPEND caract_mem TO i_caract_mem.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" VERSION="1" LANGU="S" DESCRIPT="Fija el valor de clase simple" EXPOSURE="2" STATE="1" EDITORDER="52 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" SCONAME="CLASSNUM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" SCONAME="CLASSTYPE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" SCONAME="OBJECTKEY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" SCONAME="TIPO" VERSION="1" LANGU="S" DESCRIPT="Char/Num/Fecha" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;C&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" SCONAME="CARACTERISTICA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" SCONAME="VALOR_HASTA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" SCONAME="COMMIT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="SET_VALOR_CLASE_SIMPLE" SCONAME="MENSAJE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD set_valor_clase_simple.
    DATA: o_cl          TYPE REF TO zcl_ap_clasificacion,
          l_valor_char  TYPE atwrt,
          l_cambio      TYPE c LENGTH 1,
          l_valor_fecha TYPE atwrt.

    o_cl = NEW #(
        classnum    = classnum
        classtype   = classtype
        objecttable = tabla ).

    o_cl-&gt;get_datos( objectkey = objectkey ).

    CASE tipo.
      WHEN &apos;C&apos;.
        l_valor_char = o_cl-&gt;get_char( caracteristica ).
        IF l_valor_char &lt;&gt; valor.
          l_cambio = &apos;X&apos;.
          o_cl-&gt;set_char( charact = caracteristica value_char = valor ).
        ENDIF.

      WHEN &apos;N&apos;.
        l_valor_char = o_cl-&gt;get_char( caracteristica ).
        IF l_valor_char &lt;&gt; valor.
          l_cambio = &apos;X&apos;.
          o_cl-&gt;set_num( charact = caracteristica value_from = valor value_to = valor_hasta ).
        ENDIF.

      WHEN &apos;F&apos;.
        l_valor_fecha = o_cl-&gt;get_fecha( caracteristica ).
        IF l_valor_fecha &lt;&gt; valor.
          l_cambio = &apos;X&apos;.
          o_cl-&gt;set_fecha( charact = caracteristica fecha = valor ).
        ENDIF.
    ENDCASE.
    IF l_cambio = &apos;X&apos;.
      o_cl-&gt;set_datos( objectkey = objectkey commit = commit ).

      READ TABLE o_cl-&gt;i_return INTO o_cl-&gt;return WITH KEY type = &apos;E&apos;.
      IF sy-subrc = 0.
        mensaje = o_cl-&gt;return-message.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="TIENE_CLASIFICACION" VERSION="1" LANGU="S" DESCRIPT="Verifica si el objeto está clasificado" EXPOSURE="2" STATE="1" EDITORDER="51 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="TIENE_CLASIFICACION" SCONAME="CLASSNUM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="TIENE_CLASIFICACION" SCONAME="CLASSTYPE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="TIENE_CLASIFICACION" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="TIENE_CLASIFICACION" SCONAME="OBJECTKEY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_CLASIFICACION" CMPNAME="TIENE_CLASIFICACION" SCONAME="SI" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ABAP_BOOL"/>
  <source>METHOD tiene_clasificacion.
    DATA: l_klah  TYPE klah,
          l_objek TYPE objnum,
          l_inob  TYPE inob,
          l_kssk  TYPE kssk.

    SELECT clint FROM klah
      INTO l_klah-clint
      UP TO 1 ROWS
     WHERE klart = classtype
       AND class = classnum
     ORDER BY PRIMARY KEY.
    ENDSELECT.

    IF tabla IS INITIAL.
      l_objek = objectkey.
    ELSE.
      SELECT cuobj FROM inob
        INTO l_inob-cuobj
        UP TO 1 ROWS
       WHERE klart = classtype
         AND obtab = tabla
         AND objek = objectkey
       ORDER BY PRIMARY KEY.
      ENDSELECT.
      IF sy-subrc &lt;&gt; 0.
        l_objek = objectkey.
      ELSE.
        l_objek = l_inob-cuobj.
      ENDIF.
    ENDIF.

    IF classnum IS INITIAL.
      SELECT SINGLE objek FROM  kssk
        INTO l_kssk-objek
       WHERE objek = objectkey
         AND mafid = &apos;O&apos;
         AND klart = classtype.
    ELSE.
      SELECT objek FROM  kssk
        INTO l_kssk-objek
        UP TO 1 ROWS
       WHERE objek = l_objek
         AND mafid = &apos;O&apos;
         AND klart = classtype
         AND clint = l_klah-clint
       ORDER BY PRIMARY KEY.
      ENDSELECT.
    ENDIF.

    IF NOT l_kssk IS INITIAL.
      si = &apos;X&apos;.
    ENDIF.
  ENDMETHOD.</source>
 </method>
</CLAS>
