<?xml version="1.0" encoding="utf-8"?>
<CLAS CLSNAME="ZCL_AP_REGISTRO_INFO" VERSION="1" LANGU="S" DESCRIPT="Registro info" CATEGORY="00" EXPOSURE="2" STATE="1" RELEASE="0" CLSFINAL="X" CLSCCINCL="X" FIXPT="X" UNICODE="X" CLSBCCAT="00" DURATION_TYPE="0 " RISK_LEVEL="0 ">
 <types CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="TT_ESCALAS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="1 " TYPTYPE="4" SRCROW1="6 " SRCCOLUMN1="10 " SRCROW2="6 " SRCCOLUMN2="74 " TYPESRC_LENG="67 " TYPESRC="tt_escalas TYPE STANDARD TABLE OF ekomd WITH NON-UNIQUE KEY klfn1
"/>
 <localImplementation>*&quot;* use this source file for the definition and implementation of
*&quot;* local helper classes, interface definitions and type
*&quot;* declarations</localImplementation>
 <localTypes>*&quot;* use this source file for any type of declarations (class
*&quot;* definitions, interfaces or type declarations) you need for
*&quot;* components in the private section</localTypes>
 <localMacros>*&quot;* use this source file for any macro definitions you need
*&quot;* in the implementation part of the class</localMacros>
 <attribute CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="A017" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="8 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="A017" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="C_TCODE_CREAR" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="1 " ATTDECLTYP="2" ATTVALUE="&apos;ME11&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SY-TCODE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="C_TCODE_MODIFICAR" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="2 " ATTDECLTYP="2" ATTVALUE="&apos;ME12&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SY-TCODE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="EINA" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="6 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="EINA" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="EINE" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="7 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="EINE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="LIGHTS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="5 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SY-MSGTY" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MENSAJE" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="4 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BAPIRETURN1-MESSAGE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MSGTY" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="3 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SY-MSGTY" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <method CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="CREAR" VERSION="1" LANGU="S" DESCRIPT="Crear registro info" EXPOSURE="2" STATE="1" EDITORDER="1 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="CREAR" SCONAME="P_EINA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINA"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="CREAR" SCONAME="P_EINE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="CREAR" SCONAME="MODO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BDC_MODE" PARVALUE="&apos;N&apos;"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="CREAR" SCONAME="I_ESCALAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_ESCALAS" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="CREAR" SCONAME="INFNR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="EINA-INFNR"/>
  <source>METHOD crear.
    DATA o_bi  TYPE REF TO zcl_ap_batch_input.
    DATA l_ind TYPE numc2.

    o_bi = NEW #( ).

* Pantalla de llamada info de compras
    o_bi-&gt;dynpro( program = &apos;SAPMM06I&apos; dynpro = &apos;0100&apos; ).
    o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;/00&apos; ).
    o_bi-&gt;campos( campo = &apos;EINA-LIFNR&apos;
                  valor = p_eina-lifnr ). &quot; Número de cuenta del proveedor
    o_bi-&gt;campos( campo = &apos;EINA-MATNR&apos;
                  valor = p_eina-matnr ). &quot; Número de material
    o_bi-&gt;campos( campo = &apos;EINE-EKORG&apos;
                  valor = p_eine-ekorg ). &quot; Organización de compras
    o_bi-&gt;campos( campo = &apos;EINE-WERKS&apos;
                   valor = p_eine-werks ). &quot; Centro
    o_bi-&gt;campos( campo = &apos;EINA-INFNR&apos; valor = &apos;&apos; ).
    CASE p_eine-esokz.
      WHEN &apos;0&apos; OR &apos;&apos;.  &quot; Normal
        o_bi-&gt;campos( campo = &apos;RM06I-NORMB&apos;
                      valor = &apos;X&apos; ). &quot; Indicador: registro info normal
      WHEN &apos;1&apos;.        &quot; Contabilidad
        MESSAGE &apos;Error tipo contabilidad&apos; TYPE &apos;A&apos;.
      WHEN &apos;2&apos;.        &quot; Consignación
        o_bi-&gt;campos( campo = &apos;RM06I-KONSI&apos;
                      valor = &apos;X&apos; ).
      WHEN &apos;3&apos;.        &quot; Subcontratación
        o_bi-&gt;campos( campo = &apos;RM06I-LOHNB&apos;
                      valor = &apos;X&apos; ).
      WHEN &apos;P&apos;.        &quot; Pipeline
        o_bi-&gt;campos( campo = &apos;RM06I-PIPEL&apos;
                      valor = &apos;X&apos; ).
      WHEN OTHERS.        &quot; Otrod
        MESSAGE &apos;Error tipo&apos; TYPE &apos;A&apos;.
    ENDCASE.

* Datos generales del info de compras
    o_bi-&gt;dynpro( program = &apos;SAPMM06I&apos; dynpro = &apos;0101&apos; ).
    IF p_eine IS INITIAL.
      o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=BU&apos; ).
    ELSE.
      o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=EINE&apos; ).
    ENDIF.

    IF NOT p_eina-meins IS INITIAL.
      o_bi-&gt;campos( campo = &apos;EINA-MEINS&apos; valor = p_eina-meins ).
    ENDIF.
    IF NOT p_eina-idnlf IS INITIAL.
      o_bi-&gt;campos( campo = &apos;EINA-IDNLF&apos; valor = p_eina-idnlf ).
    ENDIF.
    IF NOT p_eina-umrez IS INITIAL OR NOT p_eina-umrez IS INITIAL.
      o_bi-&gt;campos( campo = &apos;EINA-UMREZ&apos; valor = p_eina-umrez ).
      o_bi-&gt;campos( campo = &apos;EINA-UMREN&apos; valor = p_eina-umren ).
    ENDIF.

    IF NOT p_eine IS INITIAL.

* Datos de organización de compras del info-compras parte 1
      o_bi-&gt;dynpro( program = &apos;SAPMM06I&apos; dynpro = &apos;0102&apos; ).
      o_bi-&gt;campos( campo = &apos;EINE-NORBM&apos; valor = p_eine-norbm ). &quot; Cantidad de pedido estándar
      o_bi-&gt;campos( campo = &apos;EINE-MWSKZ&apos; valor = p_eine-mwskz ). &quot; Indicador IVA
      o_bi-&gt;campos( campo = &apos;EINE-NETPR&apos; valor = p_eine-netpr ). &quot; Precio neto en info de compras

      IF NOT p_eine-ekgrp IS INITIAL.
        o_bi-&gt;campos( campo = &apos;EINE-EKGRP&apos; valor = p_eine-ekgrp ).
      ENDIF.

      IF NOT p_eine-peinh IS INITIAL.
        o_bi-&gt;campos( campo = &apos;EINE-PEINH&apos; valor = p_eine-peinh ).
      ENDIF.

      IF p_eine-bprme &lt;&gt; p_eina-meins.
        IF NOT p_eine-bpumz IS INITIAL.
          o_bi-&gt;campos( campo = &apos;EINE-BPUMZ&apos; valor = p_eine-bpumz ).
        ENDIF.
        IF NOT p_eine-bpumn IS INITIAL.
          o_bi-&gt;campos( campo = &apos;EINE-BPUMN&apos; valor = p_eine-bpumn ).
        ENDIF.
      ENDIF.

      IF NOT p_eine-bprme IS INITIAL.
        o_bi-&gt;campos( campo = &apos;EINE-BPRME&apos; valor = p_eine-bprme ).
      ENDIF.

      IF NOT p_eine-aplfz IS INITIAL.
        o_bi-&gt;campos( campo = &apos;EINE-APLFZ&apos; valor = p_eine-aplfz ).
      ENDIF.

      IF NOT p_eine-minbm IS INITIAL.
        o_bi-&gt;campos( campo = &apos;EINE-MINBM&apos; valor = p_eine-minbm ).
      ENDIF.

      IF NOT p_eine-norbm IS INITIAL.
        o_bi-&gt;campos( campo = &apos;EINE-NORBM&apos; valor = p_eine-norbm ).
      ENDIF.
    ENDIF.

    IF i_escalas IS INITIAL.
      o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=BU&apos; ).
    ELSE.
* Datos de organización de compras del info-compras parte 1
      o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=KO&apos; ).

* Condición: condiciones adicionales
      o_bi-&gt;dynpro( program = &apos;SAPMV13A&apos; dynpro = &apos;0201&apos; okcode = &apos;=PSTF&apos; ).
      o_bi-&gt;campos( campo = &apos;RV13A-DATAB&apos; valor = sy-datum ). &quot; Inicio de validez de la condición
      o_bi-&gt;campos( campo = &apos;RV13A-DATBI&apos; valor = &apos;31.12.9999&apos; ). &quot; Fin de validez del registro de condición
      o_bi-&gt;campos( campo = &apos;RV130-SELKZ(01)&apos; valor = &apos;X&apos; ). &quot; Indicador de selección en dynpros de lista
      o_bi-&gt;campos( campo = &apos;KONP-KBETR(01)&apos; valor = p_eine-netpr ). &quot; Importe/porcentaje de condición si no existe escala
      o_bi-&gt;campos( campo = &apos;KONP-KONWA(01)&apos; valor = p_eine-waers  ).
      o_bi-&gt;campos( campo = &apos;KONP-KPEIN(01)&apos; valor = p_eine-peinh ).
      o_bi-&gt;campos( campo = &apos;KONP-KMEIN(01)&apos; valor = p_eine-bprme ).

* Condiciones: Escalas de cantidades
      o_bi-&gt;dynpro( program = &apos;SAPMV13A&apos; dynpro = &apos;0303&apos; okcode = &apos;=SICH&apos; ).
      LOOP AT i_escalas ASSIGNING FIELD-SYMBOL(&lt;escala&gt;).
        l_ind = sy-tabix.
        o_bi-&gt;campos( campo = &apos;KONM-KSTBM&apos; ind = l_ind valor = &lt;escala&gt;-kstbm ). &quot; Cantidad de la condición de base de escala
        o_bi-&gt;campos( campo = &apos;KONM-KBETR&apos; ind = l_ind valor = &lt;escala&gt;-kbetr ). &quot; Importe o porcentaje de la condición
        IF l_ind = &apos;01&apos;.
          o_bi-&gt;campos( campo = &apos;RV13A-SKONWA&apos; ind = l_ind valor = &lt;escala&gt;-koein  ).
          o_bi-&gt;campos( campo = &apos;RV13A-KPEIN&apos; ind = l_ind valor = &lt;escala&gt;-kpein ).
          o_bi-&gt;campos( campo = &apos;RV13A-KMEIN&apos; ind = l_ind valor = &lt;escala&gt;-kmein ).
        ENDIF.
      ENDLOOP.
*    ADD 1 TO l_ind.
*    WHILE l_ind &lt; 8.
*      o_bi-&gt;campos( campo = &apos;KONM-KSTBM&apos; ind = l_ind valor = &apos;&apos; ). &quot; Cantidad de la condición de base de escala
*      o_bi-&gt;campos( campo = &apos;KONM-KBETR&apos; ind = l_ind valor = &apos;&apos; ). &quot; Importe o porcentaje de la condición
*      ADD 1 TO l_ind.
*    ENDWHILE.
    ENDIF.

    mensaje = o_bi-&gt;llamar_transaccion( tcode = c_tcode_crear
                        modo = modo ).
    msgty = o_bi-&gt;msgty.
    IF msgty = &apos;S&apos;.
      lights = &apos;3&apos;.
      infnr = o_bi-&gt;msgv1.
    ELSE.
      lights = &apos;1&apos;.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="EXISTE" VERSION="1" LANGU="S" DESCRIPT="Existe registro info" EXPOSURE="2" STATE="1" EDITORDER="2 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="EXISTE" SCONAME="LIFNR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINA-LIFNR"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="EXISTE" SCONAME="MATNR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINA-MATNR"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="EXISTE" SCONAME="EKORG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINE-EKORG" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="EXISTE" SCONAME="WERKS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINE-WERKS" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="EXISTE" SCONAME="ESOKZ" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINE-ESOKZ" PARVALUE="&apos;0&apos;"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="EXISTE" SCONAME="INFNR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="EINA-INFNR"/>
  <source>METHOD existe.
    CLEAR: infnr, eina, eine.

    SELECT * FROM eina
      INTO eina
      UP TO 1 ROWS
     WHERE lifnr = lifnr
       AND matnr = matnr
       AND loekz = &apos;&apos;
     ORDER BY PRIMARY KEY.
    ENDSELECT.
    IF sy-subrc = 0.
      infnr = eina-infnr.
      SELECT SINGLE * FROM eine
        INTO eine
       WHERE infnr = infnr
         AND ekorg = ekorg
         AND esokz = esokz
         AND werks = werks
         AND loekz = &apos;&apos;.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="GET_COND_A017_FECHA" VERSION="1" LANGU="S" DESCRIPT="Devuelve condicion A017 en fecha" EXPOSURE="2" STATE="1" EDITORDER="5 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="GET_COND_A017_FECHA" SCONAME="FECHA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="A017-DATBI"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="GET_COND_A017_FECHA" SCONAME="KSCHL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="A017-KSCHL" PARVALUE="&apos;PB00&apos;"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="GET_COND_A017_FECHA" SCONAME="KONP" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="KONP"/>
  <source>METHOD get_cond_a017_fecha.
    CLEAR: konp, a017.

    IF NOT eine-werks IS INITIAL.
      SELECT  * FROM a017
        INTO a017
        UP TO 1 ROWS
       WHERE kappl  = &apos;M&apos;
         AND kschl  = kschl
         AND ekorg  = eine-ekorg
         AND lifnr  = eina-lifnr
         AND werks  = eine-werks
         AND matnr  = eina-matnr
         AND datbi &gt;= fecha
         AND datab &lt;= fecha
       ORDER BY PRIMARY KEY.
      ENDSELECT.
    ELSE.
      SELECT * FROM a018
        INTO CORRESPONDING FIELDS OF a017
        UP TO 1 ROWS
       WHERE kappl  = &apos;M&apos;
         AND kschl  = kschl
         AND ekorg  = eine-ekorg
         AND lifnr  = eina-lifnr
         AND matnr  = eina-matnr
         AND datbi &gt;= fecha
         AND datab &lt;= fecha
       ORDER BY PRIMARY KEY.
      ENDSELECT.
    ENDIF.

    SELECT * FROM konp
      INTO konp
      UP TO 1 ROWS
     WHERE knumh    = a017-knumh
       AND loevm_ko = &apos;&apos;
     ORDER BY PRIMARY KEY.
    ENDSELECT.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="GET_COND_A018_FECHA" VERSION="1" LANGU="S" DESCRIPT="Devuelve condicion A018 en fecha" EXPOSURE="2" STATE="1" EDITORDER="6 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="GET_COND_A018_FECHA" SCONAME="FECHA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="A017-DATBI"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="GET_COND_A018_FECHA" SCONAME="KSCHL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="A017-KSCHL" PARVALUE="&apos;PB00&apos;"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="GET_COND_A018_FECHA" SCONAME="KONP" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="KONP"/>
  <source>METHOD get_cond_a018_fecha.
    CLEAR: konp, a017.

    SELECT * FROM a018
      INTO CORRESPONDING FIELDS OF a017
      UP TO 1 ROWS
     WHERE kappl  = &apos;M&apos;
       AND kschl  = kschl
       AND ekorg  = eine-ekorg
       AND lifnr  = eina-lifnr
       AND matnr  = eina-matnr
       AND datbi &gt;= fecha
       AND datab &lt;= fecha
     ORDER BY PRIMARY KEY.
    ENDSELECT.

    SELECT * FROM konp
      INTO konp
      UP TO 1 ROWS
     WHERE knumh    = a017-knumh
       AND loevm_ko = &apos;&apos;
     ORDER BY PRIMARY KEY.
    ENDSELECT.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" VERSION="1" LANGU="S" DESCRIPT="Modificar condiciones A017" EXPOSURE="2" STATE="1" EDITORDER="4 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" SCONAME="DATAB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="RV13A-DATAB"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" SCONAME="DATBI" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="RV13A-DATBI" PARVALUE="&apos;99991231&apos;"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" SCONAME="KBETR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="KONP-KBETR"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" SCONAME="KONWA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="KONP-KONWA" PARVALUE="&apos;EUR&apos;"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" SCONAME="KPEIN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="KONP-KPEIN" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" SCONAME="KMEIN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="KONP-KMEIN" PARVALUE="&apos;ST&apos;"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" SCONAME="BPUMZ" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINE-BPUMZ" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" SCONAME="BPUMN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINE-BPUMN" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" SCONAME="MODO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BDC_MODE" PARVALUE="&apos;N&apos;"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_COND_A017" SCONAME="MENSAJE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="BAPIRETURN1-MESSAGE"/>
  <source>METHOD modificar_cond_a017.
    DATA: o_bi    TYPE REF TO zcl_ap_batch_input,
          l_konp  TYPE konp,
          l_meins TYPE meins.

    o_bi = NEW #( ).

* Pantalla de llamada info de compras
    o_bi-&gt;dynpro( program = &apos;SAPMM06I&apos; dynpro = &apos;0100&apos; ).
    o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;/00&apos; ).
    o_bi-&gt;campos( campo = &apos;EINA-LIFNR&apos;
                  valor = eina-lifnr ). &quot; Número de cuenta del proveedor
    o_bi-&gt;campos( campo = &apos;EINA-MATNR&apos;
                  valor = eina-matnr ). &quot; Número de material
    o_bi-&gt;campos( campo = &apos;EINE-EKORG&apos;
                  valor = eine-ekorg ). &quot; Organización de compras
    o_bi-&gt;campos( campo = &apos;EINE-WERKS&apos;
                  valor = eine-werks ). &quot; Centro
    CASE eine-esokz.
      WHEN &apos;0&apos; OR &apos;&apos;.  &quot; Normal
        o_bi-&gt;campos( campo = &apos;RM06I-NORMB&apos;
                      valor = &apos;X&apos; ). &quot; Indicador: registro info normal
      WHEN &apos;2&apos;.        &quot; Consignación
        o_bi-&gt;campos( campo = &apos;RM06I-KONSI&apos;
                      valor = &apos;X&apos; ).
      WHEN &apos;3&apos;.        &quot; Subcontratación
        o_bi-&gt;campos( campo = &apos;RM06I-LOHNB&apos;
                      valor = &apos;X&apos; ).
      WHEN &apos;P&apos;.        &quot; Pipeline
        o_bi-&gt;campos( campo = &apos;RM06I-PIPEL&apos;
                      valor = &apos;X&apos; ).
    ENDCASE.

* Datos generales del info de compras
    o_bi-&gt;dynpro( program = &apos;SAPMM06I&apos; dynpro = &apos;0101&apos; ).
    o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=KO&apos; ).

    l_konp = get_cond_a017_fecha( fecha = datab ).
    IF l_konp IS INITIAL.
      l_konp = get_cond_a018_fecha( fecha = datab ).
    ENDIF.
    IF NOT l_konp IS INITIAL OR datab &lt; sy-datum.
* Visual. de periodos de validez
      o_bi-&gt;dynpro( program = &apos;SAPLV14A&apos; dynpro = &apos;0102&apos; ).
      o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=NEWD&apos; ).
    ENDIF.

* Condición: condiciones adicionales
    o_bi-&gt;dynpro( program = &apos;SAPMV13A&apos; dynpro = &apos;0201&apos; ).
    o_bi-&gt;campos( campo = &apos;BDC_CURSOR&apos; valor = &apos;KONP-KMEIN(01)&apos; ).
    o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=SICH&apos; ).
    o_bi-&gt;campos( campo = &apos;RV13A-DATAB&apos;
                  valor = datab ). &quot; Inicio de validez de la condición
    o_bi-&gt;campos( campo = &apos;RV13A-DATBI&apos;
                  valor = datbi ). &quot; Fin validez del registro condición
    o_bi-&gt;campos( campo = &apos;KONP-KBETR(01)&apos;
                  valor = kbetr ).
    IF NOT kpein IS INITIAL.
      o_bi-&gt;campos( campo = &apos;KONP-KPEIN(01)&apos;
                    valor = kpein ). &quot; Ctd.Base
    ENDIF.
    &quot; Importe/porcentaje de condición si no existe escala
    o_bi-&gt;campos( campo = &apos;KONP-KONWA(01)&apos;
                  valor = konwa ). &quot; Unidad de condición
    o_bi-&gt;campos( campo = &apos;KONP-KMEIN(01)&apos;
                  valor = kmein ). &quot; Unidad de medida para la condición

    l_meins = zcl_ap_material=&gt;get_unidad_base( eina-matnr ).
    IF l_meins &lt;&gt; kmein.
      o_bi-&gt;dynpro( program = &apos;SAPMV13A&apos; dynpro = &apos;0122&apos; ).
      o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=WEIT&apos; ).
      IF NOT bpumz IS INITIAL.
        o_bi-&gt;campos( campo = &apos;KONP-KUMNE&apos; valor = bpumz ).
      ENDIF.
      IF NOT bpumn IS INITIAL.
        o_bi-&gt;campos( campo = &apos;KONP-KUMZA&apos; valor = bpumn ).
      ENDIF.
    ENDIF.

    mensaje = o_bi-&gt;llamar_transaccion( tcode = c_tcode_modificar
                                          modo = modo ).
    me-&gt;mensaje = mensaje.
    msgty = o_bi-&gt;msgty.
    lights = o_bi-&gt;lights.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_PRECIO" VERSION="1" LANGU="S" DESCRIPT="Modifca precio" EXPOSURE="2" STATE="1" EDITORDER="7 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_PRECIO" SCONAME="P_EINE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINE"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_PRECIO" SCONAME="MODO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BDC_MODE" PARVALUE="&apos;N&apos;"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_PRECIO" SCONAME="P_EINA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINA"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_PRECIO" SCONAME="I_ESCALAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_ESCALAS" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="MODIFICAR_PRECIO" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD modificar_precio.
    DATA o_bi  TYPE REF TO zcl_ap_batch_input.
    DATA l_ind TYPE numc2.

    o_bi = NEW #( ).

    o_bi-&gt;inicio( ).

* Pantalla de llamada info de compras
    o_bi-&gt;dynpro( program = &apos;SAPMM06I&apos; dynpro = &apos;0100&apos; okcode = &apos;/00&apos; ).
    o_bi-&gt;campos( campo = &apos;EINA-LIFNR&apos; valor = p_eina-lifnr ). &quot; Número de cuenta del proveedor
    o_bi-&gt;campos( campo = &apos;EINA-MATNR&apos; valor = p_eina-matnr ). &quot; Número de material
    o_bi-&gt;campos( campo = &apos;EINE-EKORG&apos; valor = p_eine-ekorg ). &quot; Organización de compras
    o_bi-&gt;campos( campo = &apos;EINE-WERKS&apos; valor = p_eine-werks ). &quot; Centro
    o_bi-&gt;campos( campo = &apos;EINA-INFNR&apos; valor = p_eine-infnr ). &quot; Número del registro info de compras
    IF p_eine-esokz = &apos;3&apos;.
      o_bi-&gt;campos( campo = &apos;RM06I-LOHNB&apos; valor = &apos;X&apos; ). &quot; Indicador: registro info de subcontratación
      o_bi-&gt;campos( campo = &apos;RM06I-NORMB&apos; valor = &apos;&apos; ).
    ENDIF.

* Datos generales del info de compras
    o_bi-&gt;dynpro( program = &apos;SAPMM06I&apos; dynpro = &apos;0101&apos; okcode = &apos;=EINE&apos; ).

* Datos de organización de compras del info-compras parte 1
    o_bi-&gt;dynpro( program = &apos;SAPMM06I&apos; dynpro = &apos;0102&apos; okcode = &apos;=KO&apos; ).

* Visual. de periodos de validez
    o_bi-&gt;dynpro( program = &apos;SAPLV14A&apos; dynpro = &apos;0102&apos; okcode = &apos;=NEWD&apos; ).

    IF i_escalas IS INITIAL.
* Condición: condiciones adicionales
      o_bi-&gt;dynpro( program = &apos;SAPMV13A&apos; dynpro = &apos;0201&apos; okcode = &apos;=SICH&apos; ).
      o_bi-&gt;campos( campo = &apos;RV13A-DATAB&apos; valor = sy-datum ). &quot; Inicio de validez de la condición
      o_bi-&gt;campos( campo = &apos;RV13A-DATBI&apos; valor = &apos;31.12.9999&apos; ). &quot; Fin de validez del registro de condición
      o_bi-&gt;campos( campo = &apos;KONP-KBETR(01)&apos; valor = p_eine-netpr ). &quot; Importe/porcentaje de condición si no existe escala
      o_bi-&gt;campos( campo = &apos;KONP-KONWA(01)&apos; valor = p_eine-waers  ).
      o_bi-&gt;campos( campo = &apos;KONP-KPEIN(01)&apos; valor = p_eine-peinh ).
      o_bi-&gt;campos( campo = &apos;KONP-KMEIN(01)&apos; valor = p_eine-bprme ).
    ELSE.
* Condición: condiciones adicionales
      o_bi-&gt;dynpro( program = &apos;SAPMV13A&apos; dynpro = &apos;0201&apos; okcode = &apos;=PSTF&apos; ).
      o_bi-&gt;campos( campo = &apos;RV13A-DATAB&apos; valor = sy-datum ). &quot; Inicio de validez de la condición
      o_bi-&gt;campos( campo = &apos;RV13A-DATBI&apos; valor = &apos;31.12.9999&apos; ). &quot; Fin de validez del registro de condición
      o_bi-&gt;campos( campo = &apos;RV130-SELKZ(01)&apos; valor = &apos;X&apos; ). &quot; Indicador de selección en dynpros de lista
      o_bi-&gt;campos( campo = &apos;KONP-KBETR(01)&apos; valor = p_eine-netpr ). &quot; Importe/porcentaje de condición si no existe escala
      o_bi-&gt;campos( campo = &apos;KONP-KONWA(01)&apos; valor = p_eine-waers  ).
      o_bi-&gt;campos( campo = &apos;KONP-KPEIN(01)&apos; valor = p_eine-peinh ).
      o_bi-&gt;campos( campo = &apos;KONP-KMEIN(01)&apos; valor = p_eine-bprme ).

* Condiciones: Escalas de cantidades
      o_bi-&gt;dynpro( program = &apos;SAPMV13A&apos; dynpro = &apos;0303&apos; okcode = &apos;=SICH&apos; ).
      LOOP AT i_escalas ASSIGNING FIELD-SYMBOL(&lt;escala&gt;).
        l_ind = sy-tabix.
        o_bi-&gt;campos( campo = &apos;KONM-KSTBM&apos; ind = l_ind valor = &lt;escala&gt;-kstbm ). &quot; Cantidad de la condición de base de escala
        o_bi-&gt;campos( campo = &apos;KONM-KBETR&apos; ind = l_ind valor = &lt;escala&gt;-kbetr ). &quot; Importe o porcentaje de la condición
        IF l_ind = &apos;01&apos;.
          o_bi-&gt;campos( campo = &apos;RV13A-SKONWA&apos; ind = l_ind valor = &lt;escala&gt;-koein  ).
          o_bi-&gt;campos( campo = &apos;RV13A-KPEIN&apos; ind = l_ind valor = &lt;escala&gt;-kpein ).
          o_bi-&gt;campos( campo = &apos;RV13A-KMEIN&apos; ind = l_ind valor = &lt;escala&gt;-kmein ).
        ENDIF.
      ENDLOOP.
*    ADD 1 TO l_ind.
*    WHILE l_ind &lt; 8.
*      o_bi-&gt;campos( campo = &apos;KONM-KSTBM&apos; ind = l_ind valor = &apos;&apos; ). &quot; Cantidad de la condición de base de escala
*      o_bi-&gt;campos( campo = &apos;KONM-KBETR&apos; ind = l_ind valor = &apos;&apos; ). &quot; Importe o porcentaje de la condición
*      ADD 1 TO l_ind.
*    ENDWHILE.
    ENDIF.

    mensaje = o_bi-&gt;llamar_transaccion( tcode = c_tcode_modificar
                        modo = modo ).
    msgty = o_bi-&gt;msgty.
    IF msgty = &apos;S&apos;.
      lights = &apos;3&apos;.
    ELSE.
      lights = &apos;1&apos;.
      message = mensaje.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="VISUALIZAR_ST" VERSION="1" LANGU="S" DESCRIPT="Visualiza registro info" EXPOSURE="2" STATE="1" EDITORDER="3 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="VISUALIZAR_ST" SCONAME="LIFNR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINA-LIFNR" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="VISUALIZAR_ST" SCONAME="MATNR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINA-MATNR" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="VISUALIZAR_ST" SCONAME="EKORG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINE-EKORG" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="VISUALIZAR_ST" SCONAME="WERKS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINE-WERKS" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="VISUALIZAR_ST" SCONAME="ESOKZ" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINE-ESOKZ" PARVALUE="&apos;0&apos;"/>
  <parameter CLSNAME="ZCL_AP_REGISTRO_INFO" CMPNAME="VISUALIZAR_ST" SCONAME="INFNR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="EINA-INFNR" PAROPTIONL="X"/>
  <source>METHOD visualizar_st.
    DATA o_bi      TYPE REF TO zcl_ap_batch_input.
    &quot; TODO: variable is assigned but never used (ABAP cleaner)
    DATA l_mensaje TYPE bapireturn1-message.

    o_bi = NEW #( ).

* Pantalla de llamada info de compras
    o_bi-&gt;dynpro( program = &apos;SAPMM06I&apos; dynpro = &apos;0100&apos; ).
    o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;/00&apos; ).
    o_bi-&gt;campos( campo = &apos;EINA-LIFNR&apos; valor = lifnr ). &quot; Número de cuenta del proveedor
    o_bi-&gt;campos( campo = &apos;EINA-MATNR&apos; valor = matnr ). &quot; Número de material
    o_bi-&gt;campos( campo = &apos;EINE-EKORG&apos; valor = ekorg ). &quot; Organización de compras
    o_bi-&gt;campos( campo = &apos;EINE-WERKS&apos; valor = werks ). &quot; Centro
    o_bi-&gt;campos( campo = &apos;EINA-INFNR&apos; valor = infnr ).

    CASE esokz.
      WHEN &apos;0&apos; OR &apos;&apos;.  &quot; Normal
        o_bi-&gt;campos( campo = &apos;RM06I-NORMB&apos;
                      valor = &apos;X&apos; ). &quot; Indicador: registro info normal
      WHEN &apos;2&apos;.        &quot; Consignación
        o_bi-&gt;campos( campo = &apos;RM06I-KONSI&apos;
                      valor = &apos;X&apos; ).
      WHEN &apos;3&apos;.        &quot; Subcontratación
        o_bi-&gt;campos( campo = &apos;RM06I-LOHNB&apos;
                      valor = &apos;X&apos; ).
      WHEN &apos;P&apos;.        &quot; Pipeline
        o_bi-&gt;campos( campo = &apos;RM06I-PIPEL&apos;
                      valor = &apos;X&apos; ).
    ENDCASE.

    l_mensaje = o_bi-&gt;llamar_transaccion( tcode = &apos;ME13&apos; modo = &apos;E&apos; ).
  ENDMETHOD.</source>
 </method>
</CLAS>
