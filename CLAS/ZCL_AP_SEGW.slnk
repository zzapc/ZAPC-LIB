<?xml version="1.0" encoding="utf-8"?>
<CLAS CLSNAME="ZCL_AP_SEGW" VERSION="1" LANGU="S" DESCRIPT="Gestion SEGW" CATEGORY="00" EXPOSURE="2" STATE="1" RELEASE="0" CLSCCINCL="X" FIXPT="X" UNICODE="X" CLSBCCAT="00" DURATION_TYPE="0 " RISK_LEVEL="0 ">
 <types CLSNAME="ZCL_AP_SEGW" CMPNAME="T_ENTIDAD" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="1 " TYPTYPE="4" SRCROW1="7 " SRCCOLUMN1="6 " SRCROW2="10 " SRCCOLUMN2="21 " TYPESRC_LENG="142 " TYPESRC="BEGIN OF t_entidad,
        name      TYPE /iwbep/i_sbo_et-name,
        node_uuid TYPE /iwbep/i_sbo_et-node_uuid,
      END OF t_entidad
"/>
 <types CLSNAME="ZCL_AP_SEGW" CMPNAME="TT_ENTIDAD" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="2 " TYPTYPE="4" SRCROW1="11 " SRCCOLUMN1="10 " SRCROW2="11 " SRCCOLUMN2="43 " TYPESRC_LENG="36 " TYPESRC="tt_entidad TYPE TABLE OF t_entidad
"/>
 <localImplementation>*&quot;* local class implementation for public class
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</localImplementation>
 <localTypes>*&quot;* use this source file for any type declarations (class
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</localTypes>
 <localMacros>*&quot;* use this source file for any macro definitions you need
*&quot;* in the implementation part of the class

DEFINE get_rango_may_ceros.
  DATA: &amp;1 TYPE /iwbep/t_cod_select_options.
  &amp;1 = get_filter( log = v_log
                           name = &amp;2
                           it_filter_select_options = it_filter_select_options
                           it_key_tab = it_key_tab
                           mayusculas = &amp;3
                           poner_ceros = &amp;4  ).
  __add_lista v_no_campos &amp;2.
END-OF-DEFINITION.

DEFINE get_rango.
  get_rango_may_ceros &amp;1 &amp;2 &apos;&apos; &apos;&apos;.
END-OF-DEFINITION.

DEFINE get_rango_ceros.
  get_rango_may_ceros &amp;1 &amp;2 &apos;&apos; &amp;3.
END-OF-DEFINITION.

DEFINE get_rango_mayusculas.
  get_rango_may_ceros &amp;1 &amp;2 &apos;X&apos; &apos;&apos;.
END-OF-DEFINITION.

DEFINE get_key_may_ceros.
  get_key( EXPORTING log         = v_log
                             name        = &amp;2
                             it_key_tab  = it_key_tab
                             mayusculas  = &amp;3
                             poner_ceros = &amp;4
                   IMPORTING key         = &amp;1  ).
  __add_lista v_no_campos &amp;2.
END-OF-DEFINITION.

DEFINE get_key.
  get_key_may_ceros &amp;1 &amp;2 &apos;&apos; &apos;&apos;.
END-OF-DEFINITION.

DEFINE get_key_ceros.
  get_key_may_ceros &amp;1 &amp;2 &apos;&apos; &amp;3.
END-OF-DEFINITION.

DEFINE get_key_mayusculas.
  get_key_may_ceros &amp;1 &amp;2 &apos;X&apos; &apos;&apos;.
END-OF-DEFINITION.

DEFINE set_header.
  v_header-name = &amp;1.
  v_header-value = &amp;2.
  /iwbep/if_mgw_conv_srv_runtime~set_header( v_header ).
END-OF-DEFINITION.

DEFINE filter_order.
  IF NOT it_order IS INITIAL.
    get_sort_itab( EXPORTING it_order = it_order CHANGING et_entityset = et_entityset ).
  ENDIF.

  filter_itab( EXPORTING it_filter_select_options = it_filter_select_options
                                 is_paging                = is_paging
                                 it_key_tab               = it_key_tab
                                 no_campos                = v_no_campos
                       CHANGING  et_entityset             = et_entityset ).

  v_log = v_log_old.
END-OF-DEFINITION.

DEFINE ini_metodo.
  v_log_old = v_log.
  ini_metodo( entidad = &amp;1 metodo = &amp;2 ).
END-OF-DEFINITION.

DEFINE ini_metodo_set.
  DATA: l_entity LIKE LINE OF et_entityset,
        l_metodo TYPE string.
  CONCATENATE iv_entity_set_name &apos;_GET_ENTITYSET&apos; INTO l_metodo.
  TRANSLATE l_metodo TO UPPER CASE.
  ini_metodo( entidad = iv_entity_name metodo = l_metodo ).
  get_is_count.
END-OF-DEFINITION.

DEFINE ini_metodo_entity.
  DATA: l_metodo TYPE string.
  CONCATENATE iv_entity_set_name &apos;_GET_ENTITY&apos; INTO l_metodo.
  TRANSLATE l_metodo TO UPPER CASE.
  ini_metodo( entidad = iv_entity_name metodo = l_metodo ).
END-OF-DEFINITION.

DEFINE key_2_rango.
  DATA: &amp;1 TYPE /iwbep/t_cod_select_options.
  &amp;1 = key_2_rango( &amp;2 ).
END-OF-DEFINITION.

DEFINE get_is_count.
  DATA l_is_count TYPE abap_bool.
  IF NOT io_tech_request_context IS INITIAL.
  l_is_count = io_tech_request_context-&gt;has_count( ).
  ENDIF.
END-OF-DEFINITION.

DEFINE get_rango_id.
  v_id = get_field_from_abap( &amp;1 ).
  IF NOT v_id IS INITIAL.
    get_rango: &amp;2    v_id.
  ENDIF.
END-OF-DEFINITION.

DEFINE get_rango_ceros_id.
  v_id = get_field_from_abap( &amp;1 ).
  IF NOT v_id IS INITIAL.
    get_rango_ceros: &amp;2    v_id &amp;3.
  ENDIF.
END-OF-DEFINITION.


DEFINE filter_order_std.
** $inlinecount query option for all count entries.
  IF io_tech_request_context-&gt;has_inlinecount( ) = abap_true.
    DESCRIBE TABLE et_entityset LINES es_response_context-inlinecount.
  ELSE.
    CLEAR es_response_context-inlinecount.
  ENDIF.

***The function module for Filter conditons
  CALL METHOD /iwbep/cl_mgw_data_util=&gt;filtering
    EXPORTING it_select_options = it_filter_select_options
    CHANGING ct_data = et_entityset.



*** The function module for $top and $skip Query Options
  CALL METHOD /iwbep/cl_mgw_data_util=&gt;paging
    EXPORTING is_paging = is_paging
    CHANGING ct_data = et_entityset.

****The function module for Orderby condition
  CALL METHOD /iwbep/cl_mgw_data_util=&gt;orderby
    EXPORTING it_order = it_order
    CHANGING ct_data = et_entityset.
END-OF-DEFINITION.</localMacros>
 <textPool>
  <language SPRAS="S">
   <textElement ID="I" KEY="CAB" ENTRY="campo ABAP" LENGTH="20 "/>
   <textElement ID="I" KEY="KEY" ENTRY="Key" LENGTH="13 "/>
   <textElement ID="I" KEY="NEC" ENTRY="No existe clave" LENGTH="25 "/>
   <textElement ID="I" KEY="NEE" ENTRY="No existe entidad" LENGTH="27 "/>
   <textElement ID="I" KEY="NEF" ENTRY="No existe filtro por" LENGTH="40 "/>
   <textElement ID="I" KEY="NEQ" ENTRY="No existe equivalencia para" LENGTH="54 "/>
   <textElement ID="I" KEY="NEV" ENTRY="No existe valor" LENGTH="25 "/>
   <textElement ID="I" KEY="RAN" ENTRY="Rango" LENGTH="15 "/>
  </language>
 </textPool>
 <typeUsage CLSNAME="ZCL_AP_SEGW" TYPEGROUP="ABAP" VERSION="1" TPUTYPE="0" IMPLICIT="X"/>
 <forwardDeclaration>ABAP</forwardDeclaration>
 <typeClasDef CLSNAME="ZCL_AP_SEGW" TYPEGROUP="/UI2/CL_JSON" VERSION="1" TPUTYPE="1" IMPLICIT="X"/>
 <typeIntfDef CLSNAME="ZCL_AP_SEGW" TYPEGROUP="/IWBEP/IF_MGW_APPL_SRV_RUNTIME" VERSION="1" TPUTYPE="2" IMPLICIT="X"/>
 <typeIntfDef CLSNAME="ZCL_AP_SEGW" TYPEGROUP="/IWBEP/IF_MGW_CORE_SRV_RUNTIME" VERSION="1" TPUTYPE="2" IMPLICIT="X"/>
 <typeIntfDef CLSNAME="ZCL_AP_SEGW" TYPEGROUP="/IWBEP/IF_MGW_MED_ODATA_TYPES" VERSION="1" TPUTYPE="2" IMPLICIT="X"/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="GRABAR_FILTROS_NO" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="6 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="GRABAR_SOLO_ERRORES" VERSION="1" LANGU="S" DESCRIPT="Graba todo el log" EXPOSURE="2" STATE="1" EDITORDER="4 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="GRABAR_TODO" VERSION="1" LANGU="S" DESCRIPT="Graba todo el log" EXPOSURE="2" STATE="1" EDITORDER="2 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="HEADERS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="29 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TIHTTPNVP" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="HEADER_READ" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="30 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="I_ENTIDAD" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="7 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TT_ENTIDAD" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="I_SORT" VERSION="1" LANGU="S" DESCRIPT="Tabla para SORT itab BY (ABAP_SORTORDER_TAB)" EXPOSURE="2" STATE="1" EDITORDER="9 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_SORTORDER_TAB" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="NOMBRE_ODATA" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="3 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="O_CLASE" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="1 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="/IWBEP/CL_MGW_PUSH_ABS_DATA" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="RANGO_01" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="16 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="RANGO_02" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="17 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="RANGO_03" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="18 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="RANGO_04" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="19 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="RANGO_05" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="20 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="RANGO_06" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="21 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="RANGO_07" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="22 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="RANGO_08" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="23 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="RANGO_09" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="24 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="RANGO_10" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="25 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_CLAVE_PARAMETRO" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="28 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_ENTIDAD" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="8 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_FILAS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="26 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="INT4" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_FILTER" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="15 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/S_MGW_SELECT_OPTION" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_ID" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="12 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_LOG" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="5 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_LOG_OLD" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="10 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_NO_CAMPOS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="11 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_SO" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="14 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="/IWBEP/S_COD_SELECT_OPTION" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_STRING" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="13 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_SEGW" CMPNAME="V_WHERE" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="27 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="CONSTRUCTOR" VERSION="1" LANGU="S" DESCRIPT="CONSTRUCTOR" EXPOSURE="2" STATE="1" EDITORDER="1 " DISPID="0 " MTDTYPE="2" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="CONSTRUCTOR" SCONAME="NOMBRE_ODATA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="CONSTRUCTOR" SCONAME="O_CLASE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="/IWBEP/CL_MGW_PUSH_ABS_DATA" PAROPTIONL="X"/>
  <source>METHOD constructor.
    me-&gt;nombre_odata = nombre_odata.
    me-&gt;o_clase      = o_clase.

    grabar_solo_errores = &apos;X&apos;.
    grabar_todo = zcl_ap_parametros=&gt;get_atributo1( clave = &apos;ODATA&apos; campo = nombre_odata ).
    grabar_filtros_no = zcl_ap_parametros=&gt;get_atributo2( clave = &apos;ODATA&apos; campo = nombre_odata ).
    IF me-&gt;grabar_todo = &apos;N&apos;.
      CLEAR: me-&gt;grabar_solo_errores, me-&gt;grabar_todo.
    ENDIF.

    SELECT * FROM /iwbep/i_sbo_et
      APPENDING CORRESPONDING FIELDS OF TABLE i_entidad
     WHERE project = nombre_odata.

    SET PARAMETER ID &apos;Z_NO_VAR_DEF&apos; FIELD &apos;X&apos; ##EXISTS.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" VERSION="1" LANGU="S" DESCRIPT="Crea JSON desde estructura" EXPOSURE="2" STATE="1" EDITORDER="35 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="DATOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="PARES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="SUPPRESS_ITAB" VERSION="1" LANGU="S" DESCRIPT="Si blanco, dejará -&gt; [ itab = {..., si X -&gt; [ {" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BOOLEAN" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="IGNORE_BOOLEAN" VERSION="1" LANGU="S" DESCRIPT="Si blanco los XFELD lo convierte a true/false" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BOOLEAN" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="DONT_ESCAPE_LTGT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BOOLEAN" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="NUMC_AS_NUMERIC" VERSION="1" LANGU="S" DESCRIPT="Si X -&gt; los NUMC (0010) los convirte a 10, si blanco &apos;0010&apos;" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BOOLEAN" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="DATE_FORMAT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="CHAR10" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="REPLACE_UNDERSCORE" VERSION="1" LANGU="S" DESCRIPT="Si X, cambia &apos;_&apos; por &apos;-&apos;" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BOOLEAN" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="REPLACE_DOUBLE_UNDERSCORE" VERSION="1" LANGU="S" DESCRIPT="Si X, cambia &apos;__&apos; por siguiente letra en mayusculas" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BOOLEAN" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="NAME_MAPPINGS" VERSION="1" LANGU="S" DESCRIPT="ABAP&lt;-&gt;JSON Name Mapping Table" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/UI2/CL_JSON=&gt;NAME_MAPPINGS" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="PROYECTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="JSON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="13 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DATOS2JSON" SCONAME="MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="14 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD datos2json.
    &quot; TODO: parameter NAME_MAPPINGS is never used (ABAP cleaner)
    &quot; TODO: parameter PROYECTO is never used (ABAP cleaner)
    &quot; TODO: parameter ENTIDAD is never used (ABAP cleaner)

    DATA: json_doc    TYPE REF TO zcl_json_document,
          l_excepcion TYPE REF TO cx_root.

    CLEAR: json, message.

    TRY.
        json_doc = zcl_json_document=&gt;create_with_data( data = datos
                                                        suppress_itab               = suppress_itab
                                                        ignore_boolean              = ignore_boolean
                                                        dont_escape_ltgt            = dont_escape_ltgt
                                                        numc_as_numeric             = numc_as_numeric
                                                        date_format                 = date_format
                                                        replace_underscore          = replace_underscore
                                                        replace_double_underscore   = replace_double_underscore ).

        json = json_doc-&gt;get_json( ).

        IF NOT pares IS INITIAL.
          json_format_tags( EXPORTING pares = pares CHANGING json = json ).
        ENDIF.
      CATCH cx_root INTO l_excepcion.
        message = l_excepcion-&gt;get_longtext( ).
        IF message IS INITIAL.
          message = l_excepcion-&gt;get_text( ).
        ENDIF.
    ENDTRY.

*Usage zJSON
* https://github.com/se38/zJSON/wiki/Usage-zJSON
*Creating a JSON document with ABAP data (you can pass any structure/table/complex data, except objects)
*
*SELECT * FROM scarr
*   INTO TABLE scarr_t
*   UP TO 3 ROWS.
*
*json_doc = zcl_json_document=&gt;create_with_data( scarr_t ).
*json = json_doc-&gt;get_json( ).
*String &quot;json&quot; now contains:
*
*[
*{
*&quot;mandt&quot; :&quot;001&quot;,
*&quot;carrid&quot; :&quot;AA&quot;,
*&quot;carrname&quot; :&quot;American Airlines&quot;,
*&quot;currcode&quot; :&quot;USD&quot;,
*&quot;url&quot; :&quot;http://www.aa.com&quot;
*},
*{
*&quot;mandt&quot; :&quot;001&quot;,
*&quot;carrid&quot; :&quot;AB&quot;,
*&quot;carrname&quot; :&quot;Air Berlin&quot;,
*&quot;currcode&quot; :&quot;EUR&quot;,
*&quot;url&quot; :&quot;http://www.airberlin.de&quot;
*},
*{
*&quot;mandt&quot; :&quot;001&quot;,
*&quot;carrid&quot; :&quot;AC&quot;,
*&quot;carrname&quot; :&quot;Air Canada&quot;,
*&quot;currcode&quot; :&quot;CAD&quot;,
*&quot;url&quot; :&quot;http://www.aircanada.ca&quot;
*}
*]
*New in version 0.2.1
*Append multiple data objects:
*
*SELECT SINGLE * FROM mara
*   INTO mara_data
*   WHERE matnr = &apos;100-100&apos;.
*
*SELECT * FROM marc
*   INTO TABLE marc_data_t
*   WHERE matnr = &apos;100-100&apos;.
*
*json_doc = zcl_json_document=&gt;create( ).
*json_doc-&gt;append_data( data = mara_data iv_name = &apos;MARA&apos; ).
*json_doc-&gt;append_data( data = marc_data_t iv_name = &apos;MARC&apos; ).
*json = json_doc-&gt;get_json( ).
*Result
*
*{
*&quot;MARA&quot;:
*{
*&quot;mandt&quot; :&quot;800&quot;,
*&quot;matnr&quot; :&quot;100-100&quot;,
*&quot;ersda&quot; :&quot;19941107&quot;,
*&quot;ernam&quot; :&quot;BALLER&quot;,
*..
*&quot;fiber_part5&quot; :&quot;000&quot;,
*&quot;fashgrd&quot; :&quot;&quot;
*},
*&quot;MARC&quot;:
*[
*{
*&quot;mandt&quot; :&quot;800&quot;,
*&quot;matnr&quot; :&quot;100-100&quot;,
*&quot;werks&quot; :&quot;1000&quot;,
*&quot;pstat&quot; :&quot;VEDPALSQGF&quot;,
*..
*&quot;ref_schema&quot; :&quot;&quot;,
*&quot;min_troc&quot; :&quot;000&quot;,
*&quot;max_troc&quot; :&quot;000&quot;,
*&quot;target_stock&quot; :0.000
*}
*]
*}
*New in version 0.2.3
*Get ABAP data object from JSON string:
*
*Assume our JSON contains the following data (a structure object and a table)
*
*{
*&quot;scarr&quot; :
*{&quot;mandt&quot; :&quot;001&quot;,
*&quot;carrid&quot; :&quot;LH&quot;,
*&quot;carrname&quot; :&quot;Lufthansa&quot;,
*&quot;currcode&quot; :&quot;EUR&quot;,
*&quot;url&quot; :&quot;http://www.lufthansa.com&quot;
*},
*&quot;sflight&quot; :
*[{&quot;mandt&quot; :&quot;001&quot;,
*&quot;carrid&quot; :&quot;LH&quot;,
*&quot;connid&quot; :&quot;0400&quot;,
*&quot;fldate&quot; :&quot;20100821&quot;,
*..
*&quot;seatsocc_f&quot; :10},
*{&quot;mandt&quot; :&quot;001&quot;,
*&quot;carrid&quot; :&quot;LH&quot;,
*&quot;connid&quot; :&quot;0400&quot;,
*&quot;fldate&quot; :&quot;20100918&quot;,
*..
*&quot;seatsocc_f&quot; :10}
*]
*}
*Create the JSON document class as always
*
*json_doc = zcl_json_document=&gt;create_with_json( json ).
*Now get the ABAP data object
*
*TYPES: BEGIN OF ts_data,
*       scarr TYPE scarr,
*       sflight TYPE flighttab,
*     END OF ts_data.
*
*DATA: ls_data TYPE ts_data.
*
*json_doc-&gt;get_data( IMPORTING data = ls_data ).
*New in version 0.2.6
*Formatted output of a JSON string (for test purposes)
*
*json_doc = zcl_json_document=&gt;create_with_data( scarr_t ).
*json_doc-&gt;dumps( IMPORTING result = result ).
*LOOP AT result
*  ASSIGNING &lt;line&gt;.
*  WRITE:/ &lt;line&gt;.
*ENDLOOP.
*Output
*
*{
* &quot;itab&quot; :
* [
*     {
*         &quot;mandt&quot; : 001,
*         &quot;carrid&quot; : &quot;AA&quot;,
*         &quot;carrname&quot; : &quot;American Airlines&quot;,
*         &quot;currcode&quot; : &quot;USD&quot;,
*         &quot;url&quot; : &quot;http://www.aa.com&quot;
*     },
*     {
*         &quot;mandt&quot; : 001,
*         &quot;carrid&quot; : &quot;AB&quot;,
*         &quot;carrname&quot; : &quot;Air Berlin&quot;,
*         &quot;currcode&quot; : &quot;EUR&quot;,
*         &quot;url&quot; : &quot;http://www.airberlin.de&quot;
*     },
*     {
*         &quot;mandt&quot; : 001,
*         &quot;carrid&quot; : &quot;AC&quot;,
*         &quot;carrname&quot; : &quot;Air Canada&quot;,
*         &quot;currcode&quot; : &quot;CAD&quot;,
*         &quot;url&quot; : &quot;http://www.aircanada.ca&quot;
*     }
* ]
*}
*New in version 0.2.9
*Same example as above, but creation of JSON without &quot;itab&quot;.
*
*json_doc = zcl_json_document=&gt;create_with_data(
*  data          = scarr_t
*  suppress_itab = abap_true ).
*The result is now:
*
*[
* {
*     &quot;mandt&quot; : &quot;001&quot;,
*     &quot;carrid&quot; : &quot;AA&quot;,
*     &quot;carrname&quot; : &quot;American Airlines&quot;,
*     &quot;currcode&quot; : &quot;USD&quot;,
*     &quot;url&quot; : &quot;http://www.aa.com&quot;
* },
* {
*     &quot;mandt&quot; : &quot;001&quot;,
*     &quot;carrid&quot; : &quot;AB&quot;,
*     &quot;carrname&quot; : &quot;Air Berlin&quot;,
*     &quot;currcode&quot; : &quot;EUR&quot;,
*     &quot;url&quot; : &quot;http://www.airberlin.de&quot;
* },
* {
*     &quot;mandt&quot; : &quot;001&quot;,
*     &quot;carrid&quot; : &quot;AC&quot;,
*     &quot;carrname&quot; : &quot;Air Canada&quot;,
*     &quot;currcode&quot; : &quot;CAD&quot;,
*     &quot;url&quot; : &quot;http://www.aircanada.ca&quot;
* }
*]
*Working with nested arrays/tables (new in version 0.2.10)
*Please note: the JSON document class is only able to keep one array and one JSON data string in memory. If you have to parse a nested array, you need one JSON class instance per nested array.
*
*lv_json = &apos;[[123,&quot;abc&quot;],[456,&quot;def&quot;,&quot;another one&quot;]]&apos;.
*lo_json_doc = zcl_json_document=&gt;create_with_json( json = lv_json ).
*
*WHILE lo_json_doc-&gt;get_next( ) IS NOT INITIAL.
*     lo_json_doc2 = zcl_json_document=&gt;create_with_json( json = lo_json_doc-&gt;get_json( ) ).
*
*     WHILE lo_json_doc2-&gt;get_next( ) IS NOT INITIAL.
*       lv_json = lo_json_doc2-&gt;get_json( ).
*       WRITE:/ lv_json.
*     ENDWHILE.
*
*ENDWHILE.
*New in release 0.2.13
*if you are expecting a large JSON string, please use the following code to prevent unnecessary memory consumption (&quot;call by ref&quot; instead of &quot;call by value&quot;)
*
* json_doc-&gt;get_json_large(
*   IMPORTING
*     json = json
* ).
*Creating a JSON document with JSON data and read content (array in this case)
*
*json_doc = zcl_json_document=&gt;create_with_json( json ).
*
*WHILE json_doc-&gt;get_next( ) IS NOT INITIAL.
*
*   carrid = json_doc-&gt;get_value( &apos;carrid&apos; ).
*   carrname = json_doc-&gt;get_value( &apos;carrname&apos; ).
*
*   WRITE:/ carrid, carrname.
*
*ENDWHILE.
*Working with conversion exits (new in Release 0.2.14)
* TYPES: BEGIN OF ts_x,
*           field TYPE spras,
*         END OF ts_x.
*
* ls_x-field = &apos;S&apos;. &quot;Spanish
*
* json_doc-&gt;set_use_conversion_exit( abap_false ).   &quot;default
* json_doc-&gt;set_data( ls_x ).
* json = json_doc-&gt;get_json( ).
*Result {&quot;field&quot; :&quot;S&quot;}
*
* json_doc-&gt;set_use_conversion_exit( abap_true ).
* json_doc-&gt;set_data( ls_x ).
* json = json_doc-&gt;get_json( ).
*Result {&quot;field&quot; :&quot;ES&quot;}
*
* json = &apos;{&quot;field&quot; :&quot;S&quot;}&apos;.
* json_doc-&gt;set_use_conversion_exit( abap_false ).   &quot;default
* json_doc-&gt;set_json( json ).
* json_doc-&gt;get_data(
*   IMPORTING
*     data = ls_x
* ).
*Result ls-x = &apos;S&apos;
*
* json = &apos;{&quot;field&quot; :&quot;ES&quot;}&apos;.
* json_doc-&gt;set_use_conversion_exit( abap_true ).
* json_doc-&gt;set_json( json ).
* json_doc-&gt;get_data(
*   IMPORTING
*     data = ls_x
* ).
*Result ls-x = &apos;S&apos;
*
*Simple transformation (new in Release 0.2.17)
*Starting with Basis Release 7.02 SP11 (other Releases: see SAP note 1648418) and Kernel Release 720 patch 116 it is possible to parse JSON with SAP standard transformation. If you don&apos;t need special features of the JSON document class (ie. date format,
* conversion exits) you can use a NEW class METHOD to CONVERT json to ABAP DATA and vice versa (better performance and less memory consumption).
*
* TYPES: BEGIN OF ts_test,
*           s TYPE string,
*           d type d,
*         END OF ts_test.
*
*        DATA json  TYPE string.
* DATA test TYPE ts_test.
*
* &quot;*--- ABAP -&gt; JSON ---*
* test-s = &apos;aaa &quot; bbb \ ccc &lt; ddd &gt; eee&apos;.
* test-d = sy-datlo.
*
* zcl_json_document=&gt;transform_simple(
*   EXPORTING
*     data_in  = test
*   IMPORTING
*     json_out = json
* ).
*
* WRITE:/ json.
*&quot;-&gt; {&quot;RESULT&quot;:{&quot;S&quot;:&quot;aaa &quot; bbb \ ccc &lt; ddd &gt; eee&quot;,&quot;D&quot;:&quot;2013-02-01&quot;}}
*
* &quot;*--- JSON -&gt; ABAP ---*
* CLEAR test.
*
* zcl_json_document=&gt;transform_simple(
*   EXPORTING
*     json_in  = json
*   IMPORTING
*     data_out = test
* ).
*
* WRITE:/ test-s, test-d.
*&quot;-&gt; aaa &quot; bbb \ ccc &lt; ddd &gt; eee 01022013
*
*Handling of boolean values (new in Release 0.2.24)
*If data element &quot;boolean&quot; is used, the class now returns real boolean values:
*
*DATA: BEGIN OF ls_test,
*        yyy TYPE boolean,
*        xxx TYPE boolean,
*      END OF ls_test.
*
*ls_test-xxx = abap_true.
*
*DATA(json_doc) = zcl_json_document=&gt;create_with_data( ls_test ).
*cl_demo_output=&gt;display( json_doc-&gt;get_json( ) ).
*-&gt; {&quot;yyy&quot; :false,&quot;xxx&quot; :true}
*
*But the old handling is still possible:
*
*DATA(json_doc) = zcl_json_document=&gt;create_with_data(
*                     data             = ls_test
*                     ignore_boolean   = abap_true
*                 ).
*-&gt; {&quot;yyy&quot; :&quot;&quot;,&quot;xxx&quot; :&quot;X&quot;}
*
*Handling of boolean values (new in Release 0.2.25)
*We now can pass JSON boolean values to the JSON document class:
*
*DATA: BEGIN OF ls_test,
*        yyy TYPE boolean,
*        xxx TYPE boolean,
*      END OF ls_test.
*
*DATA(json_doc) = zcl_json_document=&gt;create_with_json( &apos;{&quot;yyy&quot; : false, &quot;xxx&quot; : true}&apos; ).
*json_doc-&gt;get_data( IMPORTING data = ls_test ).
*cl_demo_output=&gt;display( ls_test ).
*-&gt; test-f1 = &quot;&quot; test-f2 = &quot;X&quot;
*
*Handling of data reference objects (new in Release 0.2.25)
*TYPES: BEGIN OF ts_test,
*         f1 TYPE boolean,
*         f2 TYPE string,
*       END OF ts_test.
*
*DATA test TYPE ts_test.
*DATA test_ref TYPE REF TO data.
*
*test-f1 = abap_true.
*test-f2 = &apos;And another Test&apos;.
*
*GET REFERENCE OF test INTO test_ref.
*DATA(json_doc) = zcl_json_document=&gt;create_with_data( test_ref ).
*cl_demo_output=&gt;display( json_doc-&gt;get_json( ) ).
*-&gt; {&quot;f1&quot; :true,&quot;f2&quot; :&quot;And another Test&quot;}
*
*Handling of NUMC fields (new in Release 0.2.26)
*NUMC fields are treated like strings (surrounded by quotes) -&gt; attention: this is an incompatible change!
*
*If (like in previous versions) no quotes are required, the parameter &quot;numc_as_numeric&quot; must be set to TRUE:
*
*DATA tnumc TYPE n LENGTH 4 VALUE &apos;10&apos;.
*json_doc = zcl_json_document=&gt;create_with_data( tnumc ).
*-&gt; &quot;0010&quot;
*
*json_doc = zcl_json_document=&gt;create_with_data(
*           data             = tnumc
*           numc_as_numeric  = abap_true
*       ).
*-&gt; 10
*
*Handling of data references (new in Release 0.2.27)
*TYPES: BEGIN OF local_test,
*         field1 TYPE string,
*         field2 TYPE string,
*       END OF local_test.
*
*DATA input  TYPE REF TO data.
*DATA output TYPE REF TO data.
*
*FIELD-SYMBOLS &lt;inp&gt; TYPE local_test.
*
*CREATE DATA input TYPE local_test.
*ASSIGN input-&gt;* TO &lt;inp&gt;.
*&lt;inp&gt;-field1 = &apos;Dref string 1&apos;.
*&lt;inp&gt;-field2 = &apos;Dref string 2&apos;.
*
*DATA(json_doc) = zcl_json_document=&gt;create_with_data( input ).
*
*DATA(json) = json_doc-&gt;get_json( ).
*
*json_doc-&gt;set_json( json ).
*
*&quot;*--- Test 1: without creating data field -&gt; returns a string ---*
*FIELD-SYMBOLS &lt;ref1&gt; TYPE string.
*
*json_doc-&gt;get_data(
*  IMPORTING
*    data = output
*).
*
*ASSIGN output-&gt;* TO &lt;ref1&gt;.
*
*cl_demo_output=&gt;display( &lt;ref1&gt; ).
*-&gt; {&quot;field1&quot; :&quot;Dref string 1&quot;,&quot;field2&quot; :&quot;Dref string 2&quot;}
*
*&quot;*--- Test 2: with creating data field -&gt; returns the structured values ---*
*FIELD-SYMBOLS &lt;ref2&gt; TYPE local_test.
*
*CLEAR output.
*CREATE DATA output TYPE local_test.
*
*json_doc-&gt;get_data(
*  IMPORTING
*    data = output
*).
*
*ASSIGN output-&gt;* TO &lt;ref2&gt;.
*
*cl_demo_output=&gt;display( &lt;ref2&gt; ).
*-&gt; FIELD1 = Dref string 1 -&gt; FIELD2 = Dref string 2
*
*New option: replace underscores in fieldnames with hyphen (new in Release 2.32)
*DATA: BEGIN OF local_test,
*        field_number1 TYPE string,
*        field_number2 TYPE string,
*      END OF local_test.
*
*DATA(json) = zcl_json_document=&gt;create_with_data(
*                 data               = local_test
*                 replace_underscore = abap_true
*             )-&gt;get_json( ).
*Result
*
*{
*  &quot;field-number1&quot; :&quot;&quot;,
*  &quot;field-number2&quot; :&quot;&quot;
*}
*New option: replace double underscores in fieldnames with CamelCase (new in Release 2.33)
*    DATA: BEGIN OF test,
*            field_one      TYPE string,
*            field__two     TYPE string,
*            __field__three TYPE string,
*          END OF test.
*
*    DATA(json) = zcl_json_document=&gt;create_with_data(
*        data                      = test
*        replace_underscore        = abap_true
*        replace_double_underscore = abap_true
*    )-&gt;get_json( ).
*Result
*
*{
* &quot;field-one&quot;:&quot;&quot;,
* &quot;fieldTwo&quot;:&quot;&quot;,
* &quot;FieldThree&quot;:&quot;&quot;
*}
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="DESCOMPRIMIR_JSON" VERSION="1" LANGU="S" DESCRIPT="Descomprime JSON" EXPOSURE="2" STATE="1" EDITORDER="32 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="DESCOMPRIMIR_JSON" SCONAME="JSON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD descomprimir_json.
    DATA: l_c3 TYPE char3,
          l_s2 TYPE string,
          l_s1 TYPE string,
          i_s  TYPE TABLE OF string.

    l_c3 = json.
    IF l_c3 = &apos;!c#&apos;. &quot; String comprimido.
      SPLIT json AT l_c3 INTO l_s2 l_s1 json.
      SPLIT l_s1 AT &apos;||&apos; INTO TABLE i_s.
      LOOP AT i_s ASSIGNING FIELD-SYMBOL(&lt;s&gt;).
        SPLIT &lt;s&gt; AT &apos;=&apos; INTO l_s1 l_s2.
        REPLACE ALL OCCURRENCES OF l_s2 IN json WITH l_s1.
      ENDLOOP.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="ENTITYSET_CREATE_ENTITY_MODELO" VERSION="1" LANGU="S" DESCRIPT="Ejemplo crearte" EXPOSURE="2" STATE="1" EDITORDER="44 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD entityset_create_entity_modelo.
*
*   DATA: l_ebeln TYPE ebeln.
*
*    io_data_provider-&gt;read_entry_data( IMPORTING es_data = er_entity ).
*
*    CASE er_entity-valor.
*      WHEN &apos;ConfirmarPedido&apos;.
*        l_ebeln = er_entity-otros.
*        __poner_ceros l_ebeln.
*        DATA(l_respuesta) = confirmar_pedido( ebeln = l_ebeln datos = er_entity-respuesta ).
*        MOVE-CORRESPONDING l_respuesta TO er_entity.
*      WHEN OTHERS.
*        er_entity-type = &apos;E&apos;.
*        er_entity-message = |Acción { er_entity-valor } no reconocida|.
*    ENDCASE.
*
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTER_ITAB" VERSION="1" LANGU="S" DESCRIPT="Devuelve criterios ordenacion tabla interna" EXPOSURE="2" STATE="1" EDITORDER="9 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTER_ITAB" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTER_ITAB" SCONAME="IT_FILTER_SELECT_OPTIONS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SELECT_OPTION" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTER_ITAB" SCONAME="IS_PAGING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/S_MGW_PAGING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTER_ITAB" SCONAME="IT_KEY_TAB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_NAME_VALUE_PAIR" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTER_ITAB" SCONAME="NO_CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTER_ITAB" SCONAME="ET_ENTITYSET" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD filter_itab.
    DATA: l_entidad   TYPE string,
          r_no_campos TYPE rstt_t_range_string,
          r_rango     TYPE /iwbep/t_cod_select_options,
          l_campo     TYPE fieldname,
          o_campos    TYPE REF TO cl_abap_structdescr.

    FIELD-SYMBOLS: &lt;filter&gt; TYPE /iwbep/s_mgw_select_option,
                   &lt;entity&gt; TYPE any,
                   &lt;valor&gt;  TYPE any,
                   &lt;key&gt;    TYPE /iwbep/s_mgw_name_value_pair.

    IF entidad IS INITIAL.
      l_entidad = v_entidad.
    ELSE.
      l_entidad = entidad.
    ENDIF.

    IF NOT no_campos IS INITIAL.
      r_no_campos = zcl_ap_lista=&gt;lista2rango( lista = no_campos option = &apos;EQ&apos; sign = &apos;E&apos; ).
    ENDIF.

    LOOP AT it_filter_select_options ASSIGNING &lt;filter&gt; WHERE property IN r_no_campos.
      r_rango = &lt;filter&gt;-select_options.
      IF r_rango IS INITIAL.
        CONTINUE.
      ENDIF.

      l_campo = get_abap_field( entidad = l_entidad id = &lt;filter&gt;-property ).
      IF l_campo IS INITIAL.
        CONTINUE.
      ENDIF.

      LOOP AT et_entityset ASSIGNING &lt;entity&gt;.
        IF o_campos IS NOT BOUND.
          o_campos ?= cl_abap_typedescr=&gt;describe_by_data( &lt;entity&gt; ).
        ENDIF.
        IF o_campos IS BOUND.
          READ TABLE   o_campos-&gt;components TRANSPORTING NO FIELDS WITH KEY name = l_campo.
          IF sy-subrc = 0.
            ASSIGN COMPONENT sy-tabix OF STRUCTURE &lt;entity&gt; TO &lt;valor&gt;.
            IF sy-subrc = 0.
              IF NOT &lt;valor&gt; IN r_rango.
                DELETE et_entityset.
              ENDIF.
            ENDIF.
          ENDIF.
        ENDIF.
      ENDLOOP.
    ENDLOOP.

    LOOP AT it_key_tab ASSIGNING &lt;key&gt; WHERE name IN r_no_campos.
      l_campo = get_abap_field( entidad = l_entidad id = &lt;key&gt;-name ).
      IF l_campo IS INITIAL.
        CONTINUE.
      ENDIF.

      LOOP AT et_entityset ASSIGNING &lt;entity&gt;.
        IF o_campos IS NOT BOUND.
          o_campos ?= cl_abap_typedescr=&gt;describe_by_data( &lt;entity&gt; ).
        ENDIF.
        IF o_campos IS BOUND.
          READ TABLE o_campos-&gt;components TRANSPORTING NO FIELDS WITH KEY name = l_campo.
          IF sy-subrc = 0.
            ASSIGN COMPONENT sy-tabix OF STRUCTURE &lt;entity&gt; TO &lt;valor&gt;.
            IF sy-subrc = 0.
              IF &lt;valor&gt; &lt;&gt; &lt;key&gt;-value.
                DELETE et_entityset.
              ENDIF.
            ENDIF.
          ENDIF.
        ENDIF.
      ENDLOOP.
    ENDLOOP.

    IF NOT is_paging-skip IS INITIAL.
      DELETE et_entityset FROM 1 TO is_paging-skip.
    ENDIF.
    IF NOT is_paging-top IS INITIAL.
      DELETE et_entityset FROM is_paging-top.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTRO_CONTIENE_VALOR" VERSION="1" LANGU="S" DESCRIPT="Filtro contiene valor" EXPOSURE="2" STATE="1" EDITORDER="18 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTRO_CONTIENE_VALOR" SCONAME="IT_FILTER_SELECT_OPTIONS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SELECT_OPTION"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTRO_CONTIENE_VALOR" SCONAME="PROPERTY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTRO_CONTIENE_VALOR" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="FILTRO_CONTIENE_VALOR" SCONAME="SI" VERSION="1" LANGU="S" DESCRIPT="Declaraciones de tipo de lenguaje interno ABAP" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ABAP"/>
  <source>METHOD filtro_contiene_valor.
    FIELD-SYMBOLS &lt;filtro&gt; TYPE /iwbep/s_mgw_select_option.

    ASSIGN it_filter_select_options[ property = property ] TO &lt;filtro&gt;.
    IF sy-subrc = 0.
      IF valor IN &lt;filtro&gt;-select_options.
        si = &apos;X&apos;.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ABAP_FIELD" VERSION="1" LANGU="S" DESCRIPT="Devuelve campo ABAP" EXPOSURE="2" STATE="1" EDITORDER="7 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ABAP_FIELD" SCONAME="ID" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ABAP_FIELD" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ABAP_FIELD" SCONAME="ABAP" VERSION="1" LANGU="S" DESCRIPT="Nombre campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="FIELDNAME"/>
  <source>METHOD get_abap_field.
    DATA l_entidad TYPE string.

    FIELD-SYMBOLS &lt;entidad&gt; TYPE t_entidad.

    IF entidad IS INITIAL.
      l_entidad = v_entidad.
    ELSE.
      l_entidad = entidad.
    ENDIF.

    ASSIGN i_entidad[ name = l_entidad ] TO &lt;entidad&gt;.
    IF sy-subrc = 0.
      SELECT abap_field FROM /iwbep/i_sbo_pr
        INTO abap
        UP TO 1 ROWS
        WHERE project     = nombre_odata
          AND parent_uuid = &lt;entidad&gt;-node_uuid
          AND name        = id
        ORDER BY PRIMARY KEY.
      ENDSELECT.
      IF sy-subrc &lt;&gt; 0.
        set_log( p1 = &apos;No existe equivalencia para&apos;(NEQ) p2 = l_entidad p3 = &apos;id&apos; p4 = id ).
      ENDIF.
    ELSE.
      set_log( p1 = &apos;No existe entidad&apos;(NEE) p2 = l_entidad ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ABAP_FIELD_DATA" VERSION="1" LANGU="S" DESCRIPT="Devuelve campo ABAP" EXPOSURE="2" STATE="1" EDITORDER="16 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ABAP_FIELD_DATA" SCONAME="ID" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ABAP_FIELD_DATA" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ABAP_FIELD_DATA" SCONAME="DATOS" VERSION="1" LANGU="S" DESCRIPT="Nombre campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/I_SBO_PR"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ABAP_FIELD_DATA" SCONAME="MAYUSCULAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ABAP_FIELD_DATA" SCONAME="CEROS" VERSION="1" LANGU="S" DESCRIPT="Ámbito no definido , posiblemente para niveles patch" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="INT2"/>
  <source>METHOD get_abap_field_data.
    DATA: l_entidad TYPE string,
          l_entity  TYPE /iwbep/i_sbo_et,
          l_dominio TYPE domname,
          l_dd01l   TYPE dd01l.

    FIELD-SYMBOLS &lt;entidad&gt; TYPE t_entidad.

    CLEAR: mayusculas, ceros, datos.
    IF entidad IS INITIAL.
      l_entidad = v_entidad.
    ELSE.
      l_entidad = entidad.
    ENDIF.

    ASSIGN i_entidad[ name = l_entidad ] TO &lt;entidad&gt;.
    IF sy-subrc = 0.
      SELECT * FROM /iwbep/i_sbo_pr
        INTO datos
        UP TO 1 ROWS
        WHERE project     = nombre_odata
          AND parent_uuid = &lt;entidad&gt;-node_uuid
          AND ( name = id OR abap_field = id )
        ORDER BY PRIMARY KEY.
      ENDSELECT.
      IF sy-subrc &lt;&gt; 0.
        set_log( p1 = &apos;No existe equivalencia para&apos;(neq) p2 = l_entidad p3 = &apos;id&apos; p4 = id ).
      ELSE.
        SELECT SINGLE abap_struct FROM /iwbep/i_sbo_et
          INTO l_entity-abap_struct
          WHERE project = nombre_odata
            AND name    = l_entidad.
        IF sy-subrc = 0 AND NOT l_entity-abap_struct IS INITIAL.
          SELECT domname FROM dd03l
             INTO l_dominio
            UP TO 1 ROWS
            WHERE tabname   = l_entity-abap_struct
              AND fieldname = datos-abap_field
            ORDER BY PRIMARY KEY.
          ENDSELECT.
          IF sy-subrc = 0 AND NOT l_dominio IS INITIAL.
            SELECT convexit lowercase outputlen FROM dd01l
              INTO CORRESPONDING FIELDS OF l_dd01l
              UP TO 1 ROWS
             WHERE domname = l_dominio
             ORDER BY PRIMARY KEY.
            ENDSELECT.
            IF sy-subrc = 0.
              IF l_dd01l-convexit = &apos;ALPHA&apos;.
                ceros = l_dd01l-outputlen.
              ENDIF.
              IF l_dd01l-convexit = &apos;MATN1&apos;.
                ceros = l_dd01l-outputlen.
              ENDIF.
              IF l_dd01l-lowercase = &apos;&apos;.
                mayusculas = &apos;X&apos;.
              ENDIF.
            ENDIF.
          ENDIF.
        ENDIF.
      ENDIF.
    ELSE.
      set_log( p1 = &apos;No existe entidad&apos;(nee) p2 = l_entidad ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_DATOS_TABLA" VERSION="1" LANGU="S" DESCRIPT="Devuelve datos de una tabla" EXPOSURE="2" STATE="1" EDITORDER="31 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_DATOS_TABLA" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_DATOS_TABLA" SCONAME="CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_DATOS_TABLA" SCONAME="WHERE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_DATOS_TABLA" SCONAME="RESPUESTA" VERSION="1" LANGU="S" DESCRIPT="Acciones generéricas function import" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ZAP_SAPUI5_ACCION"/>
  <source>METHOD get_datos_tabla.
    DATA l_message TYPE string.

    zcl_ap_fs=&gt;get_tabla( EXPORTING tabla = tabla campos = campos where = where solo_campos_indicados = &apos;X&apos; get_json = &apos;X&apos;
                          IMPORTING message = l_message  json = respuesta-respuesta ).

    IF NOT l_message IS INITIAL.
      respuesta-message = l_message.
      respuesta-type    = &apos;E&apos;.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" VERSION="1" LANGU="S" DESCRIPT="Devuelve resultados de un dominio" EXPOSURE="2" STATE="1" EDITORDER="14 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" SCONAME="IT_FILTER_SELECT_OPTIONS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SELECT_OPTION" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" SCONAME="IS_PAGING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/S_MGW_PAGING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" SCONAME="IT_KEY_TAB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_NAME_VALUE_PAIR" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" SCONAME="IT_ORDER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SORTING_ORDER" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" SCONAME="DOMINIO" VERSION="1" LANGU="S" DESCRIPT="Denominación de un dominio" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="DD07T-DOMNAME"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" SCONAME="SPRAS" VERSION="1" LANGU="S" DESCRIPT="Clave de idioma del entorno de texto actual" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-LANGU" PARVALUE="SY-LANGU"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" SCONAME="MAYUSCULAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" SCONAME="NOMBRE_ID" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" SCONAME="NOMBRE_DESCRIPCION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_DOMINIO" SCONAME="ET_ENTITYSET" VERSION="1" LANGU="S" DESCRIPT="IS-H*MED: Tipo de tabla para DD07T" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="RE_T_REXCJP_DD07T"/>
  <source>METHOD get_entityset_dominio.
    DATA l_filas TYPE i.

    ini_metodo dominio &apos;GET_ENTITYSET_DOMINIO&apos;.

    IF mayusculas = &apos;X&apos;.
      get_rango_mayusculas r_valor_m nombre_id.
    ELSE.
      get_rango r_valor nombre_id.
    ENDIF.
    get_rango r_ddtext nombre_descripcion.

    l_filas = is_paging-top + is_paging-skip.
    IF l_filas = 0.
      l_filas = 100000.
    ENDIF.

    SELECT * FROM dd07t
      INTO TABLE et_entityset
     WHERE domname     = dominio
       AND ddlanguage  = spras
       AND domvalue_l IN r_valor
       AND domvalue_l IN r_valor_m
       AND ddtext     IN r_ddtext
      ORDER BY PRIMARY KEY.
    IF sy-subrc &lt;&gt; 0.
      set_log( p1 = &apos;No existen valores&apos;(NEV) ).
    ENDIF.

    IF NOT is_paging-skip IS INITIAL.
      DELETE et_entityset FROM 1 TO is_paging-skip.
    ENDIF.

    filter_order.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_MODELO" VERSION="1" LANGU="S" DESCRIPT="Ejemplo EntitySet" EXPOSURE="2" STATE="1" EDITORDER="42 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD get_entityset_modelo.
*    ini_metodo_set.
*
*    DATA(l_so) = io_tech_request_context-&gt;get_filter( )-&gt;get_filter_select_options( ).
*    get_rango_so: aufnr, qmnum, gstrp, gstri, gltri, equnr.
*
*    IF r_qmnum IS INITIAL AND r_equnr IS INITIAL AND NOT l_sql CS &apos;EQUNR&apos;.
*      o_segw-&gt;raise_message( io_context = me-&gt;mo_context message = &apos;Debe filtrar por nº de equipo&apos; ).
*    ENDIF.
*
*    TRY.
*        SELECT * FROM caufv JOIN afih ON caufv~aufnr = afih~aufnr
*          INTO CORRESPONDING FIELDS OF TABLE et_entityset
*         WHERE afih~aufnr IN r_aufnr
*           AND qmnum IN r_qmnum
*           AND gstrp IN r_gstrp
*           AND gstri IN r_gstri
*           AND gltri IN r_gltri
*           AND equnr IN r_equnr
*           AND (l_sql)
*         ORDER BY qmnum.
*      CATCH cx_root INTO DATA(o_root).
*        o_segw-&gt;raise_message( io_context = me-&gt;mo_context message = o_root-&gt;get_text( ) ).
*    ENDTRY.

* Otros a tener en cuenta

**    TRY.
**        CALL METHOD cl_clb2_tools=&gt;odata_filter2select_option
**          EXPORTING
**            iv_filter_string        = iv_filter_string
**          RECEIVING
**            rt_filter_select_option = DATA(i_filter).
**        .
**      CATCH cx_clb2_parse .
**    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_PARAMETROS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="29 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" MTDNEWEXC="X" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_PARAMETROS" SCONAME="IT_FILTER_SELECT_OPTIONS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SELECT_OPTION" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_PARAMETROS" SCONAME="IS_PAGING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/S_MGW_PAGING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_PARAMETROS" SCONAME="IT_KEY_TAB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_NAME_VALUE_PAIR" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_PARAMETROS" SCONAME="IT_ORDER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SORTING_ORDER" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_PARAMETROS" SCONAME="ET_ENTITYSET" VERSION="1" LANGU="S" DESCRIPT="Tipo tabla ZPARAMETROS" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ZT_PARAMETROS"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_PARAMETROS" SCONAME="ES_RESPONSE_CONTEXT" VERSION="1" LANGU="S" DESCRIPT="Feed request response information (EntitySet)" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/IF_MGW_APPL_SRV_RUNTIME=&gt;TY_S_MGW_RESPONSE_CONTEXT"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_PARAMETROS" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <exception CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_PARAMETROS" SCONAME="/IWBEP/CX_MGW_BUSI_EXCEPTION" VERSION="1" LANGU="S" DESCRIPT="Business Exception" MTDTYPE="0" EDITORDER="1 "/>
  <exception CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_PARAMETROS" SCONAME="/IWBEP/CX_MGW_TECH_EXCEPTION" VERSION="1" LANGU="S" DESCRIPT="Technical Exception" MTDTYPE="0" EDITORDER="2 "/>
  <source>METHOD get_entityset_parametros.
    DATA: l_so        TYPE /iwbep/s_cod_select_option,
          l_char2     TYPE char2,
          l_tabla     TYPE tabname,
          l_dominio   TYPE domname,
          l_campo     TYPE string,
          l_campos    TYPE string,
          l_atributo1 TYPE string,
          l_where     TYPE string,
          l_entity    TYPE zv_parametros.
    DATA datos TYPE REF TO data.

    FIELD-SYMBOLS: &lt;tabla&gt; TYPE STANDARD TABLE,
                   &lt;linea&gt; TYPE any,
                   &lt;fs&gt;    TYPE any.

    ini_metodo &apos;Parametro&apos; &apos;GET_ENTITYSET_PARAMETROS&apos;.

    get_rango: r_clave      &apos;Clave&apos;,
               r_campo      &apos;Campo&apos;,
               r_valor      &apos;Valor&apos;,
               r_valor2     &apos;Valor2&apos;,
               r_atributo1  &apos;Atributo1&apos;,
               r_atributo2  &apos;Atributo2&apos;,
               r_atributo3  &apos;Atributo3&apos;,
               r_atributo4  &apos;Atributo4&apos;,
               r_comentario &apos;Comentario&apos;.

    IF r_clave IS INITIAL.
      IF NOT v_clave_parametro IS INITIAL.
        l_so-sign   = &apos;I&apos;.
        l_so-option = &apos;EQ&apos;.
        l_so-low    = v_clave_parametro.
        APPEND l_so TO r_clave.
      ENDIF.
    ELSE.
* Vemos si queremos valores de otra tabla diferente
      READ TABLE r_clave INTO l_so INDEX 1.
      IF sy-subrc = 0.
        IF strlen( l_so-low ) &gt; 5.
          l_char2 = l_so-low(2).
          IF l_char2 = &apos;T &apos;.
            l_tabla = l_so-low+2.
          ELSEIF l_char2 = &apos;D &apos;.
            l_dominio = l_so-low+2.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.

    IF r_clave IS INITIAL.
      IF sy-sysid &lt;&gt; zcl_c=&gt;entorno_desarrollo.
        message = &apos;No ha definido clave acceso parámetros&apos;.
        set_log( p1 = message ).
        RETURN.
      ENDIF.
    ENDIF.

    IF NOT l_tabla IS INITIAL.
* /sap/opu/odata/SAP/ZGSDUI_FIRMA_ENTREGAS_SRV/Parametros?$filter=Clave eq &apos;T T001&apos; and Campo eq &apos;BUKRS&apos; and Atributo1 eq &apos;BUTXT&apos;  and Comentario eq &apos;BUKRS LIKE |A!!|&apos;
      READ TABLE r_campo INTO l_so INDEX 1.
      IF sy-subrc = 0.
        l_campo = l_so-low.
        __add_lista l_campos l_campo.
      ELSE.
        message = &apos;Debe especificar la clave a recuperar en CAMPO&apos;.
        set_log( p1 = message ).
        RETURN.
      ENDIF.
      READ TABLE r_atributo1 INTO l_so INDEX 1.
      IF sy-subrc = 0.
        l_atributo1 = l_so-low.
        __add_lista l_campos l_atributo1.
      ELSE.
        message = &apos;Debe especificar el valor a recuperar en ATRIBUTO1&apos;.
        set_log( p1 = message ).
        RETURN.
      ENDIF.

      READ TABLE r_comentario INTO l_so INDEX 1.
      IF sy-subrc = 0.
        l_where = l_so-low.
        REPLACE ALL OCCURRENCES OF &apos;|&apos; IN l_where WITH &apos;&apos;&apos;&apos;.
        REPLACE ALL OCCURRENCES OF &apos;!!&apos; IN l_where WITH &apos;%&apos;.
      ENDIF.

      zcl_ap_fs=&gt;get_tabla( EXPORTING tabla = l_tabla campos = l_campos where = l_where solo_campos_indicados = &apos;X&apos;
                            IMPORTING message = message datos = datos ).

      ASSIGN datos-&gt;* TO &lt;tabla&gt;.
      LOOP AT &lt;tabla&gt; ASSIGNING &lt;linea&gt;.
        CLEAR l_entity.
        l_entity-clave = l_tabla.
        ASSIGN COMPONENT l_campo OF STRUCTURE &lt;linea&gt; TO &lt;fs&gt;.
        IF sy-subrc = 0.
          l_entity-campo = &lt;fs&gt;.
        ENDIF.
        ASSIGN COMPONENT l_atributo1 OF STRUCTURE &lt;linea&gt; TO &lt;fs&gt;.
        IF sy-subrc = 0.
          l_entity-atributo1 = &lt;fs&gt;.
        ENDIF.
        APPEND l_entity TO et_entityset.
      ENDLOOP.
    ELSEIF NOT l_dominio IS INITIAL.
* /sap/opu/odata/SAP/ZGSDUI_FIRMA_ENTREGAS_SRV/Parametros?$filter=Clave eq &apos;D SHKZG&apos;
      l_entity-clave = l_dominio.
      SELECT domvalue_l ddtext FROM  dd07t                 &quot;#EC CI_BYPASS
        INTO (l_entity-campo, l_entity-atributo1)
       WHERE domname    = l_dominio
         AND ddlanguage = sy-langu
       ORDER BY domvalue_l.
        APPEND l_entity TO et_entityset.
      ENDSELECT.
    ELSE.
*items=&quot;{ path: &apos;/Parametros&apos;, templateShareable: true, sorter: { path: &apos;Valor&apos; }, filters: [{path: &apos;Clave&apos;, operator: &apos;EQ&apos;, value1: &apos;FIRMAS&apos;}, {path:&apos;Campo&apos;, operator: &apos;EQ&apos;, value1: &apos;INCIDENCIA&apos;}]}&quot;&gt;
      SELECT * FROM (zcl_c=&gt;tabla_zparametros)
        INTO CORRESPONDING FIELDS OF TABLE et_entityset
       WHERE clave     IN r_clave
         AND campo     IN r_campo
         AND valor     IN r_valor
         AND valor2    IN r_valor2
         AND atributo1 IN r_atributo1
         AND atributo2 IN r_atributo2
         AND atributo3 IN r_atributo3
         AND atributo4 IN r_atributo4
       ORDER BY PRIMARY KEY.
    ENDIF.

    filter_order.

    IF et_entityset IS NOT INITIAL.
** -- Inline Count
      es_response_context-inlinecount = lines( et_entityset ).
** -- Paging
      /iwbep/cl_mgw_data_util=&gt;paging(
        EXPORTING
          is_paging = is_paging
        CHANGING
          ct_data   = et_entityset ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITYSET_SAMPLE" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="25 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD get_entityset_sample.
**** --- Get the Selected string
*    DATA(lv_str) = io_tech_request_context-&gt;get_search_string( ).
***** --- Replace
*    REPLACE ALL OCCURRENCES OF &apos;*&apos; IN lv_str WITH &apos;%&apos;.
**** --- Get Airline Details
*    SELECT carrid carrname currcode url FROM
*          scarr INTO CORRESPONDING FIELDS OF TABLE et_entityset
*          WHERE carrid LIKE lv_str.
*    IF et_entityset IS NOT INITIAL.
*** -- Inline Count
*      es_response_context-inlinecount = lines( et_entityset ).
*** -- Paging
*      CALL METHOD /iwbep/cl_mgw_data_util=&gt;paging
*        EXPORTING
*          is_paging = is_paging
*        CHANGING
*          ct_data   = et_entityset.
*    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_DOMINIO" VERSION="1" LANGU="S" DESCRIPT="Devuelve resultados de un dominio" EXPOSURE="2" STATE="1" EDITORDER="13 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_DOMINIO" SCONAME="IT_KEY_TAB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_NAME_VALUE_PAIR"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_DOMINIO" SCONAME="DOMINIO" VERSION="1" LANGU="S" DESCRIPT="Denominación de un dominio" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="DD07T-DOMNAME"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_DOMINIO" SCONAME="SPRAS" VERSION="1" LANGU="S" DESCRIPT="Clave de idioma del entorno de texto actual" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-LANGU" PARVALUE="SY-LANGU"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_DOMINIO" SCONAME="MAYUSCULAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_DOMINIO" SCONAME="ER_ENTITY" VERSION="1" LANGU="S" DESCRIPT="DD: Textos de valores fijos de dominio (sup.a clave idioma)" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="DD07T"/>
  <source>METHOD get_entity_dominio.
    DATA l_valor TYPE dd07t-domvalue_l.

    FIELD-SYMBOLS &lt;key&gt; TYPE /iwbep/s_mgw_name_value_pair.

    ini_metodo dominio &apos;GET_ENTITY_DOMINIO&apos;.

    ASSIGN it_key_tab[ 1 ] TO &lt;key&gt;.
    IF sy-subrc = 0.
      l_valor = &lt;key&gt;-value.
    ENDIF.

    IF mayusculas = &apos;X&apos;.
      l_valor = to_upper( l_valor ).
    ENDIF.

    er_entity-domname    = dominio.
    er_entity-ddlanguage = spras.
    er_entity-domvalue_l = l_valor.
    SELECT ddtext FROM dd07t
      INTO er_entity-ddtext
      UP TO 1 ROWS
     WHERE domname    = dominio
       AND ddlanguage = spras
       AND domvalue_l = l_valor
      ORDER BY PRIMARY KEY.
    ENDSELECT.
    IF sy-subrc &lt;&gt; 0.
      set_log( p1 = &apos;No existe valor&apos;(NEV) p2 = l_valor ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_MODELO" VERSION="1" LANGU="S" DESCRIPT="Ejemplo Entity" EXPOSURE="2" STATE="1" EDITORDER="43 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD get_entity_modelo.
*    DATA: l_aufnr  TYPE aufnr.
*
*    ini_metodo_entity.
*    get_key: l_aufnr  &apos;IdOrden&apos;.
*
*    TRY.
*        ordenset_get_entityset(  EXPORTING
*            iv_entity_name           = iv_entity_name
*            iv_entity_set_name       = iv_entity_set_name
*            iv_source_name           = iv_source_name
*             IO_TECH_REQUEST_CONTEXT  = cast #( IO_TECH_REQUEST_CONTEXT )
*            it_filter_select_options = VALUE #( )
*            is_paging                = VALUE #( )
*            it_navigation_path       = VALUE #( )
*            it_order                 = VALUE #( )
*            iv_filter_string         = VALUE #( )
*            iv_search_string         = VALUE #( )
*            it_key_tab               = VALUE #( ( name = &apos;IdAviso&apos; value = l_qmnum ) )
*          IMPORTING
*            et_entityset             = DATA(et_entityset) ).
*        IF et_entityset IS INITIAL.
*          o_segw-&gt;raise_message( io_context = me-&gt;mo_context message = |No existe la orden { l_aufnr }| ).
*        ELSE.
*          READ TABLE et_entityset INTO er_entity INDEX 1.
*        ENDIF.
*      CATCH /iwbep/cx_mgw_busi_exception .
*      CATCH /iwbep/cx_mgw_tech_exception .
*    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_PARAMETRO" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="30 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_PARAMETRO" SCONAME="IT_KEY_TAB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_NAME_VALUE_PAIR" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_PARAMETRO" SCONAME="ER_ENTITY" VERSION="1" LANGU="S" DESCRIPT="Tabla generada para una vista" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ZV_PARAMETROS"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_ENTITY_PARAMETRO" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_entity_parametro.
    DATA: l_clave      TYPE zv_parametros-clave,
          l_campo      TYPE zv_parametros-campo,
          l_valor      TYPE zv_parametros-valor,
          l_valor2     TYPE zv_parametros-valor2,
          et_entityset TYPE zt_parametros.

    ini_metodo &apos;Parametro&apos; &apos;GET_ENTITY_PARAMETRO&apos;.
    get_key: l_clave  &apos;Clave&apos;,
             l_campo  &apos;Campo&apos;,
             l_valor  &apos;Valor&apos;,
             l_valor2 &apos;Valor2&apos;.
    IF l_clave IS INITIAL.
      l_clave = v_clave_parametro.
    ENDIF.

    IF NOT l_clave IS INITIAL.
      TRY.
          get_entityset_parametros(
            EXPORTING
              it_key_tab   = it_key_tab
            IMPORTING
              et_entityset = et_entityset
              message      = message ).
          IF message IS INITIAL.
            READ TABLE et_entityset INTO er_entity INDEX 1.
            IF sy-subrc &lt;&gt; 0.
              message = &apos;No se ha encontrado valor&apos;.
            ENDIF.
          ENDIF.
        CATCH /iwbep/cx_mgw_busi_exception.
        CATCH /iwbep/cx_mgw_tech_exception.
      ENDTRY.

    ELSE.
      message = &apos;No ha informado Clave&apos;.
    ENDIF.

    IF NOT message IS INITIAL.
      set_log( p1 = message ).
    ENDIF.

    v_log = v_log_old.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FIELD_FROM_ABAP" VERSION="1" LANGU="S" DESCRIPT="Devuelve Id Campo" EXPOSURE="2" STATE="1" EDITORDER="12 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FIELD_FROM_ABAP" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FIELD_FROM_ABAP" SCONAME="ABAP" VERSION="1" LANGU="S" DESCRIPT="Nombre campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FIELD_FROM_ABAP" SCONAME="ID" VERSION="1" LANGU="S" DESCRIPT="external name of a meta model element" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="/IWBEP/I_SBO_PR-NAME"/>
  <source>METHOD get_field_from_abap.
    DATA l_entidad TYPE string.

    FIELD-SYMBOLS &lt;entidad&gt; TYPE t_entidad.

    IF entidad IS INITIAL.
      l_entidad = v_entidad.
    ELSE.
      l_entidad = entidad.
    ENDIF.

    ASSIGN i_entidad[ name = l_entidad ] TO &lt;entidad&gt;.
    IF sy-subrc = 0.
      SELECT name FROM /iwbep/i_sbo_pr
        INTO id
        UP TO 1 ROWS
        WHERE project     = nombre_odata
          AND parent_uuid = &lt;entidad&gt;-node_uuid
          AND abap_field  = abap
        ORDER BY PRIMARY KEY.
      ENDSELECT.
      IF sy-subrc &lt;&gt; 0.
        set_log( p1 = &apos;No existe equivalencia para&apos;(NEQ) p2 = l_entidad p3 = &apos;campo ABAP&apos;(CAB) p4 = abap ).
      ENDIF.
    ELSE.
      set_log( p1 = &apos;No existe entidad&apos;(NEE) p2 = l_entidad ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTER" VERSION="1" LANGU="S" DESCRIPT="Devuelve el valor del filtro" EXPOSURE="2" STATE="1" EDITORDER="4 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTER" SCONAME="NAME" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTER" SCONAME="PONER_CEROS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTER" SCONAME="IT_FILTER_SELECT_OPTIONS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SELECT_OPTION"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTER" SCONAME="LOG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTER" SCONAME="MAYUSCULAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTER" SCONAME="IT_KEY_TAB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_NAME_VALUE_PAIR" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTER" SCONAME="RANGO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS"/>
  <source>METHOD get_filter.
    DATA: l_ceros TYPE int2,
          l_numc  TYPE c LENGTH 100.

    FIELD-SYMBOLS: &lt;filter&gt; TYPE /iwbep/s_mgw_select_option,
                   &lt;so&gt;     TYPE /iwbep/s_cod_select_option.

    DATA(l_mayusculas) = mayusculas.

    DESCRIBE FIELD poner_ceros TYPE DATA(l_type).
    IF l_type = &apos;C&apos;.
      IF poner_ceros CO &apos;0123456789 &apos;.
        l_ceros = poner_ceros.
      ENDIF.
    ELSEIF l_type = &apos;I&apos;.
      l_ceros = poner_ceros.
    ENDIF.

    ASSIGN it_filter_select_options[ property = name ] TO &lt;filter&gt;.
    IF sy-subrc = 0.
      rango = &lt;filter&gt;-select_options.

      IF l_mayusculas = &apos;A&apos;.
        get_abap_field_data( EXPORTING entidad = v_entidad id = &lt;filter&gt;-property
                             IMPORTING datos = DATA(l_datos_abap) mayusculas = l_mayusculas ceros = l_ceros ).
      ENDIF.

      IF l_ceros &gt; 0.
        LOOP AT rango ASSIGNING &lt;so&gt;.
          l_numc = &lt;so&gt;-low.
          __poner_ceros l_numc(l_ceros).
          &lt;so&gt;-low = l_numc.

          IF NOT &lt;so&gt;-high IS INITIAL.
            l_numc = &lt;so&gt;-high.
            __poner_ceros l_numc(l_ceros).
            &lt;so&gt;-high = l_numc.
          ENDIF.
        ENDLOOP.
      ENDIF.
      IF l_mayusculas = &apos;X&apos;.
        LOOP AT rango ASSIGNING &lt;so&gt;.
          &lt;so&gt;-low  = to_upper( &lt;so&gt;-low ).
          &lt;so&gt;-high = to_upper( &lt;so&gt;-high ).
        ENDLOOP.
      ENDIF.

    ELSE.
      IF NOT it_key_tab IS INITIAL.
        rango = get_key_rango( name = name poner_ceros = l_ceros it_key_tab = it_key_tab log = log mayusculas = l_mayusculas ).
      ENDIF.
    ENDIF.

    IF rango IS INITIAL.
      set_log( log = log p1 = &apos;No existe filtro por&apos;(nef) p2 = name type = &apos;W&apos; ).
    ELSE.
      IF me-&gt;grabar_filtros_no = &apos;D&apos;.
        LOOP AT rango ASSIGNING &lt;so&gt;.
          set_log( log = log p1 = &apos;Rango &apos;(ran) p2 = name  p3 = &apos;=&apos; p4 = &lt;so&gt;-low p5 = &lt;so&gt;-high type = &apos;I&apos; ).
        ENDLOOP.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTRO_FORMAT" VERSION="1" LANGU="S" DESCRIPT="Devuelve valor filtro formateado" EXPOSURE="2" STATE="1" EDITORDER="20 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTRO_FORMAT" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTRO_FORMAT" SCONAME="OP" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;=&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTRO_FORMAT" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_FILTRO_FORMAT" SCONAME="STRING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_filtro_format.
    CONCATENATE &apos;&apos;&apos;&apos; valor &apos;&apos;&apos;&apos; INTO string.
    IF op = &apos;=&apos;.
      CONCATENATE campo op string INTO string.
    ELSE.
      CONCATENATE campo op string INTO string SEPARATED BY space.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_HEADERS" VERSION="1" LANGU="S" DESCRIPT="Recupera parámetros de cabecera" EXPOSURE="2" STATE="1" EDITORDER="33 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD get_headers.
* 1. recuperamos el registro de la pa0105 correspondiente al usuario
    DATA l_facade TYPE REF TO /iwbep/if_mgw_dp_int_facade.

    header_read = &apos;X&apos;.

    IF o_clase IS INITIAL.
      RETURN.
    ENDIF.

    TRY.
        l_facade ?= o_clase-&gt;/iwbep/if_mgw_conv_srv_runtime~get_dp_facade( ).
        headers = l_facade-&gt;get_request_header( ).
      CATCH cx_root INTO DATA(o_root). &quot; TODO: variable is assigned but never used (ABAP cleaner)
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" VERSION="1" LANGU="S" DESCRIPT="Crea JSON desde estructura usando clase estándar" EXPOSURE="2" STATE="1" EDITORDER="39 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="DATOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="STD" VERSION="1" LANGU="S" DESCRIPT="Usar clase estándar" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="COMPRESS" VERSION="1" LANGU="S" DESCRIPT="No genera elementos vacíos" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="PRETTY_NAME" VERSION="1" LANGU="S" DESCRIPT="Tipo PrettyPrint" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/UI2/CL_JSON=&gt;PRETTY_NAME_MODE" PARVALUE="&apos;*&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="CONVERSION_EXITS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="NAME_MAPPINGS" VERSION="1" LANGU="S" DESCRIPT="ABAP&lt;-&gt;JSON Name Mapping Table" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/UI2/CL_JSON=&gt;NAME_MAPPINGS" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="PROYECTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="NUMC_AS_STRING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="JSON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_JSON" SCONAME="MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD get_json.
    &quot; TODO: parameter STD is never used (ABAP cleaner)
    &quot; TODO: parameter CONVERSION_EXITS is never used (ABAP cleaner)

    DATA l_key TYPE text132.

    CLEAR: json, message.

    TRY.
        IF NOT proyecto IS INITIAL AND NOT entidad IS INITIAL.
          DATA(l_name_mappings) = get_name_mappings( proyecto = proyecto entidad = entidad ).
        ENDIF.
        LOOP AT name_mappings ASSIGNING FIELD-SYMBOL(&lt;nm&gt;).
          INSERT &lt;nm&gt; INTO TABLE l_name_mappings.
        ENDLOOP.

        DATA(l_pretty_name) = COND char1( WHEN pretty_name = &apos;*&apos; THEN &apos;X&apos; ELSE pretty_name ).
        json = /ui2/cl_json=&gt;serialize( data = datos
                                        compress = compress
                                        pretty_name = l_pretty_name
*                                      conversion_exits = conversion_exits
                                        numc_as_string = numc_as_string
                                        name_mappings = l_name_mappings ).

        IF pretty_name = &apos;*&apos;.
          DATA(keys) = zcl_ap_regexp=&gt;buscar_patron( string = json patron = &apos;\&quot;([^&quot;]*)\&quot;:&apos; ).
          SORT keys.
          DELETE ADJACENT DUPLICATES FROM keys.
          LOOP AT keys ASSIGNING FIELD-SYMBOL(&lt;key&gt;).
            DATA(l_long) = strlen( &lt;key&gt; ).
            IF l_long &gt; 3.
              l_long = l_long - 3.
              IF NOT line_exists( l_name_mappings[ json = &lt;key&gt;+1(l_long) ] ).
                l_key = &lt;key&gt;.
                l_key+1(1) = to_upper( l_key+1(1) ).
                IF &lt;key&gt; &lt;&gt; l_key.
                  REPLACE ALL OCCURRENCES OF &lt;key&gt; IN json WITH l_key.
                ENDIF.
              ENDIF.
            ENDIF.
          ENDLOOP.
        ENDIF.

      CATCH cx_root INTO DATA(l_excepcion).
        message = l_excepcion-&gt;get_longtext( ).
        IF message IS INITIAL.
          message = l_excepcion-&gt;get_text( ).
        ENDIF.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY" VERSION="1" LANGU="S" DESCRIPT="Devuelve el valor de la clave" EXPOSURE="2" STATE="1" EDITORDER="2 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY" SCONAME="NAME" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY" SCONAME="PONER_CEROS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY" SCONAME="IT_KEY_TAB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_NAME_VALUE_PAIR"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY" SCONAME="LOG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY" SCONAME="MAYUSCULAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY" SCONAME="KEY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="0" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD get_key.
    DATA: l_tipo        TYPE c LENGTH 1,
          l_poner_ceros TYPE c LENGTH 1,
          l_num_car     TYPE i,
          l_char        TYPE c LENGTH 255.

    FIELD-SYMBOLS &lt;key&gt; TYPE /iwbep/s_mgw_name_value_pair.

    IF NOT poner_ceros IS INITIAL.
      DESCRIBE FIELD poner_ceros TYPE l_tipo.
      IF l_tipo = &apos;C&apos;.
        l_poner_ceros = &apos;X&apos;.
      ELSE.
        l_num_car = poner_ceros.
      ENDIF.
    ENDIF.

    ASSIGN it_key_tab[ name = name ] TO &lt;key&gt;.
    IF sy-subrc &lt;&gt; 0.
      IF NOT v_entidad IS INITIAL.
        DATA(l_name) = get_field_from_abap( entidad = v_entidad abap = name ).
        IF NOT l_name IS INITIAL.
          ASSIGN it_key_tab[ name = l_name ] TO &lt;key&gt;.
        ENDIF.
      ENDIF.
    ENDIF.

    IF &lt;key&gt; IS ASSIGNED.
      key = &lt;key&gt;-value.
      IF l_poner_ceros = &apos;X&apos;.
        zcl_ap_string=&gt;poner_ceros_c( CHANGING cadena = key ).
      ELSEIF l_num_car &gt; 0.
        DESCRIBE FIELD key TYPE l_tipo.
        IF l_tipo = &apos;g&apos;. &quot; String
          l_char = key.
          zcl_ap_string=&gt;poner_ceros_c( CHANGING cadena = l_char(l_num_car) ).
          key = l_char.
        ELSE.
          zcl_ap_string=&gt;poner_ceros_c( CHANGING cadena = key(l_num_car) ).
        ENDIF.
      ENDIF.
      IF mayusculas = &apos;X&apos;.
        key = to_upper( key ).
      ENDIF.
      IF me-&gt;grabar_filtros_no = &apos;D&apos; OR me-&gt;grabar_todo = &apos;X&apos;.
        set_log( log = log p1 = &apos;Key &apos;(key) p2 = name  p3 = &apos;=&apos; p4 = key type = &apos;I&apos; ).
      ENDIF.
    ELSE.
      set_log( log = log p1 = &apos;No existe clave&apos;(nec) p2 = name  type = &apos;W&apos; ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY_RANGO" VERSION="1" LANGU="S" DESCRIPT="Devuelve el valor de la clave en variable rango" EXPOSURE="2" STATE="1" EDITORDER="5 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY_RANGO" SCONAME="NAME" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY_RANGO" SCONAME="PONER_CEROS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY_RANGO" SCONAME="IT_KEY_TAB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_NAME_VALUE_PAIR"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY_RANGO" SCONAME="LOG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY_RANGO" SCONAME="MAYUSCULAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_KEY_RANGO" SCONAME="RANGO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS"/>
  <source>METHOD get_key_rango.
    DATA: l_key    TYPE text255,
          l_select TYPE /iwbep/s_cod_select_option.

    get_key( EXPORTING name = name poner_ceros = poner_ceros it_key_tab = it_key_tab log = log mayusculas = mayusculas
             IMPORTING key = l_key ).
    IF NOT l_key IS INITIAL.
      CLEAR l_select.
      l_select-option = &apos;EQ&apos;.
      l_select-sign   = &apos;I&apos;.
      l_select-low    = l_key.
      APPEND l_select TO rango.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_MIMETYPE" VERSION="1" LANGU="S" DESCRIPT="Devuelve MimeType a partir del nombre de fichero" EXPOSURE="2" STATE="1" EDITORDER="41 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_MIMETYPE" SCONAME="FICHERO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_MIMETYPE" SCONAME="MIMETYPE" VERSION="1" LANGU="S" DESCRIPT="KW Framework: Tipo MIME" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="SKWF_MIME"/>
  <source>METHOD get_mimetype.
    DATA filename TYPE skwf_filnm.

    CLEAR mimetype.
    filename = fichero.
    CALL FUNCTION &apos;SKWF_MIMETYPE_OF_FILE_GET&apos;
      EXPORTING
        filename = filename
      IMPORTING
        mimetype = mimetype.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_NAME_MAPPINGS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="38 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_NAME_MAPPINGS" SCONAME="PROYECTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_NAME_MAPPINGS" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_NAME_MAPPINGS" SCONAME="NAME_MAPPINGS" VERSION="1" LANGU="S" DESCRIPT="ABAP&lt;-&gt;JSON Name Mapping Table" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="/UI2/CL_JSON=&gt;NAME_MAPPINGS"/>
  <source>METHOD get_name_mappings.
    SELECT pr~abap_field AS abap, pr~name AS json FROM /iwbep/i_sbo_et AS et JOIN /iwbep/i_sbo_pr  AS pr
        ON  et~project   = pr~project
        AND et~node_uuid = pr~parent_uuid
      INTO TABLE @name_mappings
     WHERE et~project = @proyecto
       AND et~name    = @entidad
     ORDER BY pr~abap_field.

*SELECT et~abap_struct as estructura, et~name as entityd, pr~name as atributo, pr~abap_field as campo FROM /iwbep/i_sbo_et AS et JOIN /iwbep/i_sbo_pr  AS pr
*    ON et~project = pr~project
*    AND et~node_uuid  = pr~parent_uuid
*  INTO table @DATA(i_campos)
* WHERE et~project = &apos;Z5PDEAL&apos;.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_SORT_ITAB" VERSION="1" LANGU="S" DESCRIPT="Devuelve criterios ordenacion tabla interna" EXPOSURE="2" STATE="1" EDITORDER="8 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_SORT_ITAB" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_SORT_ITAB" SCONAME="IT_ORDER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SORTING_ORDER"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_SORT_ITAB" SCONAME="ET_ENTITYSET" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD get_sort_itab.
    DATA: l_entidad TYPE string,
          l_campo   TYPE string,
          l_sort    TYPE abap_sortorder.

    FIELD-SYMBOLS &lt;order&gt; TYPE /iwbep/s_mgw_sorting_order.

    IF entidad IS INITIAL.
      l_entidad = v_entidad.
    ELSE.
      l_entidad = entidad.
    ENDIF.

    CLEAR i_sort.

    LOOP AT it_order ASSIGNING &lt;order&gt;.
      CLEAR l_campo.
      l_campo = get_abap_field( entidad = l_entidad id = &lt;order&gt;-property ).
      IF NOT l_campo IS INITIAL.
        CLEAR l_sort.
        l_sort-name = l_campo.
        IF &lt;order&gt;-order = &apos;desc&apos;.
          l_sort-descending = &apos;X&apos;.
        ENDIF.
        APPEND l_sort TO i_sort.
      ENDIF.
    ENDLOOP.

    IF NOT i_sort IS INITIAL.
      SORT et_entityset BY (i_sort).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_VALOR_FILTER" VERSION="1" LANGU="S" DESCRIPT="Devuelve valor del filtro" EXPOSURE="2" STATE="1" EDITORDER="17 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_VALOR_FILTER" SCONAME="IT_FILTER_SELECT_OPTIONS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SELECT_OPTION"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_VALOR_FILTER" SCONAME="PROPERTY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_VALOR_FILTER" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_valor_filter.
    FIELD-SYMBOLS &lt;filtro&gt; TYPE /iwbep/s_mgw_select_option.

    ASSIGN it_filter_select_options[ property = property ] TO &lt;filtro&gt;.
    IF sy-subrc = 0.
      valor = get_valor_rango( &lt;filtro&gt;-select_options ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_VALOR_HEADER" VERSION="1" LANGU="S" DESCRIPT="Recupera el valor de header" EXPOSURE="2" STATE="1" EDITORDER="34 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_VALOR_HEADER" SCONAME="PARAMETRO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_VALOR_HEADER" SCONAME="VALUE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_valor_header.
    CLEAR value.

    IF header_read IS INITIAL.
      get_headers( ).
    ENDIF.

    ASSIGN headers[ name = parametro ] TO FIELD-SYMBOL(&lt;header&gt;).
    IF sy-subrc = 0.
      IF &lt;header&gt;-value = &apos;null&apos; OR &lt;header&gt;-value = &apos;undefined&apos;.

      ELSE.
        value = &lt;header&gt;-value.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_VALOR_RANGO" VERSION="1" LANGU="S" DESCRIPT="Devuelve el valor del rango" EXPOSURE="2" STATE="1" EDITORDER="6 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_VALOR_RANGO" SCONAME="RANGO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_VALOR_RANGO" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_valor_rango.
    DATA l_so TYPE /iwbep/s_cod_select_option.

    READ TABLE rango INTO l_so INDEX 1.
    IF sy-subrc = 0.
      valor = l_so-low.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_WHERE" VERSION="1" LANGU="S" DESCRIPT="Devuelve clausula where en función de los filtros" EXPOSURE="2" STATE="1" EDITORDER="15 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_WHERE" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_WHERE" SCONAME="IT_FILTER_SELECT_OPTIONS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SELECT_OPTION" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_WHERE" SCONAME="IT_KEY_TAB" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_NAME_VALUE_PAIR" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_WHERE" SCONAME="NO_CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_WHERE" SCONAME="CAMPOS_MAYUSCULAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_WHERE" SCONAME="CAMPOS_CEROS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="GET_WHERE" SCONAME="WHERE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_where.
    DATA: l_entidad           TYPE string,
          r_no_campos         TYPE rstt_t_range_string,
          r_campos_mayusculas TYPE rstt_t_range_string,
          r_campos_ceros      TYPE rstt_t_range_string,
          l_datos_abap        TYPE /iwbep/i_sbo_pr,
          l_mayusculas        TYPE c LENGTH 1,
          l_ceros             TYPE int2,
          r_rango             TYPE /iwbep/t_cod_select_options,
          l_campo             TYPE fieldname,
          l_cont_rangos       TYPE n LENGTH 2,
          l_nombre_rango      TYPE string,
          l_clausula          TYPE string,
          l_valor             TYPE string,
          o_campos            TYPE REF TO cl_abap_structdescr,
          l_dd01l             TYPE dd01l.

    FIELD-SYMBOLS: &lt;filter&gt; TYPE /iwbep/s_mgw_select_option,
                   &lt;rango&gt;  TYPE any,
                   &lt;key&gt;    TYPE /iwbep/s_mgw_name_value_pair,
                   &lt;so&gt;     TYPE /iwbep/s_cod_select_option,
                   &lt;entity&gt; TYPE any,
                   &lt;valor&gt;  TYPE any.

    CLEAR: rango_01, rango_02, rango_03, rango_04, rango_05, rango_06, rango_07, rango_08, rango_09, rango_10.

    CLEAR where.
    IF entidad IS INITIAL.
      l_entidad = v_entidad.
    ELSE.
      l_entidad = entidad.
    ENDIF.

    IF NOT no_campos IS INITIAL.
      r_no_campos = zcl_ap_lista=&gt;lista2rango( lista = no_campos option = &apos;NE&apos; ).
    ENDIF.
    r_campos_mayusculas = zcl_ap_lista=&gt;lista2rango( lista = campos_mayusculas ).
    r_campos_ceros = zcl_ap_lista=&gt;lista2rango( lista = campos_ceros ).

    LOOP AT it_filter_select_options ASSIGNING &lt;filter&gt;.

      IF &lt;filter&gt;-property NOT IN r_no_campos.
        CONTINUE.
      ENDIF.

      IF &lt;filter&gt;-select_options IS INITIAL.
        CONTINUE.
      ENDIF.

      get_abap_field_data( EXPORTING entidad = l_entidad id = &lt;filter&gt;-property
                           IMPORTING datos = l_datos_abap mayusculas = l_mayusculas ceros = l_ceros ).
      IF l_datos_abap IS INITIAL.
        CONTINUE.
      ENDIF.

      IF &lt;filter&gt;-property IN r_campos_mayusculas.
        l_mayusculas = &apos;X&apos;.
      ENDIF.
      IF l_datos_abap-max_length &lt;&gt; 0 AND &lt;filter&gt;-property IN r_campos_mayusculas.
        l_ceros = l_datos_abap-max_length.
      ENDIF.
      r_rango = get_filter(      name = &lt;filter&gt;-property
                                 it_filter_select_options = it_filter_select_options
                                 mayusculas = l_mayusculas
                                 poner_ceros = l_ceros  ).

      l_campo = l_datos_abap-abap_field.
      l_cont_rangos = l_cont_rangos + 1.
      CONCATENATE &apos;RANGO_&apos; l_cont_rangos INTO l_nombre_rango.
      ASSIGN (l_nombre_rango) TO &lt;rango&gt;.
      IF sy-subrc = 0.
        where = l_clausula.
      ELSE.
        __concat3 where where &apos;AND&apos; l_clausula.
      ENDIF.
      &lt;rango&gt; = r_rango.
      CONCATENATE &apos;O_SEGW-&gt;&apos; l_nombre_rango INTO l_nombre_rango.
      CONCATENATE l_campo &apos;IN&apos; l_nombre_rango INTO l_clausula SEPARATED BY space.

      IF where IS INITIAL.
        where = l_clausula.
      ELSE.
        __concat3 where where &apos;AND&apos; l_clausula.
      ENDIF.
    ENDLOOP.

    LOOP AT it_key_tab ASSIGNING &lt;key&gt; WHERE name IN r_no_campos.
      get_abap_field_data( EXPORTING entidad = l_entidad id = &lt;key&gt;-name
                           IMPORTING datos = l_datos_abap mayusculas = l_mayusculas ceros = l_ceros ).
      IF l_datos_abap IS INITIAL.
        CONTINUE.
      ENDIF.

      IF &lt;key&gt;-name IN r_campos_mayusculas.
        l_mayusculas = &apos;X&apos;.
      ENDIF.
      IF l_datos_abap-max_length &lt;&gt; 0 AND &lt;key&gt;-name IN r_campos_mayusculas.
        l_ceros = l_datos_abap-max_length.
      ENDIF.
      l_valor = &lt;key&gt;-value.
      get_key( EXPORTING name = &lt;key&gt;-name poner_ceros = l_ceros it_key_tab = it_key_tab log = v_log mayusculas = l_mayusculas
               IMPORTING key = l_valor ).

      CONCATENATE &apos;&apos;&apos;&apos; l_valor &apos;&apos;&apos;&apos; INTO l_clausula.
      CONCATENATE l_datos_abap-abap_field &apos;=&apos; l_clausula INTO l_clausula SEPARATED BY space.

      IF where IS INITIAL.
        where = l_clausula.
      ELSE.
        __concat3 where where &apos;AND&apos; l_clausula.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="INI_METODO" VERSION="1" LANGU="S" DESCRIPT="Inicializa variables clase para el método" EXPOSURE="2" STATE="1" EDITORDER="10 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="INI_METODO" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="INI_METODO" SCONAME="METODO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD ini_metodo.
    CLEAR v_no_campos.
    v_entidad = entidad.
    v_log = metodo.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2DATOS" VERSION="1" LANGU="S" DESCRIPT="Devuelve datos de un JSON" EXPOSURE="2" STATE="1" EDITORDER="26 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2DATOS" SCONAME="JSON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2DATOS" SCONAME="REMOVE_METADATA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2DATOS" SCONAME="DATE_FORMAT" VERSION="1" LANGU="S" DESCRIPT="Campo de texto, longitud 10" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="CHAR10" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2DATOS" SCONAME="DATOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2DATOS" SCONAME="MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD json2datos.
    DATA: l_json      TYPE string,
          json_doc    TYPE REF TO zcl_json_document,
          l_excepcion TYPE REF TO zcx_json_document.

    CLEAR: datos, message.

    IF json IS INITIAL.
      message = &apos;JSON vacío&apos;.
      RETURN.
    ENDIF.

    l_json = json.
    descomprimir_json( CHANGING json = l_json ).

    IF remove_metadata = &apos;X&apos;.
      REPLACE ALL OCCURRENCES OF &apos;{&quot;__metadata&quot;:&apos; IN l_json WITH &apos;{&apos;.
    ENDIF.

    json_doc = zcl_json_document=&gt;create_with_json( json = l_json date_format = date_format ).
    TRY.
        json_doc-&gt;get_data( IMPORTING  data = datos ).
      CATCH zcx_json_document INTO l_excepcion.
        message = l_excepcion-&gt;get_longtext( ).
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2TABLA" VERSION="1" LANGU="S" DESCRIPT="Recupera tabla desde un JSON" EXPOSURE="2" STATE="1" EDITORDER="27 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2TABLA" SCONAME="JSON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2TABLA" SCONAME="REMOVE_METADATA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2TABLA" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON2TABLA" SCONAME="MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD json2tabla.
    DATA: l_json      TYPE string,
          json_doc    TYPE REF TO zcl_json_document,
          l_excepcion TYPE REF TO zcx_json_document.

    CLEAR: tabla, message.

    IF json IS INITIAL.
      message = &apos;JSON vacío&apos;.
      RETURN.
    ENDIF.

    l_json = json.
    descomprimir_json( CHANGING json = l_json ).

    IF remove_metadata = &apos;X&apos;.
      REPLACE ALL OCCURRENCES OF &apos;{&quot;__metadata&quot;:&apos; IN l_json WITH &apos;{&apos;.
    ENDIF.

    json_doc = zcl_json_document=&gt;create_with_json( json = l_json ).

    TRY.
        json_doc-&gt;get_data( IMPORTING  data = tabla ).
      CATCH zcx_json_document INTO l_excepcion.
        message = l_excepcion-&gt;get_longtext( ).
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON_FORMAT_TAGS" VERSION="1" LANGU="S" DESCRIPT="Formatea TAGS JSON" EXPOSURE="2" STATE="1" EDITORDER="36 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON_FORMAT_TAGS" SCONAME="CAMEL_CASE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON_FORMAT_TAGS" SCONAME="PARES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON_FORMAT_TAGS" SCONAME="CONV_APC" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="JSON_FORMAT_TAGS" SCONAME="JSON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD json_format_tags.
    &quot; TODO: parameter CAMEL_CASE is never used (ABAP cleaner)
    &quot; TODO: parameter CONV_APC is never used (ABAP cleaner)

    DATA: orig TYPE string,
          dest TYPE string.

    SPLIT pares AT &apos;,&apos; INTO TABLE DATA(i_pares).
    LOOP AT i_pares ASSIGNING FIELD-SYMBOL(&lt;pares&gt;).
      IF &lt;pares&gt; CS &apos;|&apos;.
        SPLIT &lt;pares&gt; AT &apos;|&apos; INTO orig dest.
        CONCATENATE &apos;&quot;&apos; orig &apos;&quot;&apos; INTO orig.
        CONCATENATE &apos;&quot;&apos; dest &apos;&quot;&apos; INTO dest.
        REPLACE ALL OCCURRENCES OF orig IN json WITH dest.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="KEY_2_RANGO" VERSION="1" LANGU="S" DESCRIPT="Convierte campo simple en rango string" EXPOSURE="2" STATE="1" EDITORDER="11 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="KEY_2_RANGO" SCONAME="KEY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="KEY_2_RANGO" SCONAME="OPTION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;EQ&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="KEY_2_RANGO" SCONAME="SIGN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;I&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="KEY_2_RANGO" SCONAME="RANGO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="/IWBEP/T_COD_SELECT_OPTIONS"/>
  <source>METHOD key_2_rango.
    DATA l_rango TYPE /iwbep/s_cod_select_option.

    CLEAR l_rango.
    l_rango-option = option.
    l_rango-sign   = sign.
    l_rango-low    = key.
    APPEND l_rango TO rango.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="LOG_PETICION" VERSION="1" LANGU="S" DESCRIPT="Log peticion bruta" EXPOSURE="2" STATE="1" EDITORDER="22 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="LOG_PETICION" SCONAME="REQUEST" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="LOG_PETICION" SCONAME="EV_ENTITY_DATA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="XSTRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="LOG_PETICION" SCONAME="EV_MODEL_ID" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/MED_MODEL_IDENTIFIER" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="LOG_PETICION" SCONAME="EV_LANGUAGE" VERSION="1" LANGU="S" DESCRIPT="Clave de idioma" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="SYLANGU" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="LOG_PETICION" SCONAME="ET_TEXT_KEYS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/IF_MGW_MED_ODATA_TYPES=&gt;TY_T_MED_TEXTS" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="LOG_PETICION" SCONAME="EV_VOCAB_ID" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/MED_VOCAB_ID" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="LOG_PETICION" SCONAME="EV_VERSION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/MED_VOCAB_VERSION" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="LOG_PETICION" SCONAME="ES_REQUEST_CONTEXT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/IF_MGW_CORE_SRV_RUNTIME=&gt;TY_S_MGW_REQUEST_CONTEXT" PAROPTIONL="X"/>
  <source>METHOD log_peticion.
    &quot; TODO: parameter EV_ENTITY_DATA is never used or assigned (ABAP cleaner)
    &quot; TODO: parameter EV_MODEL_ID is never used or assigned (ABAP cleaner)
    &quot; TODO: parameter EV_LANGUAGE is never used or assigned (ABAP cleaner)
    &quot; TODO: parameter ET_TEXT_KEYS is never used or assigned (ABAP cleaner)
    &quot; TODO: parameter EV_VOCAB_ID is never used or assigned (ABAP cleaner)
    &quot; TODO: parameter EV_VERSION is never used or assigned (ABAP cleaner)
    &quot; TODO: parameter ES_REQUEST_CONTEXT is never used or assigned (ABAP cleaner)

    &quot; TODO: variable is assigned but never used (ABAP cleaner)
    DATA l_string TYPE string.

    l_string = zcl_ap_string=&gt;xstring2string( request ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="LOG_PROCESS" VERSION="1" LANGU="S" DESCRIPT="Log process" EXPOSURE="2" STATE="1" EDITORDER="19 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD log_process.
*  /IWCOR/CL_DS_PROC_DISPATCHER-&gt;/IWCOR/IF_DS_PROCESSOR~PROCESS
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="NO_CACHE" VERSION="1" LANGU="S" DESCRIPT="No cache" EXPOSURE="2" STATE="1" EDITORDER="24 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="NO_CACHE" SCONAME="ODATA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="/IWBEP/CL_MGW_PUSH_ABS_DATA"/>
  <source>METHOD no_cache.
    DATA ls_header TYPE ihttpnvp.

    ls_header-name  = &apos;Cache-Control&apos; ##NO_TEXT.
    ls_header-value = &apos;no-cache, no-store&apos; ##NO_TEXT.
    odata-&gt;set_header( ls_header ).
    ls_header-name  = &apos;Pragma&apos; ##NO_TEXT.
    ls_header-value = &apos;no-cache&apos; ##NO_TEXT.
    odata-&gt;set_header( ls_header ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="POPUP_JSON" VERSION="1" LANGU="S" DESCRIPT="Muestra un popup con el contenido del JSON" EXPOSURE="2" STATE="1" EDITORDER="37 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="POPUP_JSON" SCONAME="JSON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD popup_json.
    CALL TRANSFORMATION sjson2html SOURCE XML json
         RESULT XML DATA(lvc_html).
    cl_abap_browser=&gt;show_html( title = &apos;JSON&apos; html_string = cl_abap_codepage=&gt;convert_from( lvc_html ) ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Lanza mensaje" EXPOSURE="2" STATE="1" EDITORDER="23 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" MTDNEWEXC="X" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="IV_MSG_NUMBER" VERSION="1" LANGU="S" DESCRIPT="Número de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SYMSGNO" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="IV_MSG_TYPE" VERSION="1" LANGU="S" DESCRIPT="Tipo de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SYMSGTY" PARVALUE="&apos;E&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="IV_MSG_V1" VERSION="1" LANGU="S" DESCRIPT="Variable de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SYMSGV" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="IV_MSG_V2" VERSION="1" LANGU="S" DESCRIPT="Variable de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SYMSGV" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="IV_MSG_V3" VERSION="1" LANGU="S" DESCRIPT="Variable de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SYMSGV" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="IV_MSG_V4" VERSION="1" LANGU="S" DESCRIPT="Variable de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SYMSGV" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="IV_MSG_ID" VERSION="1" LANGU="S" DESCRIPT="Clase de mensajes" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SYMSGID" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="IO_CONTEXT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="/IWBEP/IF_MGW_CONTEXT" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="TEXTID" VERSION="1" LANGU="S" DESCRIPT="Clave T100 c/representación de parámetros en nombre atributo" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SCX_T100KEY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="CX_ROOT" VERSION="1" LANGU="S" DESCRIPT="Abstract Superclass for All Global Exceptions" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="CX_ROOT" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="BAPIRETURN" VERSION="1" LANGU="S" DESCRIPT="Tabla con informaciones de retorno BAPI" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPIRETTAB" PAROPTIONL="X"/>
  <exception CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="/IWBEP/CX_MGW_BUSI_EXCEPTION" VERSION="1" LANGU="S" DESCRIPT="Business Exception" MTDTYPE="0" EDITORDER="1 "/>
  <exception CLSNAME="ZCL_AP_SEGW" CMPNAME="RAISE_MESSAGE" SCONAME="/IWBEP/CX_MGW_TECH_EXCEPTION" VERSION="1" LANGU="S" DESCRIPT="Technical Exception" MTDTYPE="0" EDITORDER="2 "/>
  <source>METHOD raise_message.
    IF NOT io_context IS INITIAL.
      DATA(lo_message_container) = io_context-&gt;get_message_container( ).

      IF NOT bapireturn IS INITIAL.
        lo_message_container-&gt;add_messages_from_bapi( it_bapi_messages = bapireturn
                                                         iv_determine_leading_msg = /iwbep/if_message_container=&gt;gcs_leading_msg_search_option-first ).

      ELSEIF NOT iv_msg_number IS INITIAL.
        lo_message_container-&gt;add_message(
           iv_msg_id      = iv_msg_id
           iv_msg_number  = iv_msg_number
           iv_msg_type    = iv_msg_type
           iv_msg_v1      = iv_msg_v1
           iv_msg_v2      = iv_msg_v2
           iv_msg_v3      = iv_msg_v3
           iv_msg_v4      = iv_msg_v4
           iv_add_to_response_header = abap_true ).

      ELSEIF NOT message IS INITIAL.
        lo_message_container-&gt;add_message_text_only( iv_msg_type = iv_msg_type iv_msg_text = |{ message }| ).
      ELSEIF NOT cx_root IS INITIAL.
        DATA(l_string) = cx_root-&gt;get_text( ).
        lo_message_container-&gt;add_message_text_only( iv_msg_type = iv_msg_type iv_msg_text = |{ l_string }| ).
      ENDIF.
      RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception
        EXPORTING
          message_container = lo_message_container.
    ELSE.
      IF NOT textid IS INITIAL.
        RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception
          EXPORTING
            textid  = textid
            message = |{ message }|.
      ELSEIF NOT iv_msg_number IS INITIAL.
        DATA(lv_message) = VALUE scx_t100key( msgid = iv_msg_id
                                              msgno = iv_msg_number
                                              attr1 = iv_msg_v1
                                              attr2 = iv_msg_v2
                                              attr3 = iv_msg_v3
                                              attr4 = iv_msg_v4 ).

        RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception
          EXPORTING
            textid = lv_message.
      ELSEIF NOT cx_root IS INITIAL.
        RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception
          EXPORTING
            textid  = /iwbep/cx_mgw_busi_exception=&gt;business_error
            message = |{ cx_root-&gt;get_text( ) }|.
      ELSEIF NOT message IS INITIAL.
*      lv_message = VALUE scx_t100key( msgid = &apos;00&apos;
*                                      msgno = &apos;398&apos;
*                                      attr1 = iv_msg_v1
*                                                  attr2 = iv_msg_v2
*                                                  attr3 = iv_msg_v3
*                                                  attr4 = iv_msg_v4 ).

        RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception
          EXPORTING
            textid  = /iwbep/cx_mgw_busi_exception=&gt;business_error
            message = |{ message }|.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_FILTER_STR" VERSION="1" LANGU="S" DESCRIPT="Convierte filter_str to" EXPOSURE="2" STATE="1" EDITORDER="21 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_FILTER_STR" SCONAME="IV_FILTER_STRING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_FILTER_STR" SCONAME="IT_FILTER_SELECT_OPTIONS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="/IWBEP/T_MGW_SELECT_OPTION"/>
  <source>METHOD set_filter_str.
    DATA:
      lt_filter_select_options TYPE TABLE OF /iwbep/s_mgw_select_option,
      lt_key_value             TYPE /iwbep/t_mgw_name_value_pair,
      lv_input                 TYPE string,
      lt_filter_string         TYPE TABLE OF string,
      ls_filter_string         TYPE string,
      ls_select_options        TYPE /iwbep/s_cod_select_option,
      ls_filter_select_options TYPE /iwbep/s_mgw_select_option,
      lt_select_options        TYPE /iwbep/t_cod_select_options,
      lv_name                  TYPE string,
      lv_sign                  TYPE string,
      lv_value                 TYPE string.
    DATA: count      TYPE i VALUE 1,
          ls_temp    LIKE ls_filter_select_options,
          countplus  TYPE i,
          ls_sel_op  LIKE ls_select_options,
          lt_temp_op LIKE lt_select_options,
          ls_temp_op LIKE ls_select_options,
          lt_sel_op  LIKE lt_select_options,
          ls_results LIKE ls_filter_select_options,
          lt_results LIKE lt_filter_select_options.

    FIELD-SYMBOLS:
      &quot; TODO: variable is assigned but never used (ABAP cleaner)
      &lt;fs_key_value&gt;     LIKE LINE OF lt_key_value,
      &lt;fs_range_tab&gt;     LIKE LINE OF lt_filter_select_options,
      &lt;fs_select_option&gt; TYPE /iwbep/s_cod_select_option.

*******************************************************************************
    IF iv_filter_string IS NOT INITIAL.
      lv_input = iv_filter_string.

* *— get rid of )( &amp; &apos; and make AND&apos;s uppercase
      REPLACE ALL OCCURRENCES OF &apos;)&apos; IN lv_input WITH &apos;&apos;.
      REPLACE ALL OCCURRENCES OF &apos;(&apos; IN lv_input WITH &apos;&apos;.
      REPLACE ALL OCCURRENCES OF `&apos;` IN lv_input WITH &apos;&apos;.
      REPLACE ALL OCCURRENCES OF &apos; OR &apos; IN lv_input WITH &apos; AND &apos;. &quot;?
      REPLACE ALL OCCURRENCES OF &apos; or &apos; IN lv_input WITH &apos; AND &apos;. &quot;?
      REPLACE ALL OCCURRENCES OF &apos; and &apos; IN lv_input WITH &apos; AND &apos;.
      REPLACE ALL OCCURRENCES OF &apos; eq &apos; IN lv_input WITH &apos; EQ &apos;.
      SPLIT lv_input AT ` AND ` INTO TABLE lt_filter_string.

* *— build a table of key value pairs based on filter string
      LOOP AT lt_filter_string INTO ls_filter_string.
        CLEAR: ls_select_options, ls_filter_select_options, lt_select_options.
        APPEND INITIAL LINE TO lt_key_value ASSIGNING &lt;fs_key_value&gt;.

        CONDENSE ls_filter_string.
*       Split at space, then split into 3 parts
        SPLIT ls_filter_string AT &apos; &apos; INTO lv_name lv_sign lv_value.
        lv_sign = to_upper( lv_sign ).
        ls_select_options-sign   = &apos;I&apos;.
        ls_select_options-option = lv_sign.
        ls_select_options-low    = lv_value.
        APPEND ls_select_options TO lt_select_options.
        ls_filter_select_options-property       = lv_name.
        ls_filter_select_options-select_options = lt_select_options.

        APPEND ls_filter_select_options TO lt_filter_select_options.
        CLEAR ls_filter_select_options.
      ENDLOOP.
      CLEAR: ls_select_options, ls_filter_select_options, lt_select_options.
    ENDIF.

*  Loop through the select options, look for two with the same property name, if it exists, copy into one!
    SORT lt_filter_select_options ASCENDING BY property.

    READ TABLE lt_filter_select_options INTO ls_filter_select_options INDEX count.
    WHILE sy-tabix &lt;&gt; 0.
      ls_temp = ls_filter_select_options.
      countplus = count + 1.
      READ TABLE lt_filter_select_options INTO ls_filter_select_options INDEX countplus.
      IF sy-tabix &lt;&gt; 0.
        IF ls_temp-property = ls_filter_select_options-property.
          ls_sel_op-sign   = &apos;I&apos;.
          ls_sel_op-option = &apos;EQ&apos;.
          lt_temp_op = ls_temp-select_options.
          lt_select_options = ls_filter_select_options-select_options.
          READ TABLE lt_temp_op INTO ls_temp_op INDEX 1.
          IF ls_temp_op-option = &apos;GE&apos; OR ls_temp_op-option = &apos;GE&apos;.
            ls_sel_op-low = ls_temp_op-low.
            READ TABLE lt_select_options INTO ls_select_options INDEX 1.
            ls_sel_op-high = ls_select_options-low.
          ELSE.
            ls_sel_op-high = ls_temp_op-low.
            READ TABLE lt_select_options INTO ls_select_options INDEX 1.
            ls_sel_op-low = ls_select_options-low.
          ENDIF.
          APPEND ls_sel_op TO lt_sel_op.

          ls_results-property       = ls_temp-property.
          ls_results-select_options = lt_sel_op.
          APPEND ls_results TO lt_results.
          count = count + 2.
        ELSE.
          APPEND ls_temp TO lt_results.
          count = count + 1.
        ENDIF.
      ELSE.
        APPEND ls_temp TO lt_results.
        EXIT.
      ENDIF.

      CLEAR: ls_temp, lt_temp_op[], ls_temp_op, lt_sel_op[], ls_sel_op, ls_results, ls_filter_select_options.
      READ TABLE lt_filter_select_options INTO ls_filter_select_options INDEX count.
    ENDWHILE.

*?
    LOOP AT lt_results ASSIGNING &lt;fs_range_tab&gt;.
      LOOP AT &lt;fs_range_tab&gt;-select_options ASSIGNING &lt;fs_select_option&gt; WHERE option = &apos;EQ&apos; AND high &lt;&gt; &apos;&apos;.
        IF &lt;fs_select_option&gt;-high &gt; &lt;fs_select_option&gt;-low.
          &lt;fs_select_option&gt;-option = &apos;BT&apos;.
        ENDIF.
      ENDLOOP.
    ENDLOOP.

    it_filter_select_options = lt_results.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" VERSION="1" LANGU="S" DESCRIPT="Obtiene datos desde un JSON" EXPOSURE="2" STATE="1" EDITORDER="40 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="STD" VERSION="1" LANGU="S" DESCRIPT="Usar clase estándar" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="COMPRESS" VERSION="1" LANGU="S" DESCRIPT="No genera elementos vacíos" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="PRETTY_NAME" VERSION="1" LANGU="S" DESCRIPT="Tipo PrettyPrint" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/UI2/CL_JSON=&gt;PRETTY_NAME_MODE" PARVALUE="/UI2/CL_JSON=&gt;PRETTY_MODE-CAMEL_CASE"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="CONVERSION_EXITS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="NAME_MAPPINGS" VERSION="1" LANGU="S" DESCRIPT="ABAP&lt;-&gt;JSON Name Mapping Table" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="/UI2/CL_JSON=&gt;NAME_MAPPINGS" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="PROYECTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="ENTIDAD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="NUMC_AS_STRING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="JSON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="DATOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_JSON" SCONAME="MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD set_json.
    &quot; TODO: parameter STD is never used (ABAP cleaner)
    &quot; TODO: parameter COMPRESS is never used (ABAP cleaner)
    &quot; TODO: parameter CONVERSION_EXITS is never used (ABAP cleaner)
    &quot; TODO: parameter NUMC_AS_STRING is never used (ABAP cleaner)

    CLEAR: datos, message.

    TRY.
        IF NOT proyecto IS INITIAL AND NOT entidad IS INITIAL.
          DATA(l_name_mappings) = get_name_mappings( proyecto = proyecto entidad = entidad ).
        ENDIF.
        LOOP AT name_mappings ASSIGNING FIELD-SYMBOL(&lt;nm&gt;).
          INSERT &lt;nm&gt; INTO TABLE l_name_mappings.
        ENDLOOP.

        /ui2/cl_json=&gt;deserialize( EXPORTING json = json
                                             pretty_name = pretty_name
*                                           conversion_exits = conversion_exits
                                             name_mappings = l_name_mappings
                                   CHANGING  data = datos ).

      CATCH cx_root INTO DATA(l_excepcion).
        message = l_excepcion-&gt;get_longtext( ).
        IF message IS INITIAL.
          message = l_excepcion-&gt;get_text( ).
        ENDIF.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" VERSION="1" LANGU="S" DESCRIPT="Graba entrada en log" EXPOSURE="2" STATE="1" EDITORDER="3 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="LOG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="TYPE" VERSION="1" LANGU="S" DESCRIPT="Clase de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="MSGTY" PARVALUE="&apos;E&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="P1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="P2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="P3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="P4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="P5" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="P6" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="P7" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="P8" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="P9" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="ERROR_RFC" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="/IWBEP/CL_MGW_PUSH_ABS_DATA" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="MSGV1" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Variable de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="13 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-MSGV1" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="MSGV2" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Variable de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="14 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-MSGV2" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="MSGV3" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Variable de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="15 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-MSGV3" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="MSGV4" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Variable de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="16 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-MSGV4" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="SET_LOG" SCONAME="MESSAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="17 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD set_log.
    &quot; TODO: parameter ERROR_RFC is only used in commented-out code (ABAP cleaner)

    DATA: l_log    TYPE string,
          l_string TYPE string.

    IF log IS INITIAL.
      l_log = v_log.
    ELSE.
      l_log = log.
    ENDIF.

    IF ( type = &apos;E&apos; AND grabar_solo_errores = &apos;X&apos; ) OR grabar_todo = &apos;X&apos;.
      l_string = p1.
      IF grabar_filtros_no IS INITIAL AND ( l_string = &apos;No existe filtro por&apos; OR l_string = &apos;No existe clave&apos; ) AND type = &apos;W&apos;.
        EXIT.
      ENDIF.
      message = zcl_ap_utils=&gt;concat( p1 = p1 p2 = p2 p3 = p3 p4 = p4 p5 = p5 p6 = p6 p7 = p7 p8 = p8 p9 = p9  ).
      zcl_ap_log=&gt;set_log( proceso = &apos;ODATA&apos; progname = nombre_odata clave = l_log msgty = type message = message
                           msgv1 = msgv1 msgv2 = msgv2 msgv3 = msgv3 msgv4 = msgv4 ).
    ENDIF.

*  IF NOT error_rfc IS INITIAL.
*    error_rfc-&gt;/iwbep/if_sb_dpc_comm_services~rfc_exception_handling(
*      EXPORTING
*        iv_subrc            = &apos;4&apos;
*        iv_exp_message_text = l_string ).
*  ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_SEGW" CMPNAME="TABLA2JSON" VERSION="1" LANGU="S" DESCRIPT="Crea JSON desde tabla" EXPOSURE="2" STATE="1" EDITORDER="28 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="TABLA2JSON" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="TABLA2JSON" SCONAME="JSON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_SEGW" CMPNAME="TABLA2JSON" SCONAME="MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD tabla2json.
    DATA: json_doc    TYPE REF TO zcl_json_document,
          l_excepcion TYPE REF TO cx_root.

    CLEAR: json, message.

    json_doc = zcl_json_document=&gt;create_with_data( data = tabla suppress_itab = &apos;X&apos; ).

    TRY.
        json = json_doc-&gt;get_json( ).
      CATCH cx_root INTO l_excepcion.
        message = l_excepcion-&gt;get_longtext( ).
    ENDTRY.
  ENDMETHOD.</source>
 </method>
</CLAS>
