<?xml version="1.0" encoding="utf-8"?>
<CLAS CLSNAME="ZCL_AP_ALV" VERSION="1" LANGU="S" DESCRIPT="ALV" CATEGORY="00" EXPOSURE="2" STATE="1" RELEASE="0" CLSCCINCL="X" FIXPT="X" UNICODE="X" CLSBCCAT="00" DURATION_TYPE="0 " RISK_LEVEL="0 ">
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="T_ALLOWED_BUT" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="1 " TYPTYPE="4" SRCROW1="5 " SRCCOLUMN1="6 " SRCROW2="7 " SRCCOLUMN2="25 " TYPESRC_LENG="86 " TYPESRC="BEGIN OF t_allowed_but,
        function TYPE sy-ucomm,
      END OF t_allowed_but
"/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="TT_EXCLUDED_BUT" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="2 " TYPTYPE="4" SRCROW1="8 " SRCCOLUMN1="10 " SRCROW2="8 " SRCCOLUMN2="56 " TYPESRC_LENG="49 " TYPESRC="tt_excluded_but TYPE STANDARD TABLE OF sy-ucomm
"/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="TT_ALLOWED_BUT" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="3 " TYPTYPE="4" SRCROW1="9 " SRCCOLUMN1="10 " SRCROW2="9 " SRCCOLUMN2="61 " TYPESRC_LENG="54 " TYPESRC="tt_allowed_but  TYPE STANDARD TABLE OF t_allowed_but
"/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="T_TOP_OF_PAGE" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="1 " TYPTYPE="4" SRCROW1="7 " SRCCOLUMN1="6 " SRCROW2="15 " SRCCOLUMN2="25 " TYPESRC_LENG="297 " TYPESRC='BEGIN OF t_top_of_page,
        tipo     TYPE char1, &quot;(P)arametro/(R)ango
        param    TYPE string,
        texto    TYPE string,
        tabla    TYPE tabname,
        campo    TYPE fieldname,
        no_ceros TYPE abap_bool,
        valor    TYPE string,
      END OF t_top_of_page
'/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="TT_TOP_OF_PAGE" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="2 " TYPTYPE="4" SRCROW1="16 " SRCCOLUMN1="10 " SRCROW2="16 " SRCCOLUMN2="60 " TYPESRC_LENG="53 " TYPESRC="tt_top_of_page TYPE STANDARD TABLE OF t_top_of_page
"/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="T_ORDEN" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="3 " TYPTYPE="4" SRCROW1="18 " SRCCOLUMN1="6 " SRCROW2="21 " SRCCOLUMN2="19 " TYPESRC_LENG="95 " TYPESRC="BEGIN OF t_orden,
        name  TYPE lvc_fname,
        order TYPE i,
      END OF t_orden
"/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="TT_ORDEN" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="4 " TYPTYPE="4" SRCROW1="22 " SRCCOLUMN1="10 " SRCROW2="22 " SRCCOLUMN2="39 " TYPESRC_LENG="32 " TYPESRC="tt_orden TYPE TABLE OF t_orden
"/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="T_BOTON" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="5 " TYPTYPE="4" SRCROW1="23 " SRCCOLUMN1="11 " SRCROW2="27 " SRCCOLUMN2="24 " TYPESRC_LENG="158 " TYPESRC="BEGIN OF t_boton,
             boton TYPE c LENGTH 10.
             INCLUDE TYPE smp_dyntxt.
    TYPES:   ucomm TYPE sy-ucomm,
           END OF t_boton
"/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="T_HOTSPOT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="6 " TYPTYPE="4" SRCROW1="29 " SRCCOLUMN1="6 " SRCROW2="34 " SRCCOLUMN2="21 " TYPESRC_LENG="187 " TYPESRC="BEGIN OF t_hotspot,
        campo       TYPE fieldname,
        campo_ref   TYPE fieldname,
        transaccion TYPE string,
        filtro      TYPE string,
      END OF t_hotspot
"/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="TT_HOTSPOT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="7 " TYPTYPE="4" SRCROW1="35 " SRCCOLUMN1="10 " SRCROW2="35 " SRCCOLUMN2="43 " TYPESRC_LENG="36 " TYPESRC="tt_hotspot TYPE TABLE OF t_hotspot
"/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="T_BOTONES" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="8 " TYPTYPE="4" SRCROW1="36 " SRCCOLUMN1="10 " SRCROW2="36 " SRCCOLUMN2="41 " TYPESRC_LENG="34 " TYPESRC="t_botones  TYPE TABLE OF t_boton
"/>
 <types CLSNAME="ZCL_AP_ALV" CMPNAME="T_BUTTONS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="9 " TYPTYPE="4" SRCROW1="38 " SRCCOLUMN1="6 " SRCROW2="88 " SRCCOLUMN2="21 " TYPESRC_LENG="1515 " TYPESRC="BEGIN OF t_buttons,
        f01 TYPE rsfunc_txt,
        f02 TYPE rsfunc_txt,
        f03 TYPE rsfunc_txt,
        f04 TYPE rsfunc_txt,
        f05 TYPE rsfunc_txt,
        f06 TYPE rsfunc_txt,
        f07 TYPE rsfunc_txt,
        f08 TYPE rsfunc_txt,
        f09 TYPE rsfunc_txt,
        f10 TYPE rsfunc_txt,
        f11 TYPE rsfunc_txt,
        f12 TYPE rsfunc_txt,
        f13 TYPE rsfunc_txt,
        f14 TYPE rsfunc_txt,
        f15 TYPE rsfunc_txt,
        f16 TYPE rsfunc_txt,
        f17 TYPE rsfunc_txt,
        f18 TYPE rsfunc_txt,
        f19 TYPE rsfunc_txt,
        f20 TYPE rsfunc_txt,
        f21 TYPE rsfunc_txt,
        f22 TYPE rsfunc_txt,
        f23 TYPE rsfunc_txt,
        f24 TYPE rsfunc_txt,
        f25 TYPE rsfunc_txt,
        f26 TYPE rsfunc_txt,
        f27 TYPE rsfunc_txt,
        f28 TYPE rsfunc_txt,
        f29 TYPE rsfunc_txt,
        f30 TYPE rsfunc_txt,
        f31 TYPE rsfunc_txt,
        f32 TYPE rsfunc_txt,
        f33 TYPE rsfunc_txt,
        f34 TYPE rsfunc_txt,
        f35 TYPE rsfunc_txt,
        m01 TYPE rsfunc_txt,
        m02 TYPE rsfunc_txt,
        m03 TYPE rsfunc_txt,
        m04 TYPE rsfunc_txt,
        m05 TYPE rsfunc_txt,
        m06 TYPE rsfunc_txt,
        m07 TYPE rsfunc_txt,
        m08 TYPE rsfunc_txt,
        m09 TYPE rsfunc_txt,
        m10 TYPE rsfunc_txt,
        m11 TYPE rsfunc_txt,
        m12 TYPE rsfunc_txt,
        m13 TYPE rsfunc_txt,
        m14 TYPE rsfunc_txt,
      END OF t_buttons
"/>
 <localImplementation>*&quot;* local class implementation for public class
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</localImplementation>
 <localTypes>*&quot;* use this source file for any type declarations (class
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</localTypes>
 <localMacros>*&quot;* use this source file for any macro definitions you need
*&quot;* in the implementation part of the class</localMacros>
 <textPool>
  <language SPRAS="S">
   <textElement ID="I" KEY="ADN" ENTRY="ALV display not possible" LENGTH="48 "/>
   <textElement ID="I" KEY="CAM" ENTRY="Campo" LENGTH="15 "/>
   <textElement ID="I" KEY="EDC" ENTRY="Error in the Docking control" LENGTH="56 "/>
   <textElement ID="I" KEY="EGX" ENTRY="Error guardando XLSX" LENGTH="40 "/>
   <textElement ID="I" KEY="ENO" ENTRY="Error no existe ALV en orden campo" LENGTH="68 "/>
   <textElement ID="I" KEY="EOC" ENTRY="Error ALV en orden campo" LENGTH="48 "/>
   <textElement ID="I" KEY="ESF" ENTRY="Error en SET_FIELD OP=" LENGTH="44 "/>
   <textElement ID="I" KEY="NOD" ENTRY="no definida" LENGTH="21 "/>
   <textElement ID="I" KEY="NOE" ENTRY="no existe" LENGTH="19 "/>
   <textElement ID="I" KEY="NRE" ENTRY="Nº Registros" LENGTH="22 "/>
   <textElement ID="I" KEY="TAB" ENTRY="La tabla" LENGTH="18 "/>
   <textElement ID="I" KEY="TRA" ENTRY="Transacción:" LENGTH="22 "/>
  </language>
 </textPool>
 <typeUsage CLSNAME="ZCL_AP_ALV" TYPEGROUP="ABAP" VERSION="1" TPUTYPE="0" IMPLICIT="X"/>
 <typeUsage CLSNAME="ZCL_AP_ALV" TYPEGROUP="KKBLO" VERSION="1" TPUTYPE="0" IMPLICIT="X"/>
 <forwardDeclaration>ABAP</forwardDeclaration>
 <forwardDeclaration>KKBLO</forwardDeclaration>
 <typeIntfDef CLSNAME="ZCL_AP_ALV" TYPEGROUP="IF_SALV_BS_XML" VERSION="1" TPUTYPE="2" IMPLICIT="X"/>
 <typeIntfDef CLSNAME="ZCL_AP_ALV" TYPEGROUP="IF_SALV_C_LAYOUT" VERSION="1" TPUTYPE="2" IMPLICIT="X"/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="ACCION_EJECUTADA" VERSION="1" LANGU="S" EXPOSURE="1" STATE="1" EDITORDER="4 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="ALLOWED_BUTTONS" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="7 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TT_ALLOWED_BUT" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="BUTTONS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="51 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="T_BUTTONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="BUTTONS_V0" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="58 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="T_BUTTONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="CAMPO_CHECK" VERSION="1" LANGU="S" DESCRIPT="Nombre del campo check" EXPOSURE="2" STATE="1" EDITORDER="12 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="FIELDNAME" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="CAMPO_COLOR" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="5 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="CHECK_UCOMM_SEL" VERSION="1" LANGU="S" EXPOSURE="1" STATE="1" EDITORDER="5 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_COLOR_AMARILLO" VERSION="1" LANGU="S" DESCRIPT="Color Amarillo" EXPOSURE="2" STATE="1" EDITORDER="17 " ATTDECLTYP="2" ATTVALUE="3" ATTEXPVIRT="0" TYPTYPE="1" TYPE="I" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_COLOR_AMARILLO_OSC" VERSION="1" LANGU="S" DESCRIPT="Color Amarillo Oscuro" EXPOSURE="2" STATE="1" EDITORDER="22 " ATTDECLTYP="2" ATTVALUE="4" ATTEXPVIRT="0" TYPTYPE="1" TYPE="I" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_COLOR_AZUL" VERSION="1" LANGU="S" DESCRIPT="Color Azul" EXPOSURE="2" STATE="1" EDITORDER="18 " ATTDECLTYP="2" ATTVALUE="1" ATTEXPVIRT="0" TYPTYPE="1" TYPE="I" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_COLOR_BLANCO" VERSION="1" LANGU="S" DESCRIPT="Color blanco" EXPOSURE="2" STATE="1" EDITORDER="31 " ATTDECLTYP="2" ATTVALUE="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="I" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_COLOR_GRIS" VERSION="1" LANGU="S" DESCRIPT="Color Gris" EXPOSURE="2" STATE="1" EDITORDER="21 " ATTDECLTYP="2" ATTVALUE="2" ATTEXPVIRT="0" TYPTYPE="1" TYPE="I" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_COLOR_NARANJA" VERSION="1" LANGU="S" DESCRIPT="Color Naranja" EXPOSURE="2" STATE="1" EDITORDER="19 " ATTDECLTYP="2" ATTVALUE="7" ATTEXPVIRT="0" TYPTYPE="1" TYPE="I" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_COLOR_ROJO" VERSION="1" LANGU="S" DESCRIPT="Color Rojo" EXPOSURE="2" STATE="1" EDITORDER="15 " ATTDECLTYP="2" ATTVALUE="6" ATTEXPVIRT="0" TYPTYPE="1" TYPE="I" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_COLOR_VERDE" VERSION="1" LANGU="S" DESCRIPT="Color Azul claro" EXPOSURE="2" STATE="1" EDITORDER="20 " ATTDECLTYP="2" ATTVALUE="5" ATTEXPVIRT="0" TYPTYPE="1" TYPE="I" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_ABIERTO" VERSION="1" LANGU="S" DESCRIPT="Abierto" EXPOSURE="2" STATE="1" EDITORDER="48 " ATTDECLTYP="2" ATTVALUE="ICON_UNLOCKED" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_AMBAR" VERSION="1" LANGU="S" DESCRIPT="Semáforo ambar" EXPOSURE="2" STATE="1" EDITORDER="36 " ATTDECLTYP="2" ATTVALUE="ICON_YELLOW_LIGHT" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_AMBAR_SIMPLE" VERSION="1" LANGU="S" DESCRIPT="Semáforo ambar" EXPOSURE="2" STATE="1" EDITORDER="41 " ATTDECLTYP="2" ATTVALUE="ICON_LED_YELLOW" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_BLOQUEO" VERSION="1" LANGU="S" DESCRIPT="Bloqueo" EXPOSURE="2" STATE="1" EDITORDER="39 " ATTDECLTYP="2" ATTVALUE="ICON_LOCKED" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_CERRADO" VERSION="1" LANGU="S" DESCRIPT="Cerrado" EXPOSURE="2" STATE="1" EDITORDER="47 " ATTDECLTYP="2" ATTVALUE="ICON_LOCKED" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_CHECK_FALLO" VERSION="1" LANGU="S" DESCRIPT="Check fallo" EXPOSURE="2" STATE="1" EDITORDER="45 " ATTDECLTYP="2" ATTVALUE="ICON_FAILURE" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_CHECK_KO" VERSION="1" LANGU="S" DESCRIPT="Check OK" EXPOSURE="2" STATE="1" EDITORDER="44 " ATTDECLTYP="2" ATTVALUE="ICON_INCOMPLETE" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_CHECK_OK" VERSION="1" LANGU="S" DESCRIPT="Check OK" EXPOSURE="2" STATE="1" EDITORDER="43 " ATTDECLTYP="2" ATTVALUE="ICON_CHECKED" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_DUMMY" VERSION="1" LANGU="S" DESCRIPT="Dummy" EXPOSURE="2" STATE="1" EDITORDER="46 " ATTDECLTYP="2" ATTVALUE="ICON_DUMMY" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_PAPELERA" VERSION="1" LANGU="S" DESCRIPT="Papelera" EXPOSURE="2" STATE="1" EDITORDER="49 " ATTDECLTYP="2" ATTVALUE="ICON_DELETE" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_ROJO" VERSION="1" LANGU="S" DESCRIPT="Semáforo rojo" EXPOSURE="2" STATE="1" EDITORDER="37 " ATTDECLTYP="2" ATTVALUE="ICON_RED_LIGHT" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_ROJO_SIMPLE" VERSION="1" LANGU="S" DESCRIPT="Semáforo rojo" EXPOSURE="2" STATE="1" EDITORDER="42 " ATTDECLTYP="2" ATTVALUE="ICON_LED_RED" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_STOP" VERSION="1" LANGU="S" DESCRIPT="Stop" EXPOSURE="2" STATE="1" EDITORDER="50 " ATTDECLTYP="2" ATTVALUE="ICON_MESSAGE_CRITICAL" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_VERDE" VERSION="1" LANGU="S" DESCRIPT="Semáforo verde" EXPOSURE="2" STATE="1" EDITORDER="35 " ATTDECLTYP="2" ATTVALUE="ICON_GREEN_LIGHT" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_VERDE_SIMPLE" VERSION="1" LANGU="S" DESCRIPT="Semáforo verde" EXPOSURE="2" STATE="1" EDITORDER="40 " ATTDECLTYP="2" ATTVALUE="ICON_LED_GREEN" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_ICO_WARNING" VERSION="1" LANGU="S" DESCRIPT="Warning" EXPOSURE="2" STATE="1" EDITORDER="38 " ATTDECLTYP="2" ATTVALUE="ICON_MESSAGE_WARNING" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ICON_D" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_SEM_AMBAR" VERSION="1" LANGU="S" DESCRIPT="Semáforo ambar" EXPOSURE="2" STATE="1" EDITORDER="25 " ATTDECLTYP="2" ATTVALUE="2" ATTEXPVIRT="0" TYPTYPE="1" TYPE="NUM1" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_SEM_ROJO" VERSION="1" LANGU="S" DESCRIPT="Semáforo  rojo" EXPOSURE="2" STATE="1" EDITORDER="24 " ATTDECLTYP="2" ATTVALUE="1" ATTEXPVIRT="0" TYPTYPE="1" TYPE="NUM1" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="C_SEM_VERDE" VERSION="1" LANGU="S" DESCRIPT="Semáforo verde" EXPOSURE="2" STATE="1" EDITORDER="23 " ATTDECLTYP="2" ATTVALUE="3" ATTEXPVIRT="0" TYPTYPE="1" TYPE="NUM1" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="EXCLUDED_BUTTONS" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="2 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TT_EXCLUDED_BUT" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="FULLY_DYNAMIC" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="1 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="I_BOTONES" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="52 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="T_BOTONES" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="I_BOTONES_V0" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="59 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="T_BOTONES" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="I_COLUMNAS" VERSION="1" LANGU="S" DESCRIPT="Tipo tabla ZAP_ALV_COLUMNAS" EXPOSURE="2" STATE="1" EDITORDER="28 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ZAP_ALV_COLUMNAS_T" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="I_COLUMNAS3" VERSION="1" LANGU="S" DESCRIPT="Tipo tabla ZAP_ALV_COLUMNAS" EXPOSURE="2" STATE="1" EDITORDER="30 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ZAP_ALV_COLUMNAS3_T" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="I_COLUMNS" VERSION="1" LANGU="S" DESCRIPT="Columns of ALV List" EXPOSURE="2" STATE="1" EDITORDER="9 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SALV_T_COLUMN_REF" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="I_HOTSPOT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="54 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="TT_HOTSPOT" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="I_ROWS" VERSION="1" LANGU="S" DESCRIPT="Rows" EXPOSURE="2" STATE="1" EDITORDER="11 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SALV_T_ROW" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="KEY_LAYOUT" VERSION="1" LANGU="S" DESCRIPT="Layout clave" EXPOSURE="2" STATE="1" EDITORDER="55 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SALV_S_LAYOUT_KEY" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="LOGO" VERSION="1" LANGU="S" DESCRIPT="Business Document Service: Clave de objeto" EXPOSURE="2" STATE="1" EDITORDER="34 " ATTDECLTYP="0" ATTVALUE="&apos;&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BDS_TYPEID" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="NOMBRE_TABLA" VERSION="1" LANGU="S" DESCRIPT="Nombre de la tabla" EXPOSURE="1" STATE="1" EDITORDER="1 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="OPTIMIZE" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="53 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_AGGREGATION" VERSION="1" LANGU="S" DESCRIPT="All Aggregation Objects" EXPOSURE="2" STATE="1" EDITORDER="16 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_AGGREGATIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_ALV" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="1 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_TABLE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_ALV_HELPER" VERSION="1" LANGU="S" DESCRIPT="ALV" EXPOSURE="2" STATE="1" EDITORDER="56 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="ZCL_AP_ALV" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_COLUMN" VERSION="1" LANGU="S" DESCRIPT="Individual Column Object" EXPOSURE="2" STATE="1" EDITORDER="4 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_COLUMN" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_COLUMNS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="3 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_COLUMNS_TABLE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_CONTAINER" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="4 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_GUI_CUSTOM_CONTAINER" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_CONTENT" VERSION="1" LANGU="S" DESCRIPT="General Element in Design Object" EXPOSURE="2" STATE="1" EDITORDER="10 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_FORM_ELEMENT" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_DEV" VERSION="1" LANGU="S" DESCRIPT="Utilizadades desarrollo" EXPOSURE="2" STATE="1" EDITORDER="57 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="ZCL_AP_DEV" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_DSPSET" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="5 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_DISPLAY_SETTINGS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_EVENTS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="8 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_EVENTS_TABLE" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_EVENT_H" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="6 " ATTDECLTYP="1" ATTEXPVIRT="0" TYPTYPE="3" TYPE="OBJECT" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_FUNCTIONS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="2 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_FUNCTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_FUNCTIONS_LIST" VERSION="1" LANGU="S" DESCRIPT="Generic and User-Defined Functions in List-Type Tables" EXPOSURE="2" STATE="1" EDITORDER="13 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_FUNCTIONS_LIST" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_LAYOUT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="6 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_LAYOUT" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_SELECTIONS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="7 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_SELECTIONS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_SORTS" VERSION="1" LANGU="S" DESCRIPT="All Sort Objects" EXPOSURE="0" STATE="1" EDITORDER="3 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="CL_SALV_SORTS" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="O_TOP_PAGE" VERSION="1" LANGU="S" DESCRIPT="Manejo top of page ALV" EXPOSURE="2" STATE="1" EDITORDER="27 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="ZCL_AP_ALV_FORM" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="SIN_BUFFER" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="29 " ATTDECLTYP="0" ATTVALUE="&apos;&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="STATUS" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="14 " ATTDECLTYP="0" ATTRDONLY="X" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="TABLE_REF" VERSION="1" LANGU="S" EXPOSURE="0" STATE="1" EDITORDER="8 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="3" TYPE="DATA" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="TOP_OF_PAGE_AUTO" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="32 " ATTDECLTYP="0" ATTVALUE="&apos;&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="TOP_OF_PAGE_TITULO" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="33 " ATTDECLTYP="0" ATTVALUE="&apos;&apos;" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="UCOMM" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Código función que ha lanzado PAI" EXPOSURE="1" STATE="1" EDITORDER="2 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="SY-UCOMM" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="UCOMM_TEXT" VERSION="1" LANGU="S" EXPOSURE="1" STATE="1" EDITORDER="3 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="STRING" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <attribute CLSNAME="ZCL_AP_ALV" CMPNAME="YA_MOSTRADO" VERSION="1" LANGU="S" DESCRIPT="&apos;&apos;" EXPOSURE="2" STATE="1" EDITORDER="26 " ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="ABAP_BOOL" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " TYPESRC_LENG="0 "/>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="ADD_BUTTON" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="57 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="ADD_BUTTON" SCONAME="BUTTON" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Código función que ha lanzado PAI" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-UCOMM"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="ADD_BUTTON" SCONAME="TEXT" VERSION="1" LANGU="S" DESCRIPT="Menu Painter: Texto de función o de menú (4.0)" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SMP_DYNTXT-TEXT" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="ADD_BUTTON" SCONAME="ICON" VERSION="1" LANGU="S" DESCRIPT="Icono en campos de texto (representación adicional, alias)" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SMP_DYNTXT-ICON_ID" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="ADD_BUTTON" SCONAME="QINFO" VERSION="1" LANGU="S" DESCRIPT="Menu Painter: Texto info (4.0)" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SMP_DYNTXT-QUICKINFO" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="ADD_BUTTON" SCONAME="ALLOWED" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="ABAP_TRUE"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="ADD_BUTTON" SCONAME="FORZAR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="ADD_BUTTON" SCONAME="UCOMM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-UCOMM" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="ADD_BUTTON" SCONAME="STATUS2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="ADD_BUTTON" SCONAME="BORRAR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <source>METHOD add_button.
    DATA: but     TYPE smp_dyntxt,
          l_boton TYPE t_boton.

    FIELD-SYMBOLS &lt;bt&gt; TYPE any.

    IF button IS INITIAL.
      RETURN.
    ENDIF.

    IF text IS INITIAL AND icon IS INITIAL AND borrar IS INITIAL.
      RETURN.
    ENDIF.

    IF borrar IS INITIAL.
      but-icon_id   = icon.
      but-icon_text = text.
      but-text      = text.
      but-quickinfo = qinfo.
    ELSE.
      CLEAR but.
    ENDIF.

    MOVE-CORRESPONDING but TO l_boton.
    DELETE i_botones WHERE boton = button.

    l_boton-boton = button.
    l_boton-ucomm = ucomm.
    APPEND l_boton TO i_botones.

    ASSIGN COMPONENT button OF STRUCTURE buttons TO &lt;bt&gt;.
    IF &lt;bt&gt; IS ASSIGNED.
      IF &lt;bt&gt; IS INITIAL OR forzar = &apos;X&apos; OR borrar = &apos;X&apos;.
        &lt;bt&gt; = but.
        IF status2 = &apos;X&apos;.
          PERFORM set_boton IN PROGRAM zap_status2 USING buttons.
        ELSE.
          PERFORM set_boton IN PROGRAM zap_status USING buttons.
        ENDIF.
        IF allowed = abap_true.
          show_button( button = button ).
        ENDIF.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="APPEND_COLOR" VERSION="1" LANGU="S" DESCRIPT="Append tabla color" EXPOSURE="2" STATE="1" EDITORDER="29 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="APPEND_COLOR" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="APPEND_COLOR" SCONAME="COLOR" VERSION="1" LANGU="S" DESCRIPT="Número natural" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="APPEND_COLOR" SCONAME="COLORC" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="APPEND_COLOR" SCONAME="INT" VERSION="1" LANGU="S" DESCRIPT="Número natural" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT1" PARVALUE="0"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="APPEND_COLOR" SCONAME="INV" VERSION="1" LANGU="S" DESCRIPT="Número natural" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PARVALUE="0"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="APPEND_COLOR" SCONAME="TABLA_COLOR" VERSION="1" LANGU="S" DESCRIPT="Control LVA: Tabla para coloración de celdas" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="LVC_T_SCOL"/>
  <source>METHOD append_color.
    DATA: i_column TYPE TABLE OF lvc_fname,
          l_column TYPE lvc_fname,
          ls_color TYPE lvc_s_scol.

    SPLIT campo AT &apos;,&apos; INTO TABLE i_column.
    IF i_column IS INITIAL.
      APPEND &apos;&apos; TO i_column.
    ENDIF.

    LOOP AT i_column INTO l_column.
      TRANSLATE l_column TO UPPER CASE.
      CLEAR ls_color.
      ls_color-fname = l_column.
      ls_color-color-int = int.
      ls_color-color-inv = inv.
      IF NOT color IS INITIAL.
        ls_color-color-col = color.
      ELSE.
        ls_color-color-col = traduce_color( colorc ).
      ENDIF.
      APPEND ls_color TO tabla_color.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" VERSION="1" LANGU="S" DESCRIPT="CONSTRUCTOR" EXPOSURE="2" STATE="1" EDITORDER="1 " DISPID="0 " MTDTYPE="2" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;I_LISTADO&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="LIST_DISPLAY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="CPROG" VERSION="1" LANGU="S" DESCRIPT="Calling Program" CMPTYPE="1" MTDTYPE="2" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="OPTIMIZE" VERSION="1" LANGU="S" DESCRIPT="Optimizar ancho" CMPTYPE="1" MTDTYPE="2" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="BOTONES_STANDARD" VERSION="1" LANGU="S" DESCRIPT="Mostrar el ALV como Popup" CMPTYPE="1" MTDTYPE="2" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="COLOR" VERSION="1" LANGU="S" DESCRIPT="Columna con campo color" CMPTYPE="1" MTDTYPE="2" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="LVC_FNAME" PARVALUE="&apos; &apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="STATUS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos; &apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="SEL" VERSION="1" LANGU="S" DESCRIPT="&apos;&apos; No, &apos;X&apos; Simple, &apos;M&apos; Multiple" CMPTYPE="1" MTDTYPE="2" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="C" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="CAMPO_CHECK" VERSION="1" LANGU="S" DESCRIPT="Field Name" CMPTYPE="1" MTDTYPE="2" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="LIGHTS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="CONTAINER_NAME" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="C" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="NO_LAYOUT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="R_CONTAINER" VERSION="1" LANGU="S" DESCRIPT="Abstract Container for GUI Controls" CMPTYPE="1" MTDTYPE="2" EDITORDER="13 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="CL_GUI_CONTAINER" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="RESTRICCION_LAYOUT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="14 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PARVALUE="IF_SALV_C_LAYOUT=&gt;RESTRICT_NONE"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="INICIO_COLUMNA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="15 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="SIN_BUFFER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="16 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="TOP_OF_PAGE_AUTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="17 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="TOP_OF_PAGE_TITULO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="18 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="LOGO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="19 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="STATUS_PROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="20 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="GENERAR_DOCKING" VERSION="1" LANGU="S" DESCRIPT="Ratio docking automático" CMPTYPE="1" MTDTYPE="2" EDITORDER="21 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PARVALUE="0"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="NOMBRE_DOCKING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="22 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;DOCK_CONT&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="HANDLE" VERSION="1" LANGU="S" DESCRIPT="ID de gestión para llamada múltiple desde el mismo programa" CMPTYPE="1" MTDTYPE="2" EDITORDER="23 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SLIS_HANDL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="O_DEV" VERSION="1" LANGU="S" DESCRIPT="Utilizadades desarrollo" CMPTYPE="1" MTDTYPE="2" EDITORDER="24 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_DEV" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR" SCONAME="NO_AGRUPAR_CELDAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="2" EDITORDER="25 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD constructor.
    DATA: l_tabla          TYPE string,
          l_tabla2         TYPE string,
          l_error          TYPE string,
          l_container_name TYPE c LENGTH 80,
          l_string         TYPE string,
          o_excepcion      TYPE REF TO cx_salv_msg.
    DATA: lv_repid TYPE sy-repid,
          lv_dynnr TYPE sy-dynnr.
    DATA: lo_dock TYPE REF TO cl_gui_docking_container,
          lo_cont TYPE REF TO cl_gui_container.

    FIELD-SYMBOLS &lt;tabla&gt; TYPE table.

*
    IF tabla = &apos;HELPER&apos;.
      RETURN.
    ENDIF.

* Si no se informa la tabla, debemos utilizar el falso constructor diferido
    IF tabla IS INITIAL.
      RETURN.
    ENDIF.

    IF NOT cprog IS INITIAL.
      CONCATENATE &apos;(&apos; cprog &apos;)&apos; tabla INTO l_tabla.
    ELSE.
      l_tabla = tabla.
    ENDIF.

    IF NOT l_tabla CS &apos;[]&apos;.
      CONCATENATE l_tabla &apos;[]&apos; INTO l_tabla.
    ENDIF.

    nombre_tabla = l_tabla.
    ASSIGN (l_tabla) TO &lt;tabla&gt;.
    IF sy-subrc &lt;&gt; 0.
      IF NOT cprog IS INITIAL.
        CONCATENATE &apos;(&apos; cprog &apos;)o_prog-&gt;&apos; tabla INTO l_tabla2.
        ASSIGN (l_tabla2) TO &lt;tabla&gt;.
        IF sy-subrc = 0.
          nombre_tabla = l_tabla2.
        ENDIF.
      ENDIF.
    ENDIF.

    IF NOT &lt;tabla&gt; IS ASSIGNED.
      CONCATENATE &apos;La tabla&apos;(tab) l_tabla &apos;no existe&apos;(noe)
                  INTO l_error SEPARATED BY space.
      MESSAGE l_error TYPE &apos;I&apos;
              DISPLAY LIKE &apos;E&apos;.
    ELSE.
      table_ref = REF #( &lt;tabla&gt; ).
    ENDIF.

    IF NOT container_name IS INITIAL.
      l_container_name = container_name.
    ELSEIF generar_docking &gt; 0.
      lv_repid = &apos;SAPMSSY0&apos;.
      lv_dynnr = &apos;0120&apos;.

*
*   Create a docking control at bottom
      IF lo_dock IS NOT INITIAL.
        RETURN.
      ENDIF.
      CREATE OBJECT lo_dock
        EXPORTING
          repid                       = lv_repid
          dynnr                       = lv_dynnr
          ratio                       = generar_docking
          side                        = cl_gui_docking_container=&gt;dock_at_bottom
          name                        = nombre_docking
        EXCEPTIONS
          cntl_error                  = 1
          cntl_system_error           = 2
          create_error                = 3
          lifetime_error              = 4
          lifetime_dynpro_dynpro_link = 5
          OTHERS                      = 6.
      IF sy-subrc &lt;&gt; 0.
        MESSAGE &apos;Error in the Docking control&apos;(edc) TYPE &apos;S&apos;.
      ELSE.
        l_container_name = nombre_docking.
      ENDIF.
    ENDIF.

    TRY.
        IF NOT l_container_name IS INITIAL.
          l_string = l_container_name.

          IF l_container_name = nombre_docking.
            lo_cont ?= lo_dock.
            cl_salv_table=&gt;factory(
              EXPORTING
                list_display   = list_display
                r_container    = lo_cont
                container_name = l_string
              IMPORTING
                r_salv_table   = o_alv
              CHANGING
                t_table        = &lt;tabla&gt; ).
          ELSE.
            o_container = NEW #(
                container_name = l_container_name ).

            cl_salv_table=&gt;factory(
              EXPORTING
                list_display   = list_display
                r_container    = o_container
                container_name = l_string
              IMPORTING
                r_salv_table   = o_alv
              CHANGING
                t_table        = &lt;tabla&gt; ).
          ENDIF.
        ELSEIF r_container IS INITIAL.
          cl_salv_table=&gt;factory(
            EXPORTING
              list_display = list_display
            IMPORTING
              r_salv_table = o_alv
            CHANGING
              t_table      = &lt;tabla&gt; ).
        ELSE.
          cl_salv_table=&gt;factory(
            EXPORTING
              list_display = list_display
              r_container  = r_container
            IMPORTING
              r_salv_table = o_alv
            CHANGING
              t_table      = &lt;tabla&gt; ).
        ENDIF.

        inicializa_objetos( list_display       = list_display
                            optimize           = optimize
                            botones_standard   = botones_standard
                            color              = color
                            status             = status
                            sel                = sel
                            campo_check        = campo_check
                            lights             = lights
                            tabla              = tabla
                            no_layout          = no_layout
                            restriccion_layout = restriccion_layout
                            inicio_columna     = inicio_columna
                            sin_buffer         = sin_buffer
                            top_of_page_auto   = top_of_page_auto
                            top_of_page_titulo = top_of_page_titulo
                            logo               = logo
                            status_prog        = status_prog
                            handle             = handle
                            o_dev              = o_dev
                            no_agrupar_celdas  = no_agrupar_celdas ).

      CATCH cx_salv_msg INTO o_excepcion.
        l_string = o_excepcion-&gt;get_text( ).
        MESSAGE l_string TYPE &apos;E&apos;
                DISPLAY LIKE &apos;I&apos;.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" VERSION="1" LANGU="S" DESCRIPT="CONSTRUCTOR diferido con tabla" EXPOSURE="2" STATE="1" EDITORDER="23 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="LIST_DISPLAY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="OPTIMIZE" VERSION="1" LANGU="S" DESCRIPT="Optimizar ancho" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="BOTONES_STANDARD" VERSION="1" LANGU="S" DESCRIPT="Mostrar el ALV como Popup" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="COLOR" VERSION="1" LANGU="S" DESCRIPT="Columna con campo color" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="LVC_FNAME" PARVALUE="&apos; &apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="STATUS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SYPFKEY" PARVALUE="&apos; &apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="SEL" VERSION="1" LANGU="S" DESCRIPT="&apos;&apos; No, &apos;X&apos; Simple, &apos;M&apos; Multiple" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="C" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="CAMPO_CHECK" VERSION="1" LANGU="S" DESCRIPT="Field Name" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="FIELDNAME" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="LIGHTS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="CONTAINER_NAME" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="C" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="NO_LAYOUT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="RESTRICCION_LAYOUT" VERSION="1" LANGU="S" DESCRIPT="Tipo de grabación Layout" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PARVALUE="IF_SALV_C_LAYOUT=&gt;RESTRICT_NONE"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="CPROG" VERSION="1" LANGU="S" DESCRIPT="Programa de llamada" CMPTYPE="1" MTDTYPE="0" EDITORDER="13 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="TOP_OF_PAGE_AUTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="14 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="TOP_OF_PAGE_TITULO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="15 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="STATUS_PROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="16 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="HANDLE" VERSION="1" LANGU="S" DESCRIPT="ID de gestión para llamada múltiple desde el mismo programa" CMPTYPE="1" MTDTYPE="0" EDITORDER="17 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SLIS_HANDL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CONSTRUCTOR_TABLA" SCONAME="T_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="18 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <source>METHOD constructor_tabla.
    DATA l_string TYPE string.

    TRY.
        IF NOT container_name IS INITIAL.
          o_container = NEW #(
              container_name = container_name ).

          l_string = container_name.

          cl_salv_table=&gt;factory(
            EXPORTING
              list_display   = list_display
              r_container    = o_container
              container_name = l_string
            IMPORTING
              r_salv_table   = o_alv
            CHANGING
              t_table        = t_tabla ).
        ELSE.
          cl_salv_table=&gt;factory(
            EXPORTING
              list_display = list_display
            IMPORTING
              r_salv_table = o_alv
            CHANGING
              t_table      = t_tabla ).
        ENDIF.

        table_ref = REF #( t_tabla ).

        inicializa_objetos( list_display       = list_display
                            optimize           = optimize
                            botones_standard   = botones_standard
                            color              = color
                            status             = status
                            sel                = sel
                            campo_check        = campo_check
                            lights             = lights
                            tabla              = tabla
                            cprog              = cprog
                            no_layout          = no_layout
                            handle             = handle
                            status_prog        = status_prog
                            restriccion_layout = restriccion_layout
                            top_of_page_auto   = top_of_page_auto
                            top_of_page_titulo = top_of_page_titulo ).

      CATCH cx_salv_msg.
        MESSAGE &apos;ALV display not possible&apos;(adn) TYPE &apos;I&apos;
                DISPLAY LIKE &apos;E&apos;.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="CORREGUIR_VARIANTES" VERSION="1" LANGU="S" DESCRIPT="Quitar de la variante los campos definidos como visualizable" EXPOSURE="2" STATE="1" EDITORDER="42 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CORREGUIR_VARIANTES" SCONAME="I_COLUMNAS3" VERSION="1" LANGU="S" DESCRIPT="Tipo tabla ZAP_ALV_COLUMNAS3" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_ALV_COLUMNAS3_T" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="CORREGUIR_VARIANTES" SCONAME="I_COLUMNAS" VERSION="1" LANGU="S" DESCRIPT="Tipo tabla ZAP_ALV_COLUMNAS" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_ALV_COLUMNAS_T" PAROPTIONL="X"/>
  <source>METHOD correguir_variantes.
    DATA: i_ltdx        TYPE TABLE OF ltdx,
          rs_varkey     TYPE ltdxkey,
          rt_dbfieldcat TYPE TABLE OF ltdxdata.

    FIELD-SYMBOLS: &lt;ltdx&gt;  TYPE ltdx,
                   &lt;col&gt;   TYPE zap_alv_columnas,
                   &lt;campo&gt; TYPE ltdxdata,
                   &lt;col3&gt;  TYPE zap_alv_columnas3.

    SELECT relid report handle log_group username variant type FROM ltdx
      INTO CORRESPONDING FIELDS OF TABLE i_ltdx
     WHERE relid  = &apos;LT&apos;
       AND report = key_layout-report
       AND type   = &apos;F&apos;.

    SORT i_ltdx.
    DELETE ADJACENT DUPLICATES FROM i_ltdx.

    LOOP AT i_ltdx ASSIGNING &lt;ltdx&gt;.
      MOVE-CORRESPONDING &lt;ltdx&gt; TO rs_varkey.

      IMPORT lt_dbfieldcat TO rt_dbfieldcat
             FROM DATABASE ltdx(lt)
             CLIENT sy-mandt
             ID rs_varkey.

      LOOP AT i_columnas ASSIGNING &lt;col&gt; WHERE no_variante = &apos;X&apos;.
        LOOP AT rt_dbfieldcat ASSIGNING &lt;campo&gt; WHERE     key1  = &lt;col&gt;-campo
                                                      AND param = &apos;NO_OUT&apos;.
          &lt;campo&gt;-value = &lt;col&gt;-noout.
        ENDLOOP.
      ENDLOOP.

      LOOP AT i_columnas3 ASSIGNING &lt;col3&gt; WHERE no_variante = &apos;X&apos;.
        LOOP AT rt_dbfieldcat ASSIGNING &lt;campo&gt; WHERE     key1  = &lt;col3&gt;-campo
                                                      AND param = &apos;NO_OUT&apos;.
          &lt;campo&gt;-value = &lt;col3&gt;-noout.
        ENDLOOP.
      ENDLOOP.

      EXPORT lt_dbfieldcat FROM rt_dbfieldcat
             TO DATABASE ltdx(lt)
             ID rs_varkey.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="DISPLAY_DATA_DEEP_ENABLED" VERSION="1" LANGU="S" DESCRIPT="Mostrar datos tablas anidadas" EXPOSURE="2" STATE="1" EDITORDER="72 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="DISPLAY_DATA_DEEP_ENABLED" SCONAME="IT_DATA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <source>METHOD display_data_deep_enabled. &quot;#EC *
*    DATA lo_table_descr  TYPE REF TO cl_abap_tabledescr.
*    DATA lo_struct_descr TYPE REF TO cl_abap_structdescr.
*
*    lo_table_descr ?= cl_abap_tabledescr=&gt;describe_by_data( it_data ).
*    lo_struct_descr ?= lo_table_descr-&gt;get_table_line_type( ).
*    &quot;note: this might fail if it&apos;s a single-coloum-Table.
*
*    DATA(lt_components_with_ref) = lo_struct_descr-&gt;get_components( ).
*    DATA(lt_components_simple_tab) = lo_struct_descr-&gt;components.
*
*    &quot;find and remove the components that would hurt us (that is: dump)
*    LOOP AT lt_components_simple_tab ASSIGNING FIELD-SYMBOL(&lt;component&gt;)
*                                    WHERE type_kind = cl_abap_tabledescr=&gt;typekind_table.
*      DELETE lt_components_with_ref WHERE name = &lt;component&gt;-name.
*    ENDLOOP.
*
*    &quot; New Structure + Table.
*    lo_struct_descr = cl_abap_structdescr=&gt;create( p_components = lt_components_with_ref ).
*    lo_table_descr = cl_abap_tabledescr=&gt;create( p_line_type = lo_struct_descr ).
*    DATA lt_new TYPE REF TO data.
*    &quot; Create the Data-Ref of the new Type.
*    CREATE DATA lt_new TYPE HANDLE lo_table_descr.
*    &quot; Fill it with data:
*    lt_new-&gt;* = CORRESPONDING #( it_data ).
*
*    TRY.
*        cl_salv_table=&gt;factory( IMPORTING r_salv_table = DATA(lref_alv)
*                                CHANGING  t_table      = lt_new-&gt;*  ).
*      CATCH cx_salv_msg.
*    ENDTRY.
*
*    lref_alv-&gt;get_layout( )-&gt;set_key( VALUE #( report = sy-repid ) ).
*    lref_alv-&gt;get_layout( )-&gt;set_default( abap_true ).
*    lref_alv-&gt;get_layout( )-&gt;set_save_restriction( if_salv_c_layout=&gt;restrict_none ).
*    lref_alv-&gt;get_functions( )-&gt;set_all( abap_true ).
*    lref_alv-&gt;display( ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="END_OF_PAGE" VERSION="1" LANGU="S" DESCRIPT="Imprimir contenido end of page" EXPOSURE="2" STATE="1" EDITORDER="10 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD end_of_page.
    CLEAR o_content.
*  DATA: lr_header TYPE REF TO cl_salv_form_header_info,
*        l_text    TYPE string.
*  l_text = &apos;end of page for the report&apos;.
*  CREATE OBJECT lr_header
*    EXPORTING
*      text    = l_text
*      tooltip = l_text.
*  o_content = lr_header.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="EXCLUIR_BOTON" VERSION="1" LANGU="S" DESCRIPT="Excluir botón" EXPOSURE="2" STATE="1" EDITORDER="51 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXCLUIR_BOTON" SCONAME="BOTON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD excluir_boton.
    DATA: lt_func_list TYPE salv_t_ui_func,
          i_botones    TYPE TABLE OF string,
          la_func_list LIKE LINE OF lt_func_list,
          l_boton      TYPE string.

* Get all functions
    lt_func_list = o_functions-&gt;get_functions( ).
    SPLIT boton AT &apos;,&apos; INTO TABLE i_botones.

* Now hide the MYFUNCTION
    LOOP AT lt_func_list INTO la_func_list.
      LOOP AT i_botones INTO l_boton.
        IF la_func_list-r_function-&gt;get_name( ) = l_boton.
          la_func_list-r_function-&gt;set_visible( &apos; &apos; ).
        ENDIF.
      ENDLOOP.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_CSV" VERSION="1" LANGU="S" DESCRIPT="Exportar CSV" EXPOSURE="2" STATE="1" EDITORDER="38 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_CSV" SCONAME="FICHERO_SALIDA" VERSION="1" LANGU="S" DESCRIPT="Fichero de salida" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_CSV" SCONAME="SERVIDOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_CSV" SCONAME="DIALOGO_FICHERO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_CSV" SCONAME="SEPARADOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="C" PARVALUE="&apos;;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_CSV" SCONAME="MOSTRAR_MENSAJES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_CSV" SCONAME="QUITAR_CARACTERES_EXTRANOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_CSV" SCONAME="I_CSV" VERSION="1" LANGU="S" DESCRIPT="Tabla de strings" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE_OF_STRINGS"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_CSV" SCONAME="T_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD exportar_csv.
    TYPES: BEGIN OF t_cols,
             orden  TYPE n LENGTH 3,
             name   TYPE fieldname,
             titulo TYPE string,
             tipo   TYPE abap_typekind,
           END OF t_cols.

    DATA: i_columns      TYPE salv_t_column_ref,
          l_campos       TYPE abap_componentdescr,
          i_campos       TYPE abap_component_tab,
          lr_data        TYPE REF TO data,
          l_orden        TYPE i,
          l_string       TYPE string,
          l_column       TYPE salv_s_column_ref,
          l_col          TYPE t_cols,
          i_cols         TYPE TABLE OF t_cols,
          l_campo        TYPE c LENGTH 40,
          l_valor        TYPE c LENGTH 255,
          l_valor_string TYPE string,
          l_neg          TYPE c LENGTH 1.
    DATA: i_ddfiels TYPE ddfields,
          l_dfies   TYPE dfies.

    FIELD-SYMBOLS: &lt;tabla&gt; TYPE table,
                   &lt;linea&gt; TYPE any,
                   &lt;campo&gt; TYPE any.

    DEFINE add_campo.
      IF l_col-tipo = &apos;C&apos;.
        REPLACE ALL OCCURRENCES OF separador IN &amp;1 WITH &apos;:&apos;.
      ENDIF.
      WRITE &amp;1 TO l_valor LEFT-JUSTIFIED.
      IF l_col-tipo = &apos;P&apos;.
        IF l_valor CS &apos;-&apos;.
          REPLACE ALL OCCURRENCES OF &apos;-&apos; IN l_valor WITH &apos;&apos;.
          CONCATENATE &apos;-&apos; l_valor INTO l_valor.
        ENDIF.
      ENDIF.

      IF quitar_caracteres_extranos = &apos;X&apos;.
        l_valor_string = l_valor.
        zcl_ap_string=&gt;quitar_caracteres_extranos( CHANGING string = l_valor_string ).
        l_valor = l_valor_string.
      ENDIF.

      IF l_col-orden = 1.
        l_string = l_valor.
      ELSE.
        CONCATENATE l_string separador l_valor INTO l_string.
      ENDIF.
    END-OF-DEFINITION.

    i_columns = o_columns-&gt;get( ).
    IF me-&gt;nombre_tabla IS INITIAL.
      i_ddfiels = zcl_ap_dev=&gt;get_fieldcatalog_ddic( t_tabla ).
      LOOP AT i_ddfiels INTO l_dfies.
        l_campos-name   = l_dfies-fieldname.
        l_campos-suffix = l_dfies-inttype.
        APPEND l_campos TO i_campos.
      ENDLOOP.
      IF sy-subrc &lt;&gt; 0.
        i_campos = zcl_ap_dev=&gt;get_fieldcatalog( t_tabla ).
      ENDIF.
      CREATE DATA lr_data LIKE LINE OF t_tabla.
    ELSE.
      ASSIGN (me-&gt;nombre_tabla) TO &lt;tabla&gt;.
      i_campos = zcl_ap_dev=&gt;get_fieldcatalog( &lt;tabla&gt; ).
      CREATE DATA lr_data LIKE LINE OF &lt;tabla&gt;.
    ENDIF.

    CLEAR: l_orden, l_string, i_csv.
    LOOP AT i_columns INTO l_column.
      TRY.
          o_column = o_columns-&gt;get_column( l_column-columnname ).
        CATCH cx_salv_not_found.
          MESSAGE |Error recuperando columna { l_column-columnname }| TYPE &apos;S&apos;.
      ENDTRY.
      IF o_column-&gt;is_visible( ) &lt;&gt; &apos;X&apos;.
        CONTINUE.
      ENDIF.

      l_orden = l_orden + 1.
      CLEAR l_col.
      l_col-orden  = l_orden.
      l_col-name   = l_column-columnname.
      l_col-titulo = o_column-&gt;get_long_text( ).
      READ TABLE i_campos INTO l_campos WITH KEY name = l_column-columnname.
      IF sy-subrc = 0.
        IF NOT l_campos-type IS INITIAL.
          l_col-tipo = l_campos-type-&gt;type_kind.
        ELSE.
          l_col-tipo = l_campos-suffix.
        ENDIF.

        APPEND l_col TO i_cols.

        l_col-tipo = &apos;C&apos;.
        add_campo l_col-titulo.
      ENDIF.
    ENDLOOP.
    APPEND l_string TO i_csv.

    IF NOT me-&gt;nombre_tabla IS INITIAL.
      ASSIGN (me-&gt;nombre_tabla) TO &lt;tabla&gt;.
      LOOP AT &lt;tabla&gt; ASSIGNING &lt;linea&gt;.
        LOOP AT i_cols INTO l_col.
          CONCATENATE &apos;&lt;LINEA&gt;-&apos; l_col-name INTO l_campo.
          ASSIGN (l_campo) TO &lt;campo&gt;.
          IF sy-subrc = 0.
            add_campo &lt;campo&gt;.
          ENDIF.
        ENDLOOP.
        APPEND l_string TO i_csv.
      ENDLOOP.
    ELSE.
      LOOP AT t_tabla ASSIGNING &lt;linea&gt;.
        LOOP AT i_cols INTO l_col.
          CONCATENATE &apos;&lt;LINEA&gt;-&apos; l_col-name INTO l_campo.
          ASSIGN (l_campo) TO &lt;campo&gt;.
          IF sy-subrc = 0.
            add_campo &lt;campo&gt;.
          ENDIF.
        ENDLOOP.
        APPEND l_string TO i_csv.
      ENDLOOP.
    ENDIF.

    IF NOT fichero_salida IS INITIAL OR dialogo_fichero = &apos;X&apos;.
      IF servidor IS INITIAL OR dialogo_fichero = &apos;X&apos;.
        zcl_ap_ficheros=&gt;grabar( EXPORTING fichero       = fichero_salida
                                           dialogo       = dialogo_fichero
                                           mostrar_error = mostrar_mensajes
                                 CHANGING  tabla         = i_csv ).
      ELSE.
        zcl_ap_ficheros=&gt;graba_fich_servidor( EXPORTING fichero          = fichero_salida
                                                        mostrar_mensajes = mostrar_mensajes
                                              CHANGING  tabla            = i_csv ).
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" VERSION="1" LANGU="S" DESCRIPT="Exportar Excel" EXPOSURE="2" STATE="1" EDITORDER="35 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="FICHERO_SALIDA" VERSION="1" LANGU="S" DESCRIPT="Fichero de salida" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="CERRAR" VERSION="1" LANGU="S" DESCRIPT="Cerrar fichero" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="COLUMNA_INICIAL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I" PARVALUE="1"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="COL_TEXTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="COL_IMPORTES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="REPLACEMENT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="46"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="RIGHTFOOTER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="CENTERHEADER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="PREVIEW" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="DIALOGO_FICHERO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL" SCONAME="T_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD exportar_excel.
    TYPES: BEGIN OF t_tit,
             orden  TYPE n LENGTH 3,
             titulo TYPE scrtext_l,
             campo  TYPE abap_componentdescr,
           END OF t_tit.

    DATA: o_excel      TYPE REF TO zcl_ap_excel_ole,
          i_columns    TYPE salv_t_column_ref,
          i_campos     TYPE abap_component_tab,
          i_col        TYPE zap_alv_columnas3_t,     &quot; Tipo tabla ZAP_ALV_COLUMN
          l_campos     TYPE abap_componentdescr,
          l_col        TYPE zap_alv_columnas3,       &quot; Columnas
          l_tit        TYPE t_tit,
          l_titulo     TYPE scrtext_l,
          i_tit        TYPE TABLE OF t_tit,
          i_titulos    TYPE TABLE OF scrtext_l,
          i_campos_sel TYPE abap_component_tab,
          l_column     TYPE salv_s_column_ref.

    FIELD-SYMBOLS &lt;tabla&gt; TYPE table.

    o_excel = NEW #(
        visible = 0 ).

    o_excel-&gt;crear_documento( ).

    i_columns = o_columns-&gt;get( ).
    IF me-&gt;nombre_tabla IS INITIAL.
      IF NOT t_tabla IS INITIAL.
        i_campos = zcl_ap_dev=&gt;get_fieldcatalog( t_tabla ).
      ENDIF.
    ELSE.
      ASSIGN (me-&gt;nombre_tabla) TO &lt;tabla&gt;.
      IF sy-subrc = 0.
        IF NOT &lt;tabla&gt; IS INITIAL.
          i_campos = zcl_ap_dev=&gt;get_fieldcatalog( &lt;tabla&gt; ).
        ENDIF.
      ENDIF.
    ENDIF.

    IF i_campos IS INITIAL.
      RETURN.
    ENDIF.

    i_col = get_columnas( ).

    DELETE i_campos WHERE name IS INITIAL.
    LOOP AT i_campos INTO l_campos.
*    READ TABLE i_columns INTO l_column WITH KEY columnname = l_campos-name.
      READ TABLE i_col INTO l_col WITH KEY campo = l_campos-name.
      IF sy-subrc = 0.
        l_tit-orden = l_col-colum.
*      o_column = o_columns-&gt;get_column( l_column-columnname ).
*      IF o_column-&gt;is_visible( ) = &apos;X&apos;.
*        l_titulo = o_column-&gt;get_long_text( ).
        IF l_col-noout IS INITIAL.
          l_titulo = l_col-descr.
          IF l_titulo IS INITIAL.
*          l_titulo = l_column-columnname.
            l_titulo = l_col-campo.
          ENDIF.
        ELSE.
          l_titulo = &apos;#INVISIBLE#&apos;.
        ENDIF.
      ELSE.
        l_titulo = l_campos-name.
        l_tit-orden = 900.
      ENDIF.
*    APPEND l_titulo TO i_titulos.
      l_tit-titulo = l_titulo.
      l_tit-campo  = l_campos.
      APPEND l_tit TO i_tit.
    ENDLOOP.

    SORT i_tit.
    LOOP AT i_tit INTO l_tit.
      APPEND l_tit-titulo TO i_titulos.
      APPEND l_tit-campo TO i_campos_sel.
    ENDLOOP.

    IF NOT me-&gt;nombre_tabla IS INITIAL.
      ASSIGN (me-&gt;nombre_tabla) TO &lt;tabla&gt;.
      o_excel-&gt;pegar_tabla( cabecera        = &apos;X&apos;
                            i_tabla         = &lt;tabla&gt;
                            autofiltro      = &apos;X&apos;
                            i_titulos       = i_titulos
                            columna_inicial = columna_inicial
                            col_texto       = col_texto
                            col_importes    = col_importes
                            replacement     = replacement
                            i_campos_sel    = i_campos_sel ).
    ELSE.
      o_excel-&gt;pegar_tabla( cabecera        = &apos;X&apos;
                            i_tabla         = t_tabla
                            autofiltro      = &apos;X&apos;
                            i_titulos       = i_titulos
                            columna_inicial = columna_inicial
                            col_texto       = col_texto
                            col_importes    = col_importes
                            replacement     = replacement
                            i_campos_sel    = i_campos_sel ).
    ENDIF.

    IF NOT fichero_salida IS INITIAL.
      o_excel-&gt;grabar_documento( fichero         = fichero_salida
                                 cerrar          = cerrar
                                 mostrar_dialogo = dialogo_fichero ).
    ENDIF.
    IF cerrar IS INITIAL.
      o_excel-&gt;fijar_visible( ).
    ENDIF.

    IF rightfooter &lt;&gt; &apos;&apos; OR centerheader &lt;&gt; &apos;&apos; OR preview &lt;&gt; &apos;&apos;.
      o_excel-&gt;configurar_pagina( rightfooter = rightfooter centerheader = centerheader preview = preview ).
    ENDIF.

    o_excel-&gt;free( ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" VERSION="1" LANGU="S" DESCRIPT="Exportar Excel (STATIC)" EXPOSURE="2" STATE="1" EDITORDER="46 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="FICHERO_SALIDA" VERSION="1" LANGU="S" DESCRIPT="Fichero de salida" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="CERRAR" VERSION="1" LANGU="S" DESCRIPT="Cerrar fichero" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="COLUMNA_INICIAL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I" PARVALUE="1"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="COL_TEXTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="COL_IMPORTES" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="REPLACEMENT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="46"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="RIGHTFOOTER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="CENTERHEADER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="PREVIEW" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="DIALOGO_FICHERO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="MENSAJE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_EXCEL_ST" SCONAME="T_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD exportar_excel_st.
    &quot; TODO: parameter MENSAJE is never cleared or assigned (ABAP cleaner)

    DATA o_alv_xls TYPE REF TO zcl_ap_alv.

    o_alv_xls = NEW #(
        tabla = &apos;&apos; ).

    o_alv_xls-&gt;constructor_tabla( CHANGING t_tabla = t_tabla ).

    o_alv_xls-&gt;exportar_excel( EXPORTING dialogo_fichero = dialogo_fichero
                                         fichero_salida  = fichero_salida
                                         columna_inicial = columna_inicial
                                         col_texto       = col_texto
                                         col_importes    = col_importes
                                         replacement     = replacement
                                         rightfooter     = rightfooter
                                         centerheader    = centerheader
                                         preview         = preview
                                         cerrar          = cerrar
                               CHANGING  t_tabla         = t_tabla ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XLSX" VERSION="1" LANGU="S" DESCRIPT="Exportar contenido a XLSX" EXPOSURE="2" STATE="1" EDITORDER="61 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XLSX" SCONAME="TIPO_XML" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SALV_BS_CONSTANT" PARVALUE="IF_SALV_BS_XML=&gt;C_TYPE_XLSX"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XLSX" SCONAME="FICHERO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XLSX" SCONAME="DIALOGO_GRABAR_FICHERO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XLSX" SCONAME="ABRIR_EXCEL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XLSX" SCONAME="DIR_TEMP" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XLSX" SCONAME="XSTRING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="XSTRING"/>
  <source>METHOD exportar_xlsx.
    DATA: l_dir     TYPE string,
          l_fichero TYPE string,
          l_mensaje TYPE bapi_msg.

    xstring = o_alv-&gt;to_xml( xml_type = tipo_xml ).

    IF xstring IS INITIAL.
      RETURN.
    ENDIF.

    IF fichero IS INITIAL AND dialogo_grabar_fichero IS INITIAL.
      RETURN.
    ENDIF.

    IF dir_temp = &apos;X&apos;.
      l_dir = zcl_ap_documentos=&gt;get_directorio_temporal( ).
      l_fichero = zcl_ap_ficheros=&gt;concat_ruta( fichero = fichero directorio = l_dir ).
    ELSE.
      l_fichero = fichero.
    ENDIF.
    IF NOT l_fichero CS &apos;.&apos;.
      CONCATENATE l_fichero &apos;.XLSX&apos; INTO l_fichero.
    ENDIF.
    zcl_ap_ficheros=&gt;grabar_xstring( EXPORTING fichero       = l_fichero
                                               xstring       = xstring
                                               dialogo       = dialogo_grabar_fichero
                                     IMPORTING fichero_final = l_fichero
                                               mensaje       = l_mensaje ).
    IF NOT l_mensaje IS INITIAL.
      __concat2 l_mensaje &apos;Error guardando XLSX&apos;(egx) l_mensaje.
      MESSAGE l_mensaje TYPE &apos;I&apos;.
    ELSE.
      IF abrir_excel = &apos;X&apos; AND NOT l_fichero IS INITIAL.
        zcl_ap_gos=&gt;visualizar_fichero_st( l_fichero ).
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XML" VERSION="1" LANGU="S" DESCRIPT="Exportar contenido a XML" EXPOSURE="2" STATE="1" EDITORDER="47 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XML" SCONAME="TIPO_XML" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SALV_BS_CONSTANT" PARVALUE="IF_SALV_BS_XML=&gt;C_TYPE_MHTML"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XML" SCONAME="FICHERO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XML" SCONAME="DIALOGO_GRABAR_FICHERO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XML" SCONAME="XSTRING" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="XSTRING"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XML" SCONAME="SOLIX_TAB" VERSION="1" LANGU="S" DESCRIPT="GBT: SOLIX como tipo de tabla" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="SOLIX_TAB"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="EXPORTAR_XML" SCONAME="XML_SIZE" VERSION="1" LANGU="S" DESCRIPT="Tamaño de contenido de doc." CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="I"/>
  <source>METHOD exportar_xml.
    xstring = o_alv-&gt;to_xml( xml_type = tipo_xml ).

    xml_size = xstrlen( xstring ).

    solix_tab = cl_document_bcs=&gt;xstring_to_solix( ip_xstring = xstring ).

    IF NOT fichero IS INITIAL OR NOT dialogo_grabar_fichero IS INITIAL.
      zcl_ap_ficheros=&gt;grabar( EXPORTING fichero      = fichero
                                         dialogo      = dialogo_grabar_fichero
                                         tipo         = &apos;BIN&apos;
                                         bin_filesize = xml_size
                               CHANGING  tabla        = solix_tab ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="FILL_COLUMNAS" VERSION="1" LANGU="S" DESCRIPT="Devuelve valores iniciales en I_COLUMNAS" EXPOSURE="2" STATE="1" EDITORDER="43 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="FILL_COLUMNAS" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="FILL_COLUMNAS" SCONAME="I_COLUMNAS" VERSION="1" LANGU="S" DESCRIPT="Columnas" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ZAP_ALV_COLUMNAS_T"/>
  <source>METHOD fill_columnas.
    DATA: l_long    TYPE i,
          i_columns TYPE salv_t_column_ref,
          l_column  TYPE salv_s_column_ref,
          l_aux     TYPE c LENGTH 40,
          l_col     TYPE zap_alv_columnas.

    l_long = strlen( campo ).

    i_columns = o_columns-&gt;get( ).

    LOOP AT i_columns INTO l_column.
      l_aux = l_column-columnname(l_long).
      IF l_aux = campo.
        IF l_column-columnname+l_long(2) CO &apos;0123456789&apos;.
          CLEAR l_col.
          l_col-campo = l_column-columnname.
          l_col-noout = &apos;X&apos;.
          l_col-colum = l_column-columnname+l_long(2).
          l_col-descr = l_column-columnname.
          APPEND l_col TO i_columnas.
        ENDIF.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="FREE" VERSION="1" LANGU="S" DESCRIPT="Libera memoria de los objetos" EXPOSURE="2" STATE="1" EDITORDER="28 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD free.
    cl_gui_cfw=&gt;flush( ).
    IF NOT o_container IS INITIAL.
      o_container-&gt;free( ).
      CLEAR o_container.
      cl_gui_cfw=&gt;flush( ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_BOTON_QUICKINFO" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="59 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_BOTON_QUICKINFO" SCONAME="BOTON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_BOTON_QUICKINFO" SCONAME="QUICKINFO" VERSION="1" LANGU="S" DESCRIPT="Menu Painter: Interfase programa para textos dinámicos" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="SMP_DYNTXT-QUICKINFO"/>
  <source>METHOD get_boton_quickinfo.
    DATA but TYPE t_boton.

    READ TABLE i_botones INTO but WITH KEY boton = boton.
    IF sy-subrc = 0.
      quickinfo = but-quickinfo.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_BOTON_TEXT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="60 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_BOTON_TEXT" SCONAME="BOTON" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_BOTON_TEXT" SCONAME="TEXT" VERSION="1" LANGU="S" DESCRIPT="Menu Painter: Interfase programa para textos dinámicos" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="SMP_DYNTXT-TEXT"/>
  <source>METHOD get_boton_text.
    DATA but TYPE t_boton.

    READ TABLE i_botones INTO but WITH KEY boton = boton.
    IF sy-subrc = 0.
      IF NOT but-text IS INITIAL.
        text = but-text.
      ELSEIF NOT but-quickinfo IS INITIAL.
        text = but-quickinfo.
      ELSE.
        text = boton.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_CELDA_ACTIVA" VERSION="1" LANGU="S" DESCRIPT="Recupera la celda activa" EXPOSURE="2" STATE="1" EDITORDER="27 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_CELDA_ACTIVA" SCONAME="CELDA" VERSION="1" LANGU="S" DESCRIPT="Información celdas" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="SALV_T_CELL"/>
  <source>METHOD get_celda_activa.
    CLEAR celda.
    celda = o_selections-&gt;get_selected_cells( ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_COL" VERSION="1" LANGU="S" DESCRIPT="Devuelve col" EXPOSURE="2" STATE="1" EDITORDER="53 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_COL" SCONAME="COLUM" VERSION="1" LANGU="S" DESCRIPT="Número de dos posiciones" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="NUMC2"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_COL" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_COL" SCONAME="AUX1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_COL" SCONAME="COL" VERSION="1" LANGU="S" DESCRIPT="Columnas" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ZAP_ALV_COLUMNAS"/>
  <source>METHOD get_col.
    CLEAR col.
    IF NOT colum IS INITIAL.
      READ TABLE i_columnas INTO col WITH KEY colum = colum.
    ELSEIF NOT campo IS INITIAL.
      READ TABLE i_columnas INTO col WITH KEY campo = campo.
    ELSEIF NOT aux1 IS INITIAL.
      READ TABLE i_columnas INTO col WITH KEY aux1 = aux1.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_COLUMNAS" VERSION="1" LANGU="S" DESCRIPT="Devuelve las columnas mostradas por el ALV" EXPOSURE="2" STATE="1" EDITORDER="48 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_COLUMNAS" SCONAME="I_COL" VERSION="1" LANGU="S" DESCRIPT="Columnas" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="ZAP_ALV_COLUMNAS3_T"/>
  <source>METHOD get_columnas.
    DATA: o_colt TYPE REF TO cl_salv_columns_table,
          i_cols TYPE salv_t_column_ref,
          l_col  TYPE zap_alv_columnas3.

    FIELD-SYMBOLS &lt;col&gt; TYPE salv_s_column_ref.

    o_colt = o_alv-&gt;get_columns( ).
    i_cols = o_colt-&gt;get( ).

    LOOP AT i_cols ASSIGNING &lt;col&gt;.
      CLEAR l_col.
      l_col-colum       = sy-tabix.
      l_col-campo       = &lt;col&gt;-columnname.
      l_col-descr       = &lt;col&gt;-r_column-&gt;get_medium_text( ).
      l_col-descr_larga = &lt;col&gt;-r_column-&gt;get_long_text( ).
      IF &lt;col&gt;-r_column-&gt;is_visible( ) = &apos;&apos;.
        l_col-noout = &apos;X&apos;.
      ENDIF.
      APPEND l_col TO i_col.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_COLUMNA_ACTIVA" VERSION="1" LANGU="S" DESCRIPT="Recupera la columna activa" EXPOSURE="2" STATE="1" EDITORDER="25 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_COLUMNA_ACTIVA" SCONAME="COLUMNA" VERSION="1" LANGU="S" DESCRIPT="Columnas de lista ALV" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="SALV_T_COLUMN"/>
  <source>METHOD get_columna_activa.
    CLEAR columna.
    columna = o_selections-&gt;get_selected_columns( ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_CSV_AS_STRING" VERSION="1" LANGU="S" DESCRIPT="Devuelve CSV como un string" EXPOSURE="2" STATE="1" EDITORDER="39 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_CSV_AS_STRING" SCONAME="QUITAR_CARACTERES_EXTRANOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_CSV_AS_STRING" SCONAME="STRING_CSV" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_CSV_AS_STRING" SCONAME="T_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD get_csv_as_string.
    DATA: i_csv    TYPE table_of_strings,
          l_string TYPE string.

    exportar_csv( EXPORTING separador                  = cl_abap_char_utilities=&gt;horizontal_tab
                            quitar_caracteres_extranos = quitar_caracteres_extranos
                  IMPORTING i_csv                      = i_csv
                  CHANGING  t_tabla                    = t_tabla ).

    CLEAR string_csv.
    LOOP AT i_csv INTO l_string.
      IF string_csv IS INITIAL.
        string_csv = l_string.
      ELSE.
        CONCATENATE string_csv cl_abap_char_utilities=&gt;cr_lf l_string INTO string_csv.
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_DATOS_CELDA_ACTIVA" VERSION="1" LANGU="S" DESCRIPT="Recupera la celda activa" EXPOSURE="2" STATE="1" EDITORDER="31 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_DATOS_CELDA_ACTIVA" SCONAME="CELDA" VERSION="1" LANGU="S" DESCRIPT="Información celdas" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="SALV_S_CELL"/>
  <source>METHOD get_datos_celda_activa.
    DATA i_celdas_sel TYPE salv_t_cell.

    CLEAR celda.
    i_celdas_sel = get_celda_activa( ).
    READ TABLE i_celdas_sel INTO celda INDEX 1.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_DATOS_LAYOUT" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="64 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_DATOS_LAYOUT" SCONAME="REORDENAR_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_DATOS_LAYOUT" SCONAME="TABLA_REF" VERSION="1" LANGU="S" DESCRIPT="Tabla de referencia" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABNAME" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_DATOS_LAYOUT" SCONAME="SORT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="KKBLO_T_SORTINFO"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_DATOS_LAYOUT" SCONAME="FILTER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="KKBLO_T_FILTER"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_DATOS_LAYOUT" SCONAME="T_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <source>METHOD get_datos_layout.
    &quot; TODO: parameter SORT is never cleared or assigned (ABAP cleaner)
    &quot; TODO: parameter FILTER is never cleared or assigned (ABAP cleaner)

    DATA:
      ls_vari TYPE disvariant,
      lt_fcat TYPE lvc_t_fcat,
      ls_layo TYPE lvc_s_layo,
      l_sort  TYPE kkblo_sortinfo.
*      lt_sort TYPE lvc_t_sort,
*      lt_filt TYPE lvc_t_filt.
    DATA lt_kkblo_fieldcat TYPE kkblo_t_fieldcat.
    DATA lt_kkblo_sort     TYPE kkblo_t_sortinfo.
    &quot; TODO: variable is assigned but only used in commented-out code (ABAP cleaner)
    DATA lt_kkblo_filter   TYPE kkblo_t_filter.
    DATA ls_kkblo_layout   TYPE kkblo_layout.
    DATA: l_sortc TYPE abap_sortorder,
          i_sortc TYPE abap_sortorder_tab.

    cl_salv_controller_metadata=&gt;get_variant(
      EXPORTING
*       r_layout  = me-&gt;r_layout
        r_layout  = o_alv-&gt;get_layout( )
      CHANGING
        s_variant = ls_vari ).

* get columns object (basic field catalog data)
    DATA(lo_columns) = o_alv-&gt;get_columns( ).
* get aggregations object (Sorts&amp;Sums)
    DATA(lo_aggregations) = o_alv-&gt;get_aggregations( ).
* use method to create field catalog from this information
    lt_fcat =
      cl_salv_controller_metadata=&gt;get_lvc_fieldcatalog(
      r_columns      = lo_columns
      r_aggregations = lo_aggregations ).

    IF NOT tabla_ref IS INITIAL.
      IF tabla_ref = &apos;X&apos;.
        LOOP AT lt_fcat ASSIGNING FIELD-SYMBOL(&lt;fcat&gt;) WHERE domname &lt;&gt; &apos;&apos; AND ref_table IS INITIAL.
          SELECT entitytab
            FROM dd01l
            WHERE domname = @&lt;fcat&gt;-domname
            ORDER BY PRIMARY KEY
            INTO @&lt;fcat&gt;-ref_table
            UP TO 1 ROWS.
          ENDSELECT.
          IF NOT &lt;fcat&gt;-ref_table IS INITIAL.
            SELECT fieldname
              FROM dd03l
              WHERE tabname  = @&lt;fcat&gt;-ref_table
                AND rollname = @&lt;fcat&gt;-rollname
                AND domname  = @&lt;fcat&gt;-domname
              ORDER BY PRIMARY KEY
              INTO @&lt;fcat&gt;-ref_field
              UP TO 1 ROWS.
            ENDSELECT.
            IF sy-subrc = 0.
              set_field( campo = &lt;fcat&gt;-fieldname op = &apos;DDIC_REF&apos; valor = &lt;fcat&gt;-ref_table valor2 = &lt;fcat&gt;-ref_field ).
            ENDIF.
          ENDIF.
        ENDLOOP.
      ELSE.
        DATA(i_campos_tab) = zcl_ap_dev=&gt;get_fieldcatalog_tabla( tabla_ref ).
        LOOP AT lt_fcat ASSIGNING &lt;fcat&gt; WHERE ref_table IS INITIAL.
          ASSIGN i_campos_tab[ fieldname = &lt;fcat&gt;-fieldname ] TO FIELD-SYMBOL(&lt;campo&gt;).
          IF sy-subrc = 0.
            &lt;fcat&gt;-ref_field = &lt;campo&gt;-fieldname.
            &lt;fcat&gt;-ref_table = tabla_ref.
            set_field( campo = &lt;fcat&gt;-fieldname op = &apos;DDIC_REF&apos; valor = &lt;fcat&gt;-ref_table valor2 = &lt;fcat&gt;-ref_field ).
          ENDIF.
        ENDLOOP.
      ENDIF.
    ENDIF.

*    lt_fcat = zcl_ap_dev=&gt;get_fieldcatalog_tabla_alv( t_tabla  ).
* the fieldcatalog is not complete yet!
    CALL FUNCTION &apos;LVC_FIELDCAT_COMPLETE&apos;
      EXPORTING
        i_complete       = &apos;X&apos;
        i_refresh_buffer = space
        i_buffer_active  = space
        is_layout        = ls_layo
        i_test           = &apos;1&apos;
        i_fcat_complete  = &apos;X&apos;
*     IMPORTING
*       E_EDIT           =
*       ES_LAYOUT        =
      CHANGING
        ct_fieldcat      = lt_fcat.

    IF ls_vari-variant IS NOT INITIAL.

      CALL FUNCTION &apos;LVC_TRANSFER_TO_KKBLO&apos;
        EXPORTING
          it_fieldcat_lvc         = lt_fcat
        IMPORTING
          et_fieldcat_kkblo       = lt_kkblo_fieldcat
*     TABLES
*         IT_DATA                 =
        EXCEPTIONS
          it_data_missing         = 1
          it_fieldcat_lvc_missing = 2
          OTHERS                  = 3.
      IF sy-subrc &lt;&gt; 0. &quot;#EC EMPTY_IF_BRANCH
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
      ENDIF.

      CALL FUNCTION &apos;LT_VARIANT_LOAD&apos;
        EXPORTING
*         I_TOOL              = &apos;LT&apos;
          i_tabname           = &apos;1&apos;
*         I_TABNAME_SLAVE     =
          i_dialog            = &apos; &apos;
*         I_USER_SPECIFIC     = &apos; &apos;
*         I_DEFAULT           = &apos;X&apos;
*         I_NO_REPTEXT_OPTIMIZE       =
*         I_VIA_GRID          =
          i_fcat_complete     = &apos;X&apos;
        IMPORTING
*         E_EXIT              =
          et_fieldcat         = lt_kkblo_fieldcat
          et_sort             = lt_kkblo_sort
          et_filter           = lt_kkblo_filter
        CHANGING
          cs_layout           = ls_kkblo_layout
          ct_default_fieldcat = lt_kkblo_fieldcat
          cs_variant          = ls_vari
        EXCEPTIONS
          wrong_input         = 1
          fc_not_complete     = 2
          not_found           = 3
          OTHERS              = 4.
      IF sy-subrc &lt;&gt; 0. &quot;#EC EMPTY_IF_BRANCH
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
      ELSE.
        IF reordenar_tabla = &apos;X&apos;.
          LOOP AT lt_kkblo_sort INTO l_sort.
            CLEAR l_sortc.
            l_sortc-name = l_sort-fieldname.
            IF l_sort-down = &apos;X&apos;.
              l_sortc-descending = &apos;X&apos;.
            ENDIF.
            APPEND l_sortc TO i_sortc.
          ENDLOOP.
          SORT t_tabla BY (i_sortc).
        ENDIF.
      ENDIF.

*      CALL FUNCTION &apos;LVC_TRANSFER_FROM_KKBLO&apos;
*        EXPORTING
**         I_TECH_COMPLETE   =
**         I_STRUCTURE_NAME  =
*          it_fieldcat_kkblo = lt_kkblo_fieldcat
*          it_sort_kkblo     = lt_kkblo_sort
*          it_filter_kkblo   = lt_kkblo_filter
**         IT_SPECIAL_GROUPS_KKBLO         =
**         IT_FILTERED_ENTRIES_KKBLO       =
**         IT_GROUPLEVELS_KKBLO            =
**         IS_SUBTOT_OPTIONS_KKBLO         =
*          is_layout_kkblo   = ls_kkblo_layout
**         IS_REPREP_ID_KKBLO              =
**         I_CALLBACK_PROGRAM_KKBLO        =
**         IT_ADD_FIELDCAT   =
**         IT_EXCLUDING_KKBLO              =
**         IT_EXCEPT_QINFO_KKBLO           =
*        IMPORTING
*          et_fieldcat_lvc   = lt_fcat
*          et_sort_lvc       = lt_sort
*          et_filter_lvc     = lt_filt
**         ET_SPECIAL_GROUPS_LVC           =
**         ET_FILTER_INDEX_LVC             =
**         ET_GROUPLEVELS_LVC              =
**         ES_TOTAL_OPTIONS_LVC            =
*          es_layout_lvc     = ls_layo
**         ES_VARIANT_LVC    =
**         E_VARIANT_SAVE_LVC              =
**         ES_PRINT_INFO_LVC =
**         ES_REPREP_LVC     =
**         E_REPREP_ACTIVE_LVC             =
**         ET_EXCLUDING_LVC  =
**         ET_EXCEPT_QINFO_LVC             =
*        TABLES
*          it_data           = t_tabla
*        EXCEPTIONS
*          it_data_missing   = 1
*          OTHERS            = 2.
*      IF sy-subrc &lt;&gt; 0.
** MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
**         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
*      ENDIF.

    ELSE.
      IF reordenar_tabla = &apos;X&apos;.
        get_orden( IMPORTING orden = DATA(i_orden) ).
        LOOP AT i_orden ASSIGNING FIELD-SYMBOL(&lt;orden&gt;).
          APPEND VALUE #( name = &lt;orden&gt;-name ) TO i_sortc.
        ENDLOOP.
        SORT t_tabla BY (i_sortc).
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_DEFAULT_LAYOUT" VERSION="1" LANGU="S" DESCRIPT="Recupera el layout por defecto" EXPOSURE="2" STATE="1" EDITORDER="37 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_DEFAULT_LAYOUT" SCONAME="LAYOUT" VERSION="1" LANGU="S" DESCRIPT="Layout" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="DISVARIANT-VARIANT"/>
  <source>METHOD get_default_layout.
    DATA ls_layout TYPE salv_s_layout_info.

    ls_layout = cl_salv_layout_service=&gt;get_default_layout(
      s_key    = key_layout
      restrict = cl_salv_layout=&gt;restrict_none ).

    layout = ls_layout-layout.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_F4_LAYOUT" VERSION="1" LANGU="S" DESCRIPT="Matchcode de F4 para posibles layouts" EXPOSURE="2" STATE="1" EDITORDER="20 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_F4_LAYOUT" SCONAME="LAYOUT" VERSION="1" LANGU="S" DESCRIPT="Layout" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="DISVARIANT-VARIANT"/>
  <source>METHOD get_f4_layout.
    DATA ls_layout TYPE salv_s_layout_info.

    ls_layout = cl_salv_layout_service=&gt;f4_layouts(
      s_key    = key_layout
      restrict = cl_salv_layout=&gt;restrict_none ).

    layout = ls_layout-layout.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_FILA_ACTIVA" VERSION="1" LANGU="S" DESCRIPT="Devuelve la fila en la que está posicionado el cursor" EXPOSURE="2" STATE="1" EDITORDER="22 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_FILA_ACTIVA" SCONAME="FILA" VERSION="1" LANGU="S" DESCRIPT="Número natural" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="INT4"/>
  <source>METHOD get_fila_activa.
    DATA l_celda TYPE salv_s_cell.

    CLEAR: fila, i_rows.
    o_alv-&gt;get_metadata( ).
    i_rows = o_selections-&gt;get_selected_rows( ).
    READ TABLE i_rows INTO fila INDEX 1.

    IF sy-subrc &lt;&gt; 0.
      l_celda = get_datos_celda_activa( ).
      fila = l_celda-row.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_LISTA_COLUMNAS" VERSION="1" LANGU="S" DESCRIPT="Devuelve lista de columnas" EXPOSURE="2" STATE="1" EDITORDER="55 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_LISTA_COLUMNAS" SCONAME="EXCLUIR_CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_LISTA_COLUMNAS" SCONAME="SOLO_CAMPOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_LISTA_COLUMNAS" SCONAME="LISTA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_lista_columnas.
    DATA: i_col   TYPE zap_alv_columnas3_t,
          r_rango TYPE rstt_t_range_string.

    FIELD-SYMBOLS &lt;col&gt; TYPE zap_alv_columnas3.

    i_col = get_columnas( ).

    IF NOT excluir_campos IS INITIAL.
      r_rango = zcl_ap_lista=&gt;lista2rango( lista = excluir_campos ).
      DELETE i_col WHERE campo IN r_rango.
    ENDIF.

    IF NOT solo_campos IS INITIAL.
      r_rango = zcl_ap_lista=&gt;lista2rango( lista = solo_campos ).
      DELETE i_col WHERE NOT campo IN r_rango.
    ENDIF.

    LOOP AT i_col ASSIGNING &lt;col&gt;.
      __add_lista lista &lt;col&gt;-campo.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_NOMBRE_COLUMNA_ACTIVA" VERSION="1" LANGU="S" DESCRIPT="Devuelve el nombre de la columna activa" EXPOSURE="2" STATE="1" EDITORDER="26 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_NOMBRE_COLUMNA_ACTIVA" SCONAME="COL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_nombre_columna_activa.
    DATA i_columnas TYPE salv_t_column.

    i_columnas = get_columna_activa( ).
    READ TABLE i_columnas INDEX 1 INTO col.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_ORDEN" VERSION="1" LANGU="S" DESCRIPT="Recupera orden" EXPOSURE="2" STATE="1" EDITORDER="63 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_ORDEN" SCONAME="ORDEN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_ORDEN"/>
  <source>METHOD get_orden.
    DATA: o_sorts         TYPE REF TO cl_salv_sorts,
          o_sort_defined  TYPE sap_bool,
          o_sort_table    TYPE salv_t_sort_ref,
          o_sort_column   TYPE salv_s_sort_ref,
          wa_sort_columns TYPE t_orden.

    o_sorts = o_alv-&gt;get_sorts( ).
    o_sort_defined = o_sorts-&gt;is_sort_defined( ).

    IF o_sort_defined = abap_true.

      o_sort_table = o_sorts-&gt;get( ).

      LOOP AT o_sort_table INTO o_sort_column.
        CLEAR wa_sort_columns.
        wa_sort_columns-name  = o_sort_column-columnname.
        wa_sort_columns-order = o_sort_column-r_sort-&gt;get_sequence( ).

        APPEND wa_sort_columns TO orden.
      ENDLOOP.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_REGISTROS_FILTRADOS" VERSION="1" LANGU="S" DESCRIPT="Devuelve filas filtradas en el ALV" EXPOSURE="2" STATE="1" EDITORDER="66 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_REGISTROS_FILTRADOS" SCONAME="I_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_REGISTROS_FILTRADOS" SCONAME="I_REGISTROS_FILTRADOS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <source>METHOD get_registros_filtrados.
    TYPES: BEGIN OF seln_ty,
             column TYPE string,
             r_seln TYPE RANGE OF string,
           END OF seln_ty.

    DATA lp_data TYPE REF TO data.

    FIELD-SYMBOLS: &lt;et_data&gt;  TYPE INDEX TABLE,
                   &lt;ls_data&gt;  TYPE any,
                   &lt;l_column&gt; TYPE any.

    DATA: ls_sel_range  TYPE seln_ty,
          lr_filters    TYPE REF TO cl_salv_filters,
          lt_filters    TYPE salv_t_filter_ref,
          ls_filter     TYPE salv_s_filter_ref,
          ltr_selns     TYPE salv_t_selopt_ref,
          lr_seln       TYPE REF TO cl_salv_selopt,
          ls_sel        LIKE LINE OF ls_sel_range-r_seln,
          lth_sel_range TYPE HASHED TABLE OF seln_ty WITH UNIQUE KEY column.

* Build data set to export
    CREATE DATA lp_data LIKE i_tabla.
    ASSIGN lp_data-&gt;* TO &lt;et_data&gt;.

* Build work area
    CREATE DATA lp_data LIKE LINE OF i_tabla.
    ASSIGN lp_data-&gt;* TO &lt;ls_data&gt;.

    &lt;et_data&gt; = i_tabla.
    lr_filters = o_alv-&gt;get_filters( ).
    lt_filters = lr_filters-&gt;get( ).

* Go through the filters on each columns, build select ranges
    LOOP AT lt_filters INTO ls_filter.
      ls_sel_range-column = ls_filter-columnname.
      CLEAR ls_sel_range-r_seln.
      ltr_selns = ls_filter-r_filter-&gt;get( ).
      LOOP AT ltr_selns INTO lr_seln.
        ls_sel-sign   = lr_seln-&gt;get_sign( ).
        ls_sel-option = lr_seln-&gt;get_option( ).
        ls_sel-low    = lr_seln-&gt;get_low( ).
        ls_sel-high   = lr_seln-&gt;get_high( ).
        INSERT ls_sel INTO TABLE ls_sel_range-r_seln.
      ENDLOOP.

      INSERT ls_sel_range INTO TABLE lth_sel_range.
    ENDLOOP.

* Go through the data eliminating records that don&apos;t match the filters
    LOOP AT &lt;et_data&gt; INTO &lt;ls_data&gt;.
      LOOP AT lth_sel_range INTO ls_sel_range.
        ASSIGN COMPONENT ls_sel_range-column OF STRUCTURE &lt;ls_data&gt; TO &lt;l_column&gt;.
        IF &lt;l_column&gt; IN ls_sel_range-r_seln.
          CONTINUE.
        ENDIF.
        DELETE &lt;et_data&gt;.
        EXIT.
      ENDLOOP.
    ENDLOOP.

    i_registros_filtrados = &lt;et_data&gt;.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_SELECCION" VERSION="1" LANGU="S" DESCRIPT="Recupera las filas seleccionadas" EXPOSURE="2" STATE="1" EDITORDER="14 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_SELECCION" SCONAME="DESHACER_ORDENACION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_SELECCION" SCONAME="HAY_SEL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_SELECCION" SCONAME="T_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD get_seleccion.
    DATA: l_campo TYPE string,
          l_row   TYPE int4,
          l_sorts TYPE REF TO cl_salv_sorts.

    FIELD-SYMBOLS: &lt;tabla&gt; TYPE table,
                   &lt;check&gt; TYPE any,
                   &lt;campo&gt; TYPE c.

*  IF deshacer_ordenacion = &apos;X&apos;.
*    l_sorts = o_alv-&gt;get_sorts( ).
*
*    l_sorts-&gt;clear( ).
*  ENDIF.

    CLEAR: i_rows, hay_sel.
    IF o_selections IS INITIAL.
      RETURN.
    ENDIF.

    o_alv-&gt;get_metadata( ).
    i_rows = o_selections-&gt;get_selected_rows( ).

    IF campo_check IS INITIAL.
      RETURN.
    ENDIF.

    IF t_tabla IS INITIAL.
      ASSIGN (nombre_tabla) TO &lt;tabla&gt;.
      IF sy-subrc = 0.
        LOOP AT &lt;tabla&gt; ASSIGNING &lt;check&gt;.
          CONCATENATE &apos;&lt;CHECK&gt;-&apos; campo_check INTO l_campo.
          ASSIGN (l_campo) TO &lt;campo&gt;.
          READ TABLE i_rows FROM sy-tabix TRANSPORTING NO FIELDS.
          IF sy-subrc = 0.
            &lt;campo&gt; = &apos;X&apos;.
            hay_sel = &apos;X&apos;.
          ELSE.
            CLEAR &lt;campo&gt;.
          ENDIF.
        ENDLOOP.
      ENDIF.
    ELSE.
      LOOP AT t_tabla ASSIGNING &lt;check&gt;.
        CONCATENATE &apos;&lt;CHECK&gt;-&apos; campo_check INTO l_campo.
        ASSIGN (l_campo) TO &lt;campo&gt;.
        READ TABLE i_rows FROM sy-tabix TRANSPORTING NO FIELDS.
        IF sy-subrc = 0.
          &lt;campo&gt; = &apos;X&apos;.
          hay_sel = &apos;X&apos;.
        ELSE.
          CLEAR &lt;campo&gt;.
        ENDIF.
      ENDLOOP.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="GET_VALOR_CAMPO" VERSION="1" LANGU="S" DESCRIPT="Devuelve el valor del campo" EXPOSURE="2" STATE="1" EDITORDER="52 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_VALOR_CAMPO" SCONAME="REGISTRO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_VALOR_CAMPO" SCONAME="COLUM" VERSION="1" LANGU="S" DESCRIPT="Número de dos posiciones" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="NUMC2"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_VALOR_CAMPO" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="GET_VALOR_CAMPO" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD get_valor_campo.
    DATA: l_col   TYPE zap_alv_columnas,
          l_campo TYPE string.

    FIELD-SYMBOLS &lt;fs&gt; TYPE any.

    CLEAR valor.
    l_col = get_col( colum = colum campo = campo ).

    IF NOT l_col IS INITIAL.
      CONCATENATE &apos;REGISTRO-&apos; l_col-campo INTO l_campo.
      ASSIGN (l_campo) TO &lt;fs&gt;.
      IF sy-subrc = 0.
        valor = &lt;fs&gt;.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_DOUBLE_CLICK" VERSION="1" LANGU="S" DESCRIPT="Doble click" EXPOSURE="2" STATE="1" EDITORDER="3 " DISPID="0 " MTDTYPE="1" MTDDECLTYP="0" REFCLSNAME="CL_SALV_EVENTS_TABLE" REFINTNAME="IF_SALV_EVENTS_ACTIONS_TABLE" REFCMPNAME="DOUBLE_CLICK" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_DOUBLE_CLICK" SCONAME="ROW" VERSION="1" LANGU="S" DESCRIPT="Line" CMPTYPE="1" MTDTYPE="1" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="0"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_DOUBLE_CLICK" SCONAME="COLUMN" VERSION="1" LANGU="S" DESCRIPT="Column" CMPTYPE="1" MTDTYPE="1" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="0"/>
  <source>METHOD handle_double_click.
    handle_link_click( row = row column = column ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_END_OF_PAGE" VERSION="1" LANGU="S" DESCRIPT="End of page" EXPOSURE="2" STATE="1" EDITORDER="8 " DISPID="0 " MTDTYPE="1" MTDDECLTYP="0" REFCLSNAME="CL_SALV_EVENTS_TABLE" REFCMPNAME="END_OF_PAGE" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_END_OF_PAGE" SCONAME="R_END_OF_PAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="1" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="0"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_END_OF_PAGE" SCONAME="PAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="1" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="0"/>
  <source>METHOD handle_end_of_page.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_LINK_CLICK" VERSION="1" LANGU="S" DESCRIPT="Link Click" EXPOSURE="2" STATE="1" EDITORDER="5 " DISPID="0 " MTDTYPE="1" MTDDECLTYP="0" REFCLSNAME="CL_SALV_EVENTS_TABLE" REFCMPNAME="LINK_CLICK" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_LINK_CLICK" SCONAME="ROW" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="1" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="0"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_LINK_CLICK" SCONAME="COLUMN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="1" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="0"/>
  <source>METHOD handle_link_click.
    DATA: l_campo   TYPE string,
          l_hotspot TYPE t_hotspot,
          l_message TYPE bapi_msg.

    FIELD-SYMBOLS: &lt;tabla&gt;  TYPE table,
                   &lt;list&gt;   TYPE any,
                   &lt;valor&gt;  TYPE any,
                   &lt;valor2&gt; TYPE any,
                   &lt;valor3&gt; TYPE any.

    SET PARAMETER ID &apos;Z_NO_VAR_DEF&apos; FIELD &apos;X&apos;.
    IF table_ref IS INITIAL.
      CONCATENATE &apos;&apos; nombre_tabla INTO l_campo.
      ASSIGN (l_campo) TO &lt;tabla&gt;.
    ELSE.
      ASSIGN me-&gt;table_ref-&gt;* TO &lt;tabla&gt;.
    ENDIF.

    IF &lt;tabla&gt; IS ASSIGNED.
      ASSIGN &lt;tabla&gt;[ row ] TO &lt;list&gt;.
      IF sy-subrc = 0.

        READ TABLE i_hotspot INTO l_hotspot WITH KEY campo = column.

        l_message = visualizar_objeto( list = &lt;list&gt; column = column hotspot = l_hotspot row = row ).
        IF l_message IS INITIAL.
          SET PARAMETER ID &apos;Z_NO_VAR_DEF&apos; FIELD &apos;&apos;.
          RETURN.
        ENDIF.

        IF NOT o_alv_helper IS INITIAL.
          l_message = o_alv_helper-&gt;visualizar_objeto( list = &lt;list&gt; column = column hotspot = l_hotspot row = row ).
          IF l_message IS INITIAL.
            SET PARAMETER ID &apos;Z_NO_VAR_DEF&apos; FIELD &apos;&apos;.
            RETURN.
          ENDIF.
        ENDIF.

        IF NOT l_hotspot IS INITIAL.
          IF l_hotspot-transaccion &lt;&gt; &apos;&apos;.
            visualizar_obj( hotspot = l_hotspot list = &lt;list&gt; column = column ).
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.
    SET PARAMETER ID &apos;Z_NO_VAR_DEF&apos; FIELD &apos;&apos;.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_TOP_OF_PAGE" VERSION="1" LANGU="S" DESCRIPT="Top of page" EXPOSURE="2" STATE="1" EDITORDER="7 " DISPID="0 " MTDTYPE="1" MTDDECLTYP="0" REFCLSNAME="CL_SALV_EVENTS_TABLE" REFCMPNAME="TOP_OF_PAGE" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_TOP_OF_PAGE" SCONAME="R_TOP_OF_PAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="1" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="0"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_TOP_OF_PAGE" SCONAME="PAGE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="1" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="0"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_TOP_OF_PAGE" SCONAME="TABLE_INDEX" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="1" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="0"/>
  <source>METHOD handle_top_of_page.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_USER_COMMAND" VERSION="1" LANGU="S" DESCRIPT="User Command" EXPOSURE="2" STATE="1" EDITORDER="4 " DISPID="0 " MTDTYPE="1" MTDDECLTYP="0" REFCLSNAME="CL_SALV_EVENTS_TABLE" REFINTNAME="IF_SALV_EVENTS_FUNCTIONS" REFCMPNAME="ADDED_FUNCTION" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="HANDLE_USER_COMMAND" SCONAME="E_SALV_FUNCTION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="1" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="0" TYPTYPE="0"/>
  <source>METHOD handle_user_command.
*  BREAK-POINT.

*  get_seleccion( ).

    FIELD-SYMBOLS &lt;tabla&gt; TYPE table.

    CLEAR: ucomm, ucomm_text, accion_ejecutada.
    ucomm = e_salv_function.
    IF ( ucomm(1) = &apos;F&apos; OR ucomm(1) = &apos;M&apos; ) AND strlen( ucomm ) = 3.
      ASSIGN i_botones[ boton = ucomm ] TO FIELD-SYMBOL(&lt;boton&gt;).
      IF sy-subrc = 0.
        ucomm_text = &lt;boton&gt;-text.
        IF NOT &lt;boton&gt;-ucomm IS INITIAL.
          ucomm = &lt;boton&gt;-ucomm.
        ENDIF.
      ENDIF.
    ENDIF.

    IF zcl_ap_lista=&gt;es_elemento( lista = check_ucomm_sel elemento = ucomm ).
      IF NOT o_dev IS INITIAL AND NOT table_ref IS INITIAL.
        ASSIGN table_ref-&gt;* TO &lt;tabla&gt;.
        IF sy-subrc = 0.
          get_seleccion( CHANGING t_tabla = &lt;tabla&gt; ).
          LOOP AT &lt;tabla&gt; ASSIGNING FIELD-SYMBOL(&lt;linea&gt;).
            IF o_dev-&gt;get_vals( campo = &apos;CHECK&apos; linea = &lt;linea&gt; ) = &apos;X&apos;.
              DATA(l_ok) = &apos;X&apos;.
              EXIT.
            ENDIF.
          ENDLOOP.
          IF l_ok IS INITIAL.
            check_ucomm_sel = &apos;ERROR&apos;.
            MESSAGE i104(dlcn). &quot; Seleccione por lo menos un registro
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.

    CASE ucomm.
      WHEN &apos;VISIBLE&apos;.
        IF NOT o_dev IS INITIAL.
          accion_ejecutada = &apos;X&apos;.
          zcl_ap_batch_input=&gt;cambiar_modo( CHANGING modo = o_dev-&gt;modo_ct ).
        ENDIF.
      WHEN &apos;EXCEL&apos;.
        IF NOT o_dev IS INITIAL AND NOT table_ref IS INITIAL.
          ASSIGN table_ref-&gt;* TO &lt;tabla&gt;.
          IF sy-subrc = 0.
            accion_ejecutada = &apos;X&apos;.

            SELECT SINGLE clsname FROM seoclass
              &quot; TODO: variable is assigned but never used (ABAP cleaner)
              INTO @DATA(l_clase)
             WHERE clsname = &apos;ZCL_AP_ABAP2XLS&apos;.
            IF sy-subrc = 0.
              zcl_ap_abap2xls=&gt;alv_2_xls( alv = o_alv tabla = &lt;tabla&gt; abrir = &apos;X&apos; nombre_fichero = sy-title ).
            ELSE.
              exportar_excel( ).
            ENDIF.
          ENDIF.
        ENDIF.
    ENDCASE.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" VERSION="1" LANGU="S" DESCRIPT="Creación inicial de los objetos relacionados con el ALV" EXPOSURE="0" STATE="1" EDITORDER="1 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="LIST_DISPLAY" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="OPTIMIZE" VERSION="1" LANGU="S" DESCRIPT="Optimizar ancho" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="BOTONES_STANDARD" VERSION="1" LANGU="S" DESCRIPT="Mostrar el ALV como Popup" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="COLOR" VERSION="1" LANGU="S" DESCRIPT="Columna con campo color" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="LVC_FNAME" PARVALUE="&apos; &apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="STATUS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos; &apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="SEL" VERSION="1" LANGU="S" DESCRIPT="&apos;&apos; No, &apos;X&apos; Simple, &apos;M&apos; Multiple" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="C" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="CAMPO_CHECK" VERSION="1" LANGU="S" DESCRIPT="Field Name" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="LIGHTS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PARVALUE="&apos;I_LISTADO&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="NO_LAYOUT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="RESTRICCION_LAYOUT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PARVALUE="IF_SALV_C_LAYOUT=&gt;RESTRICT_NONE"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="INICIO_COLUMNA" VERSION="1" LANGU="S" DESCRIPT="Tipo tabla ZAP_ALV_COLUMNAS" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="SIN_BUFFER" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="13 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="CPROG" VERSION="1" LANGU="S" DESCRIPT="Programa de llamada" CMPTYPE="1" MTDTYPE="0" EDITORDER="14 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-CPROG" PARVALUE="SY-CPROG"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="TOP_OF_PAGE_AUTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="15 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="TOP_OF_PAGE_TITULO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="16 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="LOGO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="17 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="STATUS_PROG" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="18 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="HANDLE" VERSION="1" LANGU="S" DESCRIPT="ID de gestión para llamada múltiple desde el mismo programa" CMPTYPE="1" MTDTYPE="0" EDITORDER="19 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SLIS_HANDL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="O_DEV" VERSION="1" LANGU="S" DESCRIPT="Utilizadades desarrollo" CMPTYPE="1" MTDTYPE="0" EDITORDER="20 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_DEV" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="INICIALIZA_OBJETOS" SCONAME="NO_AGRUPAR_CELDAS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="21 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD inicializa_objetos.
    DATA l_cprog  TYPE sy-cprog.
    DATA l_status TYPE sypfkey.

    me-&gt;logo = logo.

    o_dspset = o_alv-&gt;get_display_settings( ).
    o_dspset-&gt;set_striped_pattern( cl_salv_display_settings=&gt;true ).
    IF no_agrupar_celdas = &apos;X&apos;.
      o_dspset-&gt;set_no_merging( cl_salv_display_settings=&gt;true ).
    ENDIF.

    o_layout = o_alv-&gt;get_layout( ).

    me-&gt;sin_buffer = sin_buffer.

    key_layout-report = cprog.
    IF NOT handle IS INITIAL.
      key_layout-handle = handle.
    ELSEIF tabla IS INITIAL.
      key_layout-handle = &apos;NONE&apos;.
    ELSE.
      key_layout-handle = tabla.
    ENDIF.

    IF no_layout = &apos;&apos;.
      o_layout-&gt;set_key( key_layout ).
      o_layout-&gt;set_default( &apos;X&apos; ).
      o_layout-&gt;set_save_restriction( restriccion_layout ).
    ENDIF.

    me-&gt;status = status.

    IF NOT status_prog IS INITIAL.
      l_cprog = status_prog.
    ELSE.
      l_cprog = cprog.
    ENDIF.
    SELECT obj_code
      FROM rsmptexts                                    &quot;#EC CI_GENBUFF
      WHERE progname = @l_cprog
        AND obj_type = &apos;C&apos;
        AND obj_code = @me-&gt;status
      ORDER BY PRIMARY KEY
      INTO @me-&gt;status
      UP TO 1 ROWS.
    ENDSELECT.
    IF sy-subrc &lt;&gt; 0.
      CLEAR me-&gt;status.
    ENDIF.

* activate ALV generic Functions
    IF botones_standard = &apos;X&apos;.
      o_functions = o_alv-&gt;get_functions( ).
      o_functions-&gt;set_all( ).

      o_functions_list = o_alv-&gt;get_functions( ).

*    o_alv-&gt;SET_SCREEN_STATUS( PFSTATUS = &apos;DISPLAY&apos;
*                                 REPORT = SY-REPID
*                                 SET_FUNCTIONS = o_alv-&gt;C_FUNCTIONS_ALL ).
    ENDIF.

    IF NOT me-&gt;status IS INITIAL.
*        set_status( status ).
      l_status = me-&gt;status.
      o_alv-&gt;set_screen_status(
          report        = l_cprog
          pfstatus      = l_status
          set_functions = o_alv-&gt;c_functions_all ).
    ENDIF.

* set the columns technical
    o_columns = o_alv-&gt;get_columns( ).
    me-&gt;optimize = optimize.
    o_columns-&gt;set_optimize( optimize ).
    i_columns = o_columns-&gt;get( ).

    IF NOT lights IS INITIAL.
      TRY.
          o_columns-&gt;set_exception_column( value = &apos;LIGHTS&apos; ).
        CATCH cx_salv_data_error.
          MESSAGE &apos;Error fijando columna estado&apos; TYPE &apos;S&apos;.
      ENDTRY.
    ENDIF.

* Selecciones
    o_selections = o_alv-&gt;get_selections( ).
    IF NOT sel IS INITIAL.
      IF NOT campo_check IS INITIAL.
        me-&gt;campo_check = campo_check.
        set_field( op = &apos;NOOUT&apos; campo = campo_check ).
      ENDIF.
      IF sel = &apos;X&apos;.
        o_selections-&gt;set_selection_mode( if_salv_c_selection_mode=&gt;single ).
      ELSE.
        o_selections-&gt;set_selection_mode( if_salv_c_selection_mode=&gt;row_column ).
      ENDIF.
    ENDIF.

    o_events = o_alv-&gt;get_event( ).
    SET HANDLER handle_double_click FOR o_events.
    SET HANDLER handle_user_command FOR o_events.
    SET HANDLER handle_link_click FOR o_events.

    IF NOT color IS INITIAL.
* El campo de color debe de ser: t_color TYPE lvc_t_scol
      TRY.
          o_columns-&gt;set_color_column( color ).
        CATCH cx_salv_data_error.
          MESSAGE &apos;Error fijando campo color&apos; TYPE &apos;S&apos;.
      ENDTRY.
      campo_color = color.
    ENDIF.

    o_sorts = o_alv-&gt;get_sorts( ).
    o_aggregation = o_alv-&gt;get_aggregations( ).

    set_seleccion( ).

    o_top_page = NEW #( ).

    IF NOT inicio_columna IS INITIAL.
      i_columnas = fill_columnas( inicio_columna ).
    ENDIF.

    me-&gt;top_of_page_auto   = top_of_page_auto.
    me-&gt;top_of_page_titulo = top_of_page_titulo.

    me-&gt;o_dev              = o_dev.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="OCULTAR_COLUMNAS_VACIAS" VERSION="1" LANGU="S" DESCRIPT="Ocultar columnas vacias" EXPOSURE="2" STATE="1" EDITORDER="49 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="OCULTAR_COLUMNAS_VACIAS" SCONAME="T_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD ocultar_columnas_vacias.
    DATA: i_campos TYPE abap_component_tab,
          l_campos TYPE abap_componentdescr,
          l_valor  TYPE c LENGTH 1.

    FIELD-SYMBOLS: &lt;tabla&gt; TYPE table,
                   &lt;linea&gt; TYPE any,
                   &lt;valor&gt; TYPE any.

    IF me-&gt;nombre_tabla IS INITIAL.
      IF NOT t_tabla IS INITIAL.
        i_campos = zcl_ap_dev=&gt;get_fieldcatalog( t_tabla ).
        ASSIGN t_tabla TO &lt;tabla&gt;.
      ENDIF.
    ELSE.
      ASSIGN (me-&gt;nombre_tabla) TO &lt;tabla&gt;.
      IF sy-subrc = 0.
        IF NOT &lt;tabla&gt; IS INITIAL.
          i_campos = zcl_ap_dev=&gt;get_fieldcatalog( &lt;tabla&gt; ).
        ENDIF.
      ENDIF.
    ENDIF.

    DELETE i_campos WHERE name IS INITIAL.
    DELETE i_campos WHERE name = &apos;CHECK&apos; OR name = &apos;LIGHTS&apos;.
    IF i_campos IS INITIAL.
      RETURN.
    ENDIF.

    LOOP AT i_campos INTO l_campos.
      CLEAR l_valor.
      LOOP AT &lt;tabla&gt; ASSIGNING &lt;linea&gt;.
        ASSIGN COMPONENT l_campos-name OF STRUCTURE &lt;linea&gt; TO &lt;valor&gt;.
        IF sy-subrc = 0.
          IF NOT &lt;valor&gt; IS INITIAL.
            l_valor = &apos;X&apos;.
            EXIT.
          ENDIF.
        ENDIF.
      ENDLOOP.
      IF l_valor IS INITIAL.
        set_field_noout( l_campos-name ).
      ENDIF.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="REFRESH" VERSION="1" LANGU="S" DESCRIPT="Refrescar display" EXPOSURE="2" STATE="1" EDITORDER="17 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="REFRESH" SCONAME="S_STABLE" VERSION="1" LANGU="S" DESCRIPT="Control LVA: Estabilidad de refrescar" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="LVC_S_STBL" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="REFRESH" SCONAME="REFRESH_MODE" VERSION="1" LANGU="S" DESCRIPT="ALV: Elemento de datos para constantes" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SALV_DE_CONSTANT" PARVALUE="IF_SALV_C_REFRESH=&gt;SOFT"/>
  <source>METHOD refresh.
    DATA l_stable TYPE lvc_s_stbl.

    IF NOT s_stable IS SUPPLIED.
      l_stable-row = &apos;X&apos;.
      l_stable-col = &apos;X&apos;.
    ELSE.
      l_stable = s_stable.
    ENDIF.

    IF me-&gt;optimize = &apos;X&apos;.
      o_columns-&gt;set_optimize( &apos;X&apos; ).
    ENDIF.

    TRY.
        o_alv-&gt;refresh( s_stable     = l_stable
                        refresh_mode = refresh_mode ).
      CATCH cx_root. &quot;#EC *
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="REMOVE_BUTTON" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="65 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="REMOVE_BUTTON" SCONAME="BUTTON" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Código función que ha lanzado PAI" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-UCOMM"/>
  <source>METHOD remove_button.
    IF button IS NOT INITIAL.
      IF NOT line_exists( allowed_buttons[ function = button ] ).
        DELETE excluded_buttons WHERE table_line = button.
        APPEND button TO excluded_buttons.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="RESTORE_BUTTONS" VERSION="1" LANGU="S" DESCRIPT="Guarda los botnes del status ZAP_STATUS" EXPOSURE="2" STATE="1" EDITORDER="71 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="RESTORE_BUTTONS" SCONAME="STATUS2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <source>METHOD restore_buttons.
    IF status2 IS INITIAL.
      PERFORM restaurar_botones_v1 IN PROGRAM zap_status.
    ELSE.
      PERFORM restaurar_botones_v1 IN PROGRAM zap_status2.
    ENDIF.
    i_botones = i_botones_v0.
    buttons = buttons_v0.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SAVE_BUTTONS" VERSION="1" LANGU="S" DESCRIPT="Guarda los botnes del status ZAP_STATUS" EXPOSURE="2" STATE="1" EDITORDER="70 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SAVE_BUTTONS" SCONAME="STATUS2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <source>METHOD save_buttons.
    IF status2 IS INITIAL.
      PERFORM guardar_botones_v1 IN PROGRAM zap_status.
      PERFORM clear_botones IN PROGRAM zap_status.
    ELSE.
      PERFORM guardar_botones_v1 IN PROGRAM zap_status2.
      PERFORM clear_botones IN PROGRAM zap_status2.
    ENDIF.
    i_botones_v0 = i_botones.
    buttons_v0 = buttons.
    CLEAR: i_botones, buttons.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_AGREGACION" VERSION="1" LANGU="S" DESCRIPT="Subtotales" EXPOSURE="2" STATE="1" EDITORDER="16 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_AGREGACION" SCONAME="CAMPO" VERSION="1" LANGU="S" DESCRIPT="Campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_AGREGACION" SCONAME="TIPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SALV_DE_AGGREGATION" PARVALUE="IF_SALV_C_AGGREGATION=&gt;TOTAL"/>
  <source>METHOD set_agregacion.
    DATA: i_columnas  TYPE TABLE OF lvc_fname,
          l_columname TYPE lvc_fname,
          l_error     TYPE c LENGTH 80.

    SPLIT campo AT &apos;,&apos; INTO TABLE i_columnas.
    LOOP AT i_columnas INTO l_columname.
      TRY.
          o_column = o_columns-&gt;get_column(
                         columnname = l_columname ).
          o_aggregation-&gt;add_aggregation( columnname = l_columname aggregation = tipo ).
        CATCH cx_salv_not_found.
          CONCATENATE &apos;Campo&apos;(cam) l_columname &apos;no existe&apos;(noe) INTO l_error
                      SEPARATED BY space.
          MESSAGE l_error TYPE &apos;I&apos;
                  DISPLAY LIKE &apos;E&apos;.
        CATCH cx_salv_data_error.
          MESSAGE &apos;Error fijando campo como subtotal&apos; TYPE &apos;S&apos;.
        CATCH cx_salv_existing.
          MESSAGE &apos;Error fijando campo como subtotal&apos; TYPE &apos;S&apos;.
      ENDTRY.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_COLOR" VERSION="1" LANGU="S" DESCRIPT="Fija color" EXPOSURE="2" STATE="1" EDITORDER="12 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_COLOR" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_COLOR" SCONAME="COLOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I"/>
  <source>METHOD set_color.
    DATA: l_column  TYPE string,
          lr_column TYPE REF TO cl_salv_column_table,
          ls_color  TYPE lvc_s_colo.

    IF campo IS INITIAL.
      l_column = campo_color.
    ELSE.
      l_column = campo.
    ENDIF.
    IF l_column IS INITIAL.
      RETURN.
    ENDIF.

    SPLIT l_column AT &apos;,&apos; INTO TABLE DATA(i_column).
    LOOP AT i_column INTO l_column.
      l_column = to_upper( l_column ).
      TRY.
          lr_column ?= o_columns-&gt;get_column( CONV #( l_column ) ).
        CATCH cx_salv_not_found.
          MESSAGE &apos;Campo no existe para fijar color&apos; TYPE &apos;E&apos;.
      ENDTRY.

      ls_color-col = color.

      ls_color-int = 0.

      ls_color-inv = 0.

      lr_column-&gt;set_color( ls_color ).

    ENDLOOP.
* El campo de color debe de ser: t_color TYPE lvc_t_scol
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_COLUMNAS" VERSION="1" LANGU="S" DESCRIPT="Datos de columnas desde tabla interna" EXPOSURE="2" STATE="1" EDITORDER="40 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_COLUMNAS" SCONAME="I_COLUMNAS" VERSION="1" LANGU="S" DESCRIPT="Tipo tabla ZAP_ALV_COLUMNAS" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_ALV_COLUMNAS_T" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_COLUMNAS" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <source>METHOD set_columnas.
    DATA: i_cols  TYPE zap_alv_columnas_t,
          i_colsc TYPE zap_alv_columnas_t,
          l_col   TYPE zap_alv_columnas.

    IF i_columnas IS INITIAL.
      i_cols = me-&gt;i_columnas.
    ELSE.
      i_cols = i_columnas.
    ENDIF.

    IF NOT campo IS INITIAL.
      i_colsc = fill_columnas( campo ).
      LOOP AT i_colsc INTO l_col.
        IF NOT line_exists( i_cols[ campo = l_col-campo ] ).
          APPEND l_col TO i_cols.
        ENDIF.
      ENDLOOP.
    ENDIF.

    LOOP AT i_cols INTO l_col.

      set_field_text( campo = l_col-campo valor = l_col-descr valor2 = l_col-descr_larga ).
      IF l_col-noout = &apos;X&apos;.
        set_field_noout( l_col-campo ).
      ENDIF.
      IF l_col-input = &apos;X&apos;.
        set_field_input( l_col-campo ).
      ENDIF.
      IF l_col-dosum = &apos;X&apos;.
        set_field( campo = l_col-campo op = &apos;SUM&apos; ).
      ENDIF.
      IF l_col-no_cero = &apos;X&apos;.
        set_field( campo = l_col-campo op = &apos;NO_CERO&apos; ).
      ENDIF.
      IF l_col-cambia_decimales = &apos;X&apos;.
        set_field_decimales( campo = l_col-campo valor = l_col-decimales ).
      ENDIF.
      IF l_col-ancho &lt;&gt; 0.
        set_field( campo = l_col-campo op = &apos;ANCHO&apos; valor = l_col-ancho ).
      ENDIF.
      IF l_col-borrar = &apos;X&apos;.
        set_field_quitar( l_col-campo ).
      ENDIF.
    ENDLOOP.

    IF me-&gt;i_columnas IS INITIAL.
      me-&gt;i_columnas = i_cols.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_COLUMNAS3" VERSION="1" LANGU="S" DESCRIPT="Datos de columnas desde tabla interna" EXPOSURE="2" STATE="1" EDITORDER="41 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_COLUMNAS3" SCONAME="I_COLUMNAS" VERSION="1" LANGU="S" DESCRIPT="Tipo tabla ZAP_ALV_COLUMNAS3" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ZAP_ALV_COLUMNAS3_T" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_COLUMNAS3" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <source>METHOD set_columnas3.
    DATA: i_cols  TYPE zap_alv_columnas3_t,
          i_colsc TYPE zap_alv_columnas3_t,
          l_col   TYPE zap_alv_columnas3.

    IF i_columnas IS INITIAL.
      i_cols = i_columnas3.
    ELSE.
      i_cols = i_columnas.
    ENDIF.

    IF NOT campo IS INITIAL.
*    i_colsc = fill_columnas( campo ).
      LOOP AT i_colsc INTO l_col.
        IF NOT line_exists( i_cols[ campo = l_col-campo ] ).
          APPEND l_col TO i_cols.
        ENDIF.
      ENDLOOP.
    ENDIF.

    LOOP AT i_cols INTO l_col.
      set_field_text( campo = l_col-campo valor = l_col-descr ).
      IF l_col-noout = &apos;X&apos;.
        set_field_noout( l_col-campo ).
      ENDIF.
      IF l_col-input = &apos;X&apos;.
        set_field_input( l_col-campo ).
      ENDIF.
      IF l_col-dosum = &apos;X&apos;.
        set_field( campo = l_col-campo op = &apos;SUM&apos; ).
      ENDIF.
      IF l_col-no_cero = &apos;X&apos;.
        set_field( campo = l_col-campo op = &apos;NO_CERO&apos; ).
      ENDIF.
      IF l_col-cambia_decimales = &apos;X&apos;.
        set_field_decimales( campo = l_col-campo valor = l_col-decimales ).
      ENDIF.
      IF l_col-ancho &lt;&gt; 0.
        set_field( campo = l_col-campo op = &apos;ANCHO&apos; valor = l_col-ancho ).
      ENDIF.
      IF l_col-borrar = &apos;X&apos;.
        set_field_quitar( l_col-campo ).
      ENDIF.
    ENDLOOP.

    IF i_columnas IS INITIAL.
      i_columnas3 = i_cols.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_END_OF_PAGE" VERSION="1" LANGU="S" DESCRIPT="Fijar top of page" EXPOSURE="2" STATE="1" EDITORDER="19 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD set_end_of_page.
    end_of_page( ).
    o_alv-&gt;set_end_of_list( o_content ).
    SET HANDLER handle_end_of_page FOR o_events.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD" VERSION="1" LANGU="S" DESCRIPT="Fija atributos de un campo" EXPOSURE="2" STATE="1" EDITORDER="6 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD" SCONAME="OP" VERSION="1" LANGU="S" DESCRIPT="Operación" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TEXT10"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD" SCONAME="CAMPO" VERSION="1" LANGU="S" DESCRIPT="Campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD" SCONAME="VALOR2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <source>METHOD set_field.
    DATA: i_column     TYPE TABLE OF lvc_fname,
          l_column     TYPE lvc_fname,
          l_text       TYPE c LENGTH 100,
          l_decimals   TYPE lvc_decmls,
          l_dec_column TYPE lvc_dfname,
          lr_column    TYPE REF TO cl_salv_column_table,
          l_outputlen  TYPE lvc_outlen,
          l_texto      TYPE scrtext_s,
          l_texto2     TYPE scrtext_l,
          l_texto3     TYPE scrtext_m,
          l_opt        TYPE abap_bool,
          l_int        TYPE i,
          l_error      TYPE string.
    DATA l_hotspot TYPE t_hotspot.
    DATA ls_ddic   TYPE salv_s_ddic_reference.

    SPLIT campo AT &apos;,&apos; INTO TABLE i_column.
    LOOP AT i_column INTO l_column.
      TRANSLATE l_column TO UPPER CASE.
      TRY.
          IF op = &apos;POSICION&apos; AND l_column CS &apos;/&apos;.
            SPLIT l_column AT &apos;/&apos; INTO l_column l_text.
          ENDIF.
          o_column = o_columns-&gt;get_column(
                         columnname = l_column ).
          CASE op.
            WHEN &apos;EDIT&apos; OR &apos;INPUT&apos;. &quot; o_column-&gt;set_edit( &apos;X&apos; ).
            WHEN &apos;NOOUT&apos; OR &apos;NO_OUT&apos;. o_column-&gt;set_visible( &apos; &apos; ).
            WHEN &apos;QUITAR&apos;. o_column-&gt;set_technical( if_salv_c_bool_sap=&gt;true ).
            WHEN &apos;PONER&apos;. o_column-&gt;set_technical( if_salv_c_bool_sap=&gt;false ).
            WHEN &apos;OUT&apos;. o_column-&gt;set_visible( &apos;X&apos; ).
            WHEN &apos;DECIMALS&apos;.
              l_decimals = valor.
              o_column-&gt;set_decimals( l_decimals ).
              IF NOT valor2 IS INITIAL.
                l_dec_column = valor2.
                TRY.
                    o_column-&gt;set_decimals_column( l_dec_column ).
                  CATCH cx_salv_data_error.
                    MESSAGE &apos;Error fijando cambiando decimales&apos; TYPE &apos;S&apos;.
                ENDTRY.
              ENDIF.
            WHEN &apos;SUM&apos; OR &apos;DOSUM&apos;.
              set_agregacion( l_column ).
            WHEN &apos;MERGE&apos;. &quot;&lt;fcat&gt;-no_merging = &apos;&apos;.
            WHEN &apos;KEY&apos;.
              lr_column ?= o_columns-&gt;get_column( l_column ).
              lr_column-&gt;set_key( abap_true ).
              o_columns-&gt;set_key_fixation( value = abap_true ).
            WHEN &apos;LONG&apos;. &quot;&lt;fcat&gt;-outputlen = valor.
            WHEN &apos;ANCHO&apos;.
              l_outputlen = valor.
              o_column-&gt;set_output_length( l_outputlen ).
            WHEN &apos;CHECKBOX&apos;.
*           o_column-&gt;set_cell_type( if_salv_c_cell_type=&gt;checkbox ).
              lr_column ?= o_columns-&gt;get_column( l_column ).
              lr_column-&gt;set_cell_type( if_salv_c_cell_type=&gt;checkbox ).

            WHEN &apos;NO_ZERO&apos; OR &apos;NO_CERO&apos;.
              o_column-&gt;set_zero( &apos;&apos; ).

            WHEN &apos;DROPDOWN&apos;.
              &quot;&lt;fcat&gt;-drdn_hndl = valor.
            WHEN &apos;TEXTO&apos;.
              l_texto = valor.
              IF valor2 IS INITIAL.
                l_texto2 = valor.
              ELSE.
                l_texto2 = valor2.
              ENDIF.

              IF valor IS INITIAL AND valor2 IS INITIAL.
                l_text = l_column.
                l_text+1 = to_lower( l_text+1 ).
                l_text+1 = translate( val  = l_text+1
                                      from = `_`
                                      to   = ` ` ).
                l_texto  = l_text.
                l_texto2 = l_text.
                l_texto3 = l_text.

                IF l_texto CS &apos; de &apos;.
                  REPLACE ALL OCCURRENCES OF &apos; de &apos; IN l_texto WITH &apos; &apos;.
                ENDIF.
              ENDIF.

              o_column-&gt;set_short_text( l_texto ).
              l_texto3 = l_texto2.
              o_column-&gt;set_medium_text( l_texto3 ).
              o_column-&gt;set_long_text( l_texto2 ).

            WHEN &apos;HOTSPOT&apos;.
              lr_column ?= o_columns-&gt;get_column( l_column ).
              lr_column-&gt;set_cell_type( if_salv_c_cell_type=&gt;hotspot ).
              IF NOT valor IS INITIAL.
                l_hotspot-campo       = l_column.
                l_hotspot-transaccion = valor.
                l_texto = valor.
                IF l_texto(4) = &apos;IDA_&apos;.
                  l_hotspot-filtro = valor2.
                ELSE.
                  l_hotspot-campo_ref = valor2.
                ENDIF.
                APPEND l_hotspot TO i_hotspot.
              ENDIF.
            WHEN &apos;OPT&apos;.
              lr_column ?= o_columns-&gt;get_column( l_column ).
              l_opt = valor.
              lr_column-&gt;set_optimized( l_opt ).

            WHEN &apos;POSICION&apos;.
              IF l_text IS INITIAL.
                l_int = valor.
              ELSE.
                l_int = l_text.
              ENDIF.
              o_columns-&gt;set_column_position( columnname = l_column position = l_int ).

            WHEN &apos;DDIC_REF&apos;.
              lr_column ?= o_columns-&gt;get_column( l_column ).
              IF lr_column IS INITIAL.
                IF sy-uname = zcl_c=&gt;usuario_ap.
                  MESSAGE s398(00) WITH &apos;Error en SET_FIELD OP=&apos;(esf) op l_column &apos;&apos;.
                ENDIF.
              ELSE.
                ls_ddic-table = valor.
                ls_ddic-field = valor2.

                TRY.
                    lr_column-&gt;set_ddic_reference( ls_ddic ).
                    lr_column-&gt;set_f4( abap_true ).

                  CATCH cx_root INTO DATA(o_root). &quot;#EC *
                    IF sy-sysid &lt;&gt; zcl_c=&gt;entorno_produccion OR sy-uname = zcl_c=&gt;usuario_ap.
                      DATA(l_msg) = o_root-&gt;get_text( ).
                      CONCATENATE &apos;Campo&apos;(cam) l_column &apos;Error en DDIC_REF&apos; l_msg INTO l_error
                                  SEPARATED BY space.
                      MESSAGE l_error TYPE &apos;I&apos; DISPLAY LIKE &apos;E&apos;.
                    ENDIF.
                ENDTRY.
              ENDIF.

            WHEN &apos;COL_AFTER&apos;.
              l_int = o_columns-&gt;get_column_position( columnname = CONV #( valor ) ).
              o_columns-&gt;set_column_position( columnname = l_column position = l_int ).
              o_columns-&gt;set_column_position(  columnname = CONV #( valor ) position   = l_int ).

            WHEN &apos;COL_BEFORE&apos;.
              l_int = o_columns-&gt;get_column_position( columnname = CONV #( valor ) ).
              IF l_int &gt; 1.
                l_int = l_int - 1.
                o_columns-&gt;set_column_position( columnname = l_column position = l_int ).
              ENDIF.

            WHEN OTHERS.
              MESSAGE e398(00) WITH &apos;Error en SET_FIELD OP=&apos;(esf) op
                                    &apos;no definida&apos;(nod) &apos;&apos;.
          ENDCASE.

        CATCH cx_salv_not_found.
          IF sy-sysid &lt;&gt; zcl_c=&gt;entorno_produccion OR sy-uname = zcl_c=&gt;usuario_ap.
            CONCATENATE &apos;Campo&apos;(cam) l_column &apos;no existe&apos;(noe) INTO l_error
                        SEPARATED BY space.
            MESSAGE l_error TYPE &apos;I&apos;
                    DISPLAY LIKE &apos;E&apos;.
          ENDIF.
      ENDTRY.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_DECIMALES" VERSION="1" LANGU="S" DESCRIPT="Fija el nº de decimales del campo" EXPOSURE="2" STATE="1" EDITORDER="36 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_DECIMALES" SCONAME="CAMPO" VERSION="1" LANGU="S" DESCRIPT="Campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_DECIMALES" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="0"/>
  <source>METHOD set_field_decimales.
    set_field( op = &apos;DECIMALS&apos; campo = campo valor = valor ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_HOTSPOT" VERSION="1" LANGU="S" DESCRIPT="Fija el campo como HotSpot" EXPOSURE="2" STATE="1" EDITORDER="67 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_HOTSPOT" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_HOTSPOT" SCONAME="AUTO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_HOTSPOT" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_HOTSPOT" SCONAME="VALOR2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <source>METHOD set_field_hotspot.
    DATA: i_campos TYPE TABLE OF string,
          l_campo  TYPE string,
          l_aux    TYPE c LENGTH 20.

    IF auto IS INITIAL.
      set_field( op = &apos;HOTSPOT&apos; campo = campo valor = valor valor2 = valor2 ).
    ELSE.
      SPLIT campo AT &apos;,&apos; INTO TABLE i_campos.
      LOOP AT i_campos INTO l_campo.
        l_campo = to_upper( l_campo ).
        CASE l_campo.
          WHEN &apos;KUNNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;XD03&apos; ).
          WHEN &apos;LIFNR&apos; OR &apos;TDLNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;XK03&apos; ).
          WHEN &apos;MATNR&apos; OR &apos;PLNBEZ&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;MM03&apos; ).
          WHEN &apos;VBELN&apos; OR &apos;VBELN_VA&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;VA03&apos; ).
          WHEN &apos;VBELN_VL&apos; OR &apos;ENTREGA&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;VL03N&apos; ).
          WHEN &apos;VBELN_VF&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;VF03&apos; ).
          WHEN &apos;TKNUM&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;VT03N&apos; ).
          WHEN &apos;BANFN&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;ME53N&apos; ).
          WHEN &apos;BNFPO&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;ME53N&apos; valor2 = &apos;BANFN&apos; ).
          WHEN &apos;EBELN&apos; OR &apos;KONNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;ME23N&apos; ).
          WHEN &apos;EBELP&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;ME23N&apos; valor2 = &apos;EBELN&apos; ).
          WHEN &apos;KTPNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;ME23N&apos; valor2 = &apos;KONNR&apos; ).
          WHEN &apos;BELNR&apos; OR &apos;AUGBL&apos;.
            set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;FB03&apos; ).
          WHEN &apos;BELNR_RBKP&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;MIR7&apos; ).
          WHEN &apos;GJAHR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;FB03&apos;  valor2 = &apos;BELNR&apos; ).
          WHEN &apos;MBLNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;MB03&apos; ).
          WHEN &apos;MJAHR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;MB03&apos;  valor2 = &apos;MJAHR&apos; ).
          WHEN &apos;EXIDV&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;HUMO&apos; ).
          WHEN &apos;AUFNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;CO03&apos; ).
          WHEN &apos;WARPL&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;IP03&apos; ).
          WHEN &apos;TPLNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;IL03&apos; ).
          WHEN &apos;EQUNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;IE03&apos; ).
          WHEN &apos;MDOCM&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;FO8U&apos; ).
          WHEN &apos;POINT&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;FO8X&apos; ).
          WHEN &apos;QMNUM&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;IW23&apos; ).
          WHEN &apos;TANUM&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;LT21&apos; ).
          WHEN &apos;FKNUM&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;VI03&apos; ).
          WHEN &apos;TBNUM&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;LB03&apos; ).
          WHEN &apos;LQNUM&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;LS23&apos; ).
          WHEN &apos;PRUEFLOS&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;QA03&apos; ).
          WHEN &apos;PLANS&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;PP01_S&apos; ).
          WHEN &apos;ORGEH&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;PP01_O&apos; ).
          WHEN &apos;CURSO&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;CURSO&apos; ).
          WHEN &apos;CURSO_EDT&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;CURSO_EDT&apos; ).
          WHEN &apos;DOCNUM&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;WEDI&apos; ).
          WHEN &apos;ANLN1&apos; OR &apos;ANLN2&apos;.
            set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;AS03&apos; ).
          WHEN &apos;KNUMA&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;VBO3&apos; ).
          WHEN &apos;PS_PSP_PNR&apos; OR &apos;PSPNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;CJ13&apos; ).
          WHEN &apos;URL&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;URL&apos; ).
          WHEN &apos;WI_ID&apos; OR &apos;WORKITEMID&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;WI_ID&apos; ).
          WHEN &apos;DOKNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;CV03N&apos; ).
          WHEN &apos;LGTYP&apos; OR &apos;LGPLA&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;LS03N&apos; ).
          WHEN &apos;VLTYP&apos; OR &apos;VLPLA&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;LS03N_V&apos; ).
          WHEN &apos;NLTYP&apos; OR &apos;NLPLA&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;LS03N_N&apos; ).
          WHEN &apos;REINR&apos; OR &apos;TRIPNO&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;PR05&apos; ).
          WHEN &apos;PERNR&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;PA20&apos; ).
          WHEN &apos;CHARG&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;MSC3N&apos; ).
          WHEN &apos;BUSINESSPARTNER&apos; OR &apos;PARTNER&apos;. set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;BP&apos; ).
          WHEN &apos;OBSERVACIONES&apos; OR &apos;TEXTO&apos;.
            set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;TEXT&apos; ).
          WHEN OTHERS.
            l_aux = l_campo.
            IF l_aux(3) = &apos;URL&apos;.
              set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = &apos;URL&apos; ).
            ELSE.
              set_field( op = &apos;HOTSPOT&apos; campo = l_campo valor = valor valor2 = valor2 ).
            ENDIF.
        ENDCASE.
      ENDLOOP.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_INPUT" VERSION="1" LANGU="S" DESCRIPT="Marca el campo como editable" EXPOSURE="2" STATE="1" EDITORDER="32 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_INPUT" SCONAME="CAMPO" VERSION="1" LANGU="S" DESCRIPT="Campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X" PARPREFERD="X"/>
  <source>METHOD set_field_input.
    set_field( op = &apos;INPUT&apos; campo = campo ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_NOOUT" VERSION="1" LANGU="S" DESCRIPT="Marca el campo como no visible" EXPOSURE="2" STATE="1" EDITORDER="33 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_NOOUT" SCONAME="CAMPO" VERSION="1" LANGU="S" DESCRIPT="Campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X" PARPREFERD="X"/>
  <source>METHOD set_field_noout.
    set_field( op = &apos;NO_OUT&apos; campo = campo ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_QUITAR" VERSION="1" LANGU="S" DESCRIPT="No muestra el campo en el ALV" EXPOSURE="2" STATE="1" EDITORDER="62 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_QUITAR" SCONAME="CAMPO" VERSION="1" LANGU="S" DESCRIPT="Campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X" PARPREFERD="X"/>
  <source>METHOD set_field_quitar.
    set_field( op = &apos;QUITAR&apos; campo = campo ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_TEXT" VERSION="1" LANGU="S" DESCRIPT="Define texto de campo" EXPOSURE="2" STATE="1" EDITORDER="34 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_TEXT" SCONAME="CAMPO" VERSION="1" LANGU="S" DESCRIPT="Campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_TEXT" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FIELD_TEXT" SCONAME="VALOR2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <source>METHOD set_field_text.
    set_field( op = &apos;TEXTO&apos; campo = campo valor = valor valor2 = valor2 ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FILTER" VERSION="1" LANGU="S" DESCRIPT="Fija filtros sobre un campo" EXPOSURE="2" STATE="1" EDITORDER="44 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FILTER" SCONAME="CAMPO" VERSION="1" LANGU="S" DESCRIPT="Campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FILTER" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FILTER" SCONAME="VALOR_HASTA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FILTER" SCONAME="SIGN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;I&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_FILTER" SCONAME="OPTION" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;EQ&apos;"/>
  <source>METHOD set_filter.
    DATA: lo_filters TYPE REF TO cl_salv_filters,
          l_low      TYPE salv_de_selopt_low,
          l_high     TYPE salv_de_selopt_high,
          l_op       TYPE char2.

    lo_filters = o_alv-&gt;get_filters( ).

    l_low = valor.
    l_high = valor_hasta.
    l_op = option.
    TRY.
        lo_filters-&gt;add_filter(
            columnname = campo
            sign       = sign
            option     = l_op
            low        = l_low
            high       = l_high ).

      CATCH cx_salv_not_found ##NO_HANDLER.
      CATCH cx_salv_data_error ##NO_HANDLER.
      CATCH cx_salv_existing ##NO_HANDLER.
    ENDTRY.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ICONO" VERSION="1" LANGU="S" DESCRIPT="Devuelve icono estado" EXPOSURE="2" STATE="1" EDITORDER="50 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ICONO" SCONAME="ICONO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ICONO" SCONAME="MENSAJE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ICONO" SCONAME="PERMITIR_FILTRO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;*&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ICONO" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>METHOD set_icono.
    DATA: l_icono   TYPE c LENGTH 4,
          l_long    TYPE c LENGTH 3,
          l_mensaje TYPE text255,
          l_lon     TYPE i.

    l_icono = icono.
    CASE l_icono.
      WHEN &apos;R&apos; OR &apos;1&apos; OR &apos;E&apos; OR &apos;A&apos;. l_icono = c_ico_rojo.
      WHEN &apos;2&apos; OR &apos;W&apos;. l_icono = c_ico_ambar.
      WHEN &apos;V&apos; OR &apos;3&apos; OR &apos;I&apos; OR &apos;S&apos;. l_icono = c_ico_verde.
*      WHEN &apos;W&apos;. l_icono = c_ico_warning.
      WHEN &apos;&apos;. l_icono = icon_space.
      WHEN OTHERS.
        l_icono = icono.
        IF l_icono(1) = &apos;@&apos;.
          l_long = strlen( l_icono ).
          IF l_long = 3.
            CONCATENATE l_icono &apos;@&apos; INTO l_icono.
          ENDIF.
        ENDIF.
    ENDCASE.

    IF mensaje IS INITIAL.
      valor = l_icono.
    ELSE.
      l_mensaje = mensaje.
      DO 3 TIMES.
        IF zcl_ap_string=&gt;ultimo_caracter( l_mensaje ) = &apos;@&apos;.
          l_lon = strlen( l_mensaje ) - 1.
          CLEAR l_mensaje+l_lon(1).
        ENDIF.
      ENDDO.
      IF NOT permitir_filtro IS INITIAL.
        CONCATENATE permitir_filtro l_mensaje INTO l_mensaje.
      ENDIF.

      CALL FUNCTION &apos;ICON_CREATE&apos;
        EXPORTING
          name                  = l_icono
          info                  = l_mensaje
          add_stdinf            = &apos;&apos;
        IMPORTING
          result                = valor
        EXCEPTIONS
          icon_not_found        = 1
          outputfield_too_short = 2
          OTHERS                = 3.
      IF sy-subrc &lt;&gt; 0.
        valor = icono.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_LAYOUT" VERSION="1" LANGU="S" DESCRIPT="Fija el layout" EXPOSURE="2" STATE="1" EDITORDER="21 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_LAYOUT" SCONAME="LAYOUT" VERSION="1" LANGU="S" DESCRIPT="Layout" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="DISVARIANT-VARIANT"/>
  <source>METHOD set_layout.
    o_layout-&gt;set_initial_layout( layout ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ORDEN" VERSION="1" LANGU="S" DESCRIPT="Criterios de ordenación" EXPOSURE="2" STATE="1" EDITORDER="15 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ORDEN" SCONAME="CAMPO" VERSION="1" LANGU="S" DESCRIPT="Campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING" PAROPTIONL="X" PARPREFERD="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ORDEN" SCONAME="UP" VERSION="1" LANGU="S" DESCRIPT="Indicador de una posición" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="CHAR1" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ORDEN" SCONAME="DOWN" VERSION="1" LANGU="S" DESCRIPT="Indicador de una posición" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="CHAR1" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ORDEN" SCONAME="GROUP" VERSION="1" LANGU="S" DESCRIPT="Cambio de grupo" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SALV_DE_SORT_GROUP" PARVALUE="IF_SALV_C_SORT=&gt;GROUP_NONE"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ORDEN" SCONAME="SUBTOT" VERSION="1" LANGU="S" DESCRIPT="Indicador de una posición" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="CHAR1" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_ORDEN" SCONAME="COMPRESS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <source>METHOD set_orden.
    DATA: l_sequence  TYPE salv_de_sort_sequence,
          l_columname TYPE lvc_fname,
          i_columnas  TYPE TABLE OF lvc_fname,
          l_subtot    TYPE abap_bool,
          l_len       TYPE i,
          l_error     TYPE c LENGTH 80.

    IF down = &apos;X&apos;.
      l_sequence = 2.
    ELSE.
      l_sequence = 1.
    ENDIF.

    l_columname = campo.
    SPLIT campo AT &apos;,&apos; INTO TABLE i_columnas.
    LOOP AT i_columnas INTO l_columname.
      TRY.
          l_subtot = subtot.
          IF l_columname CS &apos;*&apos;.
            l_len = strlen( l_columname ).
            IF l_len &gt; 2.
              l_len = l_len - 1.
              IF l_columname+l_len(1) = &apos;*&apos;.
                l_columname = l_columname(l_len).
                l_subtot = &apos;X&apos;.
              ENDIF.
            ENDIF.
          ENDIF.
          o_column = o_columns-&gt;get_column(
                         columnname = l_columname ).
          o_sorts-&gt;add_sort( columnname = l_columname
                             subtotal   = l_subtot
                             sequence   = l_sequence
                             group      = group ).

          IF compress = &apos;X&apos;.
            o_sorts-&gt;set_compressed_subtotal( l_columname ).
          ENDIF.
        CATCH cx_salv_not_found.
          CONCATENATE &apos;Campo&apos;(cam) l_columname &apos;no existe&apos;(noe) INTO l_error SEPARATED BY space.
          MESSAGE l_error TYPE &apos;I&apos; DISPLAY LIKE &apos;E&apos;.
        CATCH cx_salv_data_error.
          CONCATENATE &apos;Error ALV en orden campo&apos;(eoc) l_columname INTO l_error SEPARATED BY space.
          MESSAGE l_error TYPE &apos;I&apos; DISPLAY LIKE &apos;E&apos;.
        CATCH cx_salv_existing.
          CONCATENATE &apos;Error no existe ALV en orden campo&apos;(eno) l_columname INTO l_error SEPARATED BY space.
          MESSAGE l_error TYPE &apos;I&apos; DISPLAY LIKE &apos;E&apos;.
      ENDTRY.
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_SELECCION" VERSION="1" LANGU="S" DESCRIPT="Fija las filas seleccionadas" EXPOSURE="2" STATE="1" EDITORDER="24 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_SELECCION" SCONAME="T_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE" PAROPTIONL="X"/>
  <source>METHOD set_seleccion.
    DATA: t_row   TYPE salv_t_row,
          l_row   TYPE int4,
          l_campo TYPE string.

    FIELD-SYMBOLS: &lt;tabla&gt; TYPE table,
                   &lt;check&gt; TYPE any,
                   &lt;campo&gt; TYPE c.

    CLEAR i_rows.
    IF o_selections IS INITIAL.
      RETURN.
    ENDIF.

    IF campo_check IS INITIAL.
      RETURN.
    ENDIF.

    IF t_tabla IS INITIAL.
      ASSIGN (nombre_tabla) TO &lt;tabla&gt;.
      IF sy-subrc = 0.
        CLEAR t_row.
        LOOP AT &lt;tabla&gt; ASSIGNING &lt;check&gt;.
          l_row = sy-tabix.
          CONCATENATE &apos;&lt;CHECK&gt;-&apos; campo_check INTO l_campo.
          ASSIGN (l_campo) TO &lt;campo&gt;.
          IF &lt;campo&gt; = &apos;X&apos;.
            APPEND l_row TO t_row.
          ENDIF.
        ENDLOOP.
        o_selections-&gt;set_selected_rows( t_row ).
      ENDIF.
    ELSE.
      LOOP AT t_tabla ASSIGNING &lt;check&gt;.
        l_row = sy-tabix.
        CONCATENATE &apos;&lt;CHECK&gt;-&apos; campo_check INTO l_campo.
        ASSIGN (l_campo) TO &lt;campo&gt;.
        IF &lt;campo&gt; = &apos;X&apos;.
          APPEND l_row TO t_row.
        ENDIF.
      ENDLOOP.
      o_selections-&gt;set_selected_rows( t_row ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_STATUS" VERSION="1" LANGU="S" DESCRIPT="Fija el status de pantalla" EXPOSURE="2" STATE="1" EDITORDER="13 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_STATUS" SCONAME="STATUS" VERSION="1" LANGU="S" DESCRIPT="Current GUI Status" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SYPFKEY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_STATUS" SCONAME="REPID" VERSION="1" LANGU="S" DESCRIPT="Current report program" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-REPID" PARVALUE="SY-REPID"/>
  <source>METHOD set_status.
*  DATA: repid TYPE sy-repid.

*  repid = sy-repid.
    o_alv-&gt;set_screen_status(
        report        = repid
        pfstatus      = status
        set_functions = o_alv-&gt;c_functions_all ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_TITULO_COL_SIN_NOMBRE" VERSION="1" LANGU="S" DESCRIPT="Fija titulo en columnas sin nombre" EXPOSURE="2" STATE="1" EDITORDER="56 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD set_titulo_col_sin_nombre.
    DATA i_col TYPE TABLE OF zap_alv_columnas3.

    FIELD-SYMBOLS &lt;col&gt; TYPE zap_alv_columnas3.

    i_col = get_columnas( ).
    LOOP AT i_col ASSIGNING &lt;col&gt; WHERE descr IS INITIAL AND descr_larga IS INITIAL.
      set_field_text( &lt;col&gt;-campo ).
    ENDLOOP.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_TOP_OF_PAGE" VERSION="1" LANGU="S" DESCRIPT="Fijar top of page" EXPOSURE="2" STATE="1" EDITORDER="18 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_TOP_OF_PAGE" SCONAME="NREG" VERSION="1" LANGU="S" DESCRIPT="Nº registros" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PARVALUE="0"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_TOP_OF_PAGE" SCONAME="I_PARAM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_TOP_OF_PAGE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_TOP_OF_PAGE" SCONAME="EXCLUIR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD set_top_of_page.
    DATA: o_content_logo TYPE REF TO cl_salv_form_layout_logo,
          lr_grid        TYPE REF TO cl_salv_form_layout_grid.

    SET HANDLER handle_top_of_page FOR o_events.
    top_of_page( nreg    = nreg
                 i_param = i_param
                 excluir = excluir ).

    IF me-&gt;logo IS INITIAL.
      o_alv-&gt;set_top_of_list( o_content ).
    ELSE.
      o_content_logo = NEW #( ).
      lr_grid = o_top_page-&gt;get_grid( ).
      o_content_logo-&gt;set_left_content( lr_grid ).
      o_content_logo-&gt;set_right_logo( logo ).
      o_alv-&gt;set_top_of_list( o_content_logo ).
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SET_VALOR_CAMPO" VERSION="1" LANGU="S" DESCRIPT="Modifica el valor del campo" EXPOSURE="2" STATE="1" EDITORDER="54 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_VALOR_CAMPO" SCONAME="COLUM" VERSION="1" LANGU="S" DESCRIPT="Número de dos posiciones" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="NUMC2" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_VALOR_CAMPO" SCONAME="CAMPO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_VALOR_CAMPO" SCONAME="VALOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_VALOR_CAMPO" SCONAME="QUITAR_STYLE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_VALOR_CAMPO" SCONAME="QUITAR_COLOR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_VALOR_CAMPO" SCONAME="CAMPO_STYLE" VERSION="1" LANGU="S" DESCRIPT="Nombre campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="FIELDNAME" PARVALUE="&apos;STYLE&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_VALOR_CAMPO" SCONAME="CAMPO_COLOR" VERSION="1" LANGU="S" DESCRIPT="Nombre campo" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="FIELDNAME" PARVALUE="&apos;COLOR&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_VALOR_CAMPO" SCONAME="AUX1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SET_VALOR_CAMPO" SCONAME="REGISTRO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <source>METHOD set_valor_campo.
    DATA: l_col   TYPE zap_alv_columnas,
          l_campo TYPE string.

    FIELD-SYMBOLS: &lt;fs&gt;    TYPE any,
                   &lt;color&gt; TYPE lvc_t_scol,
                   &lt;style&gt; TYPE lvc_t_styl.

    l_col = get_col( colum = colum campo = campo aux1 = aux1 ).

    IF l_col IS INITIAL.
      RETURN.
    ENDIF.

    CONCATENATE &apos;REGISTRO-&apos; l_col-campo INTO l_campo.
    ASSIGN (l_campo) TO &lt;fs&gt;.
    IF sy-subrc &lt;&gt; 0.
      RETURN.
    ENDIF.

    &lt;fs&gt; = valor.

    IF quitar_color = &apos;X&apos;.
      CONCATENATE &apos;REGISTRO-&apos; campo_color INTO l_campo.
      ASSIGN (l_campo) TO &lt;color&gt;.
      IF sy-subrc = 0.
        DELETE &lt;color&gt; WHERE fname = l_col-campo.
      ENDIF.
    ENDIF.

    IF quitar_style = &apos;X&apos;.
      CONCATENATE &apos;REGISTRO-&apos; campo_style INTO l_campo.
      ASSIGN (l_campo) TO &lt;style&gt;.
      IF sy-subrc = 0.
        DELETE &lt;style&gt; WHERE fieldname = l_col-campo.
      ENDIF.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW" VERSION="1" LANGU="S" DESCRIPT="Muestra ALV" EXPOSURE="2" STATE="1" EDITORDER="2 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <source>METHOD show.
    DATA: l_fecha_buffer     TYPE d,
          &quot; TODO: variable is assigned but never used (ABAP cleaner)
          l_bypassing_buffer TYPE c LENGTH 1,
          &quot; TODO: variable is assigned but never used (ABAP cleaner)
          l_buffer           TYPE c LENGTH 1.

*With parameter I_BUFFER_ACTIVE = &apos;X&apos;, buffer A is activated.If I_BUFFER_ACTIVE remains initial, the contents are nevertheless buffered in buffer B.
* For dynamic reasons, you have to forgo buffering completely (for example, a constant dynamic creation of  structures) so that you have the following options as a developer:
*1. Set SET/GET parameters ALVBUFFER to the current date.All report, variant or field catalog buffers are reset until the current date exceeds the date of the SET/GET parameter.
*2. Set I_BYPASSING_BUFFER = &apos;X&apos; on the call interface for the function modules and class methods
*- Note 339258 - ALV buffer: concept, recommendations and known errors (BC-SRV-ALV, consulting)
*- Note 122975 - Resetting buffering of ALV field catalog (BC-SRV-ALV, Consulting)
*- Note 356792 - ALV buffer: SET/GET parameter ALVBUFFER created
    IF sy-sysid = zcl_c=&gt;entorno_desarrollo OR sin_buffer = &apos;X&apos;.
      cl_gui_alv_grid=&gt;m_buffer_inactive = &apos;X&apos;.
      l_fecha_buffer = sy-datum.                              &quot; + 1.
      SET PARAMETER ID &apos;ALVBUFFER&apos; FIELD l_fecha_buffer.
      l_bypassing_buffer = &apos;X&apos;.
* SUBMIT BALVBUFDEL
    ELSE.
      l_buffer = &apos;X&apos;.
    ENDIF.

    o_alv-&gt;display( ).
    ya_mostrado = &apos;X&apos;.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_BUTTON" VERSION="1" LANGU="S" EXPOSURE="2" STATE="1" EDITORDER="58 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_BUTTON" SCONAME="BUTTON" VERSION="1" LANGU="S" DESCRIPT="Campo de sistema ABAP: Código función que ha lanzado PAI" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="SY-UCOMM"/>
  <source>METHOD show_button.
    DATA allowed TYPE t_allowed_but.

    IF button IS INITIAL.
      RETURN.
    ENDIF.
    IF NOT line_exists( allowed_buttons[ function = button ] ).
      allowed = button.
      APPEND allowed TO allowed_buttons.
      DELETE excluded_buttons WHERE table_line = button.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP" VERSION="1" LANGU="S" DESCRIPT="Muestra ALV como popup" EXPOSURE="2" STATE="1" EDITORDER="11 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP" SCONAME="START_COLUMN" VERSION="1" LANGU="S" DESCRIPT="2 byte integer (signed)" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I" PARVALUE="1"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP" SCONAME="END_COLUMN" VERSION="1" LANGU="S" DESCRIPT="2 byte integer (signed)" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I" PARVALUE="100"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP" SCONAME="START_LINE" VERSION="1" LANGU="S" DESCRIPT="2 byte integer (signed)" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I" PARVALUE="1"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP" SCONAME="END_LINE" VERSION="1" LANGU="S" DESCRIPT="2 byte integer (signed)" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I" PARVALUE="20"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP" SCONAME="SEL" VERSION="1" LANGU="S" DESCRIPT="Selccionar" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;X&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP" SCONAME="TITULO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD show_popup.
    o_alv-&gt;set_screen_popup(
      start_column = start_column
      end_column   = end_column
      start_line   = start_line
      end_line     = end_line ).

    IF sel &lt;&gt; &apos;&apos;.
      o_selections = o_alv-&gt;get_selections( ).

      IF sel = &apos;X&apos;.
        o_selections-&gt;set_selection_mode( if_salv_c_selection_mode=&gt;row_column ).
      ELSE.
        o_selections-&gt;set_selection_mode( if_salv_c_selection_mode=&gt;single ).
      ENDIF.
    ENDIF.

    IF NOT titulo IS INITIAL.
      o_alv-&gt;get_display_settings( )-&gt;set_list_header( CONV #( titulo ) ).
    ENDIF.

    o_alv-&gt;display( ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" VERSION="1" LANGU="S" DESCRIPT="Show Popup STATIC" EXPOSURE="2" STATE="1" EDITORDER="45 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="START_COLUMN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I" PARVALUE="1"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="END_COLUMN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I" PARVALUE="100"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="START_LINE" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="I" PARVALUE="1"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="COLOR" VERSION="1" LANGU="S" DESCRIPT="ALV-Control: Nom.campo de campo tabla interno" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="LVC_FNAME" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FIELD_DOSUM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FIELD_NOOUT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FIELD_ORDEN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="7 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FIELD_HOTSPOT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="8 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_OP1" VERSION="1" LANGU="S" DESCRIPT="Texto de longitud 10" CMPTYPE="1" MTDTYPE="0" EDITORDER="9 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TEXT10" PARVALUE="&apos;EQ&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_CAMPO1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="10 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_VALOR1" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="11 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_VALOR_HASTA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="12 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_OP2" VERSION="1" LANGU="S" DESCRIPT="Texto de longitud 10" CMPTYPE="1" MTDTYPE="0" EDITORDER="13 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TEXT10" PARVALUE="&apos;EQ&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_CAMPO2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="14 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_VALOR2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="15 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_VALOR_HASTA2" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="16 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_OP3" VERSION="1" LANGU="S" DESCRIPT="Texto de longitud 10" CMPTYPE="1" MTDTYPE="0" EDITORDER="17 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TEXT10" PARVALUE="&apos;EQ&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_CAMPO3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="18 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_VALOR3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="19 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_VALOR_HASTA3" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="20 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_OP4" VERSION="1" LANGU="S" DESCRIPT="Texto de longitud 10" CMPTYPE="1" MTDTYPE="0" EDITORDER="21 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TEXT10" PARVALUE="&apos;EQ&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_CAMPO4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="22 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_VALOR4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="23 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FILTRO_VALOR_HASTA4" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="24 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="NO_LAYOUT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="25 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="RESTRICCION_LAYOUT" VERSION="1" LANGU="S" DESCRIPT="Número natural" CMPTYPE="1" MTDTYPE="0" EDITORDER="26 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PARVALUE="IF_SALV_C_LAYOUT=&gt;RESTRICT_NONE"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="FIELD_POS" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="27 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="O_ALV_HELPER" VERSION="1" LANGU="S" DESCRIPT="ALV" CMPTYPE="1" MTDTYPE="0" EDITORDER="28 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="3" TYPE="ZCL_AP_ALV" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="SHOW_POPUP_ST" SCONAME="T_TABLA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="29 " DISPID="0 " PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TABLE"/>
  <source>METHOD show_popup_st.
    DATA: o_alv      TYPE REF TO zcl_ap_alv,
          l_end_line TYPE i.

    o_alv = NEW #(
        tabla = &apos;&apos; ).

    o_alv-&gt;constructor_tabla( EXPORTING color = color restriccion_layout = restriccion_layout no_layout = no_layout CHANGING t_tabla = t_tabla ).

    l_end_line = lines( t_tabla ).
    l_end_line = l_end_line + start_line + 1.
    IF l_end_line &gt; 20.
      l_end_line = 20.
    ENDIF.

    IF NOT field_dosum IS INITIAL.
      o_alv-&gt;set_agregacion( field_dosum ).
    ENDIF.

    IF NOT field_noout IS INITIAL.
      o_alv-&gt;set_field_noout( field_noout ).
    ENDIF.

    IF NOT field_pos IS INITIAL.
      o_alv-&gt;set_field( campo = field_pos op = &apos;POSICION&apos; ).
    ENDIF.

    IF NOT field_orden IS INITIAL.
      o_alv-&gt;set_orden( field_orden ).
    ENDIF.

    IF NOT field_hotspot IS INITIAL.
      o_alv-&gt;set_field_hotspot( campo = field_hotspot auto = &apos;X&apos; ).
    ENDIF.

    IF NOT filtro_campo1 IS INITIAL.
      o_alv-&gt;set_filter( option = filtro_op1 campo = filtro_campo1 valor = filtro_valor1 valor_hasta = filtro_valor_hasta ).
    ENDIF.
    IF NOT filtro_campo2 IS INITIAL.
      o_alv-&gt;set_filter( option = filtro_op2 campo = filtro_campo2 valor = filtro_valor2 valor_hasta = filtro_valor_hasta2 ).
    ENDIF.
    IF NOT filtro_campo3 IS INITIAL.
      o_alv-&gt;set_filter( option = filtro_op3 campo = filtro_campo3 valor = filtro_valor3 valor_hasta = filtro_valor_hasta3 ).
    ENDIF.
    IF NOT filtro_campo4 IS INITIAL.
      o_alv-&gt;set_filter( option = filtro_op4 campo = filtro_campo4 valor = filtro_valor4 valor_hasta = filtro_valor_hasta4 ).
    ENDIF.

    o_alv-&gt;o_alv_helper = o_alv_helper.

    o_alv-&gt;show_popup( end_line     = l_end_line
                       start_column = start_column
                       end_column   = end_column
                       start_line   = start_line ).

*CLASS lcl_alv DEFINITION INHERITING FROM zcl_ap_alv FINAL.
*  PUBLIC SECTION.
*    METHODS: visualizar_objeto REDEFINITION.
*ENDCLASS.
*
*CLASS lcl_alv IMPLEMENTATION.
*
*  METHOD visualizar_objeto.
*    MESSAGE &apos;Hola&apos; TYPE &apos;I&apos;.
*  ENDMETHOD. &quot;handle_double_click
*
*ENDCLASS. &quot;lcl_alv IMPLEMENTATION
*
*
*START-OF-SELECTION.
*  SELECT kunnr, name1 FROM kna1
*    UP TO 10 ROWS
*    INTO TABLE @DATA(i_soc).
*
*  DATA(o_alv) = NEW lcl_alv( tabla = &apos;HELPER&apos; ).
*  zcl_ap_alv=&gt;show_popup_st( EXPORTING field_hotspot = &apos;KUNNR&apos; o_alv_helper = o_alv CHANGING t_tabla = i_soc ).
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="TOP_OF_PAGE" VERSION="1" LANGU="S" DESCRIPT="Imprimir contenido top of page" EXPOSURE="2" STATE="1" EDITORDER="9 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="TOP_OF_PAGE" SCONAME="NREG" VERSION="1" LANGU="S" DESCRIPT="Número natural" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="INT4" PARVALUE="0"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="TOP_OF_PAGE" SCONAME="I_PARAM" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_TOP_OF_PAGE" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="TOP_OF_PAGE" SCONAME="EXCLUIR" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PARVALUE="&apos;&apos;"/>
  <source>METHOD top_of_page.
    DATA l_text TYPE string.

    CLEAR: o_content,
           o_top_page-&gt;i_filtros.

    IF top_of_page_titulo = &apos;X&apos;.
      o_top_page-&gt;set_titulo( sy-title ).
    ELSEIF top_of_page_titulo = &apos;Z&apos;.
      IF sy-batch = &apos;X&apos; OR sy-tcode IS INITIAL OR sy-tcode = &apos;YAP&apos; OR sy-tcode = &apos;SE38&apos;.
        CONCATENATE &apos;Report:&apos; sy-cprog sy-title INTO l_text SEPARATED BY space.
      ELSE.
        CONCATENATE &apos;Transacción:&apos;(tra) sy-tcode sy-title INTO l_text SEPARATED BY space.
      ENDIF.
      o_top_page-&gt;set_titulo( text = l_text ).
    ELSEIF top_of_page_titulo = &apos;R&apos;.
      CONCATENATE &apos;Report:&apos; sy-cprog sy-title INTO l_text SEPARATED BY space.
      o_top_page-&gt;set_titulo( text = l_text ).
    ELSEIF NOT top_of_page_titulo IS INITIAL.
      o_top_page-&gt;set_titulo( top_of_page_titulo ).
    ENDIF.

    IF top_of_page_auto = &apos;X&apos;.
      o_top_page-&gt;add_rango_auto( i_param = i_param excluir = excluir ).

      IF NOT nreg IS INITIAL.
        o_top_page-&gt;add_rango( texto = &apos;N.Registros&apos;(nre) valor = nreg ).
      ENDIF.

      o_top_page-&gt;crea_info_seleccion( ).
      o_content = o_top_page-&gt;get_grid( ).
    ENDIF.

*  DATA: lr_grid   TYPE REF TO cl_salv_form_layout_grid,
*        lr_grid_1 TYPE REF TO cl_salv_form_layout_grid,
*        lr_label  TYPE REF TO cl_salv_form_label,
*        lr_text   TYPE REF TO cl_salv_form_text,
*        l_text    TYPE string.
*  CREATE OBJECT lr_grid.
*  l_text = &apos;TOP OF PAGE for the report&apos; .
*  lr_grid-&gt;create_header_information(
*    row    = 1
*    column = 1
*    text    = l_text
*    tooltip = l_text ).
*  lr_grid-&gt;add_row( ).
*  lr_grid_1 = lr_grid-&gt;create_grid(
*                row    = 3
*                column = 1 ).
*  lr_label = lr_grid_1-&gt;create_label(
*    row     = 1
*    column  = 1
*    text    = &apos;Number of Data Records&apos;
*    tooltip = &apos;Number of Data Records&apos; ).
*  lr_text = lr_grid_1-&gt;create_text(
*    row     = 1
*    column  = 2
*    text    = &apos;10&apos;
*    tooltip = &apos;10&apos; ).
*  lr_label-&gt;set_label_for( lr_text ).
*  lr_label = lr_grid_1-&gt;create_label(
*    row    = 2
*    column = 1
*    text    = &apos;date&apos;
*    tooltip = &apos;date&apos; ).
*  l_text = &apos;today&apos;.
*  lr_text = lr_grid_1-&gt;create_text(
*    row    = 2
*    column = 2
*    text    = &apos;today&apos;
*    tooltip = &apos;today&apos; ).
*  lr_label-&gt;set_label_for( lr_text ).
*  o_content = lr_grid.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="TRADUCE_COLOR" VERSION="1" LANGU="S" DESCRIPT="Traduce código de color" EXPOSURE="2" STATE="1" EDITORDER="30 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="TRADUCE_COLOR" SCONAME="CODIGO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="TRADUCE_COLOR" SCONAME="COLOR" VERSION="1" LANGU="S" DESCRIPT="Número natural" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="INT4"/>
  <source>METHOD traduce_color.
    DATA: l_codigo  TYPE c LENGTH 12,
          l_inicial TYPE c LENGTH 1.

* http://www.abap.es/Centro_ALV_colores.htm
    l_codigo = codigo.
    l_codigo = to_upper( l_codigo ).

    l_inicial = codigo.

    CASE l_inicial.
      WHEN &apos;R&apos;.    &quot; Rojo
        color = c_color_rojo.
      WHEN &apos;B&apos;.   &quot; Azul
        IF l_codigo &lt;&gt; &apos;BLANCO&apos;.
          color = c_color_azul.
        ENDIF.
      WHEN &apos;N&apos;.    &quot; Naranja
        color = c_color_naranja.
      WHEN &apos;V&apos;.    &quot; Verde
        color = c_color_verde.
      WHEN &apos;G&apos;.    &quot; Gris
        color = c_color_gris.
      WHEN &apos;T&apos;.
        color = c_color_amarillo_osc.
      WHEN &apos;L&apos;.
        color = c_color_blanco.
      WHEN OTHERS.
        CASE l_codigo.
          WHEN &apos;BLANCO&apos;.
            color = c_color_blanco.
          WHEN &apos;AZUL&apos;.
            color = c_color_azul.
          WHEN &apos;AMARILLO&apos;.
            color = c_color_amarillo.
          WHEN &apos;AMARILLO OSC&apos;.
            color = c_color_amarillo_osc.
        ENDCASE.
    ENDCASE.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJ" VERSION="1" LANGU="S" DESCRIPT="Visualizar documento" EXPOSURE="2" STATE="1" EDITORDER="68 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="1" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJ" SCONAME="HOTSPOT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="T_HOTSPOT" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJ" SCONAME="LIST" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJ" SCONAME="COLUMN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJ" SCONAME="SALIDA" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJ" SCONAME="MOD" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="1" PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJ" SCONAME="MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD visualizar_obj.
    DATA: o_root   TYPE REF TO cx_root,
          l_aux1   TYPE text255,
          l_sufijo TYPE string,
          l_text   TYPE text132,
          l_campo  TYPE string,
          l_metodo TYPE string,
          l_clase  TYPE string,
          l_aux2   TYPE text255,
          l_cont   TYPE i,
          tab      TYPE abap_parmbind,
          ptab     TYPE abap_parmbind_tab.
    DATA l_vbeln TYPE vbeln_va.
    DATA l_ebeln TYPE ebeln.
    DATA l_aufnr TYPE aufnr.
    DATA l_otype TYPE hrp1000-otype.

    FIELD-SYMBOLS: &lt;valor&gt;  TYPE any,
                   &lt;valor2&gt; TYPE any,
                   &lt;valor3&gt; TYPE any,
                   &lt;valor4&gt; TYPE any,
                   &lt;tabla&gt;  TYPE table.

    CLEAR: mod, salida.

    DATA(l_alv_cliente) = zcl_c=&gt;get_constante( &apos;ZCL_ALV&apos; ).
    IF NOT l_alv_cliente IS INITIAL.
      TRY.
          CALL METHOD (l_alv_cliente)=&gt;(&apos;VISUALIZAR_OBJ_CLIENTE&apos;)
            EXPORTING
              hotspot = hotspot
              list    = list
              column  = column
            IMPORTING
              salida  = salida
              mod     = mod
            RECEIVING
              message = message.
          IF NOT mod IS INITIAL.
            RETURN.
          ELSE.
            CLEAR message.
          ENDIF.
        CATCH cx_root INTO o_root. &quot;#EC *
* No hay implementación especifica de cliente, continuamos.
      ENDTRY.
    ENDIF.

    IF hotspot-campo_ref IS INITIAL.
      ASSIGN COMPONENT column OF STRUCTURE  list TO &lt;valor&gt;.
    ELSE.
      ASSIGN COMPONENT hotspot-campo_ref OF STRUCTURE list TO &lt;valor&gt;.
    ENDIF.
    IF sy-subrc &lt;&gt; 0.
      RETURN.
    ENDIF.

    SPLIT column AT &apos;_&apos; INTO l_aux1 l_sufijo.

    IF NOT &lt;valor&gt; IS INITIAL.
      l_text = hotspot-transaccion.
      IF l_text(4) = &apos;IDA_&apos;.
        l_campo = hotspot-filtro.
        SPLIT hotspot-transaccion AT &apos;IDA_&apos; INTO l_metodo l_clase.
        IF l_campo CS &apos;$&apos;.
          SPLIT l_campo AT &apos;$&apos; INTO l_aux1 l_aux2.
          ASSIGN COMPONENT l_aux2 OF STRUCTURE list TO &lt;valor&gt;.
          IF sy-subrc = 0.
            CONCATENATE &apos;$&apos; l_aux2 INTO l_aux2.
            l_cont = strlen( l_aux2 ).
            REPLACE l_aux2(l_cont) WITH &lt;valor&gt; INTO l_campo.
          ENDIF.
        ELSE.
          REPLACE &apos;?&apos; WITH &lt;valor&gt; INTO l_campo.
        ENDIF.
        NEW zcl_ap_alv_ida( tabla = l_clase filtros = l_campo )-&gt;fullscreen_display( ).
      ELSE.
        CASE hotspot-transaccion.
          WHEN &apos;VA03&apos;.
            SPLIT &lt;valor&gt; AT &apos;,&apos; INTO DATA(l_ped) DATA(l_aux).
            l_vbeln = l_ped.
            __poner_ceros l_vbeln.
            SELECT SINGLE vbeln FROM vbak
              INTO l_aux1
             WHERE vbeln = l_vbeln.
            IF sy-subrc = 0.
              l_clase = &apos;ZCL_AP_PEDIDO_SD&apos;.
            ELSE.
              SELECT SINGLE vbeln FROM likp
                INTO l_aux1
               WHERE vbeln = l_vbeln.
              IF sy-subrc = 0.
                l_clase = &apos;ZCL_AP_ENTREGAS&apos;.
              ELSE.
                SELECT SINGLE vbeln FROM vbrk
                  INTO l_aux1
                 WHERE vbeln = l_vbeln.
                IF sy-subrc = 0.
                  l_clase = &apos;ZCL_AP_FACTURA_SD&apos;.
                ELSE.
                  SELECT SINGLE ebeln FROM ekko
                    INTO l_aux1
                   WHERE ebeln = l_vbeln.
                  IF sy-subrc = 0.
                    l_clase = &apos;ZCL_AP_PEDIDO_MM&apos;.
                  ENDIF.
                ENDIF.
              ENDIF.
            ENDIF.
            IF l_clase IS INITIAL.
              RETURN.
            ENDIF.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;VBELN&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            IF l_clase = &apos;ZCL_AP_PEDIDO_MM&apos;.
              tab-name = &apos;EBELN&apos;.
              l_ebeln = &lt;valor&gt;.
              tab-value = REF #( l_ebeln ).
            ENDIF.

            INSERT tab INTO TABLE ptab.

          WHEN &apos;VL03N&apos;.
            l_clase = &apos;ZCL_AP_ENTREGAS&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;VBELN&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;VF03&apos;.
            l_clase = &apos;ZCL_AP_FACTURA_SD&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;VBELN&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;VT03N&apos;.
            l_clase = &apos;ZCL_AP_TRANSPORTE&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;TKNUM&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;ME53N&apos;.
            l_clase = &apos;ZCL_AP_SOLICITUD&apos;.
            l_metodo = &apos;VISUALIZAR_SOLICITUD_ST&apos;.
            tab-name  = &apos;BANFN&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            ASSIGN COMPONENT &apos;BNFPO&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;BNFPO&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

          WHEN &apos;ME23N&apos;.
            l_clase = &apos;ZCL_AP_PEDIDO_MM&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;EBELN&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            ASSIGN COMPONENT &apos;EBELP&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;EBELP&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

          WHEN &apos;IW23&apos; OR &apos;QM03&apos;.
            l_metodo = &apos;VISUALIZAR_ST&apos;.
            tab-name  = &apos;QMNUM&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            SELECT qmtyp
              FROM tq80
              JOIN qmel ON tq80~qmart = qmel~qmart     &quot;#EC CI_BUFFJOIN
              WHERE qmnum = @&lt;valor&gt;
              ORDER BY qmnum
              INTO @DATA(l_qmtyp)
              UP TO 1 ROWS.
            ENDSELECT.
            IF sy-subrc &lt;&gt; 0.
              RETURN.
            ELSE.
              CASE l_qmtyp.
                WHEN &apos;01&apos;. &quot; Aviso mantenim.
                  l_clase = &apos;ZCL_AP_AVISO_PM&apos;.
                WHEN &apos;02&apos;. &quot;  Aviso de calidad
                  l_clase = &apos;ZCL_AP_AVISO_QM&apos;.
                WHEN &apos;03&apos;. &quot;  Aviso de servicio
                  SET PARAMETER ID &apos;IQM&apos; FIELD &lt;valor&gt;.
                  CALL TRANSACTION &apos;IW53&apos; AND SKIP FIRST SCREEN.
                  RETURN.
                WHEN &apos;04&apos;. &quot;  Reclamación
                WHEN &apos;05&apos;. &quot;  Aviso general
              ENDCASE.
            ENDIF.

          WHEN &apos;MM03&apos;.
            l_clase = &apos;ZCL_AP_MATERIAL&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;MATNR&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;FB03&apos; OR &apos;FB09&apos;.
            l_clase = &apos;ZCL_AP_DOC_FI&apos;.
            l_metodo = &apos;FB03&apos;.
            tab-name  = &apos;BELNR&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            CLEAR l_aux2.
            IF NOT l_sufijo IS INITIAL.
              CONCATENATE &apos;BUKRS_&apos; l_sufijo INTO l_aux1.
              ASSIGN COMPONENT l_aux1 OF STRUCTURE list TO &lt;valor2&gt;.
              IF sy-subrc = 0.
                IF NOT &lt;valor2&gt; IS INITIAL.
                  l_aux2 = &apos;FOUND&apos;.
                  tab-value = REF #( &lt;valor2&gt; ).
                ENDIF.
              ENDIF.
            ENDIF.

            IF l_aux2 IS INITIAL.
              ASSIGN COMPONENT &apos;BUKRS&apos; OF STRUCTURE list TO &lt;valor2&gt;.
              IF sy-subrc = 0.
                tab-value = REF #( &lt;valor2&gt; ).
              ELSE.
                tab-value = REF #( zcl_c=&gt;bukrs ).
              ENDIF.
            ENDIF.
            tab-name = &apos;BUKRS&apos;.
            INSERT tab INTO TABLE ptab.

            IF hotspot-transaccion = &apos;FB09&apos;.
              CLEAR l_aux2.
              ASSIGN COMPONENT &apos;BUZEI&apos; OF STRUCTURE list TO &lt;valor2&gt;.
              IF sy-subrc = 0.
                IF NOT &lt;valor2&gt; IS INITIAL.
                  tab-value = REF #( &lt;valor2&gt; ).
                  tab-name  = &apos;BUZEI&apos;.
                  INSERT tab INTO TABLE ptab.
                ENDIF.
              ENDIF.
            ENDIF.

            IF column = &apos;AUGBL&apos;.
              ASSIGN COMPONENT &apos;AUGDT&apos; OF STRUCTURE list TO &lt;valor2&gt;.
              IF sy-subrc = 0.
                IF NOT &lt;valor2&gt; IS INITIAL.
                  l_aux2 = &apos;FOUND&apos;.
                  tab-value = REF #( &lt;valor2&gt;(4) ).
                  tab-name  = &apos;GJAHR&apos;.
                  INSERT tab INTO TABLE ptab.
                ENDIF.
              ENDIF.
            ENDIF.
            IF l_aux2 IS INITIAL.
              IF NOT l_sufijo IS INITIAL.
                CONCATENATE &apos;GJAHR_&apos; l_sufijo INTO l_aux1.
                ASSIGN COMPONENT l_aux1 OF STRUCTURE list TO &lt;valor2&gt;.
                IF sy-subrc = 0.
                  IF NOT &lt;valor2&gt; IS INITIAL.
                    l_aux2 = &apos;FOUND&apos;.
                    tab-value = REF #( &lt;valor2&gt; ).
                    tab-name  = &apos;GJAHR&apos;.
                    INSERT tab INTO TABLE ptab.
                  ENDIF.
                ENDIF.
              ENDIF.
            ENDIF.
            IF l_aux2 IS INITIAL.
              ASSIGN COMPONENT &apos;GJAHR&apos; OF STRUCTURE list TO &lt;valor3&gt;.
              IF sy-subrc = 0.
                tab-value = REF #( &lt;valor3&gt; ).
                tab-name  = &apos;GJAHR&apos;.
                INSERT tab INTO TABLE ptab.
              ENDIF.
            ENDIF.

          WHEN &apos;MB03&apos;.
            l_clase = &apos;ZCL_AP_DOCMAT&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;MBLNR&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            ASSIGN COMPONENT &apos;MJAHR&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;MJAHR&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;ZEILE&apos; OF STRUCTURE list TO &lt;valor3&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;ZEILE&apos;.
              tab-value = REF #( &lt;valor3&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

          WHEN &apos;LS03N&apos;.
            l_clase = &apos;ZCL_AP_OT&apos;.
            l_metodo = &apos;LS03N&apos;.

            ASSIGN COMPONENT &apos;LGNUM&apos; OF STRUCTURE list TO &lt;valor&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGNUM&apos;.
              tab-value = REF #( &lt;valor&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;LGTYP&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGTYP&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;LGPLA&apos; OF STRUCTURE list TO &lt;valor3&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGPLA&apos;.
              tab-value = REF #( &lt;valor3&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

          WHEN &apos;LS03N_V&apos;.
            l_clase = &apos;ZCL_AP_OT&apos;.
            l_metodo = &apos;LS03N&apos;.

            ASSIGN COMPONENT &apos;LGNUM&apos; OF STRUCTURE list TO &lt;valor&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGNUM&apos;.
              tab-value = REF #( &lt;valor&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;VLTYP&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGTYP&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;VLPLA&apos; OF STRUCTURE list TO &lt;valor3&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGPLA&apos;.
              tab-value = REF #( &lt;valor3&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

          WHEN &apos;LS03N_N&apos;.
            l_clase = &apos;ZCL_AP_OT&apos;.
            l_metodo = &apos;LS03N&apos;.

            ASSIGN COMPONENT &apos;LGNUM&apos; OF STRUCTURE list TO &lt;valor&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGNUM&apos;.
              tab-value = REF #( &lt;valor&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;NLTYP&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGTYP&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;NLPLA&apos; OF STRUCTURE list TO &lt;valor3&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGPLA&apos;.
              tab-value = REF #( &lt;valor3&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

          WHEN &apos;CV03N&apos;.
            l_clase = &apos;ZCL_AP_GD&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;DOKNR&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            ASSIGN COMPONENT &apos;DOKAR&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;DOKAR&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;DOKTL&apos; OF STRUCTURE list TO &lt;valor3&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;DOKTL&apos;.
              tab-value = REF #( &lt;valor3&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;DOKVR&apos; OF STRUCTURE list TO &lt;valor4&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;DOKVR&apos;.
              tab-value = REF #( &lt;valor4&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

          WHEN &apos;LT21&apos;.
            l_clase = &apos;ZCL_AP_OT&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;TANUM&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            ASSIGN COMPONENT &apos;LGNUM&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGNUM&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;TAPOS&apos; OF STRUCTURE list TO &lt;valor3&gt;.
            IF sy-subrc = 0.
              IF NOT &lt;valor3&gt; IS INITIAL.
                tab-name  = &apos;TAPOS&apos;.
                tab-value = REF #( &lt;valor3&gt; ).
                INSERT tab INTO TABLE ptab.
              ENDIF.
            ENDIF.

          WHEN &apos;QA03&apos;.
            l_clase = &apos;ZCL_AP_LOTES_INSP&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;PRUEFLOS&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;LB03&apos;.
            l_clase = &apos;ZCL_AP_NT&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;TBNUM&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            ASSIGN COMPONENT &apos;LGNUM&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;LGNUM&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

          WHEN &apos;PR05&apos;.
            l_clase = &apos;ZCL_AP_GV&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;TRIPNO&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            ASSIGN COMPONENT &apos;PERNR&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;PERNR&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

          WHEN &apos;PA20&apos;.
            l_clase = &apos;ZCL_AP_EMPLEADO&apos;.
            l_metodo = &apos;VISUALIZAR_ST&apos;.
            tab-name  = &apos;PERNR&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            ASSIGN COMPONENT &apos;BEGDA&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;BEGDA&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;ENDDA&apos; OF STRUCTURE list TO &lt;valor3&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;ENDDA&apos;.
              tab-value = REF #( &lt;valor3&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

            ASSIGN COMPONENT &apos;INFTY&apos; OF STRUCTURE list TO &lt;valor4&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;INFTY&apos;.
              tab-value = REF #( &lt;valor4&gt; ).
              INSERT tab INTO TABLE ptab.
            ENDIF.

          WHEN &apos;BP&apos;.
            l_clase = &apos;ZCL_AP_BP&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;BP&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;XD03&apos;.
            l_clase = &apos;ZCL_AP_CLIENTE&apos;.
            l_metodo = &apos;VISUALIZAR_CLIENTE_ST&apos;.
            tab-name  = &apos;KUNNR&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;XK03&apos;.
            l_clase = &apos;ZCL_AP_PROVEEDOR&apos;.
            l_metodo = &apos;VISUALIZAR_PROVEEDOR_ST&apos;.
            tab-name  = &apos;LIFNR&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;CO03&apos;.
            l_aufnr = &lt;valor&gt;.
            __poner_ceros l_aufnr.
            SELECT SINGLE aufnr FROM aufk
              INTO l_aufnr
             WHERE aufnr = l_Aufnr.
            IF sy-subrc = 0 OR &lt;valor&gt; CS &apos;,&apos;.
              l_clase = &apos;ZCL_AP_ORDEN_PP&apos;.
              l_metodo = &apos;VISUALIZAR&apos;.
              tab-name  = &apos;AUFNR&apos;.
              tab-value = REF #( &lt;valor&gt; ).
              INSERT tab INTO TABLE ptab.
            ELSE.
              SELECT SINGLE plnum FROM plaf
                INTO @DATA(l_plnum)
               WHERE plnum = @&lt;valor&gt;.
              IF sy-subrc = 0.
                l_clase = &apos;ZCL_AP_ORDPREV&apos;.
                l_metodo = &apos;VISUALIZAR&apos;.
                tab-name  = &apos;PLNUM&apos;.
                tab-value = REF #( l_plnum ).
                INSERT tab INTO TABLE ptab.
              ENDIF.
            ENDIF.

          WHEN &apos;IP03&apos;.
            l_clase = &apos;ZCL_AP_ORDEN_PP&apos;.
            l_metodo = &apos;VISUALIZAR_PLAN&apos;.
            tab-name  = &apos;WARPL&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;IE03&apos;.
            l_clase = &apos;ZCL_AP_EQUIPO&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;EQUNR&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;IL03&apos;.
            l_clase = &apos;ZCL_AP_UBICACION&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.
            tab-name  = &apos;TPLNR&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;FO8U&apos;.
            l_clase = &apos;ZCL_AP_UBICACION&apos;.
            l_metodo = &apos;VER_DOC_MEDICION&apos;.
            tab-name  = &apos;MDOCM&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;FO8X&apos;.
            l_clase = &apos;ZCL_AP_UBICACION&apos;.
            l_metodo = &apos;VER_PTO_MEDIDA&apos;.
            tab-name  = &apos;POINT&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;HUMO&apos;.
            l_clase = &apos;ZCL_AP_HU&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.

            tab-name  = &apos;EXIDV&apos;.
            tab-value = REF #( &lt;valor&gt; ).

            ASSIGN COMPONENT &apos;VENUM&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              IF NOT &lt;valor2&gt; IS INITIAL.
                tab-name  = &apos;VENUM&apos;.
                tab-value = REF #( &lt;valor2&gt; ).
              ENDIF.
            ENDIF.

            INSERT tab INTO TABLE ptab.

          WHEN &apos;CJ13&apos;.
            l_clase = &apos;ZCL_AP_PEP&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.

            tab-name  = &apos;PEP&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;WEDI&apos;.
            l_clase = &apos;ZCL_AP_IDOC&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.

            tab-name  = &apos;DOCNUM&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;WI_ID&apos;.
            l_clase = &apos;ZCL_AP_WF&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.

            tab-name  = &apos;ID&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;URL&apos;.
            l_clase = &apos;ZCL_AP_GOS&apos;.
            l_metodo = &apos;VISUALIZAR_FICHERO_ST&apos;.

            tab-name  = &apos;FICHERO&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;CURSO&apos; OR &apos;CURSO_EDT&apos;.
            l_clase = &apos;ZCL_CURSO&apos;.

            IF hotspot-transaccion = &apos;CURSO_EDT&apos;.
              l_metodo = &apos;EDITAR&apos;.
            ELSE.
              l_metodo = &apos;VISUALIZAR&apos;.
            ENDIF.

            tab-name  = &apos;CURSO&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

          WHEN &apos;TEXT&apos;.
            l_campo = &lt;valor&gt;.
            zcl_ap_string=&gt;popup_texto( CHANGING texto = l_campo ).
            RETURN.

          WHEN &apos;TEXT_EDT&apos;.
            l_campo = &lt;valor&gt;.
            zcl_ap_string=&gt;popup_texto( EXPORTING editar = &apos;X&apos; IMPORTING modificado = mod CHANGING texto = l_campo ).
            IF mod = &apos;X&apos;.
              salida = l_campo.
            ENDIF.
            RETURN.

          WHEN &apos;LS23&apos;.
            ASSIGN COMPONENT &apos;LGNUM&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              SET PARAMETER ID &apos;LGN&apos; FIELD &lt;valor2&gt;.
            ENDIF.
            SET PARAMETER ID &apos;LQN&apos; FIELD &lt;valor&gt;.
            CALL TRANSACTION &apos;LS23 &apos; AND SKIP FIRST SCREEN.
            RETURN.

          WHEN &apos;KB13N&apos;.
            SET PARAMETER ID &apos;BLN&apos; FIELD &lt;valor&gt;.
            SET PARAMETER ID &apos;CO_BLN&apos; FIELD &lt;valor&gt;.

            ASSIGN COMPONENT &apos;KOKRS&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              SET PARAMETER ID &apos;CAC&apos; FIELD &lt;valor2&gt;.
            ENDIF.

            CALL TRANSACTION &apos;KB13N &apos; AND SKIP FIRST SCREEN.
            RETURN.

          WHEN &apos;VI03&apos;.
            SET PARAMETER ID &apos;FKK&apos; FIELD &lt;valor&gt;.
            CALL TRANSACTION &apos;VI03 &apos; AND SKIP FIRST SCREEN.
            RETURN.

          WHEN &apos;VBO3&apos;.
            SET PARAMETER ID &apos;VBO&apos; FIELD &lt;valor&gt;.
            CALL TRANSACTION &apos;VBO3&apos; AND SKIP FIRST SCREEN.
            RETURN.
          WHEN &apos;AS03&apos;.
            ASSIGN COMPONENT &apos;ANLN1&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              IF NOT &lt;valor2&gt; IS INITIAL.
                SET PARAMETER ID &apos;AN1&apos; FIELD &lt;valor2&gt;.
              ENDIF.
            ENDIF.
            ASSIGN COMPONENT &apos;ANLN2&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              IF NOT &lt;valor2&gt; IS INITIAL.
                SET PARAMETER ID &apos;AN2&apos; FIELD &lt;valor2&gt;.
              ENDIF.
            ENDIF.
            ASSIGN COMPONENT &apos;BUKRS&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              IF NOT &lt;valor2&gt; IS INITIAL.
                SET PARAMETER ID &apos;BUK&apos; FIELD &lt;valor2&gt;.
              ENDIF.
            ENDIF.
            CALL TRANSACTION &apos;AS03&apos; AND SKIP FIRST SCREEN.
            RETURN.

          WHEN &apos;MIRO&apos;.
            l_clase = &apos;ZCL_AP_FACTURA_MM&apos;.
            l_metodo = &apos;VISUALIZAR&apos;.

            tab-name  = &apos;BELNR&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            ASSIGN COMPONENT &apos;GJAHR&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;GJAHR&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ELSE.
              ASSIGN COMPONENT &apos;GJAHR_F&apos; OF STRUCTURE list TO &lt;valor2&gt;.
              IF sy-subrc = 0.
                tab-name  = &apos;GJAHR&apos;.
                tab-value = REF #( &lt;valor2&gt; ).
                INSERT tab INTO TABLE ptab.
              ENDIF.
            ENDIF.

          WHEN &apos;MSC3N&apos;.
            l_clase = &apos;ZCL_AP_LOTE&apos;.
            l_metodo = &apos;VER&apos;.

            tab-name  = &apos;CHARG&apos;.
            tab-value = REF #( &lt;valor&gt; ).
            INSERT tab INTO TABLE ptab.

            ASSIGN COMPONENT &apos;MATNR&apos; OF STRUCTURE list TO &lt;valor2&gt;.
            IF sy-subrc = 0.
              tab-name  = &apos;MATNR&apos;.
              tab-value = REF #( &lt;valor2&gt; ).
              INSERT tab INTO TABLE ptab.
            ELSE.
              ASSIGN COMPONENT &apos;WERKS&apos; OF STRUCTURE list TO &lt;valor2&gt;.
              IF sy-subrc = 0.
                tab-name  = &apos;WERKS&apos;.
                tab-value = REF #( &lt;valor2&gt; ).
                INSERT tab INTO TABLE ptab.
              ENDIF.
            ENDIF.

          WHEN OTHERS.
            l_text = hotspot-transaccion.
            IF l_text(4) = &apos;PP01&apos;.
              l_clase = &apos;ZCL_AP_OBJETO_PD&apos;.
              l_metodo = &apos;PP01&apos;.

              tab-name  = &apos;OBJID&apos;.
              tab-value = REF #( &lt;valor&gt; ).
              INSERT tab INTO TABLE ptab.

              IF l_text+5(2) &lt;&gt; &apos;&apos;.
                tab-name = &apos;OTYPE&apos;.
                l_otype = l_text+5(2).
                tab-value = REF #( l_otype ).
                INSERT tab INTO TABLE ptab.
              ENDIF.

              ASSIGN COMPONENT &apos;BEGDA&apos; OF STRUCTURE list TO &lt;valor2&gt;.
              IF sy-subrc = 0.
                IF NOT &lt;valor2&gt; IS INITIAL.
                  tab-name  = &apos;BEGDA&apos;.
                  tab-value = REF #( &lt;valor2&gt; ).
                ENDIF.
              ENDIF.

              ASSIGN COMPONENT &apos;ENDDA&apos; OF STRUCTURE list TO &lt;valor2&gt;.
              IF sy-subrc = 0.
                IF NOT &lt;valor2&gt; IS INITIAL.
                  tab-name  = &apos;ENDDA&apos;.
                  tab-value = REF #( &lt;valor2&gt; ).
                ENDIF.
              ENDIF.
            ELSE.
              DATA l_valor TYPE string.
              l_text = &lt;valor&gt;.
              TRANSLATE l_text TO UPPER CASE.
              IF l_text(5) = &apos;HTTP:&apos; OR l_text(6) = &apos;HTTPS:&apos;.
                l_clase = &apos;ZCL_AP_GOS&apos;.
                l_metodo = &apos;VISUALIZAR_FICHERO_ST&apos;.

                tab-name  = &apos;FICHERO&apos;.
                tab-value = REF #( &lt;valor&gt; ).
                INSERT tab INTO TABLE ptab.
              ENDIF.
            ENDIF.
        ENDCASE.

        IF l_clase &lt;&gt; &apos;&apos; AND l_metodo &lt;&gt; &apos;&apos;.
          TRY.
              CALL METHOD (l_clase)=&gt;(l_metodo) PARAMETER-TABLE ptab.
            CATCH cx_root INTO o_root. &quot;#EC *
              message = o_root-&gt;get_longtext( ).
              IF message IS INITIAL.
                message = o_root-&gt;get_text( ).
              ENDIF.
          ENDTRY.
        ENDIF.
      ENDIF.
    ELSE.
      CASE hotspot-transaccion.
        WHEN &apos;TEXT_EDT&apos;.
          l_campo = &lt;valor&gt;.
          zcl_ap_string=&gt;popup_texto( EXPORTING editar = &apos;X&apos; IMPORTING modificado = mod CHANGING texto = l_campo ).
          IF mod = &apos;X&apos;.
            salida = l_campo.
          ENDIF.
          RETURN.
      ENDCASE.
    ENDIF.
  ENDMETHOD.</source>
 </method>
 <method CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJETO" VERSION="1" LANGU="S" DESCRIPT="Visualizar documento" EXPOSURE="2" STATE="1" EDITORDER="69 " DISPID="0 " MTDTYPE="0" MTDDECLTYP="0" BCMTDCAT="00" BCMTDSYN="0" MTDTYPE2="00">
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJETO" SCONAME="HOTSPOT" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="T_HOTSPOT" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJETO" SCONAME="LIST" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJETO" SCONAME="COLUMN" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJETO" SCONAME="ROW" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY" PAROPTIONL="X"/>
  <parameter CLSNAME="ZCL_AP_ALV" CMPNAME="VISUALIZAR_OBJETO" SCONAME="MESSAGE" VERSION="1" LANGU="S" DESCRIPT="Texto de mensaje" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="BAPI_MSG"/>
  <source>METHOD visualizar_objeto.
    CASE column.
      WHEN &apos;X&apos;.

      WHEN OTHERS.
        message = &apos;No implementado&apos;.
    ENDCASE.
  ENDMETHOD.</source>
 </method>
</CLAS>
