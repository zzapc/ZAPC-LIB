<?xml version="1.0" encoding="utf-8"?>
<PROG NAME="ZBCUT011" VARCL="X" SUBC="1" APPL="M" RMAND="200" RLOAD="S" FIXPT="X" UCCHECK="X">
 <textPool>
  <language SPRAS="E">
   <textElement ID="R" ENTRY="Gestión de desarrollos" LENGTH="70 "/>
   <textElement ID="S" KEY="P_BADIS" ENTRY="        BADIs" LENGTH="13 "/>
   <textElement ID="S" KEY="P_BSP" ENTRY="        BSPs" LENGTH="12 "/>
   <textElement ID="S" KEY="P_BTE" ENTRY="        BTEs" LENGTH="12 "/>
   <textElement ID="S" KEY="P_CLASES" ENTRY="        Clases" LENGTH="14 "/>
   <textElement ID="S" KEY="P_DIRLIB" ENTRY="        Directorio librería" LENGTH="27 "/>
   <textElement ID="S" KEY="P_ENHAN" ENTRY="        Enhancements" LENGTH="20 "/>
   <textElement ID="S" KEY="P_FORMUL" ENTRY="        Formularios" LENGTH="19 "/>
   <textElement ID="S" KEY="P_FTP" ENTRY="        FTP" LENGTH="11 "/>
   <textElement ID="S" KEY="P_FUNCIO" ENTRY="        Funciones" LENGTH="17 "/>
   <textElement ID="S" KEY="P_LIB" ENTRY="        Modo librería" LENGTH="21 "/>
   <textElement ID="S" KEY="P_LIBT" ENTRY="        Transacción librería" LENGTH="28 "/>
   <textElement ID="S" KEY="P_MIME" ENTRY="        MIME" LENGTH="12 "/>
   <textElement ID="S" KEY="P_MODIFE" ENTRY="        Modificaciones al estándar" LENGTH="34 "/>
   <textElement ID="S" KEY="P_NUMLIN" ENTRY="        Mostrar nº de líneas" LENGTH="28 "/>
   <textElement ID="S" KEY="P_ORIGEN" ENTRY="        Origen" LENGTH="14 "/>
   <textElement ID="S" KEY="P_OUTLO" ENTRY="        Enviar por Outlook" LENGTH="26 "/>
   <textElement ID="S" KEY="P_PDF" ENTRY="        PDF Forms" LENGTH="17 "/>
   <textElement ID="S" KEY="P_PROYEC" ENTRY="        Proyectos de modificación" LENGTH="33 "/>
   <textElement ID="S" KEY="P_REPORT" ENTRY="        Reports" LENGTH="15 "/>
   <textElement ID="S" KEY="P_RUTINA" ENTRY="        Rutinas VOFM" LENGTH="20 "/>
   <textElement ID="S" KEY="P_SOLOM" ENTRY="        Sólo modificaciones lib." LENGTH="32 "/>
   <textElement ID="S" KEY="P_TABLAS" ENTRY="        Tablas" LENGTH="14 "/>
   <textElement ID="S" KEY="P_USEREX" ENTRY="        Userexits ventas" LENGTH="24 "/>
   <textElement ID="S" KEY="P_UTILI" ENTRY="        Mostrar utilización" LENGTH="27 "/>
   <textElement ID="S" KEY="P_VIVAS" ENTRY="        Tareas vivas" LENGTH="20 "/>
   <textElement ID="S" KEY="P_WEBD" ENTRY="        Web Dynpros" LENGTH="19 "/>
   <textElement ID="S" KEY="P_WF" ENTRY="        Workflows" LENGTH="17 "/>
   <textElement ID="S" KEY="P_XSLT" ENTRY="        XSLT" LENGTH="12 "/>
   <textElement ID="S" KEY="P_ZIP" ENTRY="        Comprimir con ZIP" LENGTH="25 "/>
   <textElement ID="S" KEY="S_ASIGN" ENTRY="D       ." LENGTH="18 "/>
   <textElement ID="S" KEY="S_CDAT" ENTRY="D       ." LENGTH="22 "/>
   <textElement ID="S" KEY="S_CNAM" ENTRY="D       ." LENGTH="18 "/>
   <textElement ID="S" KEY="S_DEVCLA" ENTRY="D       ." LENGTH="15 "/>
   <textElement ID="S" KEY="S_ESTADO" ENTRY="D       ." LENGTH="26 "/>
   <textElement ID="S" KEY="S_GRUPO" ENTRY="D       ." LENGTH="13 "/>
   <textElement ID="S" KEY="S_PRIOR" ENTRY="D       ." LENGTH="17 "/>
   <textElement ID="S" KEY="S_PROGR" ENTRY="D       ." LENGTH="15 "/>
   <textElement ID="S" KEY="S_REPORT" ENTRY="D       ." LENGTH="16 "/>
   <textElement ID="S" KEY="S_SUBC" ENTRY="D       ." LENGTH="24 "/>
   <textElement ID="S" KEY="S_TCODE" ENTRY="D       ." LENGTH="26 "/>
   <textElement ID="S" KEY="S_UDAT" ENTRY="D       ." LENGTH="26 "/>
   <textElement ID="S" KEY="S_UNAM" ENTRY="D       ." LENGTH="22 "/>
  </language>
  <language SPRAS="S">
   <textElement ID="I" KEY="001" ENTRY="Criterios de selección" LENGTH="44 "/>
   <textElement ID="I" KEY="003" ENTRY="Opciones" LENGTH="18 "/>
   <textElement ID="I" KEY="AIN" ENTRY="Analizando información" LENGTH="44 "/>
   <textElement ID="I" KEY="AOL" ENTRY="Abriendo Outlook... Espere por favor" LENGTH="72 "/>
   <textElement ID="I" KEY="CFI" ENTRY="Comparando ficheros" LENGTH="29 "/>
   <textElement ID="I" KEY="ECO" ENTRY="Error de conexión" LENGTH="27 "/>
   <textElement ID="I" KEY="EDE" ENTRY="Error descargando" LENGTH="27 "/>
   <textElement ID="I" KEY="EFT" ENTRY="Error al cambiar a dir.FTP" LENGTH="52 "/>
   <textElement ID="I" KEY="ETR" ENTRY="Ejecutar transacción" LENGTH="40 "/>
   <textElement ID="I" KEY="FUN" ENTRY="Función" LENGTH="17 "/>
   <textElement ID="I" KEY="IPO" ENTRY="Install plugin for object type:" LENGTH="62 "/>
   <textElement ID="I" KEY="NPA" ENTRY="No se ha podido adjuntar el fichero" LENGTH="70 "/>
   <textElement ID="I" KEY="NRE" ENTRY="Notas report" LENGTH="22 "/>
   <textElement ID="I" KEY="PRM" ENTRY="Prog.Modificado" LENGTH="25 "/>
   <textElement ID="I" KEY="PRO" ENTRY="Procesando" LENGTH="20 "/>
   <textElement ID="I" KEY="RDF" ENTRY="Realizando download de fichero..." LENGTH="66 "/>
   <textElement ID="I" KEY="REP" ENTRY="Report" LENGTH="16 "/>
   <textElement ID="I" KEY="SBS" ENTRY="Seleccionando BSPs" LENGTH="28 "/>
   <textElement ID="I" KEY="SBT" ENTRY="Seleccionando BTEs" LENGTH="28 "/>
   <textElement ID="I" KEY="SCL" ENTRY="Seleccionando clases" LENGTH="40 "/>
   <textElement ID="I" KEY="SDI" ENTRY="Selecciona un directorio" LENGTH="48 "/>
   <textElement ID="I" KEY="SDO" ENTRY="Seleccionando dominios" LENGTH="44 "/>
   <textElement ID="I" KEY="SED" ENTRY="Seleccionando elementos de datos" LENGTH="64 "/>
   <textElement ID="I" KEY="SEN" ENTRY="Seleccionando enhancement" LENGTH="50 "/>
   <textElement ID="I" KEY="SGC" ENTRY="Se han grabado los cambios" LENGTH="52 "/>
   <textElement ID="I" KEY="SMS" ENTRY="Seleccionando modificaciones al estandar" LENGTH="80 "/>
   <textElement ID="I" KEY="SPA" ENTRY="Seleccionando proyectos de ampliación" LENGTH="74 "/>
   <textElement ID="I" KEY="SPP" ENTRY="Se ha exportado tabla a portapapeles" LENGTH="72 "/>
   <textElement ID="I" KEY="SPR" ENTRY="Seleccionando programas" LENGTH="46 "/>
   <textElement ID="I" KEY="SRU" ENTRY="Seleccionando Rutinas" LENGTH="42 "/>
   <textElement ID="I" KEY="STA" ENTRY="Seleccionando tablas" LENGTH="40 "/>
   <textElement ID="I" KEY="STI" ENTRY="Seleccionando tipos" LENGTH="29 "/>
   <textElement ID="I" KEY="STZ" ENTRY="Seleccionando transacciones sin report Z" LENGTH="80 "/>
   <textElement ID="I" KEY="SUE" ENTRY="Seleccionando Userexits" LENGTH="46 "/>
   <textElement ID="I" KEY="SWD" ENTRY="Seleccionando Webdynpros" LENGTH="48 "/>
   <textElement ID="I" KEY="TRA" ENTRY="Transacción" LENGTH="21 "/>
   <textElement ID="R" ENTRY="Gestión de desarrollos" LENGTH="22 "/>
   <textElement ID="S" KEY="P_BADIS" ENTRY="        BADIs" LENGTH="13 "/>
   <textElement ID="S" KEY="P_BSP" ENTRY="        BSPs" LENGTH="12 "/>
   <textElement ID="S" KEY="P_BTE" ENTRY="        BTEs" LENGTH="12 "/>
   <textElement ID="S" KEY="P_BUSCAR" ENTRY="        Buscar en contenido" LENGTH="27 "/>
   <textElement ID="S" KEY="P_CDS" ENTRY="        CDS" LENGTH="11 "/>
   <textElement ID="S" KEY="P_CLASES" ENTRY="        Clases" LENGTH="14 "/>
   <textElement ID="S" KEY="P_DIRLIB" ENTRY="        Directorio librería" LENGTH="27 "/>
   <textElement ID="S" KEY="P_DIRTO" ENTRY="        Directorio temporal" LENGTH="27 "/>
   <textElement ID="S" KEY="P_ENHAN" ENTRY="        Enhancements" LENGTH="20 "/>
   <textElement ID="S" KEY="P_EXT" ENTRY="        Paquetes externos" LENGTH="25 "/>
   <textElement ID="S" KEY="P_FORMUL" ENTRY="        Formularios" LENGTH="19 "/>
   <textElement ID="S" KEY="P_FTP" ENTRY="        FTP" LENGTH="11 "/>
   <textElement ID="S" KEY="P_FUNCIO" ENTRY="        Funciones" LENGTH="17 "/>
   <textElement ID="S" KEY="P_GEN" ENTRY="        Objetos generados" LENGTH="25 "/>
   <textElement ID="S" KEY="P_HASH" ENTRY="        Cálculo de hash" LENGTH="23 "/>
   <textElement ID="S" KEY="P_LIB" ENTRY="        Modo librería" LENGTH="21 "/>
   <textElement ID="S" KEY="P_LIBT" ENTRY="        Transacción librería" LENGTH="28 "/>
   <textElement ID="S" KEY="P_MIME" ENTRY="        MIME" LENGTH="12 "/>
   <textElement ID="S" KEY="P_MODIFE" ENTRY="        Modificaciones al estándar" LENGTH="34 "/>
   <textElement ID="S" KEY="P_NUMLIN" ENTRY="        Mostrar nº de líneas" LENGTH="28 "/>
   <textElement ID="S" KEY="P_ONEDR" ENTRY="        Usar OneDrive" LENGTH="21 "/>
   <textElement ID="S" KEY="P_OPEN" ENTRY="        OpenSource" LENGTH="18 "/>
   <textElement ID="S" KEY="P_ORIGEN" ENTRY="        Origen" LENGTH="14 "/>
   <textElement ID="S" KEY="P_OUTLO" ENTRY="        Enviar por Outlook" LENGTH="26 "/>
   <textElement ID="S" KEY="P_PDF" ENTRY="        PDF Forms" LENGTH="17 "/>
   <textElement ID="S" KEY="P_PROYEC" ENTRY="        Proyectos de modificación" LENGTH="33 "/>
   <textElement ID="S" KEY="P_REPORT" ENTRY="        Reports" LENGTH="15 "/>
   <textElement ID="S" KEY="P_RFC" ENTRY="D       ." LENGTH="9 "/>
   <textElement ID="S" KEY="P_RUTAW" ENTRY="        Ruta a WinMerge" LENGTH="23 "/>
   <textElement ID="S" KEY="P_RUTINA" ENTRY="        Rutinas VOFM" LENGTH="20 "/>
   <textElement ID="S" KEY="P_SOLOM" ENTRY="        Sólo modificaciones lib." LENGTH="32 "/>
   <textElement ID="S" KEY="P_TABLAS" ENTRY="        Tablas" LENGTH="14 "/>
   <textElement ID="S" KEY="P_TMP" ENTRY="        Objetos temporales" LENGTH="26 "/>
   <textElement ID="S" KEY="P_USEREX" ENTRY="        Userexits ventas" LENGTH="24 "/>
   <textElement ID="S" KEY="P_UTILI" ENTRY="        Mostrar utilización" LENGTH="27 "/>
   <textElement ID="S" KEY="P_VIVAS" ENTRY="        Tareas vivas" LENGTH="20 "/>
   <textElement ID="S" KEY="P_WEBD" ENTRY="        Web Dynpros" LENGTH="19 "/>
   <textElement ID="S" KEY="P_WF" ENTRY="        Workflows" LENGTH="17 "/>
   <textElement ID="S" KEY="P_XSLT" ENTRY="        XSLT" LENGTH="12 "/>
   <textElement ID="S" KEY="P_ZIP" ENTRY="        Comprimir con ZIP" LENGTH="25 "/>
   <textElement ID="S" KEY="P_ZIPL" ENTRY="        ZIP versiones/DTEL/DOMA" LENGTH="31 "/>
   <textElement ID="S" KEY="S_ASIGN" ENTRY="D       ." LENGTH="18 "/>
   <textElement ID="S" KEY="S_CDAT" ENTRY="D       ." LENGTH="22 "/>
   <textElement ID="S" KEY="S_CNAM" ENTRY="D       ." LENGTH="18 "/>
   <textElement ID="S" KEY="S_DEVCLA" ENTRY="D       ." LENGTH="15 "/>
   <textElement ID="S" KEY="S_ESTADO" ENTRY="D       ." LENGTH="26 "/>
   <textElement ID="S" KEY="S_GRUPO" ENTRY="D       ." LENGTH="13 "/>
   <textElement ID="S" KEY="S_OT" ENTRY="D       ." LENGTH="9 "/>
   <textElement ID="S" KEY="S_PRIOR" ENTRY="D       ." LENGTH="17 "/>
   <textElement ID="S" KEY="S_PROGR" ENTRY="D       ." LENGTH="15 "/>
   <textElement ID="S" KEY="S_REPORT" ENTRY="D       ." LENGTH="16 "/>
   <textElement ID="S" KEY="S_SUBC" ENTRY="D       ." LENGTH="24 "/>
   <textElement ID="S" KEY="S_TCODE" ENTRY="D       ." LENGTH="26 "/>
   <textElement ID="S" KEY="S_UDAT" ENTRY="D       ." LENGTH="26 "/>
   <textElement ID="S" KEY="S_UNAM" ENTRY="D       ." LENGTH="22 "/>
  </language>
 </textPool>
 <dynpros>
  <dynpro PROG="ZBCUT011" DNUM="0100" FNUM="0100" BZMX="200 " BZBR="255 " MILI="192 " MICO="37 " MALI="0 " MACO="0 " NOLI="200 " NOCO="255 " VALP="0 " CUAN="G" SPRA="S" DTEXT="Pantalla">
   <dynprofield FNAM="GRID" DIDX="00C8" FLG1="00" FLG2="30" FLG3="00" FILL="U" FMB1="30" FMB2="00" LENG="FF" LINE="01" COLN="02" LANF="00" LBLK="00" LREP="00" AUTH="101" AGLT="01" ADEZ="01"/>
   <dynprofield DIDX="0000" FLG1="80" FLG2="10" FLG3="00" FMB1="00" FMB2="00" LENG="14" LINE="FF" COLN="01" LTYP="O" LANF="00" LBLK="00" LREP="00" TYPE="CHAR" AGLT="00" ADEZ="00" STXT="____________________"/>
   <dynproflowsource>PROCESS BEFORE OUTPUT.
 MODULE STATUS_0100.
*
PROCESS AFTER INPUT.
  MODULE USER_COMMAND_0100.</dynproflowsource>
  </dynpro>
 </dynpros>
 <pfstatus ACTCODE="000001" MENCODE="000011" PFKCODE="000001">
  <pfstatus_sta CODE="STANDARD" MODAL="D" ACTCODE="000001" PFKCODE="000001" BUTCODE="0001" INT_NOTE="Standard für allgemeine Listausgabe"/>
  <pfstatus_fun CODE="%PC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_EXPORT" ICON_ID="@49@" FUN_TEXT="Fichero local..." PATH="F"/>
  <pfstatus_fun CODE="%SC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SEARCH" ICON_ID="@13@" FUN_TEXT="Buscar" PATH="U"/>
  <pfstatus_fun CODE="%SL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_MAIL" ICON_ID="@1S@" FUN_TEXT="Destinatario de mail" PATH="M"/>
  <pfstatus_fun CODE="&amp;ABC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_ABC" ICON_ID="@DL@" FUN_TEXT="Análisis ABC" PATH="N"/>
  <pfstatus_fun CODE="&amp;ALL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SELECT_ALL" ICON_ID="@4B@" FUN_TEXT="Marcar todo" PATH="T"/>
  <pfstatus_fun CODE="&amp;AQW" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_WORD_PROCESSING" ICON_ID="@DK@" FUN_TEXT="Tratamiento de textos..." PATH="T"/>
  <pfstatus_fun CODE="&amp;AUF" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Especificar desglose..." PATH="E"/>
  <pfstatus_fun CODE="&amp;AVE" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Grabar..." PATH="G"/>
  <pfstatus_fun CODE="&amp;AVE" TEXTNO="002" TEXT_TYPE="S" TEXT_NAME="ICON_ALV_VARIANT_SAVE" ICON_ID="@DN@" FUN_TEXT="Grabar disposición..."/>
  <pfstatus_fun CODE="&amp;AVR" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Valor medio" PATH="M"/>
  <pfstatus_fun CODE="&amp;CDF" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Anular fijación" PATH="I"/>
  <pfstatus_fun CODE="&amp;CFI" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Fijar hasta columna" PATH="F"/>
  <pfstatus_fun CODE="&amp;CRB" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TOTAL_LEFT" ICON_ID="@0B@" FUN_TEXT="Primera columna"/>
  <pfstatus_fun CODE="&amp;CRDESIG" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Crystal Reports Designer" PATH="C"/>
  <pfstatus_fun CODE="&amp;CRE" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TOTAL_RIGHT" ICON_ID="@0C@" FUN_TEXT="Última columna"/>
  <pfstatus_fun CODE="&amp;CRL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLUMN_LEFT" ICON_ID="@0D@" FUN_TEXT="Columna izquierda"/>
  <pfstatus_fun CODE="&amp;CRR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLUMN_RIGHT" ICON_ID="@0E@" FUN_TEXT="Columna derecha"/>
  <pfstatus_fun CODE="&amp;DAU" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Separador automático" PATH="T"/>
  <pfstatus_fun CODE="&amp;DOF" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Separador siempre off" PATH="E"/>
  <pfstatus_fun CODE="&amp;DON" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Separador siempre on" PATH="R"/>
  <pfstatus_fun CODE="&amp;EB9" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TABLE_SETTINGS" ICON_ID="@36@" FUN_TEXT="Llamar informe..." PATH="L"/>
  <pfstatus_fun CODE="&amp;ERW" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Gestionar la disposición" PATH="T"/>
  <pfstatus_fun CODE="&amp;ETA" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SELECT_DETAIL" ICON_ID="@16@" FUN_TEXT="Detalles"/>
  <pfstatus_fun CODE="&amp;F12" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_CANCEL" ICON_ID="@0W@" FUN_TEXT="Cancelar" PATH="C"/>
  <pfstatus_fun CODE="&amp;IC1" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SELECT_DETAIL" ICON_ID="@16@" FUN_TEXT="Seleccionar"/>
  <pfstatus_fun CODE="&amp;ILD" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Borrar filtros" PATH="L"/>
  <pfstatus_fun CODE="&amp;ILT" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_FILTER" ICON_ID="@4G@" FUN_TEXT="Fijar filtros" PATH="F"/>
  <pfstatus_fun CODE="&amp;KOM" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLLAPSE" ICON_ID="@3T@" FUN_TEXT="Seleccionar..." PATH="A"/>
  <pfstatus_fun CODE="&amp;LFO" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Status listas..." PATH="L"/>
  <pfstatus_fun CODE="&amp;LFO" TEXTNO="002" TEXT_TYPE="S" TEXT_NAME="ICON_INFORMATION" ICON_ID="@0S@" FUN_TEXT="Status listas..."/>
  <pfstatus_fun CODE="&amp;LIS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Lista básica" PATH="I"/>
  <pfstatus_fun CODE="&amp;MAX" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Máximo" PATH="Á"/>
  <pfstatus_fun CODE="&amp;MIN" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Mínimo" PATH="I"/>
  <pfstatus_fun CODE="&amp;NFO" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_INFORMATION" ICON_ID="@0S@" FUN_TEXT="Selecciones..." ICON_TEXT="Selecciones" PATH="E"/>
  <pfstatus_fun CODE="&amp;NTE" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Refrescar"/>
  <pfstatus_fun CODE="&amp;OAD" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Seleccionar..." PATH="E"/>
  <pfstatus_fun CODE="&amp;OAD" TEXTNO="002" TEXT_TYPE="S" TEXT_NAME="ICON_ALV_VARIANT_CHOOSE" ICON_ID="@DM@" FUN_TEXT="Seleccionar disposición..."/>
  <pfstatus_fun CODE="&amp;ODN" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SORT_DOWN" ICON_ID="@3F@" FUN_TEXT="Clasificación descendente" PATH="Ó"/>
  <pfstatus_fun CODE="&amp;OL0" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_ALV_VARIANTS" ICON_ID="@LZ@" FUN_TEXT="Modificar disposición..."/>
  <pfstatus_fun CODE="&amp;OLX" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_VARIANTS" ICON_ID="@0R@" FUN_TEXT="Modificar..." PATH="M"/>
  <pfstatus_fun CODE="&amp;OMP" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_COLLAPSE" ICON_ID="@3T@" FUN_TEXT="Comprimir"/>
  <pfstatus_fun CODE="&amp;OPT" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Ancho óptimo" PATH="P"/>
  <pfstatus_fun CODE="&amp;OUP" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SORT_UP" ICON_ID="@3E@" FUN_TEXT="Clasificación ascendente" PATH="I"/>
  <pfstatus_fun CODE="&amp;RNT_PREV" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_LAYOUT_CONTROL" ICON_ID="@3G@" FUN_TEXT="Presentación preliminar" PATH="R"/>
  <pfstatus_fun CODE="&amp;SAL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_DESELECT_ALL" ICON_ID="@4D@" FUN_TEXT="Desmarcar todo" PATH="D"/>
  <pfstatus_fun CODE="&amp;SUM" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_INTERMEDIATE_SUM" ICON_ID="@5V@" FUN_TEXT="Subtotales..." PATH="S"/>
  <pfstatus_fun CODE="&amp;UMC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SUM" ICON_ID="@3Z@" FUN_TEXT="Total" PATH="T"/>
  <pfstatus_fun CODE="&amp;XPA" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_EXPAND" ICON_ID="@3S@" FUN_TEXT="Desplegar"/>
  <pfstatus_fun CODE="&amp;XXL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_XXL" ICON_ID="@DJ@" FUN_TEXT="Hoja cálculo coste..." PATH="A"/>
  <pfstatus_fun CODE="BACK" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Atrás" PATH="A"/>
  <pfstatus_fun CODE="BORRAR" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Borrar objeto" PATH="B"/>
  <pfstatus_fun CODE="BOR_DUMPS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Borra dumps" PATH="O"/>
  <pfstatus_fun CODE="CAMBIOCLAS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Cambia clase desarr." PATH="C"/>
  <pfstatus_fun CODE="COMPARAR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_RENAME" ICON_ID="@4F@" FUN_TEXT="Comparar" ICON_TEXT="Comparar" INFO_TEXT="Comparar objetos"/>
  <pfstatus_fun CODE="COMP_ONL" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Comparar online" PATH="M"/>
  <pfstatus_fun CODE="COPIAPROD" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Copia tablas prod." PATH="P"/>
  <pfstatus_fun CODE="CORREO" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_ADDRESS" ICON_ID="@0T@" FUN_TEXT="Correo" ICON_TEXT="Enviar mail" INFO_TEXT="Enviar código por correo"/>
  <pfstatus_fun CODE="DESCARGAR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_EXPORT" ICON_ID="@49@" FUN_TEXT="Descargar" ICON_TEXT="Descargar" INFO_TEXT="Descargar desarrollos"/>
  <pfstatus_fun CODE="ENTER" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Enter"/>
  <pfstatus_fun CODE="EXCEL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_XLS" ICON_ID="@J2@" FUN_TEXT="Excel"/>
  <pfstatus_fun CODE="EXEC" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_EXECUTE_OBJECT" ICON_ID="@15@" FUN_TEXT="EXEC" ICON_TEXT="Borrar pedidos" INFO_TEXT="Marcar pedidos para borrado"/>
  <pfstatus_fun CODE="FIN" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Finalizar" PATH="F"/>
  <pfstatus_fun CODE="FIX_STA" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Corregir status" PATH="C"/>
  <pfstatus_fun CODE="GRABAR" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_SYSTEM_SAVE" ICON_ID="@2L@" FUN_TEXT="Grabar"/>
  <pfstatus_fun CODE="LIN_72" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Control lin.&gt;72" PATH="L"/>
  <pfstatus_fun CODE="MACHACAR" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="SAP -&gt; Fichero" PATH="S"/>
  <pfstatus_fun CODE="NUEVAL" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_TE_ADVANCE_PAYMENT" ICON_ID="@93@" FUN_TEXT="Nueva línea" ICON_TEXT="Nueva línea" INFO_TEXT="Nueva línea"/>
  <pfstatus_fun CODE="P+" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Página siguiente"/>
  <pfstatus_fun CODE="P++" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Última página"/>
  <pfstatus_fun CODE="P-" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Página anterior"/>
  <pfstatus_fun CODE="P--" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Primera página"/>
  <pfstatus_fun CODE="REPO" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Actualizar repos." PATH="T"/>
  <pfstatus_fun CODE="SUBIR_LIB" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Fichero -&gt; SAP" PATH="A"/>
  <pfstatus_fun CODE="TADIR" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Corregir TADIR" PATH="R"/>
  <pfstatus_fun CODE="TCODE" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Transacción" PATH="N"/>
  <pfstatus_fun CODE="TIPO_TXT" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Tipos texto"/>
  <pfstatus_fun CODE="UPDATE" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Verif.Actualizac." PATH="V"/>
  <pfstatus_fun CODE="VERSIONES" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Grabar copia versión" PATH="G"/>
  <pfstatus_fun CODE="WORD" TEXTNO="001" TEXT_TYPE="S" TEXT_NAME="ICON_WORD_PROCESSING" ICON_ID="@DK@" FUN_TEXT="Documentacion" ICON_TEXT="Documentación" INFO_TEXT="Documentación"/>
  <pfstatus_fun CODE="ZTASKS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Exportar a ZTASKS F" PATH="E"/>
  <pfstatus_fun CODE="ZTASKS_WS" TEXTNO="001" TEXT_TYPE="S" FUN_TEXT="Exportar a ZTASKS WS" PATH="X"/>
  <pfstatus_men CODE="000002" NO="01" REF_TYPE="F" REF_CODE="TADIR" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="02" REF_TYPE="F" REF_CODE="ZTASKS" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="03" REF_TYPE="F" REF_CODE="ZTASKS_WS" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="04" REF_TYPE="F" REF_CODE="TCODE" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="05" REF_TYPE="F" REF_CODE="LIN_72" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="06" REF_TYPE="F" REF_CODE="FIX_STA" REF_NO="001"/>
  <pfstatus_men CODE="000002" NO="07" REF_TYPE="F" REF_CODE="TIPO_TXT" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="01" REF_TYPE="F" REF_CODE="&amp;ALL" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="02" REF_TYPE="F" REF_CODE="&amp;SAL" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="03" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="04" REF_TYPE="F" REF_CODE="&amp;ILT" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="05" REF_TYPE="F" REF_CODE="&amp;ILD" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="06" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="07" REF_TYPE="F" REF_CODE="&amp;OUP" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="08" REF_TYPE="F" REF_CODE="&amp;ODN" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="09" REF_TYPE="M" REF_CODE="000005"/>
  <pfstatus_men CODE="000004" NO="10" REF_TYPE="F" REF_CODE="&amp;SUM" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="11" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="12" REF_TYPE="F" REF_CODE="%SC" REF_NO="001"/>
  <pfstatus_men CODE="000004" NO="13" REF_TYPE="S"/>
  <pfstatus_men CODE="000004" NO="14" REF_TYPE="F" REF_CODE="&amp;F12" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="01" REF_TYPE="F" REF_CODE="&amp;UMC" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="02" REF_TYPE="F" REF_CODE="&amp;AVR" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="03" REF_TYPE="F" REF_CODE="&amp;MIN" REF_NO="001"/>
  <pfstatus_men CODE="000005" NO="04" REF_TYPE="F" REF_CODE="&amp;MAX" REF_NO="001"/>
  <pfstatus_men CODE="000006" NO="01" REF_TYPE="F" REF_CODE="&amp;ABC" REF_NO="001"/>
  <pfstatus_men CODE="000006" NO="02" REF_TYPE="S"/>
  <pfstatus_men CODE="000006" NO="03" REF_TYPE="F" REF_CODE="&amp;CRDESIG" REF_NO="001"/>
  <pfstatus_men CODE="000006" NO="04" REF_TYPE="S"/>
  <pfstatus_men CODE="000006" NO="05" REF_TYPE="F" REF_CODE="BACK" REF_NO="001"/>
  <pfstatus_men CODE="000007" NO="01" REF_TYPE="F" REF_CODE="&amp;LIS" REF_NO="001"/>
  <pfstatus_men CODE="000007" NO="02" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="03" REF_TYPE="M" REF_CODE="000008"/>
  <pfstatus_men CODE="000007" NO="04" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="05" REF_TYPE="M" REF_CODE="000009"/>
  <pfstatus_men CODE="000007" NO="06" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="07" REF_TYPE="M" REF_CODE="000010"/>
  <pfstatus_men CODE="000007" NO="08" REF_TYPE="S"/>
  <pfstatus_men CODE="000007" NO="09" REF_TYPE="F" REF_CODE="&amp;NFO" REF_NO="001"/>
  <pfstatus_men CODE="000007" NO="10" REF_TYPE="F" REF_CODE="&amp;LFO" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="01" REF_TYPE="F" REF_CODE="&amp;OLX" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="02" REF_TYPE="F" REF_CODE="&amp;OAD" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="03" REF_TYPE="S"/>
  <pfstatus_men CODE="000008" NO="04" REF_TYPE="F" REF_CODE="&amp;AVE" REF_NO="001"/>
  <pfstatus_men CODE="000008" NO="05" REF_TYPE="S"/>
  <pfstatus_men CODE="000008" NO="06" REF_TYPE="F" REF_CODE="&amp;ERW" REF_NO="001"/>
  <pfstatus_men CODE="000009" NO="01" REF_TYPE="F" REF_CODE="&amp;KOM" REF_NO="001"/>
  <pfstatus_men CODE="000009" NO="02" REF_TYPE="F" REF_CODE="&amp;AUF" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="01" REF_TYPE="F" REF_CODE="&amp;OPT" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="02" REF_TYPE="S"/>
  <pfstatus_men CODE="000010" NO="03" REF_TYPE="F" REF_CODE="&amp;CFI" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="04" REF_TYPE="F" REF_CODE="&amp;CDF" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="05" REF_TYPE="S"/>
  <pfstatus_men CODE="000010" NO="06" REF_TYPE="F" REF_CODE="&amp;DAU" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="07" REF_TYPE="F" REF_CODE="&amp;DON" REF_NO="001"/>
  <pfstatus_men CODE="000010" NO="08" REF_TYPE="F" REF_CODE="&amp;DOF" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="01" REF_TYPE="F" REF_CODE="BORRAR" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="02" REF_TYPE="F" REF_CODE="CAMBIOCLAS" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="03" REF_TYPE="F" REF_CODE="BOR_DUMPS" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="04" REF_TYPE="F" REF_CODE="COPIAPROD" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="05" REF_TYPE="F" REF_CODE="SUBIR_LIB" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="06" REF_TYPE="F" REF_CODE="MACHACAR" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="07" REF_TYPE="S"/>
  <pfstatus_men CODE="000011" NO="08" REF_TYPE="F" REF_CODE="COMP_ONL" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="09" REF_TYPE="F" REF_CODE="REPO" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="10" REF_TYPE="F" REF_CODE="VERSIONES" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="11" REF_TYPE="F" REF_CODE="UPDATE" REF_NO="001"/>
  <pfstatus_men CODE="000011" NO="12" REF_TYPE="M" REF_CODE="000002"/>
  <pfstatus_men CODE="000011" NO="13" REF_TYPE="F" REF_CODE="FIN" REF_NO="001"/>
  <pfstatus_mtx CODE="000002" TEXT_TYPE="S" TEXT="Otros" PATH="R"/>
  <pfstatus_mtx CODE="000004" TEXT_TYPE="S" TEXT="Tratar" PATH="T" INT_NOTE="STANDARD"/>
  <pfstatus_mtx CODE="000005" TEXT_TYPE="S" TEXT="Calcular" PATH="R"/>
  <pfstatus_mtx CODE="000006" TEXT_TYPE="S" TEXT="Pasar a" PATH="P" INT_NOTE="STANDARD"/>
  <pfstatus_mtx CODE="000007" TEXT_TYPE="S" TEXT="Opciones" PATH="O" INT_NOTE="STANDARD"/>
  <pfstatus_mtx CODE="000008" TEXT_TYPE="S" TEXT="Disposición" PATH="D" INT_NOTE="Sub STANDARD"/>
  <pfstatus_mtx CODE="000009" TEXT_TYPE="S" TEXT="Niveles de totalización" PATH="S" INT_NOTE="Sub STANDARD"/>
  <pfstatus_mtx CODE="000010" TEXT_TYPE="S" TEXT="Columnas" PATH="C"/>
  <pfstatus_mtx CODE="000011" TEXT_TYPE="S" TEXT="Utilidades" PATH="U"/>
  <pfstatus_act CODE="000001" NO="01" MENUCODE="000011"/>
  <pfstatus_act CODE="000001" NO="02" MENUCODE="000004"/>
  <pfstatus_act CODE="000001" NO="03" MENUCODE="000006"/>
  <pfstatus_act CODE="000001" NO="04" MENUCODE="000007"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="01" PFNO="16"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="02" PFNO="36"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="03" PFNO="17"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="04" PFNO="94"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="05" PFNO="20"/>
  <pfstatus_but PFK_CODE="000001" CODE="0001" NO="06" PFNO="14"/>
  <pfstatus_pfk CODE="000001" PFNO="00" FUNCODE="ENTER" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="02" FUNCODE="&amp;IC1" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="03" FUNCODE="BACK" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="05" FUNCODE="&amp;ALL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="06" FUNCODE="&amp;SAL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="07" FUNCODE="&amp;NFO" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="08" FUNCODE="&amp;NTE" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="09" FUNCODE="EXEC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="11" FUNCODE="GRABAR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="12" FUNCODE="&amp;F12" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="14" FUNCODE="EXCEL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="15" FUNCODE="FIN" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="16" FUNCODE="DESCARGAR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="17" FUNCODE="COMPARAR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="18" FUNCODE="&amp;CRB" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="19" FUNCODE="&amp;CRE" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="20" FUNCODE="NUEVAL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="21" FUNCODE="P--" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="22" FUNCODE="P-" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="23" FUNCODE="P+" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="24" FUNCODE="P++" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="25" FUNCODE="&amp;ABC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="26" FUNCODE="&amp;CRL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="27" FUNCODE="&amp;CRR" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="28" FUNCODE="&amp;OUP" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="29" FUNCODE="&amp;ILT" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="30" FUNCODE="&amp;UMC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="31" FUNCODE="%SL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="32" FUNCODE="&amp;OL0" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="33" FUNCODE="&amp;OAD" FUNNO="002"/>
  <pfstatus_pfk CODE="000001" PFNO="34" FUNCODE="&amp;AVE" FUNNO="002"/>
  <pfstatus_pfk CODE="000001" PFNO="35" FUNCODE="&amp;XPA" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="36" FUNCODE="CORREO" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="37" FUNCODE="&amp;EB9" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="39" FUNCODE="&amp;ETA" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="40" FUNCODE="&amp;ODN" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="41" FUNCODE="&amp;LFO" FUNNO="002"/>
  <pfstatus_pfk CODE="000001" PFNO="42" FUNCODE="&amp;SUM" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="43" FUNCODE="&amp;XXL" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="44" FUNCODE="&amp;AQW" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="45" FUNCODE="%PC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="46" FUNCODE="&amp;RNT_PREV" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="47" FUNCODE="&amp;OMP" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="71" FUNCODE="%SC" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="80" FUNCODE="P--" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="81" FUNCODE="P-" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="82" FUNCODE="P+" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="83" FUNCODE="P++" FUNNO="001"/>
  <pfstatus_pfk CODE="000001" PFNO="94" FUNCODE="WORD" FUNNO="001"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%CH"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%PC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%SC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="%SL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ABC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ALL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AQW"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AUF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AVE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;AVR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;BS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;BS+"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;BS-"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CDF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CFI"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRB"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;CRR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;DAU"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;DOF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;DON"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;EB3"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;EB9"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ERW"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ETA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;F12"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;IC1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ILD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ILT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;KOM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;LFO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;LIS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;MAX"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;MIN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;NFO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;NTE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OAD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;ODN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OL0"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OLX"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OMP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OPT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;OUP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;SAL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;SUM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;UMC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;XPA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="&amp;XXL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BAC1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BACK"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB2"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB3"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEB9"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BEBN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BORRAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="BOR_DUMPS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="CAMBIOCLAS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COL0"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COLX"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COMPARAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COMP_ONL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="COPIAPROD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="CORREO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DESCARGAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DETA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DRUK"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="DSAL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ENTE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ENTER"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="EXCEL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="EXEC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="EXIT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="EXPA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="FILD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="FILT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="FIN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="FIX_STA"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="GLIS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="GRABAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="HELP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="INFO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="KOMP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="LIN_72"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="MACHACAR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="NUEVAL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P+"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P++"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P-"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="P--"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PF09"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PF13"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PIC1"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PICK"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PRI"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PRIN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="PRNT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="REPO"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="RW"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SALL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SAUF"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SAVE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRB"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRL"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SCRR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SKOM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SODN"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SOUP"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SUBIR_LIB"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="SUMC"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="TADIR"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="TCODE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="TIPO_TXT"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="UPDATE"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="VERSIONES"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="WORD"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ZSUM"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ZTASKS"/>
  <pfstatus_set STATUS="STANDARD" FUNCTION="ZTASKS_WS"/>
  <pfstatus_doc OBJ_TYPE="A" OBJ_CODE="000001" MODAL="D" INT_NOTE="Standardoberfläche              STANDARD"/>
  <pfstatus_doc OBJ_TYPE="P" OBJ_CODE="000001" MODAL="D" NORM="X" INT_NOTE="Standard maximale Interaktion"/>
  <pfstatus_doc OBJ_TYPE="B" OBJ_CODE="000001" SUB_CODE="0001" MODAL="D" INT_NOTE="Standard maximale Interaktion"/>
  <pfstatus_tit CODE="100" TEXT="Desarrollo"/>
 </pfstatus>
 <source>************************************************************************
* APLICACION  : BC                                                    *
* TIPO        : Listado
* TITULO      : Listado seguimiento desarrollos
* DESCRIPCION :
* VERSION     : 0.72
*                                                                      *
*AUTOR: Andres Picazo                           FECHA: 28/02/2007      *
* MODIFICACIONES                                                       *
* -------------                                                        *
* FECHA        NOMBRE                               ORDEN              *
* -------------------------------------------------------------------- *
* dd.mm.yyyy   username                                                *
************************************************************************
REPORT zbcut011
      NO STANDARD PAGE HEADING
      LINE-COUNT 065
      LINE-SIZE 100.

* Trampo status
* inlclude LSMPIF03 linea 62 form check_adm tables
*if sy-uname = zcl_c=&gt;usuario_ap. exit. endif.

*------INCLUDES--------------------------------------------------------*

CONSTANTS c_version TYPE p LENGTH 8 DECIMALS 0 VALUE 20180410.

*------TABLAS/ESTRUCTURAS----------------------------------------------*
TABLES:
  cross,
  trdir,
  tadir,
  ddtypes,
  tfdir,
  v_fdirt,
  stxh,
  zbc003,
  zbc003t,
  stxfadm,
  modtext,
  modact,
  modsap,
  tstcp,
  ttxfp,
  dd02l,
  smimloio,
  e071,
  rseuinc,
  dd40l,
  dd04l,
  dd01l,
  dd02t,
  o2xsltdesc,
  hrs1000,
  sscrfields,
  tstc.

DATA: i_listado         TYPE TABLE OF zest_zbc003 WITH HEADER LINE,
      i_list_orig       TYPE TABLE OF zest_zbc003 WITH HEADER LINE,
      i_list            TYPE TABLE OF zest_zbc003 WITH HEADER LINE,
      l_listado         TYPE zest_zbc003,
      enhincinx         TYPE enhincinx,
      fpcontext         TYPE fpcontext,
      fpinterface       TYPE fpinterface,
      v_ruta_comparador TYPE string,
      o_ms              TYPE REF TO zcl_ap_mgraph.

DATA: BEGIN OF i_list_excel OCCURS 0,
        object           TYPE zest_zbc003-object,
        name             TYPE zest_zbc003-name,
        text             TYPE zest_zbc003-text,
        parentcl         TYPE zest_zbc003-parentcl,
        devclass         TYPE zest_zbc003-devclass,
        tcode            TYPE zest_zbc003-tcode,
        ttext            TYPE zest_zbc003-ttext,
        cnam             TYPE zest_zbc003-cnam,
        cdat             TYPE zest_zbc003-cdat,
        unam             TYPE zest_zbc003-unam,
        udat             TYPE zest_zbc003-udat,
        hash             TYPE zest_zbc003-hash,
        cliente_descarga TYPE zest_zbc003-cliente_descarga,
        fecha_descarga   TYPE zest_zbc003-fecha_descarga,
      END OF i_list_excel,
      i_list_excel_dic LIKE i_list_excel OCCURS 0,
      i_list_excel_ext LIKE i_list_excel OCCURS 0,
      i_list_excel_opn LIKE i_list_excel OCCURS 0,
      i_list_excel_gen LIKE i_list_excel OCCURS 0,
      i_list_excel_tmp LIKE i_list_excel OCCURS 0,
      v_text1          TYPE string,
      v_text2          TYPE string.

DATA i_source TYPE TABLE OF text255 WITH HEADER LINE.

DATA: BEGIN OF i_cambios OCCURS 0,
        name    TYPE trdir-name,
        vrsflag TYPE vxabapt255-vrsflag,
        number  TYPE vxabapt255-number,
        line    TYPE vxabapt255-line,
      END OF i_cambios,
      i_camb    TYPE TABLE OF vxabapt255,
      l_camb    TYPE vxabapt255,
      l_cambios LIKE i_cambios,
      i_grupof  TYPE TABLE OF string WITH HEADER LINE.

*------VARIABLES-------------------------------------------------------*
DATA: sgpi  TYPE REF TO zcl_ap_sgpi,
      o_alv TYPE REF TO zcl_ap_alv_grid,
      o_enh TYPE REF TO cl_enh_editor_navigator.

DATA: BEGIN OF i_ztasks OCCURS 0,
        cliente         TYPE c LENGTH 3,
        objeto          TYPE c LENGTH 30,
        descripcion_obj TYPE c LENGTH 80,
        texto           TYPE string,
      END OF i_ztasks.


DATA v_directorio TYPE string.
DATA: v_ans                TYPE c LENGTH 1,
      v_emailaddr          TYPE c LENGTH 130,
      v_no_se_adjunta_slnk TYPE c LENGTH 1,
      v_fichero_excel      TYPE string,
      v_fichero_excel_dic  TYPE string,
      v_fichero_excel_ext  TYPE string,
      v_fichero_excel_opn  TYPE string,
      v_fichero_excel_gen  TYPE string,
      v_fichero_excel_tmp  TYPE string,
      i_ficheros_ftp       TYPE TABLE OF string WITH HEADER LINE.

DATA o_bi      TYPE REF TO zcl_ap_batch_input.
DATA l_mensaje TYPE bapireturn1-message.                    &quot;#EC *

DATA o_prog    TYPE REF TO zcl_ap_dev.

RANGES: r_devclass_open FOR tadir-devclass,
        r_devclass_openf FOR tadir-devclass.

DEFINE addrango_eq.
  CLEAR &amp;1.
  &amp;1-option = &apos;EQ&apos;.
  &amp;1-sign   = &apos;I&apos;.
  &amp;1-low    = &amp;2.
  APPEND &amp;1.
END-OF-DEFINITION.


DEFINE addrango_neq.
  CLEAR &amp;1.
  &amp;1-option = &apos;EQ&apos;.
  &amp;1-sign   = &apos;E&apos;.
  &amp;1-low    = &amp;2.
  APPEND &amp;1.
END-OF-DEFINITION.

*----------------------------------------------------------------------*
* CLASS lcl_event_grid_100 DEFINITION
*----------------------------------------------------------------------*
*
*----------------------------------------------------------------------*
CLASS lcl_event_grid DEFINITION INHERITING FROM zcl_ap_alv_grid_eventos FINAL.
  PUBLIC SECTION.
    METHODS: double_click REDEFINITION,
      toolbar      REDEFINITION,
      user_command REDEFINITION.
ENDCLASS. &quot; lcl_event_grid_100 DEFINITION

DATA: o_event        TYPE REF TO lcl_event_grid,
      v_fechas_vivas TYPE d,
      i_ficheros     TYPE TABLE OF file_info WITH HEADER LINE.

*------PARAMETER/SELECT-OPTIONS EN PANTALLA----------------------------*
SELECTION-SCREEN BEGIN OF BLOCK blk_par WITH FRAME TITLE TEXT-001.

  SELECT-OPTIONS: s_tcode  FOR tstc-tcode,
                  s_report FOR trdir-name,
                  s_subc   FOR trdir-subc,
                  s_devcla FOR tadir-devclass,
                  s_estado FOR zbc003-estado,
                  s_grupo  FOR zbc003-grupo,
                  s_cdat   FOR trdir-cdat,
                  s_udat   FOR trdir-udat,
                  s_cnam   FOR trdir-cnam,
                  s_unam   FOR trdir-unam,
                  s_asign  FOR zbc003-asignado_a,
                  s_progr  FOR zbc003-probado_por,
                  s_prior  FOR zbc003-prioridad,
                  s_ot     FOR e071-trkorr.

  SELECTION-SCREEN SKIP.

  PARAMETERS: p_report AS CHECKBOX DEFAULT &apos;X&apos;,
              p_funcio AS CHECKBOX DEFAULT &apos; &apos;,
              p_clases AS CHECKBOX DEFAULT &apos; &apos;,
              p_formul AS CHECKBOX DEFAULT &apos; &apos;,
              p_proyec AS CHECKBOX DEFAULT &apos; &apos;,
              p_badis  AS CHECKBOX DEFAULT &apos; &apos;,
              p_userex AS CHECKBOX DEFAULT &apos; &apos;,
              p_modife AS CHECKBOX DEFAULT &apos; &apos;,
              p_rutina AS CHECKBOX DEFAULT &apos; &apos;,
              p_tablas AS CHECKBOX DEFAULT &apos; &apos;,
              p_cds    AS CHECKBOX DEFAULT &apos; &apos;,
              p_enhan  AS CHECKBOX DEFAULT &apos; &apos;,
              p_bte    AS CHECKBOX DEFAULT &apos; &apos;,
              p_bsp    AS CHECKBOX DEFAULT &apos; &apos;,
              p_mime   AS CHECKBOX DEFAULT &apos; &apos;,
              p_webd   AS CHECKBOX DEFAULT &apos;&apos;,
              p_pdf    AS CHECKBOX DEFAULT &apos;&apos;,
              p_xslt   AS CHECKBOX DEFAULT &apos;&apos;,
              p_wf     AS CHECKBOX DEFAULT &apos;&apos;.

SELECTION-SCREEN END OF BLOCK blk_par.

SELECTION-SCREEN BEGIN OF BLOCK blk_par3 WITH FRAME TITLE TEXT-003.
  PARAMETERS: p_rfc    TYPE rfcdest,
              p_lib    AS CHECKBOX MODIF ID zap,
              p_solom  AS CHECKBOX MODIF ID zap,
              p_utili  AS CHECKBOX MODIF ID zap,
              p_numlin AS CHECKBOX MODIF ID zap,
              p_zip    AS CHECKBOX MODIF ID zap,
              p_outlo  AS CHECKBOX MODIF ID zap,
              p_ftp    AS CHECKBOX MODIF ID zap,
              p_origen DEFAULT &apos;L&apos; MODIF ID zap,
              p_dirlib TYPE string MODIF ID zap,
              p_vivas  AS CHECKBOX MODIF ID zap,
              p_libt   AS CHECKBOX MODIF ID zap,
              p_hash   AS CHECKBOX MODIF ID zap,
              p_ext    AS CHECKBOX MODIF ID zap,
              p_open   AS CHECKBOX MODIF ID zap,
              p_gen    AS CHECKBOX MODIF ID zap,
              p_tmp    AS CHECKBOX MODIF ID zap,
              p_zipl   AS CHECKBOX DEFAULT &apos;X&apos; MODIF ID zap,
              p_buscar TYPE text132,
              p_onedr  AS CHECKBOX MODIF ID zap USER-COMMAND one,
              p_dirto  TYPE text255 MODIF ID za2,
              p_rutaw  TYPE text255.
  SELECTION-SCREEN SKIP.
  PARAMETERS p_vari LIKE disvariant-variant.
SELECTION-SCREEN END OF BLOCK blk_par3.


************************************************************************
*
*                  LOGICA DEL PROGRAMA
*
************************************************************************


*----------------------------------------------------------------------*
* INITIALIZATION
*----------------------------------------------------------------------*
INITIALIZATION.
  o_prog = NEW #( get_nombre_pc = &apos;X&apos; ).

  o_prog-&gt;initialization( EXPORTING nombre_pc = o_prog-&gt;nombre_pc CHANGING sscrfields = sscrfields ).

*  addrango_eq: s_subc &apos;1&apos;,
*               s_subc &apos;M&apos;,
*               s_subc &apos;S&apos;.

  addrango_neq: s_estado &apos;B&apos;,
                s_estado &apos;N&apos;,
                s_estado &apos;O&apos;.

  IF sy-uname = zcl_c=&gt;usuario_ap.
    SET PARAMETER ID &apos;SAPLINK_AUTHOR&apos; FIELD &apos;APICAZO&apos;.      &quot;#EC *
  ENDIF.


AT SELECTION-SCREEN OUTPUT.
  IF NOT sy-uname = zcl_c=&gt;usuario_ap.
    zcl_ap_dynpro=&gt;screen_visible( group1 = &apos;ZAP&apos; variable = &apos;&apos; ).
    CLEAR: p_lib, p_solom, p_onedr, p_dirto, p_dirlib, p_origen.
  ENDIF.
  zcl_ap_dynpro=&gt;screen_visible( group1 = &apos;ZA2&apos; variable = p_onedr ).

*----------------------------------------------------------------------
* START-OF-SELECTION.
*----------------------------------------------------------------------*
START-OF-SELECTION.
  IF p_vivas = &apos;X&apos;.
    p_report = &apos;X&apos;.
    p_funcio = &apos;X&apos;.
    p_clases = &apos;X&apos;.
    p_formul = &apos;X&apos;.
*    p_proyec = &apos;X&apos;.
*    p_badis  = &apos;X&apos;.
    p_tablas = &apos;X&apos;.
    p_pdf    = &apos;X&apos;.
*    p_xslt   = &apos;X&apos;.
    v_fechas_vivas = zcl_ap_temp=&gt;get_st_valor1( clave = sy-tcode subclave = sy-uname ).
    IF v_fechas_vivas IS INITIAL.
      v_fechas_vivas = sy-datum - 365.
    ENDIF.
  ELSEIF p_libt = &apos;X&apos;.
    p_lib = &apos;X&apos;.
    p_solom = &apos;X&apos;.
    p_report = &apos;X&apos;.
    p_funcio = &apos;X&apos;.
    p_clases = &apos;X&apos;.
    p_tablas = &apos;X&apos;.
    p_modife = &apos;X&apos;.
*    v_fechas_vivas = sy-datum - 60.
*    CLEAR s_udat.
*    s_udat-option = &apos;GT&apos;.
*    s_udat-sign = &apos;I&apos;.
*    s_udat-low = v_fechas_vivas.
*    APPEND s_udat.
  ENDIF.

  IF p_lib = &apos;X&apos; OR NOT p_rfc IS INITIAL.
    DATA v_merge TYPE string.
    v_merge = |C:\\Program Files\\WinMerge,C:\\Users\\andre\\OneDrive\\tools\\WinMerge,| &amp;&amp;
              |\\\\nws4101.stadlerrail.ch\\vdi_data_users$\\picand\\Desktop\\WinMerge\\WinMerge\\|.

    IF p_rutaw IS INITIAL.
      v_ruta_comparador = zcl_ap_ficheros=&gt;buscar_ruta_fichero( fichero = &apos;WinMergeU.exe&apos; rutas = v_merge ). &quot;#EC *
    ELSE.
      v_ruta_comparador = p_rutaw.
    ENDIF.

  ENDIF.

  DATA: v_aux1 TYPE string,
        v_aux2 TYPE string.
  SPLIT zcl_c=&gt;ruta_descarga_slnk AT &apos;\CODIGO\Reports_slnk\&apos; INTO v_aux1 v_aux2. &quot;#EC *
  CONCATENATE &apos;\CODIGO\Reports_slnk\&apos; v_aux2 INTO v_aux1.   &quot;#EC *

  IF p_onedr = &apos;X&apos; AND NOT p_dirlib IS INITIAL.
    o_ms = NEW zcl_ap_mgraph( clave = &apos;ZAPC&apos; json_parametros = p_dirlib ).
    IF NOT o_ms-&gt;message IS INITIAL.
      MESSAGE o_ms-&gt;message TYPE &apos;I&apos;.
      RETURN.
    ENDIF.

    v_directorio = &apos;GD_LIB/LIB&apos;.
    IF p_lib = &apos;X&apos;.
      v_fichero_excel = |{ v_directorio }/libreria.xlsx|.
    ELSE.
      REPLACE &apos;/LIB&apos; IN v_directorio WITH v_aux1.
      REPLACE ALL OCCURRENCES OF &apos;\&apos; IN v_directorio WITH &apos;/&apos;.
      v_fichero_excel = |{ v_directorio }/desarrollos.xlsx|.
      REPLACE ALL OCCURRENCES OF &apos;//&apos; IN v_fichero_excel WITH &apos;/&apos;.
    ENDIF.
  ELSE.
    IF NOT p_dirlib IS INITIAL.
      v_directorio = p_dirlib.
    ELSE.

      DATA v_rlib TYPE string.
      v_rlib = |C:\\GD_LIB\\LIB,| &amp;&amp;
               |C:\\Users\\andre\\OneDrive - SAP4 Programing SL\\GD_LIB\\LIB,| &amp;&amp;
               |D:\\OneDrive - SAP4 Programing SL\\GD_LIB\\LIB,| &amp;&amp;
               |\\\\nws4101.stadlerrail.ch\\vdi_data_users$\\picand\\Downloads\\LIB|.
      v_directorio = zcl_ap_ficheros=&gt;buscar_ruta_fichero( rutas = v_rlib ).
    ENDIF.

    IF p_lib IS INITIAL.
      IF v_directorio CS &apos;\LIB\LIB&apos;.
        REPLACE &apos;\LIB\LIB&apos; IN v_directorio WITH &apos;\X||X\LIB&apos;.
        REPLACE &apos;\LIB&apos; IN v_directorio WITH v_aux1.
        REPLACE &apos;\X||X\&apos; IN v_directorio WITH &apos;\LIB\&apos;.
      ELSE.
        REPLACE &apos;\LIB&apos; IN v_directorio WITH v_aux1.
      ENDIF.

      v_fichero_excel = zcl_ap_ficheros=&gt;concat_ruta( directorio = v_directorio fichero = &apos;desarrollos.xlsx&apos; ).
    ELSE.
      v_fichero_excel = zcl_ap_ficheros=&gt;concat_ruta( directorio = v_directorio fichero = &apos;libreria.xlsx&apos; ).
    ENDIF.
  ENDIF.

  IF p_hash IS INITIAL AND p_solom IS INITIAL AND p_lib IS INITIAL.
    CLEAR v_fichero_excel.
  ENDIF.

  IF p_solom = &apos;X&apos; AND p_onedr IS INITIAL.
    i_ficheros[] = zcl_ap_ficheros=&gt;lista_ficheros( directory = v_directorio recursivo = &apos;X&apos; max_ficheros = 99999 ).
    DELETE i_ficheros WHERE filelength = 0.
    DELETE i_ficheros WHERE NOT ( filename CS &apos;.txt&apos; OR filename CS &apos;.slnk&apos; ).
  ENDIF.

  sgpi = NEW #( ).
  o_bi = NEW #( ).

  IF NOT s_ot[] IS INITIAL.
    SELECT DISTINCT object, obj_name FROM e070 JOIN e071 ON e070~trkorr = e071~trkorr
      INTO TABLE @DATA(i_obj)
     WHERE (    e070~trkorr  IN @s_ot
             OR e070~strkorr IN @s_ot )
       AND obj_name IN @s_report
       AND object   IN ( &apos;CINC&apos;, &apos;CLAS&apos;, &apos;CLSD&apos;, &apos;CPRI&apos;, &apos;CPRO&apos;, &apos;CPUB&apos;, &apos;CUAD&apos;, &apos;DDLS&apos;, &apos;DOMA&apos;, &apos;DOMD&apos;, &apos;DTEL&apos;, &apos;DYNP&apos;, &apos;ENHO&apos;, &apos;FUGR&apos;, &apos;FUNC&apos;, &apos;METH&apos;, &apos;PROG&apos;, &apos;REPS&apos;, &apos;REPT&apos;, &apos;SFPF&apos;, &apos;SFPI&apos;, &apos;TABD&apos;, &apos;TABL&apos;, &apos;TTYD&apos;, &apos;TTYP&apos; ).

    LOOP AT i_obj ASSIGNING FIELD-SYMBOL(&lt;obj&gt;).
      CASE &lt;obj&gt;-object.
        WHEN &apos;METH&apos; OR &apos;DYNP&apos;.
          APPEND VALUE #( option = &apos;EQ&apos; sign = &apos;I&apos; low = &lt;obj&gt;-obj_name(30)  ) TO s_report[].
        WHEN &apos;CINC&apos;.
          SPLIT &lt;obj&gt;-obj_name AT &apos;=&apos; INTO DATA(cl) DATA(otr).
          APPEND VALUE #( option = &apos;EQ&apos; sign = &apos;I&apos; low = cl ) TO s_report[].
        WHEN OTHERS.
          APPEND VALUE #( option = &apos;EQ&apos; sign = &apos;I&apos; low = &lt;obj&gt;-obj_name ) TO s_report[].
      ENDCASE.
    ENDLOOP.
  ENDIF.

  PERFORM seleccionar_datos.

  CALL SCREEN 0100.

************************************************************************
*
*                  FORMS ADICIONALES
*
************************************************************************

*&amp;---------------------------------------------------------------------*

*&amp;      Form  SELECCIONAR_DATOS
*&amp;---------------------------------------------------------------------*
*       Selecciona las devoluciones
*----------------------------------------------------------------------*

FORM seleccionar_datos.
  DATA r_obj    TYPE TABLE OF rstt_s_range_string WITH HEADER LINE.
  DATA l_tabla  TYPE tabname VALUE &apos;ZESTADISTICAS&apos;.
  DATA i_zbc003 LIKE zbc003 OCCURS 0 WITH HEADER LINE.
  DATA: l_aux1 TYPE c LENGTH 80,
        l_aux2 TYPE c LENGTH 80.
  DATA i_tadir     TYPE TABLE OF tadir WITH HEADER LINE.
  DATA i_enhincinx TYPE TABLE OF enhincinx WITH HEADER LINE.
  DATA: ev_include TYPE programm,
        ev_line    TYPE string.
  DATA l_ok TYPE c LENGTH 1.
  DATA: i_dd02l   TYPE TABLE OF dd02l WITH HEADER LINE,
        l_tabname LIKE d010tab-tabname,
        i_progs   LIKE d010tab OCCURS 0 WITH HEADER LINE.
  DATA i_tbe    TYPE TABLE OF tbe32 WITH HEADER LINE.
  DATA i_bsp    TYPE TABLE OF o2appl WITH HEADER LINE.
  DATA i_webd   TYPE TABLE OF wdy_application WITH HEADER LINE.
  DATA r_object TYPE RANGE OF e071-object.
  DATA: i_trdir LIKE trdir OCCURS 1000 WITH HEADER LINE,
        BEGIN OF i_tstc  OCCURS 300,
          pgmna LIKE tstc-pgmna,
          tcode LIKE tstc-tcode,
        END   OF i_tstc,
        BEGIN OF i_estad OCCURS 1000,
          report  TYPE c LENGTH 40, &quot; LIKE zestadisticas-report,
          fecha   TYPE d,           &quot; LIKE zestadisticas-fecha,

          account TYPE sy-uname,    &quot; LIKE zestadisticas-account,
          total   TYPE i,
        END OF i_estad,
        l_aux   TYPE c LENGTH 60,
        i_est   LIKE i_estad OCCURS 100000 WITH HEADER LINE,
        l_fin   TYPE c LENGTH 1,
        l_tcode TYPE sy-tcode.

  CLEAR r_obj.
  r_obj-option = &apos;CP&apos;.
  r_obj-sign   = &apos;I&apos;.
  r_obj-low    = &apos;Z*&apos;.
  APPEND r_obj.
  r_obj-low = &apos;Y*&apos;.
  APPEND r_obj.
  IF p_ext = &apos;X&apos;.
    IF sy-uname = zcl_c=&gt;usuario_ap.
      r_obj-low = &apos;/SOTHIS/*&apos;.
      APPEND r_obj.
      r_obj-low = &apos;/SEI/*&apos;.
      APPEND r_obj.
      r_obj-low = &apos;/MOVI/*&apos;.
      APPEND r_obj.
      r_obj-low = &apos;/COCKPIT/*&apos;.
      APPEND r_obj.
      r_obj-low = &apos;/IECI/*&apos;.
      APPEND r_obj.
      r_obj-low = &apos;/KABAAWM/*&apos;.
      APPEND r_obj.
    ENDIF.
  ENDIF.

  r_devclass_open-option = &apos;CP&apos;.
  IF p_open IS INITIAL.
    r_devclass_open-sign = &apos;E&apos;.
  ELSE.
    r_devclass_open-sign = &apos;I&apos;.
  ENDIF.
  r_devclass_open-low = &apos;ZABAPGIT*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;ZOPENCHECK*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;TEST_*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;ZAPCMD*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;ZABAP2XLSX*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;ZSAPLINK*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;ZEXCEL*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;ZCUTE*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;YAPCMD*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;ZAPCMD*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;*CODEPAL*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;*AOC_CHECK*&apos;. APPEND r_devclass_open.
  r_devclass_open-low = &apos;$*&apos;. APPEND r_devclass_open.

  IF p_open IS INITIAL.
    r_devclass_openf[] = r_devclass_open[].
  ENDIF.

  IF p_vivas IS INITIAL.
    SELECT tabname FROM dd02l
      UP TO 1 ROWS
      INTO l_tabla
     WHERE tabname = l_tabla
     ORDER BY PRIMARY KEY.
    ENDSELECT.
    IF sy-subrc = 0.
      SELECT * FROM (l_tabla)
        INTO CORRESPONDING FIELDS OF TABLE i_est
       WHERE report IN s_report
         AND ( report IN r_obj
          OR   report LIKE &apos;SAPMZ%&apos; ).
      SORT i_est.
      LOOP AT i_est.
        AT NEW report.
          CLEAR i_estad.
          CLEAR l_fin.
        ENDAT.
        i_estad-total = i_estad-total + 1.
        AT END OF report.
          l_fin = &apos;X&apos;.
        ENDAT.
        IF l_fin = &apos;X&apos;.
          i_estad-report  = i_est-report.
          i_estad-fecha   = i_est-fecha.
          i_estad-account = i_est-account.
          APPEND i_estad.
          CLEAR l_fin.
        ENDIF.
      ENDLOOP.
      REFRESH i_est.
      SORT i_estad.
    ENDIF.
  ENDIF.

  IF NOT v_fichero_excel IS INITIAL.
    IF p_onedr = &apos;X&apos;.
      o_ms-&gt;get_contenido_fichero( EXPORTING nombre = v_fichero_excel popup_respuesta = &apos;&apos; IMPORTING message = DATA(l_msg) tabla_xlsx = i_list_excel[] ).
      IF NOT l_msg IS INITIAL. MESSAGE l_msg TYPE &apos;I&apos;. ENDIF.
    ELSE.
      IF zcl_ap_ficheros=&gt;existe(  v_fichero_excel ).
        zcl_ap_sgpi=&gt;text( &apos;Leyendo excel con listado objetos&apos; ).

        NEW zcl_ap_abap2xls( )-&gt;lee_fichero( EXPORTING fichero       = v_fichero_excel
                                                       get_datos     = &apos;X&apos;
                                                       huge          = &apos;X&apos;
                                                       mostrar_error = &apos;&apos;
                                             IMPORTING datos         = i_list_excel[] ).

        IF p_lib IS INITIAL.
          v_fichero_excel_dic = v_fichero_excel.
          REPLACE &apos;desarrollos.xlsx&apos; IN v_fichero_excel_dic WITH &apos;desarrollos_dic.xlsx&apos;.

          IF p_tablas = &apos;X&apos;.
            v_fichero_excel_dic = v_fichero_excel.
            REPLACE &apos;desarrollos.xlsx&apos; IN v_fichero_excel_dic WITH &apos;desarrollos_dic.xlsx&apos;.
            NEW zcl_ap_abap2xls( )-&gt;lee_fichero( EXPORTING fichero       = v_fichero_excel_dic
                                                           get_datos     = &apos;X&apos;
                                                           huge          = &apos;X&apos;
                                                           mostrar_error = &apos;&apos;
                                                 IMPORTING datos         = i_list_excel_dic[] ).
            APPEND LINES OF i_list_excel_dic TO i_list_excel.
          ENDIF.

          v_fichero_excel_ext = v_fichero_excel.
          REPLACE &apos;desarrollos.xlsx&apos; IN v_fichero_excel_ext WITH &apos;desarrollos_ext.xlsx&apos;.
          IF p_ext = &apos;X&apos;.
            NEW zcl_ap_abap2xls( )-&gt;lee_fichero( EXPORTING fichero       = v_fichero_excel_ext
                                                           get_datos     = &apos;X&apos;
                                                           huge          = &apos;X&apos;
                                                           mostrar_error = &apos;&apos;
                                                 IMPORTING datos         = i_list_excel_ext[] ).
            APPEND LINES OF i_list_excel_ext TO i_list_excel.
          ENDIF.

          v_fichero_excel_opn = v_fichero_excel.
          REPLACE &apos;desarrollos.xlsx&apos; IN v_fichero_excel_opn WITH &apos;desarrollos_open.xlsx&apos;.

          IF p_open = &apos;X&apos;.
            NEW zcl_ap_abap2xls( )-&gt;lee_fichero( EXPORTING fichero       = v_fichero_excel_opn
                                                           get_datos     = &apos;X&apos;
                                                           huge          = &apos;X&apos;
                                                           mostrar_error = &apos;&apos;
                                                 IMPORTING datos         = i_list_excel_opn[] ).
            APPEND LINES OF i_list_excel_opn TO i_list_excel.
          ENDIF.

          v_fichero_excel_gen = v_fichero_excel.
          REPLACE &apos;desarrollos.xlsx&apos; IN v_fichero_excel_gen WITH &apos;desarrollos_generated.xlsx&apos;.

          IF p_gen = &apos;X&apos;.
            NEW zcl_ap_abap2xls( )-&gt;lee_fichero( EXPORTING fichero       = v_fichero_excel_gen
                                                           get_datos     = &apos;X&apos;
                                                           huge          = &apos;X&apos;
                                                           mostrar_error = &apos;&apos;
                                                 IMPORTING datos         = i_list_excel_gen[] ).
            APPEND LINES OF i_list_excel_gen TO i_list_excel.
          ENDIF.

          v_fichero_excel_tmp = v_fichero_excel.
          REPLACE &apos;desarrollos.xlsx&apos; IN v_fichero_excel_tmp WITH &apos;desarrollos_tmp.xlsx&apos;.

          IF p_tmp = &apos;X&apos;.
            NEW zcl_ap_abap2xls( )-&gt;lee_fichero( EXPORTING fichero       = v_fichero_excel_tmp
                                                           get_datos     = &apos;X&apos;
                                                           huge          = &apos;X&apos;
                                                           mostrar_error = &apos;&apos;
                                                 IMPORTING datos         = i_list_excel_tmp[] ).
            APPEND LINES OF i_list_excel_tmp TO i_list_excel.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDIF.

  RANGES: r_name FOR trdir-name,
          r_name_apc FOR trdir-name.

  addrango_eq r_name_apc &apos;&amp;&amp;&amp;&amp;&amp;&apos;.
  IF    NOT s_grupo[] IS INITIAL
     OR NOT s_asign[] IS INITIAL
     OR NOT s_progr[] IS INITIAL
     OR NOT s_prior[] IS INITIAL
     OR NOT p_lib     IS INITIAL.
    SELECT * FROM zbc003
      INTO TABLE i_zbc003
     WHERE (    grupo  IN s_grupo
             OR grupo2 IN s_grupo
             OR grupo3 IN s_grupo )
       AND asignado_a    IN s_asign
       AND procesado_por IN s_progr
       AND name          IN s_report
       AND prioridad     IN s_prior.
    IF sy-subrc &lt;&gt; 0.
      addrango_eq r_name &apos;&amp;&amp;&amp;&amp;&amp;&apos;.
    ELSE.
      IF p_lib = &apos;X&apos;.
        DELETE i_zbc003 WHERE libreria = &apos;&apos;.
      ENDIF.
      LOOP AT i_zbc003.
        addrango_eq r_name i_zbc003-name.
      ENDLOOP.
    ENDIF.
  ELSEIF p_vivas = &apos;X&apos;.
    SELECT * FROM zbc003
      INTO TABLE i_zbc003
     WHERE name IN s_report
       AND (    asignado_a     = sy-uname
             OR procesado_por  = sy-uname
             OR prioridad     &lt;&gt; 0 ).
    IF sy-subrc = 0.
      IF p_lib = &apos;X&apos;.
        DELETE i_zbc003 WHERE libreria = &apos;&apos;.
      ENDIF.
      LOOP AT i_zbc003.
        addrango_eq r_name_apc i_zbc003-name.
      ENDLOOP.
    ENDIF.
  ENDIF.

  IF p_report = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando programas&apos;(spr) ).
* Buscamos programas

    IF p_vivas IS INITIAL.
      SELECT * FROM  trdir
        INTO TABLE i_trdir
       WHERE ( name  IN r_obj
            OR name  LIKE &apos;SAPMZ%&apos;
            OR name  LIKE &apos;MZ%&apos;
            OR name  LIKE &apos;LZ%F01&apos; )
          AND NOT name LIKE &apos;%==%&apos;
          AND name IN s_report
          AND name IN r_name
      AND ( subc = &apos;1&apos; OR subc = &apos;M&apos; OR subc = &apos;I&apos; OR subc = &apos;S&apos; )
      AND subc IN s_subc
      AND ( cnam IN s_cnam
        AND unam IN s_unam
        AND cdat IN s_cdat
        AND udat IN s_udat )
      ORDER BY name.
    ELSE.
      SELECT * FROM  trdir
        INTO TABLE i_trdir
       WHERE
        name IN r_name_apc
         OR (
            ( name  IN r_obj
           OR name  LIKE &apos;SAPMZ%&apos;
           OR name  LIKE &apos;MZ%&apos;
           OR name  LIKE &apos;LZ%F01&apos; )
         AND NOT name LIKE &apos;%=====%&apos;
         AND name IN s_report
         AND name IN r_name
      AND ( subc = &apos;1&apos; OR subc = &apos;M&apos; OR subc = &apos;I&apos; OR subc = &apos;S&apos; )
      AND subc IN s_subc
      AND ( cnam = sy-uname OR unam = sy-uname )
      AND ( cdat &gt;= v_fechas_vivas OR udat &gt;= v_fechas_vivas ) )
        ORDER BY name.

      LOOP AT i_zbc003 WHERE prioridad = &apos;88888&apos;.
        DELETE i_trdir WHERE name = i_zbc003-name.
      ENDLOOP.
    ENDIF.

    IF NOT i_trdir[] IS INITIAL.
      SELECT * FROM tstc                                &quot;#EC CI_GENBUFF
        INTO CORRESPONDING FIELDS OF TABLE i_tstc
        FOR ALL ENTRIES IN i_trdir
       WHERE pgmna = i_trdir-name.
    ENDIF.
    SORT i_tstc.
    sgpi-&gt;get_filas_tabla( i_trdir[] ).
    LOOP AT i_trdir.
      SELECT SINGLE devclass FROM  tadir
        INTO i_listado-devclass
       WHERE pgmid    = &apos;R3TR&apos;
         AND object   = &apos;PROG&apos;
         AND obj_name = i_trdir-name
         AND delflag  = &apos;&apos;.
      IF NOT ( sy-subrc = 0 OR i_trdir-rmand IS INITIAL ). &quot; Reports raros a borrar
        CONTINUE.
      ENDIF.

      sgpi-&gt;porcentaje( texto = &apos;Procesando&apos;(pro) cantidad = sy-tabix ).
      CLEAR i_listado.
      MOVE-CORRESPONDING i_trdir TO i_listado.
      i_listado-object = &apos;PROG&apos;.
      READ TABLE i_tstc WITH KEY pgmna = i_trdir-name
           BINARY SEARCH.
      IF sy-subrc = 0.
        i_listado-tcode = i_tstc-tcode.
      ELSE.
        i_listado-tcode = &apos;SE38&apos;.
      ENDIF.

      IF i_listado-tcode IN s_tcode.
        APPEND i_listado.
      ENDIF.
    ENDLOOP.

    zcl_ap_sgpi=&gt;text( &apos;Seleccionando transacciones sin report Z&apos;(stz) ).
    LOOP AT i_tstc WHERE     (    tcode(1) = &apos;Z&apos;
                               OR tcode(1) = &apos;Y&apos; )
                         AND tcode IN s_tcode.
      READ TABLE i_listado WITH KEY tcode = i_tstc-tcode.
      IF sy-subrc = 0.
        CONTINUE.
      ENDIF.

      CLEAR i_listado.
      i_listado-object = &apos;PROG&apos;.
      i_listado-tcode  = i_tstc-tcode.
      i_listado-name   = i_tstc-pgmna.
      IF i_listado-name IS INITIAL.
        SELECT SINGLE * FROM tstcp
         WHERE tcode = i_tstc-tcode.
        IF sy-subrc = 0.
          i_listado-subc = &apos;1&apos;.
          IF tstcp-param+2(12) = &apos;START_REPORT&apos;.
            SPLIT tstcp-param AT &apos;D_SREPOVARI-REPORT=&apos;
                  INTO l_aux1 l_aux2.
            SPLIT l_aux2 AT &apos;;&apos; INTO i_listado-name l_aux1.
          ELSEIF tstcp-param+2(4) = &apos;ZBC4&apos;.
            SPLIT tstcp-param AT &apos;P_TABLA=&apos;
                  INTO l_aux1 l_aux2.
            SPLIT l_aux2 AT &apos;;&apos; INTO i_listado-aux l_aux1.
          ELSEIF tstcp-param+2(6) = &apos;ZBCTAB&apos;.
            SPLIT tstcp-param AT &apos;TABLA=&apos;
                  INTO l_aux1 l_aux2.
            SPLIT l_aux2 AT &apos;;&apos; INTO i_listado-aux l_aux1.
          ELSE.
            i_listado-name = tstcp-param+2.
          ENDIF.
        ENDIF.
      ENDIF.

      IF i_listado-name IN r_name.
        READ TABLE i_trdir WITH KEY name = i_listado-name
             BINARY SEARCH.
        IF sy-subrc = 0.
          MOVE-CORRESPONDING i_trdir TO i_listado.
        ELSE.
          SELECT SINGLE * FROM  trdir
           WHERE name  = i_listado-name
             AND name IN s_report.
          IF sy-subrc = 0.
            MOVE-CORRESPONDING trdir TO i_listado.
          ENDIF.
        ENDIF.

        IF i_listado-name(4) = &apos;AQQQ&apos;.
          i_listado-subc = &apos;Q&apos;.
        ENDIF.
        IF i_listado-subc IN s_subc.
          APPEND i_listado.
        ENDIF.
      ENDIF.
    ENDLOOP.

    zcl_ap_sgpi=&gt;text( &apos;Seleccionando programas&apos;(spr) ).
    LOOP AT i_listado.
      IF NOT i_listado-tcode IS INITIAL.
        IF i_listado-name IS INITIAL.
          SELECT SINGLE * FROM tstcp
           WHERE tcode = i_listado-tcode.
          SEARCH tstcp FOR &apos;EXTDREPORT=KE&apos;.
          IF sy-subrc = 0.
            DELETE i_listado.
            CONTINUE.
          ENDIF.
        ENDIF.

        SELECT SINGLE ttext FROM tstct
      INTO i_listado-ttext
     WHERE sprsl = sy-langu
       AND tcode = i_listado-tcode.
      ENDIF.
      SELECT SINGLE text FROM trdirt
        INTO i_listado-text
       WHERE sprsl = sy-langu
         AND name  = i_listado-name.
      SELECT SINGLE devclass FROM  tadir
        INTO i_listado-devclass
       WHERE pgmid    = &apos;R3TR&apos;
         AND object   = &apos;PROG&apos;
         AND obj_name = i_listado-name.
      IF i_listado-devclass IN s_devcla AND i_listado-devclass IN r_devclass_openf.
        IF NOT i_listado-name IS INITIAL.
          READ TABLE i_estad WITH KEY report = i_listado-name
               BINARY SEARCH.
          IF sy-subrc = 0.
            i_listado-total  = i_estad-total.
            i_listado-fult   = i_estad-fecha.
            i_listado-uuname = i_estad-account.
          ENDIF.
        ENDIF.

        IF p_numlin = &apos;X&apos;.
          IF NOT i_listado-name IS INITIAL.
            READ REPORT i_listado-name INTO i_source.
            i_listado-numlin = lines( i_source ).
          ENDIF.
        ENDIF.

        MODIFY i_listado.
      ELSE.
        DELETE i_listado.
      ENDIF.
    ENDLOOP.
  ENDIF.

  IF p_utili = &apos;X&apos;.
    LOOP AT i_listado WHERE subc = &apos;1&apos;.
      SELECT include FROM cross
        INTO cross-include
       WHERE type = &apos;R&apos;
         AND name = i_listado-name.
        IF i_listado-aux IS INITIAL.
          i_listado-aux = cross-include.
        ELSE.
          CONCATENATE i_listado-aux &apos;,&apos; cross-include
                      INTO i_listado-aux SEPARATED BY space.
        ENDIF.
        IF i_listado-total = 0.
          READ TABLE i_estad WITH KEY report = cross-include
               BINARY SEARCH.
          IF sy-subrc = 0.
            i_listado-total = i_estad-total.
          ENDIF.
        ENDIF.

      ENDSELECT.
      MODIFY i_listado.
    ENDLOOP.

    LOOP AT i_listado WHERE subc = &apos;I&apos;.
      SELECT * FROM rseuinc
       WHERE include = i_listado-name.
        IF i_listado-aux IS INITIAL.
          i_listado-aux = rseuinc-master.
        ELSE.
          CONCATENATE i_listado-aux &apos;,&apos; rseuinc-master
                      INTO i_listado-aux SEPARATED BY space.
        ENDIF.
        IF i_listado-total = 0.
          READ TABLE i_estad WITH KEY report = rseuinc-master
               BINARY SEARCH.
          IF sy-subrc = 0.
            i_listado-total = i_estad-total.
          ENDIF.
        ENDIF.
        IF i_listado-tcode IS INITIAL.
          READ TABLE i_tstc WITH KEY pgmna = rseuinc-master
               BINARY SEARCH.
          IF sy-subrc = 0.
            i_listado-tcode = i_tstc-tcode.
            SELECT SINGLE ttext FROM tstct
          INTO i_listado-ttext
         WHERE sprsl = sy-langu
           AND tcode = i_listado-tcode.
          ENDIF.
        ENDIF.
      ENDSELECT.
      MODIFY i_listado.
    ENDLOOP.
  ENDIF.

  IF p_funcio = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando funciones&apos; ).
    SELECT * FROM v_fdirt
     WHERE area           IN r_obj
       AND funcname       IN s_report
       AND funcname NOT LIKE &apos;TABLE%&apos;
       AND funcname NOT LIKE &apos;VIEW%&apos;
       AND active          = &apos;X&apos;
       AND spras           = sy-langu.
      IF v_fdirt-funcname IN r_name.
        SELECT SINGLE * FROM tadir
         WHERE pgmid     = &apos;R3TR&apos;
           AND object    = &apos;FUGR&apos;
           AND obj_name  = v_fdirt-area
           AND devclass IN s_devcla
           AND devclass IN r_devclass_openf.
        IF sy-subrc = 0.
          CLEAR i_listado.
          i_listado-object   = &apos;FUGR&apos;.  &quot; APC03112010
          i_listado-devclass = tadir-devclass.
          PERFORM get_funcion USING v_fdirt-funcname.
          IF p_utili = &apos;X&apos;.
            SELECT include FROM cross
              INTO cross-include
             WHERE type = &apos;F&apos;
               AND name = i_listado-name.
              IF i_listado-aux IS INITIAL.
                i_listado-aux = cross-include.
              ELSE.
                CONCATENATE i_listado-aux &apos;,&apos; cross-include
                            INTO i_listado-aux SEPARATED BY space.
              ENDIF.
              IF i_listado-total = 0.
                READ TABLE i_estad WITH KEY report = cross-include
                     BINARY SEARCH.
                IF sy-subrc = 0.
                  i_listado-total = i_estad-total.
                ENDIF.
              ENDIF.

            ENDSELECT.
          ENDIF.

          APPEND i_listado.
        ENDIF.
      ENDIF.
    ENDSELECT.
  ENDIF.

  IF p_clases = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando clases&apos;(scl) ).

    IF i_zbc003[] IS INITIAL.
      SELECT  devclass object obj_name FROM  tadir      &quot;#EC CI_GENBUFF
        INTO CORRESPONDING FIELDS OF TABLE i_tadir
       WHERE pgmid     = &apos;R3TR&apos;
         AND object    = &apos;CLAS&apos;
         AND obj_name IN r_obj
         AND obj_name IN s_report
         AND devclass IN s_devcla
         AND devclass IN r_devclass_openf
         AND delflag   = &apos;&apos;.
    ELSE.
      SELECT  devclass object obj_name FROM  tadir      &quot;#EC CI_GENBUFF
        INTO CORRESPONDING FIELDS OF TABLE i_tadir
         FOR ALL ENTRIES IN i_zbc003
       WHERE pgmid     = &apos;R3TR&apos;
         AND object    = &apos;CLAS&apos;
         AND obj_name  = i_zbc003-name
         AND devclass IN s_devcla
         AND devclass IN r_devclass_openf
         AND delflag   = &apos;&apos;.
    ENDIF.
    LOOP AT i_tadir INTO tadir.
      SELECT SINGLE clsname FROM seoclass
        INTO tadir-obj_name
       WHERE clsname = tadir-obj_name.
      IF sy-subrc &lt;&gt; 0.
        CONTINUE.
      ENDIF.

      CLEAR i_listado.
      i_listado-name     = tadir-obj_name.
      i_listado-object   = tadir-object.
      i_listado-subc     = &apos;C&apos;.
      i_listado-tcode    = &apos;SE24&apos;.
      i_listado-text     = stxh-tdtitle.
      i_listado-devclass = tadir-devclass.

      SELECT  descript author createdon
                    changedby changedon
        FROM vseoclass
        UP TO 1 ROWS
        INTO (i_listado-text, i_listado-cnam, i_listado-cdat,
              i_listado-unam, i_listado-udat)
       WHERE clsname = tadir-obj_name
         AND langu   = sy-langu
       ORDER BY PRIMARY KEY.
      ENDSELECT.

      CONCATENATE tadir-obj_name &apos;%&apos; INTO l_aux.
      SELECT MAX( udat ) FROM progdir
        INTO i_listado-udat
       WHERE name LIKE l_aux.

      SELECT unam FROM progdir
        INTO i_listado-unam
        UP TO 1 ROWS
       WHERE name  LIKE l_aux
         AND state    = &apos;A&apos;
         AND udat     = i_listado-udat
       ORDER BY PRIMARY KEY.
      ENDSELECT.

      APPEND i_listado.
    ENDLOOP.
  ENDIF.

  IF p_enhan = &apos;X&apos;.                                                              &quot; NOLIB
    o_enh = NEW #( ).
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando enhancement&apos;(sen) ).                            &quot; NOLIB
    SELECT  devclass object obj_name FROM  tadir        &quot;#EC CI_GENBUFF
      INTO CORRESPONDING FIELDS OF tadir
     WHERE object   IN ( &apos;ENHO&apos;, &apos;ENHS&apos; )
       AND obj_name IN r_obj                                                   &quot; NOLIB
       AND obj_name IN s_report.                                                 &quot; NOLIB
      &quot; NOLIB
      CLEAR i_listado.                                                           &quot; NOLIB
      i_listado-name   = tadir-obj_name.  &quot; NOLIB
      i_listado-object = tadir-object.
      i_listado-subc   = &apos;A&apos;.  &quot; NOLIB

      CLEAR enhincinx.
      SELECT enhinclude FROM enhincinx
        INTO enhincinx-enhinclude
        UP TO 1 ROWS
       WHERE enhname = i_listado-name
        ORDER BY PRIMARY KEY.
      ENDSELECT.
      IF NOT enhincinx-enhinclude IS INITIAL.
        SELECT SINGLE cnam cdat unam udat vern FROM trdir
          INTO CORRESPONDING FIELDS OF i_listado
         WHERE name = enhincinx-enhinclude.
      ENDIF.

      SELECT obj_name FROM enhobj                                &quot; NOLIB
        INTO (i_listado-tcode )                                &quot; NOLIB
        UP TO 1 ROWS
       WHERE enhname = tadir-obj_name                                           &quot; NOLIB
       ORDER BY PRIMARY KEY.
      ENDSELECT.
      i_listado-devclass = tadir-devclass.                                       &quot; NOLIB
      APPEND i_listado.                                                          &quot; NOLIB
    ENDSELECT.                                                                   &quot; NOLIB
    LOOP AT i_listado WHERE subc = &apos;A&apos;.
      i_listado-subc = &apos;+&apos;.

      SELECT * FROM enhincinx
        INTO TABLE i_enhincinx
       WHERE enhname = i_listado-name.

      LOOP AT i_enhincinx.                               &quot;#EC CI_NESTED
        i_listado-text = i_enhincinx-full_name.

        o_enh-&gt;get_line_position( EXPORTING iv_full_name = i_enhincinx-full_name
                                            iv_prog      = i_enhincinx-programname
                                            iv_enhname   = i_enhincinx-enhname
                                  IMPORTING ev_include   = ev_include
                                            ev_line      = ev_line ).
        i_listado-tcode  = ev_include.
        i_listado-object = &apos;PROG&apos;.

        APPEND i_listado.
      ENDLOOP.
    ENDLOOP.
  ENDIF.                                                                         &quot; NOLIB

  IF p_formul = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando formularios&apos; ).
    SELECT tdfdate tdform tdfuser tdldate tdluser tdtitle FROM stxh
      INTO CORRESPONDING FIELDS OF stxh
   WHERE tdobject  = &apos;FORM&apos;
     AND tdform   IN s_report
*     AND tdform IN r_name
     AND tdform   IN r_obj
     AND tdid      = &apos;DEF&apos;
     AND tdspras   = &apos;S&apos;.
      IF stxh-tdform IN r_name.
        CLEAR i_listado.
        i_listado-name   = stxh-tdform.
        i_listado-subc   = &apos;S&apos;.
        i_listado-tcode  = &apos;SE71&apos;.
        i_listado-text   = stxh-tdtitle.
        i_listado-cdat   = stxh-tdfdate.
        i_listado-cnam   = stxh-tdfuser.
        i_listado-udat   = stxh-tdldate.
        i_listado-unam   = stxh-tdluser.
        i_listado-object = &apos;FORM&apos;.  &quot; APC03112010

        SELECT SINGLE devclass FROM  tadir
          INTO i_listado-devclass
         WHERE pgmid    = &apos;R3TR&apos;
           AND object   = &apos;FORM&apos;
           AND obj_name = i_listado-name.

        IF p_utili = &apos;X&apos;.
          SELECT * FROM ttxfp                           &quot;#EC CI_GENBUFF
           WHERE tdform = i_listado-name.
            IF i_listado-ttext IS INITIAL.
              i_listado-ttext = ttxfp-print_name.
            ELSE.
              CONCATENATE i_listado-ttext &apos;,&apos; ttxfp-print_name
                          INTO i_listado-ttext.
            ENDIF.
          ENDSELECT.
        ENDIF.
        APPEND i_listado.
      ENDIF.
    ENDSELECT.

    SELECT * FROM  stxfadm
           WHERE formname   IN s_report
             AND formname   IN r_obj
             AND masterlang  = sy-langu
             AND devclass   IN s_devcla
             AND devclass   IN r_devclass_openf.
      IF stxfadm-formname IN r_name.
        CLEAR i_listado.
        i_listado-name   = stxfadm-formname.
        i_listado-subc   = &apos;S&apos;.
        i_listado-object = &apos;SSFO&apos;.  &quot; APC03112010
        i_listado-tcode  = &apos;SMARTFORMS&apos;.
        i_listado-cdat   = stxfadm-firstdate.
        i_listado-cnam   = stxfadm-firstuser.
        i_listado-udat   = stxfadm-lastdate.
        i_listado-unam   = stxfadm-lastuser.

        SELECT pgnam, kschl
          FROM tnapr
          WHERE nacha = &apos;1&apos;
            AND sform = @stxfadm-formname
          ORDER BY PRIMARY KEY
          INTO (@i_listado-tcode, @i_listado-ttext)
          UP TO 1 ROWS.
        ENDSELECT.

        SELECT SINGLE caption FROM  stxfadmt
          INTO i_listado-text
               WHERE langu    = sy-langu
                 AND formname = stxfadm-formname.
        APPEND i_listado.
      ENDIF.
    ENDSELECT.

  ENDIF.

  IF p_proyec = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando proyectos de ampliacion&apos;(spa) ).
    REFRESH i_list.
    SELECT * FROM modtext
     WHERE sprsl  = sy-langu
       AND name  IN s_report.
      IF modtext-name IN r_name.
        CLEAR i_list.
        i_list-name = modtext-name.
        i_list-subc = &apos;A&apos;.
        i_list-text = modtext-modtext.
        APPEND i_list.
      ENDIF.
    ENDSELECT.

    LOOP AT i_list.
      CLEAR l_ok.
      SELECT * FROM modact
       WHERE name = i_list-name.
        i_listado-devclass = modact-devclass.
        SELECT * FROM modsap
         WHERE name = modact-member
           AND typ  = &apos;E&apos;.
          i_listado       = i_list.
          i_listado-tcode = modsap-member.
          SELECT SINGLE modtext FROM  modsapt
            INTO i_listado-aux
                 WHERE sprsl = sy-langu
                   AND name  = modsap-name.
          SELECT SINGLE * FROM tfdir
           WHERE funcname = modsap-member.
          CONCATENATE tfdir-pname+3 &apos;U&apos; tfdir-include INTO
          i_listado-ttext.

          i_listado-ttext(1) = &apos;Z&apos;.
          SELECT SINGLE name FROM trdir
            INTO trdir-name
           WHERE name = i_listado-ttext.
          IF sy-subrc = 0.

            IF i_listado-ttext(2) = &apos;ZX&apos;.
              SELECT SINGLE cnam unam cdat udat FROM  trdir
                INTO (i_listado-cnam, i_listado-unam,
                      i_listado-cdat, i_listado-udat)
               WHERE name = i_listado-ttext.
              i_listado-object = &apos;PROG&apos;.
            ENDIF.

            IF i_listado-devclass IS INITIAL.
              SELECT SINGLE devclass FROM  tadir
                INTO i_listado-devclass
               WHERE pgmid    = &apos;R3TR&apos;
                 AND object   = &apos;PROG&apos;
                 AND obj_name = i_listado-ttext.
            ENDIF.

            APPEND i_listado.
            l_ok = &apos;X&apos;.
          ENDIF.
        ENDSELECT.
      ENDSELECT.
      IF l_ok IS INITIAL.
        APPEND i_list TO i_listado.
      ENDIF.
    ENDLOOP.

  ENDIF.

  IF p_badis = &apos;X&apos;.
    SELECT devclass object obj_name FROM tadir          &quot;#EC CI_GENBUFF
      INTO CORRESPONDING FIELDS OF tadir
     WHERE pgmid     = &apos;R3TR&apos;
       AND object    = &apos;SXCI&apos;
       AND obj_name IN s_report
       AND obj_name IN r_name
       AND obj_name IN r_obj
       AND devclass IN s_devcla
       AND devclass IN r_devclass_openf
       AND delflag   = &apos;&apos;.
      CLEAR i_listado.
      i_listado-name  = tadir-obj_name.
      i_listado-subc  = &apos;B&apos;.
      i_listado-tcode = &apos;SE19&apos;.

      SELECT SINGLE text FROM  sxc_attrt
        INTO i_listado-text
       WHERE imp_name = tadir-obj_name
         AND sprsl    = sy-langu.

      SELECT imp_class FROM sxc_class                   &quot;#EC CI_GENBUFF
        INTO i_listado-ttext
        UP TO 1 ROWS
       WHERE imp_name = tadir-obj_name
       ORDER BY PRIMARY KEY.
      ENDSELECT.

      SELECT SINGLE descript author createdon
                    changedby changedon
        FROM vseoclass
        INTO (i_listado-aux, i_listado-cnam, i_listado-cdat,
              i_listado-unam, i_listado-udat)
       WHERE clsname = i_listado-ttext.

      IF i_listado-ttext(1) = &apos;Z&apos;.
        CONCATENATE i_listado-ttext &apos;%&apos; INTO l_aux.
        SELECT MAX( udat ) FROM progdir
          INTO i_listado-udat
         WHERE name LIKE l_aux.

        SELECT  unam FROM progdir
          INTO i_listado-unam
          UP TO 1 ROWS
         WHERE name  LIKE l_aux
           AND state    = &apos;A&apos;
           AND udat     = i_listado-udat
         ORDER BY PRIMARY KEY.
        ENDSELECT.
      ENDIF.

      i_listado-object = &apos;CLAS&apos;.

      APPEND i_listado.
    ENDSELECT.
  ENDIF.

  IF p_userex = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando Userexits&apos;(sue) ).
    SELECT * FROM  trdir
      INTO TABLE i_trdir
     WHERE ( ( name  LIKE &apos;MV%Z%&apos; )
         OR  ( name  LIKE &apos;RV%Z%&apos; )
         OR  ( name  LIKE &apos;LV%Z%&apos; )
         OR  ( name  LIKE &apos;RPC%Z%&apos; )
         OR  ( name  LIKE &apos;VV05HF%&apos; )
         OR  ( name  LIKE &apos;LV0%CFZZ&apos; ) )
        AND name IN s_report
        AND name IN r_name
        AND subc = &apos;I&apos;
        AND unam &lt;&gt; &apos;SAP&apos;
        AND unam &lt;&gt; &apos;SAP*&apos;
        AND unam &lt;&gt; &apos;DDIC&apos;.
    LOOP AT i_trdir WHERE name IN r_name.
      CLEAR i_listado.
      MOVE-CORRESPONDING i_trdir TO i_listado.
      i_listado-object = &apos;PROG&apos;.
      SELECT SINGLE text FROM trdirt
        INTO i_listado-text
       WHERE sprsl = sy-langu
         AND name  = i_listado-name.
      SELECT SINGLE devclass FROM  tadir
        INTO i_listado-devclass
       WHERE pgmid    = &apos;R3TR&apos;
         AND object   = &apos;PROG&apos;
         AND obj_name = i_listado-name.
      APPEND i_listado.
    ENDLOOP.
  ENDIF.

  IF p_rutina = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando Rutinas&apos;(sru) ).
    SELECT * FROM  trdir
      INTO TABLE i_trdir
     WHERE name      LIKE &apos;RV%&apos;
       AND name  NOT LIKE &apos;RV%NN&apos;
       AND name  NOT LIKE &apos;RV%CC&apos;
       AND name  NOT LIKE &apos;RV%Z%&apos;
       AND name        IN s_report
       AND subc         = &apos;I&apos;
       AND unam        &lt;&gt; &apos;SAP&apos;.
    LOOP AT i_trdir WHERE name IN r_name.
      CLEAR i_listado.
      MOVE-CORRESPONDING i_trdir TO i_listado.
      i_listado-object = &apos;PROG&apos;.  &quot; APC03112010
      i_listado-tcode  = &apos;VOFM&apos;.  &quot; APC03112010
      SELECT SINGLE text FROM trdirt
        INTO i_listado-text
       WHERE sprsl = sy-langu
         AND name  = i_listado-name.
      SELECT SINGLE devclass FROM  tadir
        INTO i_listado-devclass
       WHERE pgmid    = &apos;R3TR&apos;
         AND object   = &apos;PROG&apos;
         AND obj_name = i_listado-name.
      APPEND i_listado.
    ENDLOOP.
  ENDIF.

  IF p_tablas = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando tablas&apos;(sta) ).

    IF p_vivas IS INITIAL.
      SELECT  as4date as4user tabclass tabname FROM  dd02l
        INTO CORRESPONDING FIELDS OF TABLE i_dd02l
       WHERE tabname IN r_obj
         AND tabname IN s_report
         AND as4user IN s_cnam
         AND as4user IN s_unam
         AND as4date IN s_cdat
         AND as4date IN s_udat.
    ELSE.
      SELECT as4date as4user tabclass tabname FROM  dd02l
        INTO CORRESPONDING FIELDS OF TABLE i_dd02l
        WHERE tabname IN r_name_apc
           OR (     tabname IN r_obj
                AND tabname IN s_report
                AND ( as4user  = sy-uname )
                AND ( as4date &gt;= v_fechas_vivas ) ).
    ENDIF.
    LOOP AT i_dd02l INTO dd02l.
      IF dd02l-tabname NOT IN r_name.
        CONTINUE.
      ENDIF.

      CLEAR i_listado.
      i_listado-name = dd02l-tabname.
      SELECT ddtext FROM  dd02t
        UP TO 1 ROWS
        INTO i_listado-text
             WHERE tabname    = i_listado-name
               AND ddlanguage = sy-langu
       ORDER BY PRIMARY KEY.
      ENDSELECT.

      SELECT SINGLE devclass object FROM tadir          &quot;#EC CI_GENBUFF
        INTO (i_listado-devclass, i_listado-object)
       WHERE pgmid     = &apos;R3TR&apos;
         AND object   IN ( &apos;TABL&apos;, &apos;VIEW&apos; )
         AND obj_name  = dd02l-tabname
         AND delflag   = &apos;&apos;.
      IF NOT ( i_listado-devclass IN s_devcla AND i_listado-devclass IN r_devclass_openf ).
        CONTINUE.
      ENDIF.

      CASE dd02l-tabclass.
        WHEN &apos;INTTAB&apos;.
          i_listado-subc = &apos;E&apos;.
        WHEN &apos;VIEW&apos;.
          i_listado-subc = &apos;V&apos;.
        WHEN &apos;APPEND&apos;.
          i_listado-subc = &apos;A&apos;.
        WHEN OTHERS.
          i_listado-subc = &apos;T&apos;.
          IF p_numlin = &apos;X&apos;.
            SELECT COUNT( * ) FROM (i_listado-name)
              INTO i_listado-numlin.
          ENDIF.
      ENDCASE.

      i_listado-cdat  = dd02l-as4date.
      i_listado-cnam  = dd02l-as4user.

      i_listado-tcode = &apos;SE11&apos;.

      IF p_utili = &apos;X&apos;.
        l_tabname = i_listado-name.
        CALL FUNCTION &apos;RS_TABLE_IN_PROGRAMS&apos;
          EXPORTING
            tabname  = l_tabname
          TABLES
            proglist = i_progs.
        LOOP AT i_progs.                                 &quot;#EC CI_NESTED
          IF i_listado-aux IS INITIAL.
            i_listado-aux = i_progs-master.
          ELSE.
            CONCATENATE i_listado-aux &apos;,&apos; i_progs-master
                        INTO i_listado-aux SEPARATED BY space.
          ENDIF.

          IF i_listado-total = 0.
            READ TABLE i_estad WITH KEY report = i_progs-master
                 BINARY SEARCH.
            IF sy-subrc = 0.
              i_listado-total = i_estad-total.
            ENDIF.
          ENDIF.

        ENDLOOP.
      ENDIF.

      APPEND i_listado.
    ENDLOOP.

    IF p_vivas IS INITIAL AND p_libt IS INITIAL.
      zcl_ap_sgpi=&gt;text( &apos;Seleccionando tipos&apos;(sti) ).
      SELECT * FROM  ddtypes
       WHERE typename IN r_obj
         AND typename IN s_report.
        IF ddtypes-typename IN r_name.

          SELECT SINGLE as4date as4user FROM  dd40l
            INTO CORRESPONDING FIELDS OF dd04l
           WHERE typename  = ddtypes-typename
             AND as4user  IN s_cnam
             AND as4user  IN s_unam
             AND as4user  &lt;&gt; &apos;SAP&apos;
             AND as4date  IN s_cdat
             AND as4date  IN s_udat.
          IF sy-subrc = 0.
            CLEAR i_listado.
            i_listado-name = ddtypes-typename.
            SELECT SINGLE devclass object FROM tadir    &quot;#EC CI_GENBUFF
               INTO (i_listado-devclass, i_listado-object)
              WHERE pgmid       = &apos;R3TR&apos;
                AND object   LIKE &apos;T%&apos;
                AND obj_name    = ddtypes-typename.
            IF i_listado-devclass IN s_devcla AND i_listado-devclass IN r_devclass_openf.

              i_listado-cdat  = dd40l-as4date.
              i_listado-cnam  = dd40l-as4user.
              i_listado-tcode = &apos;SE11&apos;.
              i_listado-subc  = &apos;D&apos;.

              SELECT ddtext FROM  dd40t
                INTO i_listado-text
                UP TO 1 ROWS
              WHERE typename   = i_listado-name
                AND ddlanguage = sy-langu
               ORDER BY PRIMARY KEY.
              ENDSELECT.

              APPEND i_listado.
            ENDIF.
          ENDIF.
        ENDIF.
      ENDSELECT.

      zcl_ap_sgpi=&gt;text( &apos;Seleccionando elementos de datos&apos;(sed) ).

      SELECT  as4date as4user rollname FROM  dd04l
        INTO CORRESPONDING FIELDS OF dd04l
       WHERE rollname IN s_report
         AND rollname IN r_name
         AND rollname IN r_obj
         AND as4user  IN s_cnam
         AND as4user  &lt;&gt; &apos;SAP&apos;
         AND as4user  IN s_unam
         AND as4date  IN s_cdat
         AND as4date  IN s_udat.
        IF sy-subrc = 0.
          CLEAR i_listado.
          i_listado-name = dd04l-rollname.
          SELECT SINGLE devclass object FROM tadir
             INTO (i_listado-devclass, i_listado-object)
            WHERE pgmid    = &apos;R3TR&apos;
              AND object   = &apos;DTEL&apos;
              AND obj_name = i_listado-name.
          IF i_listado-devclass IN s_devcla AND i_listado-devclass IN r_devclass_openf.

            i_listado-cdat  = dd04l-as4date.
            i_listado-cnam  = dd04l-as4user.
            i_listado-tcode = &apos;SE11&apos;.
            i_listado-subc  = &apos;D&apos;.

            SELECT ddtext FROM  dd04t
              INTO i_listado-text
              UP TO 1 ROWS
            WHERE rollname   = i_listado-name
              AND ddlanguage = sy-langu
              ORDER BY PRIMARY KEY.
            ENDSELECT.

            APPEND i_listado.
          ENDIF.
        ENDIF.
      ENDSELECT.

      zcl_ap_sgpi=&gt;text( &apos;Seleccionando dominios&apos;(sdo) ).
      SELECT  as4date as4user domname FROM  dd01l
        INTO CORRESPONDING FIELDS OF dd01l
       WHERE domname IN s_report
         AND domname IN r_obj
         AND domname IN r_name
         AND as4user IN s_cnam
         AND as4user &lt;&gt; &apos;SAP&apos;
         AND as4user IN s_unam
         AND as4date IN s_cdat
         AND as4date IN s_udat.
        IF sy-subrc = 0.
          CLEAR i_listado.
          i_listado-name = dd01l-domname.
          SELECT SINGLE devclass object FROM tadir
             INTO (i_listado-devclass, i_listado-object)
            WHERE pgmid    = &apos;R3TR&apos;
              AND object   = &apos;DOMA&apos;
              AND obj_name = i_listado-name.
          IF i_listado-devclass IN s_devcla AND i_listado-devclass IN r_devclass_openf.

            i_listado-cdat  = dd01l-as4date.
            i_listado-cnam  = dd01l-as4user.
            i_listado-tcode = &apos;SE11&apos;.
            i_listado-subc  = &apos;D&apos;.

            SELECT ddtext FROM  dd01t
              INTO i_listado-text
              UP TO 1 ROWS
            WHERE domname    = i_listado-name
              AND ddlanguage = sy-langu
             ORDER BY PRIMARY KEY.
            ENDSELECT.

            APPEND i_listado.
          ENDIF.
        ENDIF.
      ENDSELECT.
    ENDIF.
  ENDIF.

  IF p_cds = &apos;X&apos;.
    CLEAR i_listado.
    SELECT  as4date as4user ddlname FROM  ddddlsrc
      INTO (i_listado-cdat, i_listado-cnam, i_listado-name )
     WHERE ddlname IN r_obj
       AND ddlname IN s_report
       AND as4user IN s_cnam
       AND as4user IN s_unam
       AND as4date IN s_cdat
       AND as4date IN s_udat.

      SELECT SINGLE ddtext FROM ddddlsrct
        INTO i_listado-text
       WHERE ddlname = i_listado-name.

      SELECT SINGLE devclass object FROM tadir          &quot;#EC CI_GENBUFF
        INTO (i_listado-devclass, i_listado-object)
       WHERE pgmid     = &apos;R3TR&apos;
         AND object   IN (&apos;DDLS&apos;)
         AND obj_name  = i_listado-name
         AND delflag   = &apos;&apos;.
      i_listado-tcode = &apos;SE11&apos;.
      i_listado-subc  = &apos;C&apos;.
      APPEND i_listado.
    ENDSELECT.
  ENDIF.

  IF p_modife = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando modificaciones al estandar&apos;(sms) ).
    SELECT * FROM zbc003
      WHERE name   IN s_report
        AND tcode  IN s_tcode
        AND name   IN r_name
        AND estado  = &apos;M&apos;.
      CLEAR i_listado.
      MOVE-CORRESPONDING zbc003 TO i_listado.

      IF NOT i_listado-tcode IS INITIAL.
        SELECT SINGLE ttext FROM tstct
      INTO i_listado-ttext
     WHERE sprsl = sy-langu
       AND tcode = i_listado-tcode.
      ENDIF.
      SELECT SINGLE text FROM trdirt
        INTO i_listado-text
       WHERE sprsl = sy-langu
         AND name  = i_listado-name.
      SELECT SINGLE devclass object FROM  tadir
        INTO (i_listado-devclass, i_listado-object)
       WHERE pgmid    = &apos;R3TR&apos;
         AND object   = &apos;PROG&apos;
         AND obj_name = i_listado-name.
      IF sy-subrc &lt;&gt; 0.
        SELECT SINGLE devclass object FROM  tadir       &quot;#EC CI_GENBUFF
        INTO (i_listado-devclass, i_listado-object)
         WHERE pgmid    = &apos;R3TR&apos;
           AND obj_name = i_listado-name.
      ENDIF.
      IF i_listado-object IS INITIAL.                          &quot; APC03112010
        SELECT SINGLE name FROM trdir                             &quot; APC03112010
          INTO trdir-name
         WHERE name = i_listado-name.                          &quot; APC03112010
        IF sy-subrc = 0.                                       &quot; APC03112010
          i_listado-object = &apos;PROG&apos;.                           &quot; APC03112010
        ENDIF.                                                 &quot; APC03112010
      ENDIF.                                                   &quot; APC03112010

      SELECT SINGLE cnam unam cdat udat FROM  trdir
        INTO (i_listado-cnam, i_listado-unam,
              i_listado-cdat, i_listado-udat)
       WHERE name = i_listado-name.

      PERFORM icono_status USING i_listado-estado
              CHANGING i_listado-icono.

      IF i_listado-estado = &apos;B&apos;.
        zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc      = &apos;ROJO&apos;
                                       CHANGING  tabla_color = i_listado-color ).
      ELSEIF i_listado-estado = &apos;O&apos;.
        zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc      = &apos;NARANJA&apos;
                                       CHANGING  tabla_color = i_listado-color ).
      ELSEIF i_listado-estado = &apos;M&apos;.
        zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc      = &apos;AMARILLO&apos;
                                       CHANGING  tabla_color = i_listado-color ).
      ENDIF.

      i_listado-tipo = &apos;X&apos;.

      APPEND i_listado.
    ENDSELECT.
  ENDIF.

  IF p_bte = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando BTEs&apos;(sbt) ).

    SELECT * FROM tbe31
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct IN s_report
        AND funct IN r_obj.
    SELECT * FROM tbe32
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct IN s_report
        AND funct IN r_obj.

    SELECT * FROM tbe34
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct IN s_report
        AND funct IN r_obj.

    SELECT * FROM tps31
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct IN s_report
        AND funct IN r_obj.
    SELECT * FROM tps32
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct IN s_report
        AND funct IN r_obj.

    SELECT * FROM tps34
      APPENDING CORRESPONDING FIELDS OF TABLE i_tbe
      WHERE funct IN s_report
        AND funct IN r_obj.

    LOOP AT i_tbe WHERE funct IN r_name.
      CLEAR i_listado.
      SELECT * FROM v_fdirt
        UP TO 1 ROWS
       WHERE area     IN r_obj
         AND funcname  = i_tbe-funct
         AND active    = &apos;X&apos;
         AND spras     = sy-langu
       ORDER BY PRIMARY KEY.
      ENDSELECT.
      IF sy-subrc = 0.
        PERFORM get_funcion USING v_fdirt-funcname.
        i_listado-tcode = &apos;FIBF&apos;.
        i_listado-subc  = &apos;9&apos;.
        APPEND i_listado.
      ENDIF.
    ENDLOOP.
  ENDIF.

  IF p_bsp = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando BSPs&apos;(sbs) ).

    SELECT * FROM o2appl                                &quot;#EC CI_GENBUFF
      INTO TABLE i_bsp
      WHERE applname  IN s_report
        AND applname  IN r_obj
        AND applname  IN r_name
        AND author    IN s_cnam
        AND changedby IN s_unam
        AND createdon IN s_cdat
        AND changedon IN s_udat.

    LOOP AT i_bsp.
      i_listado-tcode  = &apos;BSP&apos;.
      i_listado-subc   = &apos;B&apos;.
      i_listado-object = &apos;WAPA&apos;.
      i_listado-name   = i_bsp-applname.
      i_listado-cdat   = i_bsp-createdon.
      i_listado-cnam   = i_bsp-author.
      i_listado-udat   = i_bsp-changedon.
      i_listado-unam   = i_bsp-changedby.
      i_listado-ttext  = i_bsp-applclas.

      APPEND i_listado.
    ENDLOOP.
  ENDIF.

  IF p_webd = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Seleccionando Webdynpros&apos;(swd) ).

    SELECT * FROM wdy_application                       &quot;#EC CI_GENBUFF
      INTO TABLE i_webd
      WHERE application_name IN s_report
        AND application_name IN r_obj
        AND author           IN s_cnam
        AND changedby        IN s_unam
        AND createdon        IN s_cdat
        AND changedon        IN s_udat.

    LOOP AT i_webd.
      CLEAR i_listado.
      i_listado-tcode  = &apos;WEBDYNPRO&apos;.
      i_listado-subc   = &apos;W&apos;.
      i_listado-object = &apos;WDYA&apos;.
      i_listado-name   = i_webd-application_name.
      i_listado-cdat   = i_webd-createdon.
      i_listado-cnam   = i_webd-author.
      i_listado-udat   = i_webd-changedon.
      i_listado-unam   = i_webd-changedby.

      APPEND i_listado.
    ENDLOOP.

    SELECT  devclass object obj_name FROM tadir         &quot;#EC CI_GENBUFF
      INTO CORRESPONDING FIELDS OF tadir
     WHERE pgmid       = &apos;R3TR&apos;
       AND object   LIKE &apos;WD%&apos;
       AND obj_name   IN s_report
       AND obj_name   IN r_obj
       AND devclass   IN s_devcla
       AND delflag     = &apos;&apos;.
      IF NOT line_exists( i_listado[ subc   = &apos;W&apos;
                                     object = tadir-object
                                     name   = tadir-obj_name ] ).
        CLEAR i_listado.
        MOVE-CORRESPONDING tadir TO i_listado.
        i_listado-tcode    = &apos;WEBDYNPRO&apos;.
        i_listado-subc     = &apos;W&apos;.
        i_listado-name     = tadir-obj_name.
        i_listado-devclass = tadir-devclass.
        APPEND i_listado.
      ENDIF.
    ENDSELECT.

  ENDIF.

  IF p_mime = &apos;X&apos;.
    SELECT * FROM smimloio                              &quot;#EC CI_GENBUFF
     WHERE crea_user &lt;&gt; &apos;SAP&apos;
       AND crea_time  &gt; &apos;20100101000000&apos;
       AND prop09    IN s_report.

      CLEAR i_listado.
      i_listado-tcode  = &apos;MIME&apos;.
      i_listado-subc   = &apos;M&apos;.
      i_listado-object = &apos;SMIM&apos;.
      i_listado-ttext  = smimloio-lo_class.
      i_listado-name   = smimloio-prop09.
      i_listado-text   = smimloio-loio_id.
      i_listado-cnam   = smimloio-crea_user.
      i_listado-cdat   = smimloio-crea_time(8).
      IF smimloio-chng_time IS INITIAL.
        i_listado-unam = i_listado-cnam.
        i_listado-udat = i_listado-cdat.
      ELSE.
        i_listado-unam = smimloio-chng_user.
        i_listado-udat = smimloio-chng_time.
      ENDIF.

      IF     i_listado-cnam IN s_cnam
         AND i_listado-unam IN s_unam
         AND i_listado-cdat IN s_cdat
         AND i_listado-udat IN s_udat.
        IF smimloio-prop02 = &apos;M_FOLDER&apos; AND NOT smimloio-prop08 IS INITIAL.
          SELECT SINGLE prop09 FROM smimloio
            INTO i_listado-tcode
           WHERE loio_id  = smimloio-prop08
             AND lo_class = smimloio-prop02.
        ENDIF.
        APPEND i_listado.
      ENDIF.
    ENDSELECT.
  ENDIF.

  IF p_pdf = &apos;X&apos;.
    SELECT devclass obj_name FROM tadir                 &quot;#EC CI_GENBUFF
      INTO CORRESPONDING FIELDS OF tadir
     WHERE pgmid     = &apos;R3TR&apos;
       AND object    = &apos;SFPF&apos;
       AND obj_name IN s_report
       AND obj_name IN r_name
       AND obj_name IN r_obj
       AND devclass IN s_devcla
       AND delflag   = &apos;&apos;.
      CLEAR i_listado.
      i_listado-name     = tadir-obj_name.
      i_listado-subc     = &apos;P&apos;.
      i_listado-tcode    = &apos;SFP&apos;.
      i_listado-object   = &apos;SFPF&apos;.
      i_listado-devclass = tadir-devclass.

      SELECT * FROM fpcontext
        INTO fpcontext
        UP TO 1 ROWS
       WHERE name = tadir-obj_name
       ORDER BY PRIMARY KEY.
      ENDSELECT.

      i_listado-cdat = fpcontext-firstdate.
      i_listado-cnam = fpcontext-firstuser.
      i_listado-udat = fpcontext-lastdate.
      i_listado-unam = fpcontext-lastuser.

      SELECT SINGLE text FROM  fpcontextt
        INTO i_listado-text
             WHERE name     = fpcontext-name
               AND state    = fpcontext-state
               AND language = sy-langu.

      APPEND i_listado.
    ENDSELECT.

    SELECT devclass obj_name FROM tadir                 &quot;#EC CI_GENBUFF
      INTO CORRESPONDING FIELDS OF tadir
         WHERE pgmid     = &apos;R3TR&apos;
           AND object    = &apos;SFPI&apos;
           AND obj_name IN s_report
           AND obj_name IN r_name
           AND obj_name IN r_obj
           AND devclass IN s_devcla
           AND delflag   = &apos;&apos;.
      CLEAR i_listado.
      i_listado-name     = tadir-obj_name.
      i_listado-subc     = &apos;P&apos;.
      i_listado-tcode    = &apos;SFP&apos;.
      i_listado-object   = &apos;SFPI&apos;.
      i_listado-devclass = tadir-devclass.

      SELECT firstdate firstuser lastdate lastuser FROM fpinterface
        UP TO 1 ROWS
        INTO CORRESPONDING FIELDS OF fpinterface
       WHERE name = tadir-obj_name
        ORDER BY PRIMARY KEY.
      ENDSELECT.

      i_listado-cdat = fpinterface-firstdate.
      i_listado-cnam = fpinterface-firstuser.
      i_listado-udat = fpinterface-lastdate.
      i_listado-unam = fpinterface-lastuser.

      SELECT SINGLE text FROM  fpinterfacet
        INTO i_listado-text
             WHERE name     = fpinterface-name
               AND state    = fpinterface-state
               AND language = sy-langu.

      APPEND i_listado.
    ENDSELECT.
  ENDIF.

  IF p_xslt = &apos;X&apos;.
    SELECT devclass obj_name FROM tadir                 &quot;#EC CI_GENBUFF
      INTO CORRESPONDING FIELDS OF tadir
             WHERE pgmid     = &apos;R3TR&apos;
               AND object    = &apos;XSLT&apos;
               AND obj_name IN s_report
               AND obj_name IN r_name
               AND obj_name IN r_obj
               AND devclass IN s_devcla
               AND delflag   = &apos;&apos;.
      SELECT author createdon changedby changedon FROM o2xsltdesc
        INTO CORRESPONDING FIELDS OF o2xsltdesc
        UP TO 1 ROWS
       WHERE relid = &apos;TR&apos; AND xsltdesc = tadir-obj_name
       ORDER BY PRIMARY KEY.
      ENDSELECT.
      IF sy-subrc = 0.

        CLEAR i_listado.
        i_listado-name   = tadir-obj_name.
        i_listado-subc   = &apos;X&apos;.
        i_listado-tcode  = &apos;XSLT_TOOL&apos;.
        i_listado-object = &apos;XSLT&apos;.
        i_listado-cnam   = o2xsltdesc-author.
        i_listado-cdat   = o2xsltdesc-createdon.
        i_listado-unam   = o2xsltdesc-changedby.
        i_listado-udat   = o2xsltdesc-changedon.

        APPEND i_listado.
      ENDIF.
    ENDSELECT.
  ENDIF.

  IF p_wf = &apos;X&apos;.
    SELECT mc_short stext uname aedtm FROM hrs1000      &quot;#EC CI_GENBUFF
      INTO CORRESPONDING FIELDS OF hrs1000
     WHERE otype    IN ( &apos;AC&apos;, &apos;TS&apos;, &apos;WS&apos; )
       AND uname    &lt;&gt; &apos;SAP&apos;
       AND mc_short IN s_report
       AND mc_short IN r_name
       AND mc_short IN r_obj.
      CLEAR i_listado.
      i_listado-name = hrs1000-mc_short.
      i_listado-subc = &apos;W&apos;.
      CONCATENATE hrs1000-otype hrs1000-objid INTO i_listado-tcode.
      i_listado-object = hrs1000-otype.
      i_listado-text   = hrs1000-stext.
      IF hrs1000-otype = &apos;WS&apos;.
        SELECT SINGLE created_by created_on changed_by changed_on FROM swdsheader &quot;#EC CI_GENBUFF
          INTO (i_listado-cnam, i_listado-cdat, i_listado-unam, i_listado-udat)
        WHERE wfd_id = i_listado-tcode.
      ELSE.
        i_listado-unam = hrs1000-uname.
        i_listado-cnam = hrs1000-uname.
        i_listado-udat = hrs1000-aedtm.
        i_listado-cdat = hrs1000-aedtm.
      ENDIF.
      APPEND i_listado.
    ENDSELECT.
  ENDIF.

  zcl_ap_sgpi=&gt;text( &apos;Analizando informaciÃ³n&apos;(ain) ).

  LOOP AT i_listado WHERE devclass = &apos;&apos;.
    SELECT devclass FROM  tadir                         &quot;#EC CI_GENBUFF
      INTO i_listado-devclass
      UP TO 1 ROWS
     WHERE object   = i_listado-object
       AND obj_name = i_listado-name
     ORDER BY PRIMARY KEY.
    ENDSELECT.
    MODIFY i_listado.
  ENDLOOP.

  DELETE i_listado WHERE     NOT devclass IN s_devcla
                         AND NOT devclass IN r_devclass_open.

  LOOP AT i_listado.
    SELECT SINGLE * FROM zbc003
     WHERE name  = i_listado-name
       AND tcode = i_listado-tcode.
    IF sy-subrc = 0.
      MOVE-CORRESPONDING zbc003 TO i_listado.
    ENDIF.

    PERFORM icono_status USING i_listado-estado
            CHANGING i_listado-icono.

    IF i_listado-total &gt; 0.
      zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc      = &apos;VERDE&apos;
                                     CHANGING  tabla_color = i_listado-color ).
    ELSEIF i_listado-estado = &apos;B&apos;.
      zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc      = &apos;ROJO&apos;
                                     CHANGING  tabla_color = i_listado-color ).
    ELSEIF i_listado-estado = &apos;O&apos;.
      zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc      = &apos;NARANJA&apos;
                                     CHANGING  tabla_color = i_listado-color ).
    ELSEIF i_listado-estado = &apos;M&apos;.
      zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc      = &apos;AMARILLO&apos;
                                     CHANGING  tabla_color = i_listado-color ).
    ENDIF.

    SELECT SINGLE tcode FROM zdocumentos
      INTO l_tcode
     WHERE tcode = i_listado-name.
    IF sy-subrc &lt;&gt; 0 AND i_listado-grupo &lt;&gt; &apos;&apos;.
      SELECT SINGLE tcode FROM zdocumentos
        INTO l_tcode
       WHERE tcode = i_listado-grupo.
    ENDIF.
    IF sy-subrc = 0.
      i_listado-doc = icon_word_processing.
    ENDIF.

    SELECT comentarios FROM zbc003t
      UP TO 1 ROWS
      INTO i_listado-comentarios
     WHERE name  = i_listado-name
       AND tcode = i_listado-tcode
      ORDER BY PRIMARY KEY.
    ENDSELECT.
    MODIFY i_listado.
  ENDLOOP.

  LOOP AT i_listado WHERE         udat IS INITIAL
                          AND NOT cdat IS INITIAL.
    i_listado-udat = i_listado-cdat.
    i_listado-unam = i_listado-cnam.
    MODIFY i_listado.
  ENDLOOP.

  DELETE i_listado WHERE NOT estado IN s_estado.
  DELETE i_listado WHERE NOT asignado_a IN s_asign.
  DELETE i_listado WHERE NOT procesado_por IN s_progr.

  DELETE i_listado WHERE    NOT cnam IN s_cnam
                         OR NOT cdat IN s_cdat
                         OR NOT unam IN s_unam
                         OR NOT udat IN s_udat.

  IF p_gen IS INITIAL.
    DELETE i_listado WHERE text CS &apos;(generated)&apos;.
  ENDIF.

  IF p_tmp IS INITIAL AND p_lib IS INITIAL.
    DELETE i_listado WHERE devclass = &apos;$TMP&apos;.
  ENDIF.

  IF p_vivas = &apos;X&apos;.
    DELETE i_listado WHERE NOT ( ( cnam = sy-uname OR unam = sy-uname ) ).

    DELETE i_listado WHERE NOT ( cdat &gt;= v_fechas_vivas OR udat &gt;= v_fechas_vivas ).
  ENDIF.

  IF p_lib = &apos;X&apos;.
    DELETE i_listado WHERE libreria = &apos;&apos;.
  ENDIF.

* Si un mismo objeto tiene varias transacciones, las igualamos
  LOOP AT i_listado ASSIGNING FIELD-SYMBOL(&lt;listado&gt;) WHERE object = &apos;PROG&apos; AND tcode &lt;&gt; &apos;&apos; AND tcode &lt;&gt; &apos;,&apos;.
    ASSIGN i_listado[ object = &lt;listado&gt;-object
                      name   = &lt;listado&gt;-name
                      prueba = &apos;X&apos; ] TO FIELD-SYMBOL(&lt;listado2&gt;).
    IF sy-subrc &lt;&gt; 0.
      &lt;listado&gt;-prueba = &apos;X&apos;.
    ELSE.
      &lt;listado2&gt;-tcode = |{ &lt;listado2&gt;-tcode }, { &lt;listado&gt;-tcode }|.
      DELETE i_listado.
    ENDIF.
  ENDLOOP.

  IF p_hash = &apos;X&apos; OR p_lib = &apos;X&apos; OR p_solom = &apos;X&apos; OR p_buscar &lt;&gt; &apos;&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Calculando hash&apos; ).
    LOOP AT i_listado.
      CLEAR i_listado-color.
      PERFORM get_hash.
      CLEAR i_list_excel.
      READ TABLE i_list_excel WITH KEY object = i_listado-object
                                       name   = i_listado-name.
      IF sy-subrc = 0.
        i_listado-cliente_descarga = i_list_excel-cliente_descarga.
        i_listado-fecha_descarga   = i_list_excel-fecha_descarga.
      ENDIF.
      IF i_list_excel-hash = i_listado-hash.
        i_listado-icono = icon_equal_green.
      ELSE.
        i_listado-icono = icon_incoming_object.
        i_listado-marca = &apos;X&apos;.
      ENDIF.
      MODIFY i_listado.
    ENDLOOP.
  ENDIF.

  IF p_lib = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( &apos;Comparando ficheros&apos;(cfi) ).
    PERFORM comparar_ficheros.
  ELSEIF NOT p_rfc IS INITIAL.
    LOOP AT i_listado.
      i_listado-marca = &apos;X&apos;.
      MODIFY i_listado.
    ENDLOOP.
    PERFORM comparar_ficheros.
  ENDIF.

  IF p_solom = &apos;X&apos;.
    DELETE i_listado WHERE icono = icon_equal_green.
  ENDIF.

  LOOP AT i_listado ASSIGNING &lt;listado&gt;.
    CASE &lt;listado&gt;-icono.
      WHEN icon_equal_green.
        zcl_ap_alv_grid=&gt;append_color( EXPORTING colorc      = &apos;VERDE&apos;
                                       CHANGING  tabla_color = &lt;listado&gt;-color ).
      WHEN OTHERS.
        IF NOT &lt;listado&gt;-fecha_descarga IS INITIAL.
          IF &lt;listado&gt;-fecha_descarga = sy-datum AND &lt;listado&gt;-cliente_descarga = zcl_c=&gt;cliente_tasks.
            &lt;listado&gt;-icono = icon_incoming_object. &quot; Descarga
            zcl_ap_alv_grid=&gt;append_color( EXPORTING campo       = &apos;CLIENTE_DESCARGA,FECHA_DESCARGA&apos;
                                                     colorc      = &apos;VERDE&apos;
                                           CHANGING  tabla_color = &lt;listado&gt;-color ).

          ELSEIF &lt;listado&gt;-icono = icon_incoming_object. &quot; Descarga
            IF &lt;listado&gt;-udat &gt;= &lt;listado&gt;-fecha_descarga.
              zcl_ap_alv_grid=&gt;append_color( EXPORTING campo       = &apos;UDAT,FECHA_DESCARGA&apos;
                                                       colorc      = &apos;VERDE&apos;
                                             CHANGING  tabla_color = &lt;listado&gt;-color ).
            ELSE.
              zcl_ap_alv_grid=&gt;append_color( EXPORTING campo       = &apos;UDAT,FECHA_DESCARGA&apos;
                                                       colorc      = &apos;ROJO&apos;
                                             CHANGING  tabla_color = &lt;listado&gt;-color ).
            ENDIF.
          ELSEIF &lt;listado&gt;-icono = icon_outgoing_object. &quot; Subida
            IF &lt;listado&gt;-udat &lt; &lt;listado&gt;-fecha_descarga.
              zcl_ap_alv_grid=&gt;append_color( EXPORTING campo       = &apos;UDAT,FECHA_DESCARGA&apos;
                                                       colorc      = &apos;VERDE&apos;
                                             CHANGING  tabla_color = &lt;listado&gt;-color ).
            ELSE.
              zcl_ap_alv_grid=&gt;append_color( EXPORTING campo       = &apos;UDAT,FECHA_DESCARGA&apos;
                                                       colorc      = &apos;ROJO&apos;
                                             CHANGING  tabla_color = &lt;listado&gt;-color ).
            ENDIF.
          ENDIF.
        ENDIF.
    ENDCASE.
  ENDLOOP.

* Buscamos OTS
  LOOP AT i_listado ASSIGNING &lt;listado&gt;.

    SELECT SINGLE parentcl FROM tdevc
      INTO &lt;listado&gt;-parentcl
     WHERE devclass = &lt;listado&gt;-devclass.
    IF &lt;listado&gt;-parentcl = &apos;ZDESGREF&apos;.
      CLEAR &lt;listado&gt;-parentcl.
    ENDIF.

    IF NOT &lt;listado&gt;-parentcl IS INITIAL.
      DO 4 TIMES.
        SELECT SINGLE parentcl FROM tdevc
          INTO &lt;listado&gt;-parentcl
         WHERE devclass  = &lt;listado&gt;-parentcl
           AND parentcl &lt;&gt; &apos;&apos;.
        IF sy-subrc &lt;&gt; 0.
          EXIT.
        ENDIF.
      ENDDO.
    ENDIF.

    r_object = VALUE #( ( option = &apos;EQ&apos; sign = &apos;I&apos; low = &lt;listado&gt;-object ) ).
    IF &lt;listado&gt;-object = &apos;PROG&apos;.
      APPEND VALUE #( option = &apos;EQ&apos; sign = &apos;I&apos; low = &apos;REPS&apos; ) TO r_object.
    ENDIF.
    IF &lt;listado&gt;-object = &apos;CLAS&apos;.
      DATA(aux1) = |{ &lt;listado&gt;-name(30) }%|.
      SELECT e071~trkorr e070~strkorr FROM e071 JOIN e070 ON e071~trkorr = e070~trkorr
        INTO CORRESPONDING FIELDS OF &lt;listado&gt;
        UP TO 1 ROWS
       WHERE object     IN ( &apos;CLAS&apos;, &apos;METH&apos;, &apos;CLSD&apos;, &apos;CPRI&apos;, &apos;CPRO&apos;, &apos;CPUB&apos; )
         AND obj_name LIKE aux1
         AND trstatus    = &apos;D&apos; &quot; Pendiente de liberar
       ORDER BY e070~trkorr DESCENDING.
      ENDSELECT.
    ELSE.
      SELECT e071~trkorr e070~strkorr FROM e071 JOIN e070 ON e071~trkorr = e070~trkorr
        INTO CORRESPONDING FIELDS OF &lt;listado&gt;
        UP TO 1 ROWS
       WHERE object   IN r_object
         AND obj_name  = &lt;listado&gt;-name
         AND trstatus  = &apos;D&apos; &quot; Pendiente de liberar
       ORDER BY e070~trkorr DESCENDING.
      ENDSELECT.
    ENDIF.
    IF NOT &lt;listado&gt;-strkorr IS INITIAL.
      SELECT SINGLE as4text FROM  e07t
        INTO &lt;listado&gt;-as4text
      WHERE trkorr = &lt;listado&gt;-strkorr.
    ENDIF.
  ENDLOOP.

  i_list_orig[] = i_listado[].
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  icono_status
*&amp;---------------------------------------------------------------------*
FORM icono_status USING    pe_estado
                  CHANGING ps_icono.

  CASE pe_estado.
    WHEN &apos;B&apos;.  &quot; Borrar
      ps_icono = icon_delete.
    WHEN &apos;C&apos;.  &quot; Critico
      ps_icono = icon_message_warning_small.
    WHEN &apos;O&apos;.  &quot; Obsoleto
      ps_icono = icon_bw_simulate_cancel.
    WHEN &apos;?&apos;.  &quot; Duda
      ps_icono = icon_message_question_small.
    WHEN &apos;M&apos;.
      ps_icono = icon_message_critical.
    WHEN &apos;A&apos;.
      ps_icono = icon_okay.
    WHEN &apos;N&apos;.
      ps_icono = icon_interval_include.
    WHEN &apos;Q&apos;.
      ps_icono = icon_list.
    WHEN &apos;R&apos;.
      ps_icono = icon_biw_report.
  ENDCASE.
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  editar_nota
*&amp;---------------------------------------------------------------------*
FORM editar_nota USING pe_name
                       pe_tcode.

  DATA: i_zbc003t LIKE zbc003t OCCURS 0 WITH HEADER LINE,
        i_lineas  LIKE zbc003t-comentarios OCCURS 0 WITH HEADER LINE,
        l_titulo  TYPE c LENGTH 80.

  SELECT comentarios FROM zbc003t
    INTO CORRESPONDING FIELDS OF TABLE i_zbc003t
   WHERE name  = pe_name
     AND tcode = pe_tcode.

  LOOP AT i_zbc003t.
    i_lineas = i_zbc003t-comentarios.
    APPEND i_lineas.
  ENDLOOP.

  CONCATENATE &apos;Notas report&apos;(nre) pe_name pe_tcode
              INTO l_titulo SEPARATED BY space.
  CALL FUNCTION &apos;TERM_CONTROL_EDIT&apos;
    EXPORTING
      titel          = l_titulo
      langu          = sy-langu
    TABLES
      textlines      = i_lineas
    EXCEPTIONS
      user_cancelled = 1
      OTHERS         = 2.
  IF sy-subrc = 0.
    DELETE FROM zbc003t
     WHERE name  = pe_name
       AND tcode = pe_tcode.
    LOOP AT i_lineas.
      CLEAR zbc003t.
      zbc003t-name        = pe_name.
      zbc003t-tcode       = pe_tcode.
      zbc003t-linea       = sy-tabix.
      zbc003t-comentarios = i_lineas.
      MODIFY zbc003t.
    ENDLOOP.
  ENDIF.
*  endif.
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  descargar_slnk
*&amp;---------------------------------------------------------------------*
FORM descargar_slnk USING pe_mail.
  DATA: v_dif     TYPE c LENGTH 50,
        l_no      TYPE c LENGTH 1,
        l_string  TYPE string,
        l_xstring TYPE xstring,
        l_aux     TYPE c LENGTH 40,
        l_nombre  TYPE c LENGTH 80,
        l_smartf  TYPE tdsfname.
  DATA: _objname TYPE string,
        xml      TYPE string.
  DATA deffilename  TYPE string.
  DATA izip         TYPE REF TO cl_abap_zip.
  DATA errorflag    TYPE flag.
  DATA deffilename3 TYPE string.
  DATA i_tabla      TYPE TABLE OF text255.
  DATA: l_version TYPE string,
        zbc003v   TYPE zbc003v.
  DATA deffilename2 TYPE string.
  DATA i_codigo     TYPE tttext255.
  DATA l_comando    TYPE string.
  DATA zip_file     TYPE xstring.
  DATA binary_tab   TYPE STANDARD TABLE OF x255.
  DATA i_texto_mail LIKE solisti1 OCCURS 0 WITH HEADER LINE.
  DATA i_ficheros   LIKE tnotetem OCCURS 0 WITH HEADER LINE.

  CHECK i_listado-object &lt;&gt; &apos;&apos;.
  CHECK i_listado-name &lt;&gt; &apos;&apos;.

  CLEAR v_dif.
  IF sy-ucomm(4) = &apos;COMP&apos;.
    CONCATENATE &apos;___DIF_&apos; zcl_c=&gt;empresa INTO v_dif.
  ELSEIF pe_mail = &apos;B&apos;.
    IF sy-ucomm = &apos;MACHACAR&apos;.
      CONCATENATE &apos;__DESCARGA_&apos; zcl_c=&gt;empresa &apos;_&apos; sy-datum &apos;_&apos; sy-uzeit INTO v_dif.
    ELSE.
      IF p_lib = &apos;X&apos;.
        CONCATENATE &apos;__BACKUP_&apos; zcl_c=&gt;empresa &apos;_&apos; sy-datum &apos;_&apos; sy-uzeit INTO v_dif.
      ELSE.
        MESSAGE &apos;¿?&apos; TYPE &apos;E&apos;.
        DATA(l_versiones) = &apos;X&apos;.
        CONCATENATE &apos;_&apos; sy-datum &apos;_&apos; sy-uzeit INTO v_dif.
      ENDIF.
    ENDIF.
  ENDIF.

  CASE i_listado-object.
    WHEN &apos;PROG&apos;.
      IF i_listado-subc = &apos;P&apos;.
        _objname = i_listado-ttext.
        CONCATENATE i_listado-ttext &apos;_&apos; i_listado-text INTO i_listado-text.
      ELSEIF i_listado-subc = &apos;A&apos; OR i_listado-subc = &apos;+&apos;.
        IF i_listado-ttext(1) = &apos;Z&apos;.
          _objname = i_listado-ttext.
        ELSE.
          _objname = i_listado-tcode.
        ENDIF.
      ELSE.
        _objname = i_listado-name.
      ENDIF.
    WHEN &apos;CLAS&apos;.
      IF i_listado-subc = &apos;B&apos;.                          &quot; APC03112010
        _objname = i_listado-ttext.
      ELSE.
        _objname = i_listado-name.
      ENDIF.
    WHEN &apos;TABL&apos; OR &apos;VIEW&apos; OR
         &apos;TTYP&apos; OR &apos;DOMA&apos; OR &apos;DTEL&apos; OR
         &apos;SSFO&apos; OR &apos;FORM&apos; OR
         &apos;WAPA&apos; OR &apos;WDYA&apos; OR &apos;WDYN&apos; OR &apos;WDCA&apos; OR &apos;WDCC&apos; OR
         &apos;ENHO&apos; OR &apos;ENHS&apos; OR
         &apos;SFPF&apos; OR &apos;SFPI&apos; OR
         &apos;XSLT&apos; OR &apos;DDLS&apos;.

      _objname = i_listado-name.
    WHEN &apos;FUGR&apos;.
      IF sy-ucomm = &apos;COMPARAR&apos; OR sy-ucomm = &apos;COMP_ONL&apos;.
        _objname = i_listado-name.
      ELSE.
        _objname = i_listado-ttext.
      ENDIF.
    WHEN &apos;SMIM&apos;.
      _objname = i_listado-text.
    WHEN &apos;SHLP&apos;.
      EXIT.
  ENDCASE.

  IF i_listado-object &lt;&gt; &apos;FORM&apos; AND i_listado-object &lt;&gt; &apos;SFPF&apos; AND i_listado-object &lt;&gt; &apos;DDLS&apos;.
    CLEAR l_no.
    IF i_listado-object = &apos;FUGR&apos;.
      IF pe_mail IS INITIAL.
        IF line_exists( i_grupof[ table_line = _objname ] ).
          l_no = &apos;X&apos;.
        ENDIF.
      ENDIF.
    ENDIF.
    IF l_no IS INITIAL.
      xml = zcl_ap_dev=&gt;get_saplink_xml( object = i_listado-object
                                         nombre = _objname ).
      IF xml IS INITIAL.
        MESSAGE s398(00) WITH &apos;Install plugin for object type:&apos;(ipo) i_listado-object _objname &apos;&apos;.
      ENDIF.
    ENDIF.
  ENDIF.

  l_string = i_listado-text.
  zcl_ap_string=&gt;limpiar_nombre_fichero( CHANGING string = l_string ).
  i_listado-text = l_string.

  IF pe_mail = &apos;X&apos; OR p_ftp = &apos;X&apos;.
    IF p_lib = &apos;X&apos;.
*      CONCATENATE i_listado-object &apos;_&apos; _objname
      CONCATENATE v_directorio &apos;\&apos; i_listado-object &apos;\&apos;
               v_dif
               &apos;.slnk&apos; INTO deffilename.
    ELSE.
      CONCATENATE i_listado-object &apos;_&apos; _objname &apos;_&apos;
                 i_listado-text
                 v_dif
                 &apos;.slnk&apos; INTO deffilename.
    ENDIF.
    IF p_zip = &apos;X&apos;.
      izip = NEW #( ).
      l_xstring = zcl_ap_string=&gt;string2xstring( xml ).
      izip-&gt;add( name    = deffilename
                 content = l_xstring ).
    ENDIF.
  ENDIF.

  DATA(l_object) = i_listado-object.
  DATA(l_objname) = _objname.

  IF i_listado-parentcl IS INITIAL.
    DATA(l_devclass) = i_listado-devclass.
  ELSE.
    l_devclass = i_listado-parentcl.
  ENDIF.
  REPLACE ALL OCCURRENCES OF &apos;/&apos; IN l_object WITH &apos;_&apos;.
  REPLACE ALL OCCURRENCES OF &apos;/&apos; IN l_objname WITH &apos;_&apos;.
  REPLACE ALL OCCURRENCES OF &apos;/&apos; IN i_listado-text WITH &apos;_&apos;.
  REPLACE ALL OCCURRENCES OF &apos;/&apos; IN l_devclass WITH &apos;_&apos;.
  REPLACE ALL OCCURRENCES OF &apos;\&apos; IN l_object WITH &apos;_&apos;.
  REPLACE ALL OCCURRENCES OF &apos;\&apos; IN l_objname WITH &apos;_&apos;.
  REPLACE ALL OCCURRENCES OF &apos;\&apos; IN i_listado-text WITH &apos;_&apos;.
  REPLACE ALL OCCURRENCES OF &apos;\&apos; IN l_devclass WITH &apos;_&apos;.

  IF p_lib IS INITIAL AND i_listado-object &lt;&gt; &apos;FUGR&apos;.
    IF l_versiones = &apos;X&apos;.
      CONCATENATE v_directorio &apos;\VERSIONES\&apos;
                 l_object &apos;_&apos; l_objname &apos;_&apos;
                 i_listado-text
                 v_dif
                 &apos;.slnk&apos; INTO deffilename.
    ELSE.
      CONCATENATE v_directorio
                 l_object &apos;_&apos; l_objname &apos;_&apos;
                 i_listado-text
                 v_dif
                 &apos;.slnk&apos; INTO deffilename.

    ENDIF.
  ELSE.
    CONCATENATE v_directorio &apos;\&apos; i_listado-object &apos;\&apos; l_objname
*               l_object &apos;_&apos; l_objname
           v_dif
           &apos;.slnk&apos; INTO deffilename.
  ENDIF.
  l_aux = deffilename.
  IF l_aux(2) &lt;&gt; &apos;\\&apos;.
    REPLACE &apos;\\&apos; WITH &apos;\&apos; INTO deffilename.
  ENDIF.
  CLEAR errorflag.

  IF p_onedr IS INITIAL.
    REPLACE ALL OCCURRENCES OF &apos;/&apos; IN deffilename WITH &apos;_&apos;.
  ENDIF.

  IF pe_mail &lt;&gt; &apos;V&apos;.
    IF pe_mail = &apos;B&apos;.
      IF p_onedr IS INITIAL.
        REPLACE &apos;\LIB&apos; WITH &apos;\LIB_BACKUP&apos; INTO deffilename.
      ELSE.
        REPLACE &apos;/LIB&apos; WITH &apos;/LIB_BACKUP&apos; INTO deffilename.
      ENDIF.
    ENDIF.
    IF i_listado-object = &apos;SFPF&apos;.
      PERFORM descargar_sfp USING deffilename _objname.
    ELSEIF i_listado-object = &apos;DDLS&apos;.
    ELSEIF i_listado-object &lt;&gt; &apos;FORM&apos;.
      CLEAR l_no.
      IF i_listado-object = &apos;FUGR&apos;.
        IF pe_mail IS INITIAL.
          IF line_exists( i_grupof[ table_line = _objname ] ).
            l_no = &apos;X&apos;.
          ELSE.
            APPEND _objname TO i_grupof.
          ENDIF.
        ENDIF.
      ENDIF.
      IF l_no IS INITIAL AND sy-ucomm(4) &lt;&gt; &apos;COMP&apos;.
        PERFORM putonmachine USING deffilename xml.
        IF errorflag IS NOT INITIAL.
          MESSAGE s398(00) WITH &apos;Error descargando&apos;(ede) deffilename &apos;&apos; &apos;&apos;.
          EXIT.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDIF.

  l_nombre = _objname.

  IF i_listado-object = &apos;SSFO&apos;.
    CONCATENATE l_nombre &apos;&apos; INTO l_smartf.
    CALL FUNCTION &apos;FB_DOWNLOAD_FORM&apos;
      EXPORTING
        i_formname           = l_smartf
        i_formtype           = &apos; &apos;
        i_with_dialog        = &apos;&apos;
*     IMPORTING
*       O_FORMNAME           =
      EXCEPTIONS
        no_name              = 1
        no_form              = 2
        no_access_permission = 3
        illegal_language     = 4
        illegal_formtype     = 5
        OTHERS               = 6.
    IF sy-subrc &lt;&gt; 0.
      MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
              WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    ENDIF.

  ELSEIF i_listado-object = &apos;FORM&apos;.
    CONCATENATE v_directorio &apos;\&apos; l_devclass &apos;\&apos;
               i_listado-object &apos;_&apos;
               i_listado-name
               &apos;.txt&apos; INTO deffilename3.
    IF deffilename3(2) &lt;&gt; &apos;\\&apos;.
      REPLACE &apos;\\&apos; WITH &apos;\&apos; INTO deffilename3.
    ENDIF.
    IF strlen( deffilename3 ) &gt; 72.
      deffilename3 = |{ i_listado-object }_{ i_listado-name }_.txt|.
    ENDIF.
    SUBMIT rstxscrp WITH obj_name = _objname             &quot;#EC CI_SUBMIT
           WITH dataset = deffilename3
           EXPORTING LIST TO MEMORY
           AND RETURN.
  ELSEIF i_listado-object = &apos;FUGR&apos;.
    i_tabla = zcl_ap_dev=&gt;get_objeto_como_texto( tipo   = i_listado-object
                                                 nombre = i_listado-name ).
    _objname = i_listado-name.
  ELSEIF i_listado-object = &apos;SFPF&apos;.
  ELSE.
    i_tabla = zcl_ap_dev=&gt;get_objeto_como_texto( tipo   = i_listado-object
                                                 nombre = l_nombre ).
  ENDIF.

  IF NOT i_tabla[] IS INITIAL.
    DATA l_extension TYPE string.
    l_extension = &apos;.txt&apos;.
    IF i_listado-object = &apos;PROG&apos; OR i_listado-object = &apos;CLAS&apos; OR i_listado-object = &apos;FUGR&apos;.
      l_extension = &apos;.abap&apos;.
    ENDIF.

    IF pe_mail = &apos;V&apos;.
      l_version = zcl_ap_string=&gt;tabla2string( tabla = i_tabla[] ).

      CLEAR zbc003v.
      MOVE-CORRESPONDING i_listado TO zbc003v.
      zbc003v-fecha  = sy-datum.
      zbc003v-hora   = sy-uzeit.
      zbc003v-string = l_version.
      MODIFY zbc003v FROM zbc003v.

    ELSE.
      IF p_lib IS INITIAL.
        IF l_versiones IS INITIAL.
          CONCATENATE v_directorio &apos;\&apos; l_devclass &apos;\&apos; i_listado-object &apos;\&apos;
                     i_listado-object &apos;_&apos;
                     _objname &apos;_&apos;
                     i_listado-text
                     v_dif
                     l_extension INTO deffilename2.
        ELSE.
          CONCATENATE v_directorio &apos;\VERSIONES\&apos;
                     i_listado-object &apos;_&apos;
                     _objname &apos;_&apos;
                     i_listado-text
                     v_dif
                     l_extension INTO deffilename2.
        ENDIF.
      ELSE.
        CONCATENATE v_directorio &apos;\&apos; i_listado-object &apos;\&apos;
*                   i_listado-object &apos;_&apos;
                   _objname
                   v_dif
                   l_extension INTO deffilename2.

        CONCATENATE v_directorio &apos;\&apos; i_listado-object &apos;\&apos;
*                   i_listado-object &apos;_&apos;
                   _objname
                   l_extension INTO deffilename3.
      ENDIF.

      IF pe_mail = &apos;B&apos;.
        REPLACE &apos;\LIB&apos; WITH &apos;\LIB_BACKUP&apos; INTO deffilename2.
        REPLACE &apos;\LIB&apos; WITH &apos;\LIB_BACKUP&apos; INTO deffilename3.
      ENDIF.

      IF o_ms IS INITIAL.
        REPLACE ALL OCCURRENCES OF &apos;/&apos; IN deffilename2 WITH &apos;_&apos;.
        REPLACE ALL OCCURRENCES OF &apos;/&apos; IN deffilename3 WITH &apos;_&apos;.
        IF p_rfc IS INITIAL.
          zcl_ap_ficheros=&gt;grabar( EXPORTING fichero       = deffilename2
                                             mostrar_error = &apos;I&apos;
                                   CHANGING  tabla         = i_tabla ).
        ENDIF.
      ELSEIF sy-ucomm(4) &lt;&gt; &apos;COMP&apos;.
        l_string = zcl_ap_string=&gt;tabla2string( i_tabla ).
        IF NOT l_string IS INITIAL.
          REPLACE ALL OCCURRENCES OF &apos;\&apos; IN deffilename2 WITH &apos;/&apos;.
          DATA(l_stringx) = zcl_ap_string=&gt;string2xstring( l_string ).
          REPLACE ALL OCCURRENCES OF ` ` IN deffilename2 WITH &apos;_&apos;.
          o_ms-&gt;grabar_fichero( EXPORTING nombre       = deffilename2
                                          contenidox   = l_stringx
                                          content_type = &apos;text/plain&apos;
                                IMPORTING message      = DATA(l_msg) ).
          IF NOT l_msg IS INITIAL. MESSAGE l_msg TYPE &apos;E&apos;. ENDIF.
        ENDIF.
      ENDIF.

      IF sy-ucomm = &apos;COMPARAR&apos;.
        IF p_onedr = &apos;X&apos;.
          v_text1 = zcl_ap_string=&gt;tabla2string( i_tabla ).
*          zcl_ap_ficheros=&gt;leer_xstring( EXPORTING fichero = deffilename3 get_string = &apos;X&apos;
          REPLACE ALL OCCURRENCES OF &apos;\&apos; IN deffilename3 WITH &apos;/&apos;.
          o_ms-&gt;get_contenido_fichero( EXPORTING nombre          = deffilename3
                                                 popup_respuesta = &apos;&apos;
                                       IMPORTING message         = l_msg
                                                 respuesta       = v_text2
                                                 contenido       = DATA(l_xstringo) ).
          IF NOT l_msg IS INITIAL.
            MESSAGE l_msg TYPE &apos;I&apos;.
            RETURN.
          ENDIF.
          IF p_dirto IS INITIAL.
            DATA(l_ruta_local) = zcl_ap_ficheros=&gt;get_directorio_temporal( ).
          ELSE.
            l_ruta_local = p_dirto.
          ENDIF.
          deffilename2 = zcl_ap_ficheros=&gt;concat_ruta( directorio = l_ruta_local fichero = &apos;CLIENTE.TXT&apos; ).
          deffilename3 = zcl_ap_ficheros=&gt;concat_ruta( directorio = l_ruta_local fichero = &apos;LIB.TXT&apos; ).
          zcl_ap_ficheros=&gt;grabar_xstring( fichero = deffilename2 xstring = zcl_ap_string=&gt;string2xstring( v_text1 ) ).
*          zcl_ap_ficheros=&gt;grabar_xstring( fichero = deffilename3 xstring = zcl_ap_string=&gt;string2xstring( v_text2 ) ).
          zcl_ap_ficheros=&gt;grabar_xstring( fichero = deffilename3 xstring = l_xstringo ).

        ELSE.
          IF NOT p_rfc IS INITIAL.
            &quot; TODO: variable is assigned but never used (ABAP cleaner)
            DATA(l_temp) = zcl_ap_ficheros=&gt;get_directorio_temporal( ).
            deffilename2 = |{ i_listado-object }_{ i_listado-name }.TXT|.
            deffilename3 = |{ i_listado-object }_{ i_listado-name }_{ p_rfc }.TXT|.
            REPLACE ALL OCCURRENCES OF &apos;/&apos; IN deffilename2 WITH &apos;_&apos;.
            REPLACE ALL OCCURRENCES OF &apos;/&apos; IN deffilename3 WITH &apos;_&apos;.

            CALL FUNCTION &apos;Z_RFC_GET_CODIGO&apos;
              EXPORTING
                object   = i_listado-object
                obj_name = i_listado-name
              IMPORTING
                i_codigo = i_codigo.
            i_tabla[] = i_codigo.

            zcl_ap_ficheros=&gt;grabar( EXPORTING fichero       = deffilename2
                                               mostrar_error = &apos;I&apos;
                                     CHANGING  tabla         = i_tabla ).

            CLEAR i_codigo.
            CALL FUNCTION &apos;Z_RFC_GET_CODIGO&apos;
              DESTINATION p_rfc
              EXPORTING
                object                = i_listado-object
                obj_name              = i_listado-name
              IMPORTING
                i_codigo              = i_codigo
              EXCEPTIONS
                system_failure        = 1
                communication_failure = 2
                OTHERS                = 3.

            IF sy-subrc &lt;&gt; 0.
              CASE sy-subrc.
                WHEN 1.
                  MESSAGE &apos;System failure during RFC call&apos; TYPE &apos;E&apos;.
                WHEN 2.
                  MESSAGE &apos;Communication failure during RFC call&apos; TYPE &apos;E&apos;.
                WHEN OTHERS.
                  MESSAGE &apos;Unknown error during RFC call&apos; TYPE &apos;E&apos;.
              ENDCASE.
            ENDIF.

            zcl_ap_ficheros=&gt;grabar( EXPORTING fichero       = deffilename3
                                               mostrar_error = &apos;I&apos;
                                     CHANGING  tabla         = i_codigo ).
          ENDIF.
          CONCATENATE &apos;&quot;&apos; deffilename2 &apos;&quot;&apos; INTO deffilename2.
          CONCATENATE &apos;&quot;&apos; deffilename3 &apos;&quot;&apos; INTO deffilename3.
        ENDIF.

        CONCATENATE deffilename2 deffilename3
                    INTO l_comando SEPARATED BY space.

        cl_gui_frontend_services=&gt;execute( EXPORTING  application            = v_ruta_comparador
                                                      parameter              = l_comando
                                           EXCEPTIONS cntl_error             = 1
                                                      error_no_gui           = 2
                                                      bad_parameter          = 3
                                                      file_not_found         = 4
                                                      path_not_found         = 5
                                                      file_extension_unknown = 6
                                                      error_execute_failed   = 7
                                                      synchronous_failed     = 8
                                                      not_supported_by_gui   = 9 ).
        IF sy-subrc &lt;&gt; 0.
          MESSAGE &apos;Error lanzando comparador&apos; TYPE &apos;I&apos;.
        ENDIF.
      ELSEIF sy-ucomm = &apos;COMP_ONL&apos;.
        v_text1 = zcl_ap_string=&gt;tabla2string( i_tabla ).
        zcl_ap_ficheros=&gt;leer_xstring( EXPORTING fichero    = deffilename3
                                                 get_string = &apos;X&apos;
                                       IMPORTING string     = v_text2 ).

        DATA(v_url1) = &apos;https://sap4-my.sharepoint.com/:t:/p/andres/EVad4mu4Cd5PidxmVnjy8U8BZ_--2JfOLBhTmGnVP9YwbA?e=kS34KU?&amp;download=1&apos;.
        DATA(v_url2) = &apos;https://sap4-my.sharepoint.com/:t:/p/andres/EZDfCwIhjrBBph9h8h9TBWIBuOVwU870gwm4Taan_dX5GA?e=XaIFnf?&amp;download=1&apos;.
*        DATA(v_url1) = &apos;https://sap4-my.sharepoint.com/personal/andres_sap4_com/Documents/Compartir/temp/t1.txt?ga=1&apos;.
*        DATA(v_url2) = &apos;https://sap4-my.sharepoint.com/personal/andres_sap4_com/Documents/Compartir/temp/t2.txt?ga=2&apos;.
*        DATA(l_url) = |https://extendsclass.com/text-compare.html?url1=data:text/plain;charset=UTF-8;page=21,{ v_text1 }&amp;url2=data:text/plain;charset=UTF-8;page=21,{ v_text2 }|.
        DATA(l_url) = |https://extendsclass.com/text-compare.html?url1={ v_url1 }&amp;url2={ v_url2 }|.
*        DATA(l_url) = |https://www.diffnow.com/compare-urls?url1={ v_url1 }&amp;url2={ v_url2 }|.
        zcl_ap_gos=&gt;visualizar_fichero_st( l_url ).
      ENDIF.
    ENDIF.
  ENDIF.

  IF pe_mail &lt;&gt; &apos;V&apos;.
    IF pe_mail = &apos;X&apos; OR p_ftp = &apos;X&apos;.
      IF p_zip = &apos;X&apos;.
        CONCATENATE _objname &apos;_&apos;
                   i_listado-text
                   &apos;.txt&apos; INTO deffilename2.
        l_string  = zcl_ap_string=&gt;tabla2string( i_tabla ).
        l_xstring = zcl_ap_string=&gt;string2xstring( l_string ).

        CALL FUNCTION &apos;SCMS_XSTRING_TO_BINARY&apos;
          EXPORTING
            buffer     = zip_file
          TABLES
            binary_tab = binary_tab.

        CONCATENATE v_directorio &apos;\&apos;
                   _objname &apos;_&apos;
                   i_listado-text
                   v_dif
                   &apos;.zip&apos; INTO deffilename2.

        zcl_ap_ficheros=&gt;grabar( EXPORTING fichero       = deffilename2
                                           tipo          = &apos;BIN&apos;
                                           mostrar_error = &apos;I&apos;
                                 CHANGING  tabla         = binary_tab ).
      ENDIF.

      REFRESH i_texto_mail.
      LOOP AT i_tabla INTO i_texto_mail.
        APPEND i_texto_mail.
      ENDLOOP.

      IF v_no_se_adjunta_slnk IS INITIAL.
        IF p_zip IS INITIAL.
          i_ficheros-template = deffilename.
        ELSE.
          i_ficheros-template = deffilename2.
        ENDIF.
        APPEND i_ficheros.
        APPEND i_ficheros-template TO i_ficheros_ftp.

      ENDIF.

      IF pe_mail = &apos;X&apos;.
        CONCATENATE &apos;(&apos; zcl_c=&gt;empresa &apos;)&apos; i_listado-name &apos;-&apos;
                   i_listado-text INTO deffilename2.

        IF v_ans = &apos;J&apos;.
          DELETE i_ficheros WHERE template = &apos;&apos;.
          IF p_outlo IS INITIAL.
*            CALL FUNCTION &apos;Z_ENVIO_MAIL&apos;
*              EXPORTING
*                subject    = deffilename2
*                direccion  = v_emailaddr
*                urgente    = &apos;X&apos;
*                html       = &apos;&apos;
*              TABLES
*                texto      = i_texto_mail
*                t_ficheros = i_ficheros.
          ELSE.
            PERFORM outlook TABLES i_ficheros i_texto_mail
                    USING v_emailaddr deffilename2.
          ENDIF.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDIF.

  IF pe_mail = &apos;&apos;.
    PERFORM get_hash.
    i_listado-descargado = &apos;X&apos;.
  ENDIF.
ENDFORM.

*\--------------------------------------------------------------------/


*/------------------------putOnMachine--------------------------------\
FORM putonmachine USING fullpath  TYPE string
                        xmlstring TYPE string.

  IF xmlstring IS INITIAL.
    RETURN.
  ENDIF.

  IF NOT o_ms IS INITIAL.
    DATA(l_xstring) = zcl_ap_string=&gt;string2xstring( xmlstring ).
    IF NOT l_xstring IS INITIAL.
*        o_ms-&gt;grabar_fichero( EXPORTING nombre = fullpath contenidox = l_xstring content_type = &apos;text/plain&apos;
      REPLACE ALL OCCURRENCES OF &apos;\&apos; IN fullpath WITH &apos;/&apos;.
      REPLACE ALL OCCURRENCES OF &apos;GD_LIB_LIB&apos; IN fullpath WITH &apos;GD_LIB/LIB&apos;.
      CONDENSE fullpath.
      REPLACE ALL OCCURRENCES OF ` ` IN fullpath WITH &apos;_&apos;.
      &quot; TODO: variable is assigned but never used (ABAP cleaner)
      DATA(l_stringx) = zcl_ap_string=&gt;string2xstring( xmlstring ).
      o_ms-&gt;grabar_fichero( EXPORTING nombre       = fullpath
                                      contenidox   = l_xstring
                                      content_type = &apos;text/plain&apos;
                            IMPORTING message      = DATA(l_msg) ).
      IF NOT l_msg IS INITIAL. MESSAGE l_msg TYPE &apos;E&apos;. ENDIF.
    ENDIF.
  ELSE.
    TRY.
        TRY.
            zcl_ap_ficheros=&gt;grabar_xstring( fichero       = fullpath
                                             local         = &apos;X&apos;
                                             mostrar_error = &apos;I&apos;
                                             string        = xmlstring ).
            CLEAR v_no_se_adjunta_slnk.
          CATCH cx_root.
            v_no_se_adjunta_slnk = &apos;X&apos;.
        ENDTRY.
      CATCH cx_root.
        v_no_se_adjunta_slnk = &apos;X&apos;.
    ENDTRY.
  ENDIF.
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  outlook
*&amp;---------------------------------------------------------------------*

FORM outlook
  TABLES email_attachments STRUCTURE tnotetem
         email_body        STRUCTURE solisti1
  USING  email_address
         subject.

  DATA: g_translate    TYPE c LENGTH 2,
        t_vbs          LIKE STANDARD TABLE OF soli WITH HEADER LINE,
        g_file         TYPE c LENGTH 120,
        g_last         TYPE c LENGTH 1,
        g_vbs_filename LIKE rlgrap-filename,
        commandline    TYPE string.
  DATA l_string TYPE string.

*- Prepare a code to translate a quote into a hex-tab
*- so it can then be translated back to 2 double quotes.
  CONCATENATE &apos;&quot;&apos; cl_abap_char_utilities=&gt;cr_lf+1(1) INTO g_translate.

  APPEND: &apos;Dim myolapp &apos; TO t_vbs,                          &quot;#EC *
      &apos;Dim olNamespace &apos; TO t_vbs,                          &quot;#EC *
      &apos;Dim myItem &apos; TO t_vbs,                               &quot;#EC *
      &apos;Dim myRecipient &apos; TO t_vbs,                          &quot;#EC *
      &apos;Dim myAttachments &apos; TO t_vbs,                        &quot;#EC *
      &apos; &apos; TO t_vbs,                                         &quot;#EC *
      &apos;Set myolapp = CreateObject(&quot;Outlook.Application&quot;) &apos; TO t_vbs, &quot;#EC *
      &apos;Set olNamespace = myolapp.GetNamespace(&quot;MAPI&quot;) &apos; TO t_vbs, &quot;#EC *
      &apos;Set myItem = myolapp.CreateItem(olMailItem) &apos; TO t_vbs, &quot;#EC *
      &apos; &apos; TO t_vbs.

*- Destinatarios del mensaje
*  LOOP AT email_address.
*   IF email_address = space. CONTINUE. ENDIF.
  CONCATENATE
    &apos;Set myRecipient = myItem.Recipients.Add(&quot;&apos; email_address &apos;&quot;)&apos; &quot;#EC *
    INTO t_vbs.
  APPEND t_vbs.
*  ENDLOOP.

*- Asunto del mensaje
  CONCATENATE &apos;myItem.Subject = &quot;&apos; subject &apos;&quot;&apos; INTO t_vbs.  &quot;#EC *
  APPEND t_vbs.

*- Ficheros adjuntos
  APPEND &apos;Set myAttachments = myItem.Attachments&apos; TO t_vbs. &quot;#EC *

*- Chequeamos la existencia de los ficheros adjuntos
  LOOP AT email_attachments.

    g_file = email_attachments-template.

*    CALL FUNCTION &apos;WS_QUERY&apos;
*      EXPORTING
*        filename       = g_file
*        query          = &apos;FE&apos;
*      EXCEPTIONS
*        inv_query      = 1
*        no_batch       = 2
*        frontend_error = 3
*        OTHERS         = 4.
*    IF sy-subrc EQ 0.
    IF zcl_ap_ficheros=&gt;existe( g_file ).
      CONCATENATE &apos;myAttachments.Add(&quot;&apos; email_attachments-template &apos;&quot;)&apos; &quot;#EC *
                  INTO t_vbs.
      APPEND t_vbs.
    ELSE.
      MESSAGE i000(38) WITH
        &apos;No se ha podido adjuntar el fichero&apos;(npa) email_attachments.
    ENDIF.
  ENDLOOP.

*- Cuerpo del email
  CLEAR: g_last,
         t_vbs.
  APPEND t_vbs.
  LOOP AT email_body.
    AT FIRST.
      APPEND &apos;myitem.body = _&apos; TO t_vbs.
    ENDAT.
    AT LAST.
      g_last = &apos;X&apos;.
    ENDAT.

*- Double-quotes(&quot;) will cause an error in VBScript
*- Replace with a hex-tab and then replace with
*- 2 double-quotes (&quot;&quot;)
    TRANSLATE email_body USING g_translate.
    WHILE sy-subrc = 0.
      REPLACE cl_abap_char_utilities=&gt;cr_lf+1(1)
              WITH &apos;&quot;&quot;&apos; INTO email_body.
    ENDWHILE.

    IF g_last = &apos;X&apos;.
      CONCATENATE &apos;&quot;&apos; email_body &apos;&quot; &amp;vbCrLf &apos;
                  INTO t_vbs.
    ELSE.
      CONCATENATE &apos;&quot;&apos; email_body &apos;&quot; &amp;vbCrLf &amp;_&apos;
                  INTO t_vbs.
    ENDIF.
    APPEND t_vbs.
  ENDLOOP.

*  APPEND &apos;myItem.Display&apos; TO t_vbs.
  APPEND &apos;myItem.Send&apos; TO t_vbs.

*- Preparamos el nombre de fichero vbscript para descargarlo
*- y ejecutarlo, llamando a la variable de entorno de Windows
*- TEMP
  CLEAR g_vbs_filename.
*  CALL FUNCTION &apos;WS_QUERY&apos;
*    EXPORTING
*      environment    = &apos;TEMP&apos;
*      query          = &apos;EN&apos;
*    IMPORTING
*      return         = g_vbs_filename
*    EXCEPTIONS
*      inv_query      = 1
*      no_batch       = 2
*      frontend_error = 3
*      OTHERS         = 4.

  g_vbs_filename = zcl_ap_ficheros=&gt;get_directorio_temporal( ).

  CONCATENATE g_vbs_filename &apos;mail.vbs&apos; INTO g_vbs_filename.
  commandline = g_vbs_filename.

  PERFORM sapgui_progress(rstxldmc) USING 10
    &apos;Realizando download de fichero...&apos;(rdf).

  l_string = g_vbs_filename.

*- Descargamos el fichero vbscript
  zcl_ap_ficheros=&gt;grabar( EXPORTING fichero = l_string
                           CHANGING  tabla   = t_vbs[] ).

* Abrimos el Outlook
  PERFORM sapgui_progress(rstxldmc) USING 50
    &apos;Abriendo Outlook... Espere por favor&apos;(aol).

  cl_gui_frontend_services=&gt;execute( EXPORTING  application            = &apos;WSCRIPT.EXE&apos;
                                                parameter              = commandline
                                     EXCEPTIONS cntl_error             = 1
                                                error_no_gui           = 2
                                                bad_parameter          = 3
                                                file_not_found         = 4
                                                path_not_found         = 5
                                                file_extension_unknown = 6
                                                error_execute_failed   = 7
                                                synchronous_failed     = 8
                                                not_supported_by_gui   = 9 ).
  IF sy-subrc &lt;&gt; 0.
    MESSAGE &apos;Error abriendo outlook&apos; TYPE &apos;I&apos;.
  ELSE.
    MESSAGE s000(38) WITH &apos;Abriendo Outlook... Espere por favor&apos;(aol).
    WAIT UP TO 5 SECONDS.
  ENDIF.
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  copy_ftp
*&amp;---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM copy_ftp.
  DATA o_ftp TYPE REF TO zcl_ap_ftp.

  o_ftp = NEW #( ).

  o_ftp-&gt;connect( user     = &apos;sap4abap&apos;
                  password = &apos;B5DC3B26771B&apos;
                  host     = &apos;sap4.com&apos; ).

  IF NOT o_ftp-&gt;error_conexion IS INITIAL.
    MESSAGE &apos;Error de conexion&apos;(eco) TYPE &apos;E&apos;.
  ELSE.
    IF o_ftp-&gt;cd( &apos;lib&apos; ) = &apos;X&apos;.

      IF NOT zcl_c=&gt;empresa IS INITIAL.
        IF o_ftp-&gt;cd( zcl_c=&gt;empresa ) = &apos;&apos;.
          MESSAGE e398(00) WITH &apos;Error al cambiar a dir.FTP&apos;(eft) zcl_c=&gt;empresa &apos;&apos; &apos;&apos;.
        ENDIF.
      ENDIF.

      LOOP AT i_ficheros_ftp.
        IF o_ftp-&gt;put( i_ficheros_ftp ) = &apos;&apos;.
          WRITE / o_ftp-&gt;mensaje_error.
        ENDIF.
      ENDLOOP.
    ENDIF.

    o_ftp-&gt;disconnect( ).

  ENDIF.
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  COMPARAR_FICHEROS
*&amp;---------------------------------------------------------------------*
FORM comparar_ficheros.
  DATA: i_ficheros TYPE TABLE OF file_info WITH HEADER LINE,
        i_tabla    TYPE TABLE OF text1024,
        i_tabla2   TYPE TABLE OF text1024 WITH HEADER LINE,
        l_tabla    TYPE text1024,
        l_aux1     TYPE string,
        l_aux2     TYPE string.
  DATA l_nombrefichero TYPE string.
  DATA i_codigo        TYPE tttext255.
  DATA v_text3         TYPE string.
  DATA string          TYPE string.
  DATA: aux1 TYPE c LENGTH 80,
        aux2 TYPE c LENGTH 80,
        aux3 TYPE c LENGTH 80,
        aux4 TYPE c LENGTH 80,
        aux5 TYPE string.
  DATA r_lin_exc TYPE RANGE OF string.
  DATA l_dif     TYPE i.
  DATA: i_t1_255 TYPE TABLE OF text255,
        i_t2_255 TYPE TABLE OF text255.
  DATA abaptext_delta LIKE vxabapt255 OCCURS 0 WITH HEADER LINE.

  i_ficheros[] = zcl_ap_ficheros=&gt;lista_ficheros( DIRECTORY = v_directorio RECURSIVO = &apos;X&apos; ).
  LOOP AT i_ficheros.
    i_ficheros-filename = to_upper( i_ficheros-filename ). &quot;#EC TRANSLANG
    MODIFY i_ficheros.
  ENDLOOP.

  LOOP AT i_listado WHERE marca = &apos;X&apos;.
    zcl_ap_sgpi=&gt;text( |Comparando { i_listado-name }| ).

    CLEAR: i_tabla,
           i_tabla2.
    REFRESH: i_tabla, i_tabla2.

    IF i_listado-object = &apos;PROG&apos; OR i_listado-object = &apos;CLAS&apos; OR i_listado-object = &apos;FUGR&apos;.
      CONCATENATE i_listado-object &apos;\&apos; i_listado-name &apos;.abap&apos; INTO DATA(l_nf).
    ELSE.
      CONCATENATE i_listado-object &apos;\&apos; i_listado-name &apos;.txt&apos; INTO l_nf.
    ENDIF.
    IF o_ms IS INITIAL.
      IF p_rfc IS INITIAL.
        CONCATENATE v_directorio &apos;\&apos; l_nf INTO l_nombrefichero.
        l_nombrefichero = to_upper( l_nombrefichero ).

        CLEAR i_ficheros.
        READ TABLE i_ficheros WITH KEY filename = l_nombrefichero.
        IF sy-subrc = 0.
          zcl_ap_ficheros=&gt;leer( EXPORTING fichero       = l_nombrefichero
                                           mostrar_error = &apos;&apos;
                                 CHANGING  tabla         = i_tabla[] ).
        ENDIF.
      ELSE.
        CALL FUNCTION &apos;Z_RFC_GET_CODIGO&apos;
          DESTINATION p_rfc
          EXPORTING
            object                = i_listado-object
            obj_name              = i_listado-name
            modo                  = &apos;C&apos;
          IMPORTING
            i_codigo              = i_codigo
            trdir                 = trdir
          EXCEPTIONS
            system_failure        = 1
            communication_failure = 2
            OTHERS                = 3.

        IF sy-subrc &lt;&gt; 0.
          CASE sy-subrc.
            WHEN 1.
              MESSAGE &apos;System failure during RFC call&apos; TYPE &apos;E&apos;.
            WHEN 2.
              MESSAGE &apos;Communication failure during RFC call&apos; TYPE &apos;E&apos;.
            WHEN OTHERS.
              MESSAGE &apos;Unknown error during RFC call&apos; TYPE &apos;E&apos;.
          ENDCASE.
        ENDIF.

        i_listado-fecha_descarga   = trdir-udat.
        i_listado-cliente_descarga = trdir-unam.

        i_tabla[] = i_codigo.

      ENDIF.
    ELSE.
      CONCATENATE v_directorio &apos;/&apos; l_nf INTO l_nombrefichero.
      o_ms-&gt;get_contenido_fichero( EXPORTING nombre          = l_nombrefichero
                                             popup_respuesta = &apos;&apos;
                                   IMPORTING message         = DATA(l_msg)
                                             respuesta       = DATA(v_text2)
                                             contenido       = DATA(l_xstring) ).
      IF NOT l_msg IS INITIAL.
        MESSAGE l_msg TYPE &apos;I&apos;.
        RETURN.
      ENDIF.
      TRY.

          DATA(lv_conv) = cl_abap_conv_in_ce=&gt;create(
            encoding = &apos;1100&apos;
            input    = l_xstring ).

        CATCH cx_root INTO DATA(o_root).
          l_msg = o_root-&gt;get_text( ).
      ENDTRY.

      TRY.

          lv_conv-&gt;read(
            IMPORTING
              data = v_text3 ).

        CATCH cx_root INTO o_root.
          l_msg = o_root-&gt;get_text( ).
      ENDTRY.

      zcl_ap_string=&gt;string2tabla( EXPORTING string = v_text3 longitud = 255 CHANGING tabla = i_tabla[] ).

*      LOOP AT i_tabla ASSIGNING FIELD-SYMBOL(&lt;sss&gt;).
*        IF &lt;sss&gt; CS &apos;No!&apos;.
*          BREAK-POINT.
*        ENDIF.
*      ENDLOOP.

    ENDIF.

    DATA l_s TYPE string.
    DEFINE fix_comment.
      IF l_tabla CS &amp;1.
        REPLACE ALL OCCURRENCES OF &amp;1 IN l_tabla WITH &apos;.&apos;.
      ENDIF.
      l_s = l_tabla.
      zcl_ap_string=&gt;quitar_caracteres_extranos( CHANGING string = l_s ).
      l_tabla = l_s.
    END-OF-DEFINITION.

    DEFINE fix_comments.
      fix_comment: `. &quot;#EC NOTEXT .`, ` ##NO_TEXT.`.
    END-OF-DEFINITION.

    IF i_tabla IS INITIAL.
      i_listado-icono    = icon_incoming_object.  &quot; BAJAR
      i_listado-libreria = &apos;N&apos;.
    ELSE.
      IF p_rfc IS INITIAL.
        zcl_ap_dev=&gt;texto_comparable( CHANGING i_tabla = i_tabla[] ).

        LOOP AT i_tabla INTO l_tabla.                    &quot;#EC CI_NESTED
          IF l_tabla CS &apos;type-pools&apos; OR l_tabla CS &apos;TYPE_POOLS&apos;.
            DELETE i_tabla.
            CONTINUE.
          ELSEIF l_tabla CS &apos;&quot;&apos;.
            SPLIT l_tabla AT &apos;&quot;&apos; INTO l_aux1 l_aux2.
            l_tabla = l_aux1.
          ENDIF.
          fix_comments.

          IF ( i_listado-subc = &apos;T&apos; OR i_listado-subc = &apos;E&apos; ) AND l_tabla CS &apos;;&apos;.
            SPLIT l_tabla AT &apos;;&apos; INTO aux1 aux2 aux3 aux4 aux5.
            CONCATENATE aux1 aux2 aux3 aux4 INTO l_tabla SEPARATED BY &apos;;&apos;.
          ENDIF.

          MODIFY i_tabla FROM l_tabla.
        ENDLOOP.

        LOOP AT i_tabla INTO l_tabla.                    &quot;#EC CI_NESTED
          IF l_tabla IS INITIAL.
            DELETE i_tabla.
          ENDIF.
        ENDLOOP.

        DO 10 TIMES.
          DATA(l_reintentar) = &apos;&apos;.
          LOOP AT i_tabla ASSIGNING FIELD-SYMBOL(&lt;t&gt;).   &quot;#EC CI_NESTED
            CONDENSE &lt;t&gt; NO-GAPS.
            &lt;t&gt; = to_upper( &lt;t&gt; ).
            IF &lt;t&gt; = &apos;TYPES:&apos; OR &lt;t&gt; = &apos;TYPES&apos;.
              DATA(l_idx) = sy-tabix + 1.
              READ TABLE i_tabla INTO DATA(l_t2) INDEX l_idx.
              IF sy-subrc = 0.
                CONDENSE l_t2 NO-GAPS. l_t2 = to_upper( l_t2 ).
                &lt;t&gt; = |TYPES{ l_t2 }|.
                DELETE i_tabla INDEX l_idx.
                l_reintentar = &apos;X&apos;.
              ENDIF.
            ENDIF.
            IF &lt;t&gt; = &apos;CONSTANTS:&apos; OR &lt;t&gt; = &apos;CONSTANTS&apos;.
              l_idx = sy-tabix + 1.
              READ TABLE i_tabla INTO l_t2 INDEX l_idx.
              IF sy-subrc = 0.
                CONDENSE l_t2 NO-GAPS. l_t2 = to_upper( l_t2 ).
                &lt;t&gt; = |CONSTANTS{ l_t2 }|.
                DELETE i_tabla INDEX l_idx.
                l_reintentar = &apos;X&apos;.
              ENDIF.
            ENDIF.
          ENDLOOP.
          IF l_reintentar IS INITIAL.
            EXIT.
          ENDIF.
        ENDDO.
      ENDIF.

      i_listado-nlinlib = lines( i_tabla ).
      i_tabla2[] = zcl_ap_dev=&gt;get_objeto_como_texto( tipo   = i_listado-object
                                                      nombre = i_listado-name
                                                      modo   = &apos;C&apos; ).

      IF p_rfc IS INITIAL.
        LOOP AT i_tabla2 INTO l_tabla.                   &quot;#EC CI_NESTED
          IF l_tabla CS &apos;type-pools&apos; OR l_tabla CS &apos;TYPE_POOLS&apos;.
            DELETE i_tabla2.
            CONTINUE.
          ELSEIF l_tabla CS &apos;&quot;&apos;.
            SPLIT l_tabla AT &apos;&quot;&apos; INTO l_aux1 l_aux2.
            l_tabla = l_aux1.
          ENDIF.

          fix_comments.
          MODIFY i_tabla2 FROM l_tabla.
        ENDLOOP.

        LOOP AT i_tabla2 INTO l_tabla.                   &quot;#EC CI_NESTED
          IF l_tabla IS INITIAL.
            DELETE i_tabla2.
          ENDIF.
        ENDLOOP.

        DO 10 TIMES.
          l_reintentar = &apos;&apos;.
          LOOP AT i_tabla2 ASSIGNING &lt;t&gt;.                &quot;#EC CI_NESTED
            CONDENSE &lt;t&gt; NO-GAPS.
            &lt;t&gt; = to_upper( &lt;t&gt; ).
            IF &lt;t&gt; = &apos;TYPES:&apos; OR &lt;t&gt; = &apos;TYPES&apos;.
              l_idx = sy-tabix + 1.
              READ TABLE i_tabla2 INTO l_t2 INDEX l_idx.
              IF sy-subrc = 0.
                CONDENSE l_t2 NO-GAPS. l_t2 = to_upper( l_t2 ).
                &lt;t&gt; = |TYPES{ l_t2 }|.
                DELETE i_tabla2 INDEX l_idx.
                l_reintentar = &apos;X&apos;.
              ENDIF.
            ENDIF.

            IF &lt;t&gt; = &apos;CONSTANTS:&apos; OR &lt;t&gt; = &apos;CONSTANTS&apos;.
              l_idx = sy-tabix + 1.
              READ TABLE i_tabla INTO l_t2 INDEX l_idx.
              IF sy-subrc = 0.
                CONDENSE l_t2 NO-GAPS. l_t2 = to_upper( l_t2 ).
                &lt;t&gt; = |CONSTANTS{ l_t2 }|.
                DELETE i_tabla INDEX l_idx.
                l_reintentar = &apos;X&apos;.
              ENDIF.
            ENDIF.
          ENDLOOP.
          IF l_reintentar IS INITIAL.
            EXIT.
          ENDIF.
        ENDDO.

        r_lin_exc = VALUE #( option = &apos;EQ&apos;
                             sign   = &apos;I&apos;
                             ( low = &apos;PRIVATESECTION.&apos; )
                             ( low = &apos;PROTECTEDSECTION.&apos; ) ).
        LOOP AT i_tabla INTO l_tabla.                    &quot;#EC CI_NESTED
          IF l_tabla IN r_lin_exc.
            DELETE i_tabla.
          ENDIF.
        ENDLOOP.
        LOOP AT i_tabla2 INTO l_tabla.                   &quot;#EC CI_NESTED
          IF l_tabla IN r_lin_exc.
            DELETE i_tabla2.
          ENDIF.
        ENDLOOP.

        DATA(i_t) = i_tabla[].
        CLEAR i_tabla[].
        CLEAR string.
        LOOP AT i_t ASSIGNING &lt;t&gt;.                       &quot;#EC CI_NESTED
          IF string IS INITIAL.
            string = &lt;t&gt;.
          ELSE.
            CONCATENATE string &lt;t&gt; INTO string SEPARATED BY space.
          ENDIF.

          IF zcl_ap_string=&gt;ultimo_caracter( &lt;t&gt; ) = &apos;.&apos;.
            IF i_listado-object = &apos;CLAS&apos;. REPLACE ALL OCCURRENCES OF &apos;!&apos; IN string WITH &apos;&apos;. ENDIF.
            CONDENSE string NO-GAPS.
            APPEND string TO i_tabla.
            CLEAR string.
          ENDIF.
        ENDLOOP.
        i_t = i_tabla2[].
        CLEAR i_tabla2[].
        LOOP AT i_t ASSIGNING &lt;t&gt;.                       &quot;#EC CI_NESTED
          IF string IS INITIAL.
            string = &lt;t&gt;.
          ELSE.
            CONCATENATE string &lt;t&gt; INTO string SEPARATED BY space.
          ENDIF.
          IF zcl_ap_string=&gt;ultimo_caracter( &lt;t&gt; ) = &apos;.&apos;.
            IF i_listado-object = &apos;CLAS&apos;. REPLACE ALL OCCURRENCES OF &apos;!&apos; IN string WITH &apos;&apos;. ENDIF.
            CONDENSE string NO-GAPS.
            APPEND string TO i_tabla2.
            CLEAR string.
          ENDIF.
        ENDLOOP.
      ENDIF.

      i_listado-nlinlib = lines( i_tabla ).
      i_listado-nlinact = lines( i_tabla2 ).

      i_listado-icono   = icon_equal_green.

      IF i_listado-nlinlib &lt;&gt; i_listado-nlinact.
        i_listado-icono = icon_not_equal_red.
      ELSE.
        IF p_rfc IS INITIAL.
          LOOP AT i_tabla INTO l_tabla.                  &quot;#EC CI_NESTED
            IF l_tabla(6) = &apos;TYPES:&apos;. l_tabla+5 = l_tabla+6. ENDIF.
            CLEAR i_tabla2.
            READ TABLE i_tabla2 INDEX sy-tabix.
            IF i_tabla2(6) = &apos;TYPES:&apos;. i_tabla2+5 = i_tabla2+6. ENDIF.
            IF l_tabla = i_tabla2.
              CONTINUE.
            ENDIF.

            IF NOT o_ms IS INITIAL.
              IF i_tabla2 = &apos;IFSTRINGCS&apos;&apos;EUR&apos;&apos;.&apos; AND l_tabla = &apos;IFSTRINGCS&apos;&apos;.&apos;&apos;.&apos;.
                CONTINUE.
              ENDIF.
              IF i_tabla2 = &apos;REPLACEALLOCCURRENCESOF&apos;&apos;EUR&apos;&apos;INSTRINGWITH&apos;&apos;EUR&apos;&apos;.&apos; AND l_tabla = &apos;REPLACEALLOCCURRENCESOF&apos;&apos;.&apos;&apos;INSTRINGWITH&apos;&apos;EUR&apos;&apos;.&apos;.
                CONTINUE.
              ENDIF.
            ENDIF.

* Se raya con los acentos...
            DATA(l_ok) = &apos;&apos;.
            IF NOT o_ms IS INITIAL.
              IF strlen( l_tabla ) = strlen( i_tabla2 ).
                DATA(l_long) = strlen( l_tabla ).
                CLEAR l_dif.
                DO l_long TIMES.
                  DATA(l_inx) = sy-index - 1.
                  IF l_tabla+l_inx(1) &lt;&gt; i_tabla2+l_inx(1).
                    IF l_tabla+l_inx(1) = &apos;?&apos; OR l_tabla+l_inx(1) = &apos;.&apos; OR l_tabla+l_inx(1) = &apos;¡&apos;.
                    ELSE.
                      l_dif = l_dif + 1.
                    ENDIF.
                  ENDIF.
                ENDDO.
                IF l_dif = 0.
                  l_ok = &apos;X&apos;.
                ELSE.
                  l_ok = &apos;&apos;.
                ENDIF.
              ENDIF.
            ENDIF.
            IF l_ok IS INITIAL.
              i_listado-icono = icon_not_equal_red.
              EXIT.
            ENDIF.
          ENDLOOP.
        ELSE.
          IF i_tabla2[] &lt;&gt; i_tabla[].
            i_listado-icono = icon_not_equal_red.
          ENDIF.
        ENDIF.
      ENDIF.

      IF i_listado-icono = icon_not_equal_red.
        i_t1_255 = i_tabla2[].
        i_t2_255 = i_tabla[].
        abaptext_delta[] = zcl_ap_dev=&gt;comparar_reports( tabla1 = i_t1_255
                                                         tabla2 = i_t2_255 ).

        LOOP AT abaptext_delta.                          &quot;#EC CI_NESTED
          CLEAR i_cambios.
          MOVE-CORRESPONDING abaptext_delta TO i_cambios.
          i_cambios-name = i_listado-name.
          APPEND i_cambios.
        ENDLOOP.

        IF     i_listado-nlinact  &gt; i_listado-nlinlib
           AND i_listado-udat    &gt;= i_ficheros-writedate.
          i_listado-icono = icon_incoming_object.                      &quot; BAJAR
        ELSEIF     i_listado-nlinact  &lt; i_listado-nlinlib
               AND i_listado-udat    &lt;= i_ficheros-writedate.
          i_listado-icono = icon_outgoing_object.                      &quot; SUBIR
        ENDIF.
      ENDIF.
    ENDIF.

    IF p_solom = &apos;&apos; OR i_listado-icono &lt;&gt; icon_equal_green.
      MODIFY i_listado.
    ELSE.
      DELETE i_listado.
    ENDIF.

  ENDLOOP.
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  SUBIR_LIB
*&amp;---------------------------------------------------------------------*
FORM subir_lib.
  DATA: l_tipo    TYPE c LENGTH 4,
        l_file    TYPE c LENGTH 300,
        isslinkee TYPE c LENGTH 1.
  DATA: l_object   TYPE e071-object,
        l_obj_name TYPE e071-obj_name.

  PERFORM get_tipo USING i_listado-subc i_listado-name
          CHANGING l_tipo.

  CONCATENATE l_tipo &apos;\&apos; i_listado-name &apos;.slnk&apos; INTO DATA(l_nf).
  IF NOT o_ms IS INITIAL AND NOT p_dirto IS INITIAL.

    CONCATENATE v_directorio &apos;/&apos; l_nf INTO l_file.
    o_ms-&gt;get_contenido_fichero( EXPORTING nombre = CONV #( l_file ) popup_respuesta = &apos;&apos; IMPORTING message = DATA(l_msg) respuesta = DATA(v_text2) ).
    IF NOT l_msg IS INITIAL.
      MESSAGE l_msg TYPE &apos;I&apos;.
      RETURN.
    ENDIF.
    l_file = zcl_ap_ficheros=&gt;concat_ruta( directorio = p_dirto fichero = l_nf ).
    zcl_ap_ficheros=&gt;grabar_xstring( fichero = l_file xstring = zcl_ap_string=&gt;string2xstring( v_text2 ) ).
  ELSE.

    CONCATENATE v_directorio &apos;\&apos; l_nf INTO l_file.
  ENDIF.

  isslinkee = &apos;X&apos;.
  EXPORT isslinkee TO MEMORY ID &apos;ISSLNK&apos;.
  SUBMIT zsaplink                                        &quot;#EC CI_SUBMIT
         AND RETURN
*   VIA SELECTION-SCREEN
         WITH filename = l_file
         WITH slpkg    = i_listado-devclass
         WITH overwr   = &apos;X&apos;.

  PERFORM cambiar_clase_desarrollo.

  l_object   = l_tipo.
  l_obj_name = i_listado-name.
  zcl_ap_dev=&gt;activar_objeto( object   = l_object
                              obj_name = l_obj_name ).
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  GET_TIPO
*&amp;---------------------------------------------------------------------*
FORM get_tipo USING    pe_subc
                       pe_name
              CHANGING ps_tipo.

  CASE pe_subc.
    WHEN &apos;1&apos; OR &apos;I&apos; OR &apos;M&apos;.
      ps_tipo = &apos;PROG&apos;.
    WHEN &apos;C&apos;.
      ps_tipo = &apos;CLAS&apos;.
    WHEN &apos;T&apos; OR &apos;E&apos;.
      SELECT as4date, as4user, tabclass, tabname
        FROM dd02l
        WHERE tabname = @pe_name
        ORDER BY PRIMARY KEY
        INTO CORRESPONDING FIELDS OF @dd02l
        UP TO 1 ROWS.
      ENDSELECT.
      IF sy-subrc = 0.
        ps_tipo = &apos;TABL&apos;.
      ELSE.
        CLEAR ps_tipo.
      ENDIF.
    WHEN &apos;D&apos;.
      ps_tipo = &apos;TTYP&apos;.
    WHEN &apos;F&apos;.
      ps_tipo = &apos;FUGR&apos;.
  ENDCASE.
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  CAMBIAR_CLASE_DESARROLLO
*&amp;---------------------------------------------------------------------*
FORM cambiar_clase_desarrollo.
  e071-obj_name = i_listado-name.
  zcl_ap_dev=&gt;popup_cambio_clase_desarrollo( object   = i_listado-object
                                             obj_name = e071-obj_name
                                             devclass = i_listado-devclass ).
ENDFORM.
*&amp;---------------------------------------------------------------------*
*&amp;      Form  VER_VERSIONES
*&amp;---------------------------------------------------------------------*

CLASS lcl_alv_popup DEFINITION INHERITING FROM zcl_ap_alv FINAL.
  PUBLIC SECTION.
    DATA i_versiones TYPE TABLE OF zbc003v.

    METHODS handle_double_click REDEFINITION.
ENDCLASS.                    &quot; lcl_alv DEFINITION


*----------------------------------------------------------------------*
*       CLASS lcl_alv IMPLEMENTATION
*----------------------------------------------------------------------*
*
*----------------------------------------------------------------------*
CLASS lcl_alv_popup IMPLEMENTATION.
  METHOD handle_double_click.
    DATA l_version TYPE zbc003v.

    READ TABLE i_versiones INTO l_version INDEX row.
    IF sy-subrc = 0.
      zcl_ap_string=&gt;editor_popup_string( l_version-string ).
    ENDIF.
  ENDMETHOD.
ENDCLASS.                    &quot; lcl_alv IMPLEMENTATION

*&amp;---------------------------------------------------------------------*
*&amp;      Form  ver_versiones
*&amp;---------------------------------------------------------------------*

FORM ver_versiones.
  DATA o_alv TYPE REF TO lcl_alv_popup.

  o_alv = NEW #( tabla = &apos;&apos; ).

  SELECT * FROM zbc003v
    INTO TABLE o_alv-&gt;i_versiones
   WHERE name  = i_listado-name
     AND tcode = i_listado-tcode.

  o_alv-&gt;constructor_tabla( EXPORTING tabla   = &apos;I_VERSIONES&apos;
                            CHANGING  t_tabla = o_alv-&gt;i_versiones ).

  o_alv-&gt;show( ).
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  ACTUALIZAR_REPOSITORIO
*&amp;---------------------------------------------------------------------*
FORM actualizar_repositorio.
  DATA: o_repo    TYPE REF TO zcl_ap_repo,
        l_cambio  TYPE c LENGTH 1,
        l_repo    TYPE zap_repo,
        l_fichero TYPE string.

  o_repo = NEW #( origen        = p_origen
                  ruta_pc_local = v_directorio ).

  o_repo-&gt;conexion( password = &apos;B5DC3B23704A7C&apos; ).

  LOOP AT i_listado WHERE marca = &apos;X&apos;.
    CLEAR l_cambio.
    READ TABLE o_repo-&gt;i_repo INTO l_repo WITH KEY object = i_listado-object
                                                   nombre = i_listado-name.
    IF sy-subrc &lt;&gt; 0.
      CLEAR l_repo.
      MOVE-CORRESPONDING i_listado TO l_repo.
      l_repo-nombre      = i_listado-name.
      l_repo-descripcion = i_listado-text.
      APPEND l_repo TO o_repo-&gt;i_repo.
      l_cambio = &apos;X&apos;.
    ELSE.
      l_repo-udat = i_listado-udat.
      IF l_repo-udat &lt;&gt; i_listado-udat.
        l_repo-udat = i_listado-udat.
        l_cambio    = &apos;X&apos;.
        MODIFY o_repo-&gt;i_repo FROM l_repo INDEX sy-tabix.
      ENDIF.
    ENDIF.

    IF l_cambio = &apos;X&apos;.
      IF p_origen = &apos;F&apos;.
        CONCATENATE v_directorio &apos;\&apos;
                   i_listado-name &apos;.txt&apos;
                    INTO l_fichero.
        o_repo-&gt;actualizar_fichero( l_fichero ).

        CONCATENATE v_directorio &apos;\&apos;
                   i_listado-object &apos;_&apos; i_listado-name &apos;.slnk&apos;
                    INTO l_fichero.
        o_repo-&gt;actualizar_fichero( l_fichero ).
      ENDIF.
    ENDIF.
  ENDLOOP.

  o_repo-&gt;actualiza_indice_repo( ).

  o_repo-&gt;desconexion( ).
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  get_funcion
*&amp;---------------------------------------------------------------------*
FORM get_funcion USING pe_funcion.
  i_listado-subc  = &apos;F&apos;.
  i_listado-name  = pe_funcion.
  i_listado-text  = v_fdirt-stext.
  i_listado-tcode = &apos;SE37&apos;.
  i_listado-ttext = v_fdirt-area.

  SELECT SINGLE * FROM tfdir
   WHERE funcname = v_fdirt-funcname.
  CONCATENATE tfdir-pname+3 &apos;U&apos; tfdir-include INTO trdir-name.

  SELECT SINGLE cdat cnam udat unam FROM trdir
    INTO (i_listado-cdat, i_listado-cnam,
          i_listado-udat, i_listado-unam)
   WHERE name  = trdir-name
     AND cnam IN s_cnam
     AND unam IN s_unam
     AND cdat IN s_cdat
     AND udat IN s_udat.
  IF sy-subrc = 0.
    SELECT SINGLE devclass FROM  tadir
      INTO i_listado-devclass
     WHERE pgmid    = &apos;R3TR&apos;
       AND object   = &apos;PROG&apos;
       AND obj_name = trdir-name.
    IF sy-subrc = 0.
      IF p_numlin = &apos;X&apos;.
        READ REPORT trdir-name INTO i_source.
        i_listado-numlin = lines( i_source ).
      ENDIF.
    ENDIF.
  ENDIF.
ENDFORM.
*&amp;---------------------------------------------------------------------*
*&amp;      Module  USER_COMMAND_0100  INPUT
*&amp;---------------------------------------------------------------------*
MODULE user_command_0100 INPUT.
  DATA: l_ok   TYPE c LENGTH 1,
        l_fila TYPE i.

  o_alv-&gt;comprobar_cambios( ).
  o_alv-&gt;get_filas_sel( ).
  l_fila = o_alv-&gt;get_fila_activa( ).

  LOOP AT i_listado.
    READ TABLE o_alv-&gt;i_filas_sel TRANSPORTING NO FIELDS WITH KEY index = sy-tabix.
    IF sy-subrc = 0.
      i_listado-marca = &apos;X&apos;.
    ELSE.
      CLEAR i_listado-marca.
    ENDIF.
    MODIFY i_listado.
  ENDLOOP.

  CASE sy-ucomm.
    WHEN &apos;BACK&apos;.
      LEAVE TO SCREEN 0.
    WHEN &apos;ENTER&apos;.

      LOOP AT i_listado.
        PERFORM icono_status USING i_listado-estado
                          CHANGING i_listado-icono.
        MODIFY i_listado.
      ENDLOOP.
      o_alv-&gt;refrescar_grid( ).
    WHEN &apos;GRABAR&apos;.
      LOOP AT i_listado.
        CLEAR i_list_orig.
        READ TABLE i_list_orig INDEX sy-tabix.
        IF i_listado &lt;&gt; i_list_orig.
          CLEAR zbc003.
          MOVE-CORRESPONDING i_listado TO zbc003.
          MODIFY zbc003.
        ENDIF.
      ENDLOOP.
      i_list_orig[] = i_listado[].
      MESSAGE &apos;Se han grabado los cambios&apos;(sgc) TYPE &apos;S&apos;.
      LOOP AT i_listado.
        PERFORM icono_status USING i_listado-estado
                          CHANGING i_listado-icono.
        MODIFY i_listado.
      ENDLOOP.
      o_alv-&gt;refrescar_grid( ).

      PERFORM grabar_list_excel.
    WHEN &apos;NUEVAL&apos;.
      zcl_ap_popup=&gt;popup_usuario( EXPORTING campo1 = &apos;TRDIR-NAME&apos;
                                             campo2 = &apos;TSTC-TCODE&apos;
                                             titulo = &apos;Prog.Modificado&apos;(prm)
                                   IMPORTING return = l_ok
                                   CHANGING  valor1 = i_listado-name
                                             valor2 = i_listado-tcode ).
      IF l_ok = &apos;&apos;.
        i_listado-estado = &apos;M&apos;.
        APPEND i_listado.
      ENDIF.
      o_alv-&gt;refrescar_grid( ).

    WHEN &apos;TCODE&apos;.
      CLEAR tstc.
      zcl_ap_popup=&gt;popup_usuario( EXPORTING campo1 = &apos;TSTC-TCODE&apos;
                                             titulo = &apos;Ejecutar transacciÃ³n&apos;(etr)
                                   IMPORTING return = l_ok
                                   CHANGING  valor1 = tstc-tcode ).
      IF l_ok = &apos;&apos;.
        CALL TRANSACTION tstc-tcode.                     &quot;#EC CI_CALLTA
      ENDIF.


    WHEN &apos;DESCARGAR&apos;.
      IF v_directorio IS INITIAL.
        cl_gui_frontend_services=&gt;directory_browse( EXPORTING  window_title         = &apos;Selecciona un directorio&apos; &quot;#EC *
                                                               initial_folder       = zcl_c=&gt;ruta_descarga_slnk
                                                    CHANGING   selected_folder      = v_directorio
                                                    EXCEPTIONS cntl_error           = 1
                                                               error_no_gui         = 2
                                                               not_supported_by_gui = 3
                                                               OTHERS               = 4 ).
      ENDIF.

      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        IF i_listado-icono = icon_incoming_object AND i_listado-devclass(1) &lt;&gt; &apos;/&apos; AND i_listado-object &lt;&gt; &apos;DOMA&apos; AND i_listado-object &lt;&gt; &apos;DTEL&apos;.
          PERFORM guardar_version.
        ENDIF.
        PERFORM descargar_slnk USING &apos;&apos;.
        MODIFY i_listado.
      ENDLOOP.
      IF sy-subrc = 0.
        IF p_vivas = &apos;X&apos;.
          zcl_ap_temp=&gt;set_st( clave = sy-tcode subclave = sy-uname valor1 = sy-datum ).
        ENDIF.
      ENDIF.
      IF p_ftp = &apos;X&apos;.
        PERFORM copy_ftp.
      ENDIF.
      PERFORM grabar_list_excel.
      IF p_zipl = &apos;X&apos; AND p_onedr IS INITIAL.
        PERFORM zip.
      ENDIF.

    WHEN &apos;COMPARAR&apos;.
      READ TABLE i_listado INDEX l_fila.
      IF sy-subrc = 0.
        PERFORM descargar_slnk USING &apos;&apos;.
      ENDIF.

    WHEN &apos;COMP_ONL&apos;.
      CLEAR: v_text1,
             v_text2.
      READ TABLE i_listado INDEX l_fila.
      IF sy-subrc = 0.
        PERFORM descargar_slnk USING &apos;&apos;.
      ENDIF.

    WHEN &apos;NVERSION&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        PERFORM descargar_slnk USING &apos;V&apos;.
      ENDLOOP.

    WHEN &apos;MACHACAR&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        CLEAR l_ok.
        IF i_listado-icono &lt;&gt; icon_incoming_object AND i_listado-icono &lt;&gt; icon_equal_green.
          l_ok = zcl_ap_popup=&gt;confirmar( titulo = &apos;Descargar objeto&apos; &quot;#EC *
                                          texto  = &apos;¿Esta seguro de querer descargar el objeto?&apos; &quot;#EC *
                                          texto2 = i_listado-name ).
          sy-ucomm = &apos;MACHACAR&apos;.
        ELSE.
          l_ok = &apos;X&apos;.
        ENDIF.

        IF l_ok = &apos;X&apos;.
          PERFORM descargar_slnk USING &apos;B&apos;.
          PERFORM descargar_slnk USING &apos;&apos;.
          i_listado-cliente_descarga = zcl_c=&gt;cliente_tasks.
          i_listado-fecha_descarga   = sy-datum.
          MODIFY i_listado.
        ENDIF.
      ENDLOOP.
      PERFORM grabar_list_excel.

    WHEN &apos;VERSIONES&apos;.
      READ TABLE i_listado INDEX l_fila.
      IF sy-subrc = 0.
        PERFORM ver_versiones.
      ENDIF.

    WHEN &apos;SUBIR_LIB&apos;.
      IF p_lib = &apos;X&apos;.
        LOOP AT i_listado WHERE marca = &apos;X&apos;.
          CLEAR l_ok.
          IF i_listado-icono &lt;&gt; icon_outgoing_object.                      &quot; BAJAR
            l_ok = zcl_ap_popup=&gt;confirmar( titulo = &apos;Subir objeto&apos; &quot;#EC *
                                            texto  = &apos;¿Esta seguro de querer subir el objeto?&apos; &quot;#EC *
                                            texto2 = i_listado-name ).
            sy-ucomm = &apos;SUBIR_LIB&apos;.
          ELSE.
            l_ok = &apos;X&apos;.
          ENDIF.

          IF l_ok = &apos;X&apos;.
            PERFORM descargar_slnk USING &apos;B&apos;.

            PERFORM subir_lib.

            PERFORM get_hash.

            MODIFY i_listado.
          ENDIF.
        ENDLOOP.
      ENDIF.
      PERFORM grabar_list_excel.

    WHEN &apos;WORD&apos;.
      RANGES r_tcode FOR sy-tcode.
      READ TABLE i_listado INDEX l_fila.
      IF sy-subrc = 0.
        IF i_listado-object = &apos;TABL&apos; OR i_listado-object = &apos;VIEW&apos;.
          PERFORM generar_doc_tabla USING i_listado-name.
        ELSE.
          IF NOT i_listado-grupo IS INITIAL.
            addrango_eq r_tcode i_listado-grupo.
          ENDIF.
          IF NOT i_listado-grupo2 IS INITIAL.
            addrango_eq r_tcode i_listado-grupo2.
          ENDIF.
          IF NOT i_listado-grupo3 IS INITIAL.
            addrango_eq r_tcode i_listado-grupo3.
          ENDIF.
          addrango_eq r_tcode i_listado-name.
          SUBMIT zdocumentos                             &quot;#EC CI_SUBMIT
            AND RETURN
            WITH s_tcode IN r_tcode.
        ENDIF.
      ENDIF.

    WHEN &apos;CORREO&apos;.
      IF v_directorio IS INITIAL.
        cl_gui_frontend_services=&gt;directory_browse( EXPORTING  window_title         = &apos;Selecciona un directorio&apos; &quot;#EC *
                                                               initial_folder       = zcl_c=&gt;ruta_descarga_slnk
                                                    CHANGING   selected_folder      = v_directorio
                                                    EXCEPTIONS cntl_error           = 1
                                                               error_no_gui         = 2
                                                               not_supported_by_gui = 3
                                                               OTHERS               = 4 ).
      ENDIF.
      IF v_emailaddr IS INITIAL.
        IF sy-sysid = &apos;NSP&apos;.
          v_emailaddr = &apos;sap4abap@gmail.com&apos;.
          v_ans       = &apos;J&apos;.
        ELSE.
          CALL FUNCTION &apos;CORRESPONDENCE_POPUP_EMAIL&apos;
            EXPORTING
              i_intad  = &apos;sap4abap@gmail.com&apos;
            IMPORTING
              e_answer = v_ans
              e_intad  = v_emailaddr.
        ENDIF.
      ENDIF.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        PERFORM descargar_slnk USING &apos;X&apos;.
      ENDLOOP.
      IF p_ftp = &apos;X&apos;.
        PERFORM copy_ftp.
      ENDIF.

    WHEN &apos;BORRAR&apos;.
      LOOP AT i_listado WHERE     marca = &apos;X&apos;
                              AND ( subc = &apos;1&apos; OR subc = &apos;I&apos; OR subc = &apos;M&apos; ).
        IF i_listado-devclass IS INITIAL.
          CALL FUNCTION &apos;RS_DELETE_PROGRAM&apos;
            EXPORTING
              program            = i_listado-name
              suppress_checks    = &apos;X&apos;
              suppress_popup     = &apos;X&apos;
              with_includes      = &apos; &apos;
              with_cua           = &apos; &apos;
              with_documentation = &apos; &apos;
              with_dynpro        = &apos; &apos;
              with_textpool      = &apos; &apos;
              skip_progress_ind  = &apos;X&apos;
            EXCEPTIONS
              enqueue_lock       = 1
              object_not_found   = 2
              permission_failure = 3
              reject_deletion    = 4
              OTHERS             = 5.
          IF sy-subrc &lt;&gt; 0.
            MESSAGE |Error borrando { i_listado-name }| TYPE &apos;I&apos;.
          ENDIF.
          COMMIT WORK AND WAIT.
          DELETE i_listado.

        ELSE.
          zcl_ap_dev=&gt;borrar_programa( i_listado-name ).
        ENDIF.
      ENDLOOP.

      DATA: l_objname LIKE rsedd0-ddobjname,
            l_objtype LIKE rsedd0-ddobjtype,
            l_corrnum LIKE e070-trkorr.
      LOOP AT i_listado WHERE     marca = &apos;X&apos;
                              AND ( subc = &apos;T&apos; OR subc = &apos;E&apos; OR subc = &apos;D&apos; OR subc = &apos;V&apos; ).
        l_objname = i_listado-name.
        l_objtype = i_listado-object.
        IF i_listado-object = &apos;DTEL&apos;. l_objtype = &apos;E&apos;. ENDIF.
        CALL FUNCTION &apos;RS_DD_DELETE_OBJ&apos;
          EXPORTING
            no_ask               = &apos;X&apos;
            objname              = l_objname
            objtype              = l_objtype
          CHANGING
            corrnum              = l_corrnum
          EXCEPTIONS
            not_executed         = 1
            object_not_found     = 2
            object_not_specified = 3
            permission_failure   = 4
            dialog_needed        = 5
            OTHERS               = 6.
        IF sy-subrc &lt;&gt; 0.
          MESSAGE |Error borrando { l_objname }| TYPE &apos;I&apos;.
        ENDIF.
      ENDLOOP.


    WHEN &apos;CAMBIOCLAS&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        PERFORM cambiar_clase_desarrollo.
      ENDLOOP.

    WHEN &apos;COPIAPROD&apos;.
      DATA l_sistema TYPE rfcdest.

      IF sy-sysid = zcl_c=&gt;entorno_produccion.
        l_sistema = zcl_c=&gt;rfc_desarrollo.
      ELSE.
        l_sistema = zcl_c=&gt;rfc_produccion.
      ENDIF.
      CALL FUNCTION &apos;Z_RFC_GET_TABLA&apos;
        EXPORTING
          tabla      = &apos;ZBC003&apos;
          actualizar = &apos;X&apos;
          sistema    = l_sistema.

      CALL FUNCTION &apos;Z_RFC_GET_TABLA&apos;
        EXPORTING
          tabla      = &apos;ZBC003T&apos;
          actualizar = &apos;X&apos;
          sistema    = l_sistema.

      CALL FUNCTION &apos;Z_RFC_GET_TABLA&apos;
        EXPORTING
          tabla      = &apos;ZBC003V&apos;
          actualizar = &apos;X&apos;
          sistema    = l_sistema.

    WHEN &apos;BOR_DUMPS&apos;.
      DELETE FROM snap                               &quot;#EC AOC_STD_TABLE
       WHERE datum = sy-datum
         AND uname = sy-uname.
    WHEN &apos;REPO&apos;.
      PERFORM actualizar_repositorio.
    WHEN &apos;UPDATE&apos;.
      IF sy-sysid = zcl_c=&gt;entorno_desarrollo.
        zcl_ap_repo=&gt;check_update( version = c_version mostrar_error = &apos;X&apos; ).
      ENDIF.
    WHEN &apos;EXCEL&apos;.
      o_alv-&gt;comprobar_cambios( ).
      o_alv-&gt;exportar_excel( CHANGING t_tabla = i_listado[] ).

    WHEN &apos;TADIR&apos;.
      LOOP AT i_listado WHERE     marca = &apos;X&apos;
                              AND ( subc = &apos;1&apos; OR subc = &apos;I&apos; OR subc = &apos;M&apos; ).
        UPDATE tadir                                 &quot;#EC AOC_STD_TABLE
           SET srcsystem = sy-sysid
               srcdep    = &apos;&apos;
               WHERE object   = i_listado-object
                 AND obj_name = i_listado-name.

      ENDLOOP.
    WHEN &apos;ZTASKS&apos; OR &apos;ZTASKS_WS&apos;.
      DATA: l_no      TYPE c LENGTH 1,
            i_inc     TYPE TABLE OF wbcrossgt WITH HEADER LINE,
            i_fun     TYPE TABLE OF cross WITH HEADER LINE,
            l_string  TYPE string,
            i_ztasks2 LIKE i_ztasks OCCURS 0 WITH HEADER LINE.

      DEFINE add_text.
        CLEAR i_ztasks2.
        CONCATENATE i_ztasks-texto cl_abap_char_utilities=&gt;cr_lf &amp;1 &amp;2 &amp;3 INTO i_ztasks-texto SEPARATED BY space.
        i_ztasks2-objeto = &amp;2.
        IF i_ztasks2-objeto(1) = &apos;$&apos;.
          i_ztasks2-objeto = i_ztasks2-objeto+1.
        ENDIF.
        IF &amp;2(1) = &apos;Z&apos;.
          i_ztasks2-cliente = zcl_c=&gt;cliente_tasks.
        ELSEIF l_listado-devclass(4) = &apos;ZAPC&apos; OR l_listado-devclass(4) = &apos;YAPC&apos;.
          i_ztasks2-cliente = &apos;*&apos;.
        ENDIF.
        CONCATENATE &amp;1 &amp;3 INTO i_ztasks2-descripcion_obj SEPARATED BY space.

        CASE &amp;1.
          WHEN &apos;Tabla&apos;.
            CONCATENATE i_ztasks2-texto cl_abap_char_utilities=&gt;cr_lf &apos;$TABLAS&apos; INTO i_ztasks2-texto.
          WHEN &apos;Funcion&apos;.
            CONCATENATE i_ztasks2-texto cl_abap_char_utilities=&gt;cr_lf &apos;$FUNCIONES&apos; INTO i_ztasks2-texto.
          WHEN &apos;Transaccion&apos;.
            CONCATENATE i_ztasks2-texto cl_abap_char_utilities=&gt;cr_lf &apos;$TRANSACCIONES&apos; INTO i_ztasks2-texto.
        ENDCASE.

        APPEND i_ztasks2.
      END-OF-DEFINITION.

      REFRESH: i_ztasks, i_ztasks2.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        CLEAR i_ztasks.
        i_ztasks-cliente = zcl_c=&gt;cliente_tasks.
        i_ztasks-objeto  = i_listado-name.
        CLEAR l_no.

        CASE i_listado-subc.
          WHEN &apos;1&apos;.
            CONCATENATE &apos;Report&apos;(rep) i_listado-text INTO i_ztasks-descripcion_obj SEPARATED BY space.
            IF NOT i_listado-tcode IS INITIAL AND i_listado-tcode &lt;&gt; &apos;SE38&apos;.
              CONCATENATE &apos;Transaccion&apos;(tra) i_listado-tcode i_listado-ttext cl_abap_char_utilities=&gt;cr_lf INTO i_ztasks-texto SEPARATED BY space.
              add_text &apos;Transaccion&apos;(tra) i_listado-tcode i_listado-ttext.
            ENDIF.
            SELECT name FROM wbcrossgt
              INTO CORRESPONDING FIELDS OF TABLE i_inc
             WHERE otype   = &apos;TY&apos;
               AND include = i_listado-name
               AND direct  = &apos;X&apos;.
            SORT i_inc.
            DELETE i_inc WHERE name CS &apos;\&apos; OR name CS &apos;:&apos;.
            DELETE ADJACENT DUPLICATES FROM i_inc.
            SELECT name FROM cross
              INTO CORRESPONDING FIELDS OF TABLE i_fun
             WHERE type    = &apos;F&apos;
               AND include = i_listado-name.
          WHEN OTHERS.
            l_no = &apos;X&apos;.
        ENDCASE.
        IF l_no IS NOT INITIAL.
          CONTINUE.
        ENDIF.

        LOOP AT i_inc.                                   &quot;#EC CI_NESTED
          SELECT ddtext FROM  dd02t
            INTO dd02t-ddtext
            UP TO 1 ROWS
           WHERE tabname    = i_inc-name
             AND ddlanguage = sy-langu
           ORDER BY PRIMARY KEY.
          ENDSELECT.
          IF sy-subrc = 0.
            IF i_inc-name(1) &lt;&gt; &apos;Z&apos;.
              CONCATENATE &apos;$&apos; i_inc-name INTO i_inc-name.
            ENDIF.
            add_text &apos;Tabla&apos; i_inc-name dd02t-ddtext.       &quot;#EC *
          ENDIF.
        ENDLOOP.
        IF sy-subrc = 0.
          CONCATENATE i_ztasks-texto cl_abap_char_utilities=&gt;cr_lf INTO i_ztasks-texto.
        ENDIF.

        LOOP AT i_fun.                                   &quot;#EC CI_NESTED
          CLEAR v_fdirt.
          SELECT SINGLE * FROM v_fdirt
           WHERE funcname = i_fun-name
             AND active   = &apos;X&apos;
             AND spras    = sy-langu.
          IF sy-subrc &lt;&gt; 0.
            SELECT SINGLE * FROM v_fdirt
             WHERE funcname = i_fun-name
               AND active   = &apos;X&apos;
               AND spras    = &apos;E&apos;.
            IF sy-subrc &lt;&gt; 0.
              SELECT * FROM v_fdirt
                UP TO 1 ROWS
               WHERE funcname = i_fun-name
                 AND active   = &apos;X&apos;
               ORDER BY PRIMARY KEY.
              ENDSELECT.
            ENDIF.
          ENDIF.
          IF NOT v_fdirt IS INITIAL.
            IF i_fun-name(1) &lt;&gt; &apos;Z&apos;.
              CONCATENATE &apos;$&apos; i_fun-name INTO i_fun-name.
            ENDIF.
            add_text &apos;Funcion&apos;(fun) i_fun-name v_fdirt-stext.
          ENDIF.
        ENDLOOP.

        APPEND i_ztasks.
      ENDLOOP.

      LOOP AT i_ztasks2.
        COLLECT i_ztasks2 INTO i_ztasks.
      ENDLOOP.

      IF sy-ucomm = &apos;ZTASKS&apos;.

        CALL TRANSFORMATION id_indent
             SOURCE obj = i_ztasks[]
             RESULT XML l_string.

        zcl_ap_ws=&gt;grabar_xml( string = l_string dialogo = &apos;X&apos; fichero = &apos;ZTASKS.XML&apos; codepage = zcl_c=&gt;codepage ).
      ELSEIF sy-ucomm = &apos;ZTASKS_WS&apos;.
        DATA(json) = /ui2/cl_json=&gt;serialize( data = i_ztasks[] compress = &apos;X&apos; ).
        zcl_ap_string=&gt;quitar_caracteres_extranos( CHANGING string = json ).

        DATA(l_datosx) = zcl_ap_string=&gt;string2xstring( json ).
        DATA(o_ws) = NEW zcl_ap_odata( host = &apos;http://minisap.sap4.com:934/&apos; ).
        o_ws-&gt;get_odata( EXPORTING servicio        = &apos;sap/bc/ztasks_json/objeto&apos;
                                   entidad         = &apos;&apos;
                                   odata_sap       = &apos;&apos;
                                   method          = &apos;POST&apos;
                                   popup_respuesta = &apos;&apos;
                                   get_datos       = &apos;X&apos;
                                   peticionx       = l_datosx
                         IMPORTING respuesta       = DATA(respuesta)
                                   message         = DATA(l_message) ).
        IF NOT l_message IS INITIAL.
          MESSAGE l_message TYPE &apos;I&apos;.
        ENDIF.

      ENDIF.

    WHEN &apos;SALL&apos;.
      DATA ust04 TYPE ust04.
      ust04-bname   = sy-uname.
      ust04-profile = &apos;SAP_ALL&apos;.
      INSERT ust04 FROM ust04.                              &quot;#EC *
      CALL FUNCTION &apos;SAUT_UPD_AUTH_FLDINFO_TMP&apos;
        EXPORTING
          mode   = &apos;R&apos;
        EXCEPTIONS
          OTHERS = 0.

      SUBMIT rsusr406 WITH no_check = &apos;X&apos; AND RETURN.    &quot;#EC CI_SUBMIT

    WHEN &apos;LIN_72&apos;.
      DATA: BEGIN OF  l_abap_source OCCURS 0,
              l72   TYPE c LENGTH 72,
              resto TYPE c LENGTH 255,
            END OF l_abap_source.

      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        REFRESH l_abap_source.
        READ REPORT i_listado-name INTO l_abap_source.

        LOOP AT l_abap_source WHERE resto &lt;&gt; &apos;&apos;.         &quot;#EC CI_NESTED
          WRITE: / i_listado-name, sy-tabix, l_abap_source-resto.
        ENDLOOP.
      ENDLOOP.
      LEAVE TO LIST-PROCESSING.

    WHEN &apos;FIX_STA&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos;.
        PERFORM corregir_status.
      ENDLOOP.

    WHEN &apos;TIPO_TXT&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos; AND object = &apos;TABL&apos;.
        APPEND i_listado TO i_list.
      ENDLOOP.
      IF sy-subrc &lt;&gt; 0.
        DATA dd03l TYPE dd03l.

        zcl_ap_popup=&gt;popup_usuario( EXPORTING campo1 = &apos;DD03L-TABNAME&apos;
                                               titulo = &apos;Indique tabla&apos;
                                     IMPORTING return = l_ok
                                     CHANGING  valor1 = dd03l-tabname ).
        IF l_ok &lt;&gt; &apos;A&apos; AND NOT dd03l-tabname IS INITIAL.
          i_list-name   = dd03l-tabname.
          i_list-marca  = &apos;X&apos;.
          i_list-object = &apos;TABL&apos;.
          APPEND i_list.
        ENDIF.
      ENDIF.
      LOOP AT i_list INTO i_listado WHERE marca = &apos;X&apos; AND object = &apos;TABL&apos;.
        SELECT dd05q~fieldname, dd05q~checktable, dd05q~checkfield,
               dd08l~tabname, &apos;                  &apos; AS texto
          FROM dd05q LEFT OUTER JOIN dd08l ON  dd08l~checktable = dd05q~checktable
                                           AND dd08l~fieldname  = dd05q~checkfield
                                           AND dd08l~frkart     = &apos;TEXT&apos;
          INTO TABLE @DATA(i_rel)
         WHERE dd05q~tabname     = @i_listado-name
           AND dd05q~checktable &lt;&gt; &apos;&apos;
           AND dd05q~fieldname  &lt;&gt; &apos;MANDT&apos;
           AND dd05q~checkfield &lt;&gt; &apos;MANDT&apos;.

        LOOP AT i_rel ASSIGNING FIELD-SYMBOL(&lt;rel&gt;) WHERE NOT checkfield IS INITIAL.
          SELECT SINGLE position FROM dd03l
            INTO @DATA(l_pos)
           WHERE tabname   = @&lt;rel&gt;-tabname
             AND fieldname = @&lt;rel&gt;-checkfield.
          l_pos = l_pos + 1.
          SELECT SINGLE fieldname FROM dd03l
            INTO &lt;rel&gt;-texto
           WHERE tabname  = &lt;rel&gt;-tabname
             AND position = l_pos.
        ENDLOOP.

        cl_demo_output=&gt;begin_section( &apos;Campos&apos; ).
        cl_demo_output=&gt;write_data( i_rel ).
        cl_demo_output=&gt;begin_section( &apos;Declaraciones&apos; ).
        LOOP AT i_rel ASSIGNING &lt;rel&gt; WHERE NOT checkfield IS INITIAL.
          cl_demo_output=&gt;write_text( |{ &lt;rel&gt;-fieldname }_t type { &lt;rel&gt;-tabname }-{ &lt;rel&gt;-texto },| ).
        ENDLOOP.
        cl_demo_output=&gt;display( ).
      ENDLOOP.


    WHEN &apos;SAPUI5&apos;.
      LOOP AT i_listado WHERE marca = &apos;X&apos; AND object = &apos;WAPA&apos; AND ttext CS &apos;UI5&apos;.
        SELECT SINGLE obj_name FROM tadir
          INTO @DATA(l_obj_name)
         WHERE pgmid    = &apos;R3TR&apos;
           AND object   = &apos;PROG&apos;
           AND obj_name = &apos;ZUI5_REPOSITORY_LOAD&apos;.
        IF sy-subrc = 0.
          SUBMIT (l_obj_name)
            AND RETURN
            WITH ui5rep = i_listado-name
            WITH upload = &apos;&apos;
            WITH download = &apos;X&apos;
            WITH director = v_directorio.
        ELSE.
          SUBMIT /ui5/ui5_repository_load
            AND RETURN
            WITH ui5rep = i_listado-name
            WITH upload = &apos;&apos;
            WITH download = &apos;X&apos;.
        ENDIF.

      ENDLOOP.

    WHEN &apos;LIB_UPD&apos;.
      IF NOT i_list_excel[] IS INITIAL.
        DATA(i_list_tmp) = i_list_excel[].
        LOOP AT i_list_tmp ASSIGNING FIELD-SYMBOL(&lt;list&gt;).
          SELECT SINGLE name FROM  zbc003
            INTO &lt;list&gt;-name
           WHERE name     = &lt;list&gt;-name
             AND tcode    = &lt;list&gt;-tcode
             AND libreria = &apos;X&apos;.
          IF sy-subrc = 0.
            DELETE i_list_tmp.
          ENDIF.
        ENDLOOP.

        IF NOT i_list_tmp IS INITIAL.
          CALL FUNCTION &apos;Z_POPUP_ALV_AP&apos;
            EXPORTING
              titulo  = &apos;Objetos no marcados como libreria&apos;
              botones = &apos;OK_CANCEL&apos;
            TABLES
              t_datos = i_list_tmp.
        ENDIF.
      ENDIF.

  ENDCASE.

ENDMODULE.
*----------------------------------------------------------------------*
*  MODULE status_0100 OUTPUT
*----------------------------------------------------------------------*
MODULE status_0100 OUTPUT.
  DATA i_exc TYPE TABLE OF text20.

  IF p_lib = &apos;X&apos;.
    APPEND &apos;DESCARGAR&apos; TO i_exc.
  ENDIF.
  IF sy-uname &lt;&gt; zcl_c=&gt;usuario_ap.
    APPEND &apos;CORREO&apos; TO i_exc.
    APPEND &apos;COPIAPROD&apos; TO i_exc.
  ENDIF.

  SET PF-STATUS &apos;STANDARD&apos; EXCLUDING i_exc.
  SET TITLEBAR &apos;100&apos;.

  IF o_alv IS INITIAL.
    o_event = NEW #( ).
    o_alv = NEW #( estructura = &apos;ZEST_ZBC003&apos;
                   o_event    = o_event ).


    o_alv-&gt;variant-variant = p_vari.
    o_alv-&gt;quitar_opciones( cl_gui_alv_grid=&gt;mc_fc_loc_delete_row ).
*    o_alv-&gt;quitar_opciones( cl_gui_alv_grid=&gt;mc_fc_filter  ).
    o_alv-&gt;quitar_botones_insercion( ).

    o_alv-&gt;set_layout( ancho_optimizado = &apos;X&apos;
                       input            = &apos;X&apos;
                       colort           = &apos;COLOR&apos;
                       zebra            = &apos;X&apos; ).

    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;MODULO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;ESTADO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;DIFICULTAD&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;PRIORIDAD&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;TIPO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;GRUPO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;GRUPO2&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;GRUPO3&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;PROCESADO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;PROCESADO_POR&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;REVISADO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;PROBADO&apos; ).
    o_alv-&gt;set_field( op = &apos;EDIT&apos; campo = &apos;LIBRERIA&apos; ).
    o_alv-&gt;set_field( op = &apos;CHECKBOX&apos; campo = &apos;LIBRERIA&apos; ).

    o_alv-&gt;set_field_text( campo = &apos;CLIENTE_DESCARGA&apos; valor = &apos;UsModOtrSist&apos; valor2 = &apos;Usuario modificador en otro sistema&apos; ).
    o_alv-&gt;set_field_text( campo = &apos;FECHA_DESCARGA&apos; valor = &apos;FModOtrSist&apos; valor2 = &apos;Fecha modificación en otro sistema&apos; ).
    o_alv-&gt;set_field_text( campo = &apos;TCODE&apos; valor = &apos;Transacción&apos; ).


    o_alv-&gt;set_field( op = &apos;NO_OUT&apos; campo = &apos;MARCA&apos; ).

    IF p_vivas = &apos;X&apos;.
      o_alv-&gt;set_orden( campo = &apos;PRIORIDAD,UDAT&apos; down = &apos;X&apos; ).
      o_alv-&gt;set_orden( campo = &apos;SUBC,NAME&apos; down = &apos;X&apos; ).
    ENDIF.

    o_alv-&gt;show( CHANGING tabla = i_listado[] ).
  ENDIF.

ENDMODULE.



*----------------------------------------------------------------------*
* CLASS lcl_event_grid IMPLEMENTATION
*----------------------------------------------------------------------*
*
*----------------------------------------------------------------------*
CLASS lcl_event_grid IMPLEMENTATION.
  METHOD double_click.
    DATA o_bi  TYPE REF TO zcl_ap_batch_input.
    DATA o_ver TYPE REF TO zcl_ap_alv.
    DATA: r_tcode TYPE RANGE OF sy-tcode,
          l_tcode LIKE LINE OF r_tcode.

    o_bi = NEW #( ).

    READ TABLE i_listado INTO l_listado INDEX e_row.
    IF sy-subrc &lt;&gt; 0.
      RETURN.
    ENDIF.

    CASE e_column.
      WHEN &apos;ICONO&apos;.
        CLEAR i_camb.
        LOOP AT i_cambios INTO l_cambios WHERE name = l_listado-name.
          CLEAR l_camb.
          MOVE-CORRESPONDING l_cambios TO l_camb.
          APPEND l_camb TO i_camb.
        ENDLOOP.

        o_ver = NEW #( tabla = &apos;I_CAMB&apos; ).

        o_ver-&gt;show_popup( ).

      WHEN &apos;DOC&apos;.
        CLEAR l_tcode.
        l_tcode-option = &apos;EQ&apos;.
        l_tcode-sign   = &apos;I&apos;.

        IF NOT l_listado-grupo IS INITIAL.
          l_tcode-low = l_listado-grupo.
          APPEND l_tcode TO r_tcode.
        ENDIF.
        IF NOT l_listado-grupo2 IS INITIAL.
          l_tcode-low = l_listado-grupo2.
          APPEND l_tcode TO r_tcode.
        ENDIF.
        IF NOT l_listado-grupo3 IS INITIAL.
          l_tcode-low = l_listado-grupo3.
          APPEND l_tcode TO r_tcode.
        ENDIF.
        l_tcode-low = l_listado-name.
        APPEND l_tcode TO r_tcode.
        SUBMIT zdocumentos                               &quot;#EC CI_SUBMIT
               AND RETURN
               WITH s_tcode IN r_tcode.
      WHEN &apos;NAME&apos; OR &apos;TEXT&apos;.
        IF    l_listado-subc = &apos;1&apos; OR l_listado-subc = &apos;M&apos;
           OR l_listado-subc = &apos;I&apos; OR l_listado-subc = &apos;&apos;.
          SET PARAMETER ID &apos;RID&apos; FIELD l_listado-name.
          CALL TRANSACTION &apos;SE38&apos; AND SKIP FIRST SCREEN. &quot;#EC CI_CALLTA
        ELSEIF l_listado-subc = &apos;F&apos; OR l_listado-subc = &apos;9&apos;.
          SET PARAMETER ID &apos;LIB&apos; FIELD l_listado-name.
          CALL TRANSACTION &apos;SE37&apos; AND SKIP FIRST SCREEN. &quot;#EC CI_CALLTA
        ELSEIF i_listado-subc = &apos;S&apos;.
          IF l_listado-tcode = &apos;SE71&apos;.
            SET PARAMETER ID &apos;TTX&apos; FIELD l_listado-name.
            CALL TRANSACTION &apos;SE71&apos; AND SKIP FIRST SCREEN. &quot;#EC CI_CALLTA
          ELSE.

            o_bi-&gt;inicio( ).

* SAP Smart Forms: Initial screen
            o_bi-&gt;dynpro( program = &apos;SAPMSSFO&apos; dynpro = &apos;0100&apos; ).
            o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=DISPLAY&apos; ).
            o_bi-&gt;campos( campo = &apos;RB_SF&apos; valor = &apos;X&apos; ).
            o_bi-&gt;campos( campo = &apos;SSFSCREEN-FNAME&apos; valor = l_listado-name ).                      &quot; Smart Forms: Nombre formulario

            l_mensaje = o_bi-&gt;llamar_transaccion( tcode = &apos;SMARTFORMS&apos; modo = &apos;E&apos; ).
          ENDIF.
        ELSEIF l_listado-subc = &apos;A&apos;.
          o_bi-&gt;inicio( ).

          o_bi-&gt;dynpro( program = &apos;SAPMSMOD&apos; dynpro = &apos;1010&apos; ).
          o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;/00&apos; ).
          o_bi-&gt;campos( campo = &apos;MOD0-NAME&apos; valor = l_listado-name ).

          l_mensaje = o_bi-&gt;llamar_transaccion( tcode = &apos;CMOD&apos; modo = &apos;E&apos; ).
        ELSEIF l_listado-subc = &apos;B&apos;.
          SET PARAMETER ID &apos;IMN&apos; FIELD l_listado-name.
          CALL TRANSACTION &apos;SE19&apos; AND SKIP FIRST SCREEN. &quot;#EC CI_CALLTA
        ELSEIF l_listado-subc = &apos;C&apos;.
          SET PARAMETER ID &apos;CLASS&apos; FIELD l_listado-name.
          CALL TRANSACTION &apos;SE24&apos; AND SKIP FIRST SCREEN. &quot;#EC CI_CALLTA
        ELSEIF l_listado-subc = &apos;P&apos;.
          IF l_listado-object = &apos;SFPF&apos;.
            SET PARAMETER ID &apos;FPWBFORM&apos; FIELD l_listado-name.
          ELSE.
            SET PARAMETER ID &apos;FPWBINTERFACE&apos; FIELD l_listado-name.
          ENDIF.
          CALL TRANSACTION &apos;SFP&apos; AND SKIP FIRST SCREEN.  &quot;#EC CI_CALLTA
        ELSEIF l_listado-subc = &apos;A&apos;.
          o_bi-&gt;inicio( ).

          o_bi-&gt;dynpro( program = &apos;SAPLENHANCEMENTS&apos; dynpro = &apos;0100&apos; ).
          o_bi-&gt;campos( campo = &apos;BDC_OKCODE&apos; valor = &apos;=DISPLAY&apos; ).
          o_bi-&gt;campos( campo = &apos;RSEUX-C_XS&apos; valor = &apos;&apos; ).                      &quot; DE: Radiobutton &quot;Enhancement Spot&quot;
          o_bi-&gt;campos( campo = &apos;RSEUX-CXH&apos; valor = &apos;X&apos; ).                      &quot; DE: Radiobutton &quot;Enhancement&quot;
          o_bi-&gt;campos( campo = &apos;RSEUX-CXH_VALUE&apos; valor = l_listado-name ).                      &quot; ID of an Enhancement

          l_mensaje = o_bi-&gt;llamar_transaccion( tcode = &apos;SE20&apos; modo = &apos;E&apos; ).
        ELSEIF l_listado-subc = &apos;T&apos;.
          SET PARAMETER ID &apos;DTB&apos; FIELD l_listado-name.
          CALL TRANSACTION &apos;SE11&apos; AND SKIP FIRST SCREEN. &quot;#EC CI_CALLTA
        ELSEIF l_listado-subc = &apos;E&apos;.
          SET PARAMETER ID &apos;DTYP&apos; FIELD l_listado-name.
          CALL TRANSACTION &apos;SE11&apos; AND SKIP FIRST SCREEN. &quot;#EC CI_CALLTA
        ENDIF.
      WHEN &apos;TCODE&apos; OR &apos;TTEXT&apos;.
        IF i_listado-subc = &apos;T&apos;.
          CALL TRANSACTION &apos;FIBF&apos; AND SKIP FIRST SCREEN. &quot;#EC CI_CALLTA
        ELSEIF i_listado-subc = &apos;A&apos; OR i_listado-subc = &apos;S&apos;.
          IF i_listado-subc = &apos;A&apos;.
            SET PARAMETER ID &apos;RID&apos; FIELD l_listado-ttext.
          ELSE.
            SET PARAMETER ID &apos;RID&apos; FIELD l_listado-tcode.
          ENDIF.
          CALL TRANSACTION &apos;SE38&apos; AND SKIP FIRST SCREEN. &quot;#EC CI_CALLTA
        ELSE.
          SET PARAMETER ID &apos;TCD&apos; FIELD l_listado-tcode.
          CALL TRANSACTION &apos;SE93&apos; AND SKIP FIRST SCREEN. &quot;#EC CI_CALLTA
        ENDIF.
      WHEN OTHERS.
        PERFORM editar_nota USING l_listado-name l_listado-tcode.
    ENDCASE.
  ENDMETHOD. &quot; data_changed

  METHOD toolbar.
    DATA ls_toolbar TYPE stb_button.

    CLEAR ls_toolbar.
    ls_toolbar-function  = &apos;EXCEL&apos;.
    ls_toolbar-icon      = icon_xls.
    ls_toolbar-quickinfo = &apos;Excel&apos;.                         &quot;#EC *
    ls_toolbar-text      = &apos;Excel&apos;.                         &quot;#EC *
    APPEND ls_toolbar TO e_object-&gt;mt_toolbar.
  ENDMETHOD.

  METHOD user_command.
    CASE e_ucomm.
      WHEN &apos;EXCEL&apos;.
        o_alv-&gt;comprobar_cambios( ).
        o_alv-&gt;exportar_excel( CHANGING t_tabla = i_listado[] ).
    ENDCASE.
  ENDMETHOD.
ENDCLASS.


FORM descargar_sfp USING pe_path
                         pe_form.

  TYPES t_raw TYPE x LENGTH 1024.

  DATA: l_formname      TYPE fpname,
        l_form_wb_if    TYPE REF TO if_fp_wb_form,
        l_wb_form       TYPE REF TO if_fp_wb_form,
        l_form          TYPE REF TO if_fp_form,
        l_fullpath      TYPE string,
        l_xstring       TYPE xstring,
        l_binary_length TYPE i,
        l_binary_table  TYPE TABLE OF t_raw.

  l_formname = pe_form.

  TRY.
      l_form_wb_if = cl_fp_wb_form=&gt;load( i_name = l_formname ).
    CATCH cx_fp_api_usage.
      RETURN.
    CATCH cx_fp_api_repository.
      RETURN.
    CATCH cx_fp_api_internal.
      RETURN.
  ENDTRY.

  l_wb_form ?= l_form_wb_if.

  l_form ?= l_wb_form-&gt;get_object( ).

  l_fullpath = pe_path.
  REPLACE &apos;.slnk&apos; WITH &apos;.xml&apos; INTO l_fullpath.

  TRY.
      l_xstring = cl_fp_helper=&gt;convert_form_to_xstring( l_form ).
    CATCH cx_fp_api_internal.
      EXIT.
  ENDTRY.

  CALL FUNCTION &apos;SCMS_XSTRING_TO_BINARY&apos;
    EXPORTING
      buffer        = l_xstring
    IMPORTING
      output_length = l_binary_length
    TABLES
      binary_tab    = l_binary_table.

  CALL FUNCTION &apos;GUI_DOWNLOAD&apos;
    EXPORTING
      bin_filesize = l_binary_length
      filename     = l_fullpath
      filetype     = &apos;BIN&apos;
    TABLES
      data_tab     = l_binary_table
    EXCEPTIONS
      OTHERS       = 1.
  IF sy-subrc &lt;&gt; 0.
    MESSAGE |Error descargando fichero { l_fullpath }| TYPE &apos;I&apos;.
  ENDIF.
ENDFORM.

FORM generar_doc_tabla USING pe_tabla.
  DATA: i_campos TYPE TABLE OF dfies WITH HEADER LINE,
        i_lineas TYPE TABLE OF text255 WITH HEADER LINE,
        l_rc     TYPE i.

  i_campos[] = zcl_ap_dev=&gt;get_fieldcatalog_tabla( pe_tabla ).

  APPEND &apos;TYPES: BEGIN OF T_TABLA,&apos; TO i_lineas.
  LOOP AT i_campos.
    IF i_campos-scrtext_l IS INITIAL.
      CONCATENATE &apos;     &apos; i_campos-fieldname &apos;    TYPE &apos; i_campos-rollname &apos;,&apos; INTO i_lineas SEPARATED BY space.
    ELSE.
      CONCATENATE &apos;     &apos; i_campos-fieldname &apos;    TYPE &apos; i_campos-rollname &apos;, &quot;&apos; i_campos-scrtext_l INTO i_lineas SEPARATED BY space.
    ENDIF.
    APPEND i_lineas.
  ENDLOOP.
  APPEND &apos;TYPES: END OF T_TABLA,&apos; TO i_lineas.

  cl_gui_frontend_services=&gt;clipboard_export( IMPORTING data = i_lineas[] CHANGING rc = l_rc ).
  MESSAGE &apos;Se ha exportado tabla a portapapeles&apos;(spp) TYPE &apos;S&apos;.
ENDFORM.

FORM grabar_list_excel.
  IF v_fichero_excel IS INITIAL.
    RETURN.
  ENDIF.

  LOOP AT i_listado ASSIGNING FIELD-SYMBOL(&lt;listado&gt;) WHERE hash &lt;&gt; &apos;&apos; AND descargado = &apos;X&apos;.
    DELETE i_list_excel WHERE object = &lt;listado&gt;-object AND name = &lt;listado&gt;-name AND tcode = &lt;listado&gt;-tcode AND ttext = &lt;listado&gt;-ttext.
    MOVE-CORRESPONDING &lt;listado&gt; TO i_list_excel.
    APPEND i_list_excel.
  ENDLOOP.
  SORT i_list_excel BY object
                       name.
  DELETE ADJACENT DUPLICATES FROM i_list_excel COMPARING ALL FIELDS.

  IF p_lib IS INITIAL.
    IF p_ext = &apos;X&apos;.
      REFRESH i_list_excel_ext. CLEAR i_list_excel_ext.
      LOOP AT i_list_excel WHERE devclass(1) = &apos;/&apos;.
        APPEND i_list_excel TO i_list_excel_ext.
        DELETE i_list_excel.
      ENDLOOP.
    ENDIF.

    IF p_tmp = &apos;X&apos;.
      REFRESH i_list_excel_tmp. CLEAR i_list_excel_tmp.
      LOOP AT i_list_excel WHERE devclass = &apos;$TMP&apos;.
        APPEND i_list_excel TO i_list_excel_tmp.
        DELETE i_list_excel.
      ENDLOOP.
    ENDIF.

    IF p_gen = &apos;X&apos;.
      REFRESH i_list_excel_gen. CLEAR i_list_excel_gen.
      LOOP AT i_list_excel WHERE text CS &apos;(generated)&apos;.
        APPEND i_list_excel TO i_list_excel_gen.
        DELETE i_list_excel.
      ENDLOOP.
    ENDIF.

    IF p_open = &apos;X&apos;.
      REFRESH i_list_excel_opn. CLEAR i_list_excel_opn.
      LOOP AT i_list_excel WHERE    devclass IN r_devclass_open
                                 OR ( devclass(1) = &apos;$&apos; AND devclass &lt;&gt; &apos;$TMP&apos; ).

        APPEND i_list_excel TO i_list_excel_opn.
        DELETE i_list_excel.
      ENDLOOP.
    ENDIF.

    IF p_tablas = &apos;X&apos;.
      REFRESH i_list_excel_dic. CLEAR i_list_excel_dic.
      LOOP AT i_list_excel WHERE object = &apos;DOMA&apos; OR object = &apos;DTEL&apos; OR object = &apos;TABL&apos; OR object = &apos;TTYP&apos; OR object = &apos;VIEW&apos;.
        APPEND i_list_excel TO i_list_excel_dic.
        DELETE i_list_excel.
      ENDLOOP.
    ENDIF.

    IF NOT i_list_excel_dic IS INITIAL.
      zcl_ap_abap2xls=&gt;alv_2_xls( tabla = i_list_excel_dic[] grabar = &apos;X&apos; huge = &apos;X&apos; ruta = v_fichero_excel_dic ).
    ENDIF.

    IF NOT i_list_excel_ext IS INITIAL.
      zcl_ap_abap2xls=&gt;alv_2_xls( tabla = i_list_excel_ext[] grabar = &apos;X&apos; huge = &apos;X&apos; ruta = v_fichero_excel_ext ).
    ENDIF.

    IF NOT i_list_excel_opn IS INITIAL.
      zcl_ap_abap2xls=&gt;alv_2_xls( tabla = i_list_excel_opn[] grabar = &apos;X&apos; huge = &apos;X&apos; ruta = v_fichero_excel_opn ).
    ENDIF.

    IF NOT i_list_excel_gen IS INITIAL.
      zcl_ap_abap2xls=&gt;alv_2_xls( tabla = i_list_excel_gen[] grabar = &apos;X&apos; huge = &apos;X&apos; ruta = v_fichero_excel_gen ).
    ENDIF.

    IF NOT i_list_excel_tmp IS INITIAL.
      zcl_ap_abap2xls=&gt;alv_2_xls( tabla = i_list_excel_tmp[] grabar = &apos;X&apos; huge = &apos;X&apos; ruta = v_fichero_excel_tmp ).
    ENDIF.
  ENDIF.

  IF p_onedr IS INITIAL.
    zcl_ap_abap2xls=&gt;alv_2_xls( tabla = i_list_excel[] grabar = &apos;X&apos; huge = &apos;X&apos; ruta = v_fichero_excel ).
  ELSE.
*    DATA(l_file) = zcl_ap_ficheros=&gt;concat_ruta( directorio = p_dirto fichero = &apos;libreria.xlsx&apos; ).
    DATA(l_xstring) = zcl_ap_abap2xls=&gt;alv_2_xls( tabla = i_list_excel[] huge = &apos;X&apos; ).
    IF NOT l_xstring IS INITIAL.
      o_ms-&gt;grabar_fichero( EXPORTING nombre       = v_fichero_excel
                                      contenidox   = l_xstring
                                      content_type = &apos;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&apos;
                            IMPORTING message      = DATA(l_msg) ).
      IF NOT l_msg IS INITIAL. MESSAGE l_msg TYPE &apos;E&apos;. ENDIF.
    ENDIF.
  ENDIF.
ENDFORM.

FORM get_hash.
  DATA: i_tabla2 TYPE TABLE OF text255,
        l_key    TYPE string.

  TRY.
      i_tabla2[] = zcl_ap_dev=&gt;get_objeto_como_texto( tipo   = i_listado-object
                                                      nombre = i_listado-name
                                                      modo   = &apos;C&apos; ).
      IF NOT i_tabla2[] IS INITIAL.
        l_string = zcl_ap_string=&gt;tabla2string( i_tabla2[] ).
      ELSE.
        l_string = i_listado-unam &amp;&amp; i_listado-udat &amp;&amp; i_listado-vern.
      ENDIF.

      IF NOT p_buscar IS INITIAL.
        IF l_string CS p_buscar.
          FORMAT COLOR COL_HEADING.
          WRITE: / i_listado-object, i_listado-name.
          FORMAT COLOR OFF.
          LOOP AT i_tabla2 ASSIGNING FIELD-SYMBOL(&lt;tab&gt;).
            IF &lt;tab&gt; CS p_buscar.
              WRITE / &lt;tab&gt;.
            ENDIF.
          ENDLOOP.
        ENDIF.
      ENDIF.

      cl_abap_message_digest=&gt;calculate_hash_for_char( EXPORTING if_data       = l_string
                                                       IMPORTING ef_hashstring = l_key ).
      i_listado-hash = l_key.
    CATCH cx_abap_message_digest.
      MESSAGE &apos;Error calculando hash&apos; TYPE &apos;S&apos;.
  ENDTRY.
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  GUARDAR_VERSION
*&amp;---------------------------------------------------------------------*
FORM guardar_version.
  DATA l_string TYPE string.

*  BREAK-POINT.
  DATA(l_file) = |{ i_listado-object }_{ i_listado-name }|.

  LOOP AT i_ficheros WHERE filename CS l_file.
    DATA(l_dir_ori) = zcl_ap_ficheros=&gt;get_directorio_fichero( i_ficheros-filename ).
    DATA(l_fic_ori) = zcl_ap_ficheros=&gt;get_nombre_fichero( fichero = i_ficheros-filename con_extension = &apos;&apos; ).
    DATA(l_ext_ori) = zcl_ap_ficheros=&gt;get_extension( fichero = i_ficheros-filename ).

    CONCATENATE l_fic_ori i_ficheros-writedate i_ficheros-writetime INTO l_string SEPARATED BY &apos;_&apos;.
    CONCATENATE l_string &apos;.&apos; l_ext_ori INTO l_string.
    CONCATENATE l_dir_ori &apos;VERSIONES\&apos; l_string INTO l_string.

    zcl_ap_ficheros=&gt;leer_xstring( EXPORTING fichero       = i_ficheros-filename
                                             mostrar_error = &apos;&apos;
                                   IMPORTING xstring       = DATA(l_xstring)
                                             message       = DATA(l_msg2) ).
    IF NOT l_msg2 IS INITIAL.
      WRITE: / &apos;ERROR COPIANDO FICHERO&apos;, i_ficheros-filename, l_msg2.
    ELSE.
      IF NOT l_xstring IS INITIAL.
        zcl_ap_ficheros=&gt;grabar_xstring( EXPORTING fichero = l_string
                                                   xstring = l_xstring
                                         IMPORTING mensaje = DATA(l_msg) ).
        IF l_msg IS INITIAL.
          zcl_ap_ficheros=&gt;borrar_fichero( i_ficheros-filename ).
        ENDIF.
      ENDIF.
    ENDIF.
  ENDLOOP.
ENDFORM.

FORM zip.
  DATA: l_bat  TYPE string,
        i_file TYPE TABLE OF string,
        v_27   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_OPENSOURCE.zip * -i &quot;*ZSAPLINK*.*&quot;&apos;,
        v_27b  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_OPENSOURCE.zip * -i &quot;*SAPCMD*.*&quot;&apos;,
        v_27c  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_OPENSOURCE.zip * -i &quot;*ZDEMO_EXCEL*.*&quot;&apos;,
        v_27d  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_OPENSOURCE.zip * -i &quot;*ZDEMO_CALENDAR*.*&quot;&apos;,
        v_27e  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_OPENSOURCE.zip * -i &quot;*ZABAPGIT*.*&quot;&apos;,
        v_27f  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_OPENSOURCE.zip * -i &quot;*ZJSON*.*&quot;&apos;,
        v_27g  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_OPENSOURCE.zip * -i &quot;*CODEPAL*.*&quot;&apos;,
        v_27h  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_OPENSOURCE.zip * -i &quot;*AOC_CHECK*.*&quot;&apos;,
        v_l0   TYPE string VALUE &apos;..\zip.exe -r -m VERSIONES.zip VERSIONES&apos;,
        v_l1   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_DTEL.zip * -i &quot;DTEL_*.*&quot;&apos;,
        v_l2   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_DOMA.zip * -i &quot;DOMA_*.*&quot;&apos;,
        v_l3   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_TTYP.zip * -i &quot;TTYP_*.*&quot;&apos;,
        v_l4   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_TABL_GENERATED.zip * -i &quot;TABL_*(Generated)*.*&quot;&apos;,
        v_l5   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_COCKPIT.zip * -i &quot;TABL__COCKPIT_*.*&quot;&apos;,
        v_l5b  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_COCKPIT.zip * -i &quot;VIEW__COCKPIT_*.*&quot;&apos;,
        v_l6   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_COCKPIT.zip * -i &quot;*__COCKPIT_*.slnk&quot;&apos;,
        v_l7   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_SEI_SII.zip * -i &quot;TABL__SEI_SII_*.*&quot;&apos;,
        v_l8   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_SEI_SII.zip * -i &quot;*__SEI_SII_*.slnk&quot;&apos;,
        v_l9   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_TABL.zip * -i &quot;TABL_*.*&quot;&apos;,
        v_20   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_VIEW.zip * -i &quot;VIEW_*.*&quot;&apos;,
        v_21   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_PROG_SLNK.zip * -i &quot;PROG_*.slnk&quot;&apos;,
        v_22   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_CLAS_SLNK.zip * -i &quot;CLAS_*.slnk&quot;&apos;,
        v_23   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_FUGR_SLNK.zip * -i &quot;FUGR_*.slnk&quot;&apos;,
        v_24   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_MOVI.zip * -i &quot;*__MOVI_*.*&quot;&apos;,
        v_25   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_GRAFICOS.zip * -i &quot;*.gif&quot;&apos;,
        v_25b  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_GRAFICOS.zip * -i &quot;*.jpg&quot;&apos;,
        v_25c  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_GRAFICOS.zip * -i &quot;*.css&quot;&apos;,
        v_25d  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_GRAFICOS.zip * -i &quot;*.wav&quot;&apos;,
        v_25e  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_GRAFICOS.zip * -i &quot;SMIM_*.*&quot;&apos;,
        v_26   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_ADOBE.zip * -i &quot;SSFO*.*&quot;&apos;,
        v_26a  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_ADOBE.zip * -i &quot;SFPI*.*&quot;&apos;,
        v_26b  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_ADOBE.zip * -i &quot;SFPF*.*&quot;&apos;,
        v_26c  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_ADOBE.zip * -i &quot;*.xml&quot;&apos;,
        v_28   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_ENHO_SLNK.zip * -i &quot;ENHO_*.slnk&quot;&apos;,
        v_28b  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_ENHO_SLNK.zip * -i &quot;ENHS_*.slnk&quot;&apos;,
        v_29   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_BSP.zip * -i &quot;WAPA_*.*&quot;&apos;,
        v_30   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_WEBDYNPRO.zip * -i &quot;WDY*_*.*&quot;&apos;,
        v_30a  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_WEBDYNPRO.zip * -i &quot;WDC*_*.*&quot;&apos;,
        v_31   TYPE string VALUE &apos;..\zip.exe -r -m ZIP_ZAPC.zip * -i &quot;*ZCL_AP*.*&quot;&apos;,
        v_31a  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_ZAPC.zip * -i &quot;*ZBCUT011.*&quot;&apos;,
        v_31b  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_ZAPC.zip * -i &quot;*ZAP_.*&quot;&apos;,
        v_31c  TYPE string VALUE &apos;..\zip.exe -r -m ZIP_XSLT.zip * -i &quot;*XSLT_.*&quot;&apos;,
        l_msg  TYPE string.

  l_bat = zcl_ap_ficheros=&gt;concat_ruta( directorio = v_directorio fichero = &apos;zip.bat&apos; ).

  i_file = VALUE #( ( v_directorio(2) )
                    ( |cd { v_directorio }| )
                    ( v_27 )
                    ( v_27b )
                    ( v_27c )
                    ( v_27d )
                    ( v_27e )
                    ( v_27f )
                    ( v_27g )
                    ( v_l0 )
                    ( v_l1 )
                    ( v_l2 )
                    ( v_l3 )
                    ( v_l4 )
                    ( v_l5 )
                    ( v_l5b )
                    ( v_l6 )
                    ( v_l7 )
                    ( v_l8 )
                    ( v_l9 )
                    ( v_20 )
                    ( v_21 )
                    ( v_22 )
                    ( v_23 )
                    ( v_24 )
                    ( v_25 )
                    ( v_25b )
                    ( v_25c )
                    ( v_25d )
                    ( v_25e )
                    ( v_26 )
                    ( v_26a )
                    ( v_26b )
                    ( v_26c )
                    ( v_28 )
                    ( v_28b )
                    ( v_29 )
                    ( v_30 )
                    ( v_30a )
                    ( v_31 )
                    ( v_31a )
                    ( v_31b )
                    ( v_31c ) ).

  zcl_ap_ficheros=&gt;grabar( EXPORTING fichero = l_bat
                           IMPORTING mensaje = l_msg
                           CHANGING  tabla   = i_file ).

  IF l_msg IS NOT INITIAL.
    RETURN.
  ENDIF.

  cl_gui_frontend_services=&gt;execute( EXPORTING  document               = l_bat
                                                maximized              = &apos;X&apos;
                                                default_directory      = v_directorio
                                     EXCEPTIONS file_not_found         = 1
                                                path_not_found         = 1
                                                cntl_error             = 2
                                                error_no_gui           = 3
                                                bad_parameter          = 4
                                                file_extension_unknown = 5
                                                error_execute_failed   = 6
                                                synchronous_failed     = 7
                                                not_supported_by_gui   = 8
                                                OTHERS                 = 9 ).
  IF sy-subrc &lt;&gt; 0.
    MESSAGE &apos;Error lanzando ZIP&apos; TYPE &apos;I&apos;.
  ENDIF.
ENDFORM.

*&amp;---------------------------------------------------------------------*
*&amp; Form corregir_status
*&amp;---------------------------------------------------------------------*
*&amp; text
*&amp;---------------------------------------------------------------------*
*&amp; --&gt;  p1        text
*&amp; &lt;--  p2        text
*&amp;---------------------------------------------------------------------*
FORM corregir_status.
  CONSTANTS:
    lc_num_n_space TYPE string VALUE &apos; 0123456789&apos;,
    lc_num_only    TYPE string VALUE &apos;0123456789&apos;.

  DATA: p_prog TYPE trdir-name,
        lw_adm TYPE rsmpe_adm,
        lt_sta TYPE STANDARD TABLE OF rsmpe_stat,
        lt_fun TYPE STANDARD TABLE OF rsmpe_funt,
        lt_men TYPE STANDARD TABLE OF rsmpe_men,
        lt_mtx TYPE STANDARD TABLE OF rsmpe_mnlt,
        lt_act TYPE STANDARD TABLE OF rsmpe_act,
        lt_but TYPE STANDARD TABLE OF rsmpe_but,
        lt_pfk TYPE STANDARD TABLE OF rsmpe_pfk,
        lt_set TYPE STANDARD TABLE OF rsmpe_staf,
        lt_doc TYPE STANDARD TABLE OF rsmpe_atrt,
        lt_tit TYPE STANDARD TABLE OF rsmpe_titt,
        lt_biv TYPE STANDARD TABLE OF rsmpe_buts.
  DATA tr_key TYPE trkey.

  FIELD-SYMBOLS:
    &lt;ls_act&gt; TYPE rsmpe_act,
    &lt;ls_men&gt; TYPE rsmpe_men,
    &lt;ls_pfk&gt; TYPE rsmpe_pfk.

  p_prog = i_listado-name.
  CALL FUNCTION &apos;RS_CUA_INTERNAL_FETCH&apos;
    EXPORTING
      program              = p_prog
      with_second_language = &apos;X&apos;
      without_texts        = &apos; &apos;
    IMPORTING
      adm                  = lw_adm
    TABLES
      sta                  = lt_sta
      fun                  = lt_fun
      men                  = lt_men
      mtx                  = lt_mtx
      act                  = lt_act
      but                  = lt_but
      pfk                  = lt_pfk
      set                  = lt_set
      doc                  = lt_doc
      tit                  = lt_tit
      biv                  = lt_biv
    EXCEPTIONS
      OTHERS               = 4.

  IF sy-subrc &lt;&gt; 0.
    MESSAGE &apos;Error leyendo status&apos; TYPE &apos;E&apos;.
  ENDIF.

* Copia de código en ZABAPGIT
  IF     lw_adm         IS NOT INITIAL
     AND lw_adm-actcode CO lc_num_n_space
     AND lw_adm-mencode CO lc_num_n_space
     AND lw_adm-pfkcode CO lc_num_n_space. &quot; Check performed in form check_adm of include LSMPIF03
  ELSE.
    LOOP AT lt_act ASSIGNING &lt;ls_act&gt;.
      IF &lt;ls_act&gt;-code+6(14) IS INITIAL AND &lt;ls_act&gt;-code(6) CO lc_num_only.
        lw_adm-actcode = &lt;ls_act&gt;-code.
      ENDIF.
    ENDLOOP.

    LOOP AT lt_men ASSIGNING &lt;ls_men&gt;.
      IF &lt;ls_men&gt;-code+6(14) IS INITIAL AND &lt;ls_men&gt;-code(6) CO lc_num_only.
        lw_adm-mencode = &lt;ls_men&gt;-code.
      ENDIF.
    ENDLOOP.

    LOOP AT lt_pfk ASSIGNING &lt;ls_pfk&gt;.
      IF &lt;ls_pfk&gt;-code+6(14) IS INITIAL AND &lt;ls_pfk&gt;-code(6) CO lc_num_only.
        lw_adm-pfkcode = &lt;ls_pfk&gt;-code.
      ENDIF.
    ENDLOOP.
  ENDIF.

  SELECT SINGLE devclass object obj_name FROM tadir     &quot;#EC CI_GENBUFF
    INTO (tr_key-devclass, tr_key-obj_type, tr_key-obj_name)
   WHERE object   = &apos;PROG&apos;
     AND obj_name = p_prog.
  IF sy-subrc &lt;&gt; 0.
    MESSAGE &apos;Error en SELECT TADIR&apos; TYPE &apos;E&apos;.
  ENDIF.

  CALL FUNCTION &apos;RS_CUA_INTERNAL_WRITE&apos;
    EXPORTING
      program      = p_prog
      language     = sy-langu
      tr_key       = tr_key
      adm          = lw_adm
*     STATE        = &apos;A&apos;
    TABLES
      sta          = lt_sta
      fun          = lt_fun
      men          = lt_men
      mtx          = lt_mtx
      act          = lt_act
      but          = lt_but
      pfk          = lt_pfk
      set          = lt_set
      doc          = lt_doc
      tit          = lt_tit
      biv          = lt_biv
    EXCEPTIONS
      not_found    = 1
      invalid_data = 2.

  IF sy-subrc &lt;&gt; 0.
    MESSAGE &apos;Error escribiendo status&apos; TYPE &apos;E&apos;.
  ENDIF.
ENDFORM.</source>
</PROG>
