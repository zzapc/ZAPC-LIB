class ZCL_AP_BSP definition
  public
  create public .

public section.

  class-methods GET_URL_BSP
    importing
      !BSP type ANY
      !INICIO type ANY default 'index.htm'
      !PAR1 type ANY optional
      !PAR1_VALOR type ANY optional
    preferred parameter BSP
    returning
      value(URL) type STRING .
  class-methods EJECUTA_BSP
    importing
      !BSP type ANY
      !INICIO type ANY default 'index.htm' .
protected section.
private section.
endclass. "ZCL_AP_BSP definition
class ZCL_AP_BSP implementation.
method EJECUTA_BSP.
  DATA l_ruta TYPE TEXT255.

  l_ruta = get_url_bsp( bsp = bsp inicio = inicio ).

  CALL FUNCTION 'CALL_BROWSER'
    EXPORTING
      url                    = l_ruta
      window_name            = 'BSP'
      new_window             = ' '
    EXCEPTIONS
      frontend_not_supported = 1
      frontend_error         = 2
      prog_not_found         = 3
      no_batch               = 4
      unspecified_error      = 5
      OTHERS                 = 6.

endmethod.
METHOD get_url_bsp.
  DATA: l_abs_url   TYPE string,
        l_local_url TYPE string,
        l_host      TYPE string,
        l_port      TYPE string,
        l_protocol  TYPE string,
        l_bsp_start_parameters TYPE tihttpnvp,
        l_parametros TYPE ihttpnvp.

  if not par1 is initial.
    clear l_parametros.
    l_parametros-name  = par1.
    l_parametros-value = par1_valor.
    append l_parametros to l_bsp_start_parameters.
  endif.

  CALL METHOD cl_http_ext_webapp=>create_url_for_bsp_application
    EXPORTING
*         BSP_PROTOCOL         =
*         BSP_SERVICE          =
      bsp_application      = bsp
      bsp_start_page       = inicio
      bsp_start_parameters = l_bsp_start_parameters
    IMPORTING
      local_url            = l_local_url
      abs_url              = url
      host                 = l_host
      port                 = l_port
      protocol             = l_protocol.

*  IF NOT par1 IS INITIAL.
*    CONCATENATE url '?' par1 '=' par1_valor INTO url.
*  ENDIF.

ENDMETHOD.
endclass. "ZCL_AP_BSP implementation