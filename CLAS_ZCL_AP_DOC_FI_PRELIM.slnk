<?xml version="1.0" encoding="utf-16"?>
<CLAS CLSNAME="ZCL_AP_DOC_FI_PRELIM" VERSION="1" LANGU="S" DESCRIPT="Documentos FI preliminares" UUID="E1677AB67F3CCCF18C5F0050568D3DE9" CATEGORY="00" EXPOSURE="2" STATE="1" RELEASE="0" AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" CHGDANYON="00000000" CLSFINAL="X" CLSCCINCL="X" FIXPT="X" UNICODE="X" R3RELEASE="700" CLSBCCAT="00" DURATION_TYPE="0 " RISK_LEVEL="0 ">
 <publicSection>class ZCL_AP_DOC_FI_PRELIM definition
  public
  final
  create public .

*&quot;* public components of class ZCL_AP_DOC_FI_PRELIM
*&quot;* do not include other source files here!!!
public section.

  data BKPF type BKPF .

  class ZCL_C definition load .
  class-methods GET_BKPF
    importing
      !BUKRS type BKPF-BUKRS default ZCL_C=&gt;BUKRS
      !BELNR type BKPF-BELNR
      !GJAHR type BKPF-GJAHR
    returning
      value(BKPF) type BKPF .
  class-methods INSERTAR_URL_GOS_ST
    importing
      !BUKRS type BKPF-BUKRS default ZCL_C=&gt;BUKRS
      !BELNR type BKPF-BELNR
      !GJAHR type BKPF-GJAHR
      !URL type STRING
      !TITULO type STRING
    returning
      value(ERROR) type EKKO-LOEKZ .
  class-methods GET_URL_POR_TITULO_ST
    importing
      !BUKRS type BKPF-BUKRS default ZCL_C=&gt;BUKRS
      !BELNR type BKPF-BELNR
      !GJAHR type BKPF-GJAHR
      !TITULO type STRING
    returning
      value(URL) type STRING .
  class-methods BORRAR_URL_GOS_ST
    importing
      !BUKRS type BKPF-BUKRS default ZCL_C=&gt;BUKRS
      !BELNR type BKPF-BELNR
      !GJAHR type BKPF-GJAHR
      !URL type STRING
      !TITULO type STRING
    returning
      value(ERROR) type EKKO-LOEKZ .</publicSection>
 <protectedSection>*&quot;* protected components of class ZCL_FI_REL_DOCS
*&quot;* do not include other source files here!!!
protected section.</protectedSection>
 <privateSection>*&quot;* private components of class ZCL_DOC_FI_PRELIM
*&quot;* do not include other source files here!!!
private section.</privateSection>
 <localImplementation>*&quot;* local class implementation for public class
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</localImplementation>
 <localTypes>*&quot;* use this source file for any type declarations (class
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</localTypes>
 <localMacros>*&quot;* use this source file for any macro definitions you need
*&quot;* in the implementation part of the class</localMacros>
 <attribute CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="BKPF" VERSION="1" LANGU="S" DESCRIPT="Cabecera de documento para Contabilidad" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" ATTDECLTYP="0" ATTEXPVIRT="0" TYPTYPE="1" TYPE="BKPF" SRCROW1="0 " SRCCOLUMN1="0 " SRCROW2="0 " SRCCOLUMN2="0 " R3RELEASE="700" TYPESRC_LENG="0 "/>
 <method CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="BORRAR_URL_GOS_ST" VERSION="1" LANGU="S" DESCRIPT="Borrar URL en documento" EXPOSURE="2" STATE="1" EDITORDER="4 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" MTDTYPE="0" MTDDECLTYP="1" R3RELEASE="700" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="BORRAR_URL_GOS_ST" SCONAME="BUKRS" VERSION="1" LANGU="S" DESCRIPT="Sociedad" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-BUKRS" PARVALUE="ZCL_C=&gt;BUKRS"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="BORRAR_URL_GOS_ST" SCONAME="BELNR" VERSION="1" LANGU="S" DESCRIPT="Número de un documento contable" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-BELNR"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="BORRAR_URL_GOS_ST" SCONAME="GJAHR" VERSION="1" LANGU="S" DESCRIPT="Ejercicio" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-GJAHR"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="BORRAR_URL_GOS_ST" SCONAME="URL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="BORRAR_URL_GOS_ST" SCONAME="TITULO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="BORRAR_URL_GOS_ST" SCONAME="ERROR" VERSION="1" LANGU="S" DESCRIPT="Se ha producido error" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="EKKO-LOEKZ"/>
  <source>method BORRAR_URL_GOS_ST.

  DATA l_clave TYPE srgbtbrel-instid_a.

  concatenate bukrs belnr gjahr into l_clave.
  error = zcl_gos=&gt;borrar_url_gos_st( tipo   = &apos;FIPP&apos;
                                clave  = l_clave
                                titulo = titulo
                                url    = url ).

endmethod.</source>
 </method>
 <method CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_BKPF" VERSION="1" LANGU="S" DESCRIPT="Recupera datos de caberca" EXPOSURE="2" STATE="1" EDITORDER="1 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" MTDTYPE="0" MTDDECLTYP="1" R3RELEASE="700" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_BKPF" SCONAME="BUKRS" VERSION="1" LANGU="S" DESCRIPT="Sociedad" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-BUKRS" PARVALUE="ZCL_C=&gt;BUKRS"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_BKPF" SCONAME="BELNR" VERSION="1" LANGU="S" DESCRIPT="Número de un documento contable" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-BELNR"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_BKPF" SCONAME="GJAHR" VERSION="1" LANGU="S" DESCRIPT="Ejercicio" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-GJAHR"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_BKPF" SCONAME="BKPF" VERSION="1" LANGU="S" DESCRIPT="Cabecera de documento para Contabilidad" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="BKPF"/>
  <source>method GET_BKPF.

  select single * from bkpf
    into bkpf
   where bukrs = bukrs
     and belnr = belnr
     and gjahr = gjahr.

endmethod.</source>
 </method>
 <method CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_URL_POR_TITULO_ST" VERSION="1" LANGU="S" DESCRIPT="Devuelve URL por titulo" EXPOSURE="2" STATE="1" EDITORDER="3 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" MTDTYPE="0" MTDDECLTYP="1" R3RELEASE="700" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_URL_POR_TITULO_ST" SCONAME="BUKRS" VERSION="1" LANGU="S" DESCRIPT="Sociedad" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-BUKRS" PARVALUE="ZCL_C=&gt;BUKRS"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_URL_POR_TITULO_ST" SCONAME="BELNR" VERSION="1" LANGU="S" DESCRIPT="Número de un documento contable" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-BELNR"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_URL_POR_TITULO_ST" SCONAME="GJAHR" VERSION="1" LANGU="S" DESCRIPT="Ejercicio" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-GJAHR"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_URL_POR_TITULO_ST" SCONAME="TITULO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="GET_URL_POR_TITULO_ST" SCONAME="URL" VERSION="1" LANGU="S" DESCRIPT="Documentos URL GOS" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="STRING"/>
  <source>method GET_URL_POR_TITULO_ST.
  DATA l_clave TYPE srgbtbrel-instid_a.

  if not belnr is initial.
  concatenate bukrs belnr gjahr into l_clave.
  url = zcl_gos=&gt;get_url_por_titulo_st( tipo   = &apos;FIPP&apos;
                                        clave  = l_clave
                                        titulo = titulo ).
  endif.

endmethod.</source>
 </method>
 <method CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="INSERTAR_URL_GOS_ST" VERSION="1" LANGU="S" DESCRIPT="Insertar URL en documento" EXPOSURE="2" STATE="1" EDITORDER="2 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" MTDTYPE="0" MTDDECLTYP="1" R3RELEASE="700" BCMTDCAT="00" BCMTDSYN="0">
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="INSERTAR_URL_GOS_ST" SCONAME="BUKRS" VERSION="1" LANGU="S" DESCRIPT="Sociedad" CMPTYPE="1" MTDTYPE="0" EDITORDER="1 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-BUKRS" PARVALUE="ZCL_C=&gt;BUKRS"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="INSERTAR_URL_GOS_ST" SCONAME="BELNR" VERSION="1" LANGU="S" DESCRIPT="Número de un documento contable" CMPTYPE="1" MTDTYPE="0" EDITORDER="2 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-BELNR"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="INSERTAR_URL_GOS_ST" SCONAME="GJAHR" VERSION="1" LANGU="S" DESCRIPT="Ejercicio" CMPTYPE="1" MTDTYPE="0" EDITORDER="3 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="BKPF-GJAHR"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="INSERTAR_URL_GOS_ST" SCONAME="URL" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="4 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="INSERTAR_URL_GOS_ST" SCONAME="TITULO" VERSION="1" LANGU="S" CMPTYPE="1" MTDTYPE="0" EDITORDER="5 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="0" PARPASSTYP="1" TYPTYPE="1" TYPE="STRING"/>
  <parameter CLSNAME="ZCL_AP_DOC_FI_PRELIM" CMPNAME="INSERTAR_URL_GOS_ST" SCONAME="ERROR" VERSION="1" LANGU="S" DESCRIPT="Se ha producido error" CMPTYPE="1" MTDTYPE="0" EDITORDER="6 " DISPID="0 " AUTHOR="APICAZO" CREATEDON="20120306" CHANGEDON="00000000" PARDECLTYP="3" PARPASSTYP="0" TYPTYPE="1" TYPE="EKKO-LOEKZ"/>
  <source>method INSERTAR_URL_GOS_ST.

  DATA l_clave TYPE srgbtbrel-instid_a.

  concatenate bukrs belnr gjahr into l_clave.
  error = zcl_gos=&gt;insertar_url_gos_st( tipo   = &apos;FIPP&apos;
                                clave  = l_clave
                                titulo = titulo
                                url    = url ).

endmethod.</source>
 </method>
</CLAS>
